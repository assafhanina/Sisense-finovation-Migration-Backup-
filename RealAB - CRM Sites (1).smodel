{
    "title": "RealAB - CRM Sites",
    "type": "extract",
    "buildDestination": {
        "destination": "elasticube"
    },
    "fiscal": "system",
    "relations": [
        {
            "type": null,
            "columns": [
                {
                    "dataset": "1bb0efa4-ebc6-40ac-a702-05ea375429ed",
                    "table": "22fa6e2d-a79e-48ad-9881-87df2c9d69b1",
                    "column": "ccc416e2-6734-4913-889f-11032629c95f"
                },
                {
                    "dataset": "57eaec9f-1b7e-473e-b183-c9772c96316c",
                    "table": "4965aea6-148c-4b5f-9563-da2382b062a1",
                    "column": "0253cfe3-5b6b-4c92-98bb-503dceb64da4"
                },
                {
                    "dataset": "830d4746-9c3a-4cdf-b6e5-fae353e8f18d",
                    "table": "9e74eddc-4972-46b0-a406-c87a30391a10",
                    "column": "33ec7f8f-d879-469d-801c-eedb5a42c35b"
                },
                {
                    "dataset": "59ee1f1a-fac6-475c-8392-e086ea5fddf2",
                    "table": "a9a08c29-c754-4aac-ace0-44db6e0006c6",
                    "column": "022b6178-3956-4904-a294-0a1c93e875f5"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "346f4039-3cf8-4bf6-b108-4dc3d5f60c6a",
                    "table": "10b8599f-82ab-423b-a671-f7e32f13c5a1",
                    "column": "b4915dc3-ed8c-4dea-a00a-87d57abeed4c"
                },
                {
                    "dataset": "1bb0efa4-ebc6-40ac-a702-05ea375429ed",
                    "table": "22fa6e2d-a79e-48ad-9881-87df2c9d69b1",
                    "column": "c2499c2d-b73c-4c28-97ae-e2770827cf32"
                },
                {
                    "dataset": "830d4746-9c3a-4cdf-b6e5-fae353e8f18d",
                    "table": "9e74eddc-4972-46b0-a406-c87a30391a10",
                    "column": "20913230-a57d-44e7-ad70-59fc2ac08224"
                },
                {
                    "dataset": "59ee1f1a-fac6-475c-8392-e086ea5fddf2",
                    "table": "a9a08c29-c754-4aac-ace0-44db6e0006c6",
                    "column": "9932987c-2449-4aa9-828c-6afed87d02c6"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "0299345c-bb88-4518-84db-928332852f4c",
                    "table": "9e4be48b-7653-4433-8ae4-1d20b5ec2921",
                    "column": "28ebaeb5-8c65-463e-aae2-4c9b8149bcd5"
                },
                {
                    "dataset": "1bb0efa4-ebc6-40ac-a702-05ea375429ed",
                    "table": "22fa6e2d-a79e-48ad-9881-87df2c9d69b1",
                    "column": "069909fa-50c1-4081-b896-433e1bf07a3c"
                },
                {
                    "dataset": "59ee1f1a-fac6-475c-8392-e086ea5fddf2",
                    "table": "a9a08c29-c754-4aac-ace0-44db6e0006c6",
                    "column": "eee88e36-881f-42e5-972f-226a5e80050d"
                },
                {
                    "dataset": "830d4746-9c3a-4cdf-b6e5-fae353e8f18d",
                    "table": "9e74eddc-4972-46b0-a406-c87a30391a10",
                    "column": "27cdbc1d-a3f5-48ff-8b70-bf38e199aa01"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "0de89b60-ad57-487b-89dd-243d55054cb6",
                    "table": "b72865b7-b46f-410d-a594-b73db6ee183b",
                    "column": "14930bd8-6fc8-4c2a-a189-e2fa4354f547"
                },
                {
                    "dataset": "830d4746-9c3a-4cdf-b6e5-fae353e8f18d",
                    "table": "9e74eddc-4972-46b0-a406-c87a30391a10",
                    "column": "5929559f-3e6f-4e1f-8467-617a02ff9c41"
                },
                {
                    "dataset": "59ee1f1a-fac6-475c-8392-e086ea5fddf2",
                    "table": "a9a08c29-c754-4aac-ace0-44db6e0006c6",
                    "column": "c64b87f9-7512-438f-a94c-54eaff038b4a"
                },
                {
                    "dataset": "1bb0efa4-ebc6-40ac-a702-05ea375429ed",
                    "table": "22fa6e2d-a79e-48ad-9881-87df2c9d69b1",
                    "column": "4b2f80ba-ce5c-4114-b051-6eacd606c9ba"
                }
            ]
        }
    ],
    "datasets": [
        {
            "oid": "00a1dd10-d9a8-4fcd-bec2-90fbf210d225",
            "fullname": "MySql:MySql-00a1dd10-d9a8-4fcd-bec2-90fbf210d225",
            "type": "extract",
            "name": "MySql-00a1dd10-d9a8-4fcd-bec2-90fbf210d225",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1925e378-73fe-481c-b150-d596a8f7c188",
                        "id": "tq_PLUAX1N5M",
                        "name": "Arrow_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a3f40fbc-1991-4047-9b08-106c17d58a52",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4a4df81-27e8-41b0-8191-d44e804b438b",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "59967249-c8bf-4da0-809f-81c03aae48d7",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9c732d32-e016-4f44-b891-802ef608a0a9",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ab135fc3-244c-4f32-80b1-fb8268a0794e",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ce62aa94-5656-43e7-8058-4938858816d5",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a5c81984-ffae-4aec-b439-a674536f38e7",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8cf5dea1-4a7d-4aee-9ea6-ea4ff18afa25",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "0b4be129-50bb-43e5-8638-c5b86d7cda70",
                        "configOptions": {
                            "importQuery": "select\n\tcast(brand.id + 1000 as char) as site_name,\n\tconcat(cast(brand.id + 1000 as char), '10010', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on trader_account.id = trader.default_account_id\ninner join brand on trader.brand_id = brand.id"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "7e9b70bc-4ead-435a-8b30-f67559c46b0b",
                        "id": "tq_jvVKJQzOE",
                        "name": "Arrow_eom_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "cfe6da6b-d007-4e18-8b69-4d92e37cef32",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "786c9772-4ea8-4276-9541-1cecfbf2577d",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e8eebc4-8eb7-4289-b26f-e4d28b34a0cf",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19c50d79-28b9-40e5-b8c9-c3aed1382dc6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37f38bb2-388c-4a73-8cbf-8eda95091521",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c7c5f900-b7ae-4f84-b538-452c6fe4ceab",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "869acf53-6c24-4099-b8fa-44545243ce2e",
                        "configOptions": {
                            "importQuery": "select `date`, YEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key, code, site_id,employee_key, open_pnl\nfrom\n(select open_pnl_per_day.*, case when `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date` else last_day(`date`) end as eom_date \nfrom\n(select  `date` - interval 1 day as 'date',c.code, cast(1000 + e.id as char) as site_id, concat(cast(1000 + e.id as char),10010,d.user_id) as employee_key, sum(open_pnl) as open_pnl\nfrom open_pnl_daily a \ninner join trader_account b on a.trader_id = b.trader_id \ninner join currency c on b.currency_id = c.id\ninner join trader d on a.trader_id = d.id\ninner join brand e on d.brand_id = e.id\ngroup by 1,2,3,4) open_pnl_per_day) eom_pnl\nwhere `date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd28a56da002c368dcf",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFMaz+izJFwQ7HgJUHVXggmldBM8T/h1mY0r2y8zpsHvKmwzD6I8ssX+l0X+TuIP5Ql2SkezEu+zKlhGGjozXGuYOz5g3alToOKLh+ovnOTKLddCPNh4ut0H9WpKzkvNXxw==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "01824bbf-bb83-4ad7-aa22-561af438370a",
            "fullname": "MySql:MySql-01824bbf-bb83-4ad7-aa22-561af438370a",
            "type": "extract",
            "name": "MySql-01824bbf-bb83-4ad7-aa22-561af438370a",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "61190cd28a56da002c368dd1",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFMMaoUpheaIg1X20cwDm22EnLAAqvqavFiaH0phSqpzlex53e6kdd5tYPRE2QovPreS5AwJdfzfupHCfQ7lkIdkgGgRCQg8p+EiFSUUd+ptD",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "028b4ef7-e526-48c0-b401-46319c18179d",
            "fullname": "MySql:4183a4d7-64a0-4490-81c8-dd7da2e18027",
            "type": "extract",
            "name": "4183a4d7-64a0-4490-81c8-dd7da2e18027",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "61190cd28a56da002c368dd3",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoholBm9zTgPkWmVjr8ZqHeK",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0299345c-bb88-4518-84db-928332852f4c",
            "fullname": "MySql:MySql-0299345c-bb88-4518-84db-928332852f4c",
            "type": "extract",
            "name": "MySql-0299345c-bb88-4518-84db-928332852f4c",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9e4be48b-7653-4433-8ae4-1d20b5ec2921",
                        "id": "dim_date",
                        "name": "DW_DimDate",
                        "type": "base",
                        "schemaName": "ext_mart_prod",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "28ebaeb5-8c65-463e-aae2-4c9b8149bcd5",
                                "id": "DateKey",
                                "name": "DateKey",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4a2ec024-69e4-4ac2-9f08-cb9d11c92ea9",
                                "id": "Full_Date",
                                "name": "Full_Date",
                                "type": 19,
                                "size": 26,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a1a0c3c3-596b-44de-88b7-dbb9e87193ac",
                                "id": "FullDateTime",
                                "name": "FullDateTime",
                                "type": 19,
                                "size": 26,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2040411-6b3e-4e30-9b80-6d17a263bc13",
                                "id": "Date_Name",
                                "name": "Date_Name",
                                "type": 18,
                                "size": 11,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "229478a8-967f-4790-bb78-0e6e7e6ea33f",
                                "id": "Date_Name_Us",
                                "name": "Date_Name_Us",
                                "type": 18,
                                "size": 11,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "134e0821-d5a1-4e56-9a56-914084931af4",
                                "id": "Date_Name_Eu",
                                "name": "Date_Name_Eu",
                                "type": 18,
                                "size": 11,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c9dd790-b653-4096-972b-3ca04084fdee",
                                "id": "Day_Of_Week",
                                "name": "Day_Of_Week",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "66ac089f-c1d9-4da7-9c7c-bdc182c3d67e",
                                "id": "Day_Name_Of_Week",
                                "name": "Day_Name_Of_Week",
                                "type": 18,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01b5964a-ea9b-4646-a424-bd2c77ed8f0d",
                                "id": "Day_Of_Month",
                                "name": "Day_Of_Month",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a039d73e-ec5d-4975-b812-d10fb3c36d3e",
                                "id": "Day_Of_Year",
                                "name": "Day_Of_Year",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f2c99de-98bf-4987-811b-db687f4c8c0d",
                                "id": "year_day",
                                "name": "year_day",
                                "type": 18,
                                "size": 7,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e5fd76b-2f88-401f-8fe6-df8ef1239c40",
                                "id": "Weekday_Weekend",
                                "name": "Weekday_Weekend",
                                "type": 18,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "088da470-dcbf-4876-aaf4-f4e54f1d8547",
                                "id": "Week",
                                "name": "Week",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "012d59e1-64a6-454a-b96b-deb6593acd07",
                                "id": "Month_Name",
                                "name": "Month_Name",
                                "type": 18,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4608ffb2-adac-4db7-be8d-29571686af65",
                                "id": "Month_Of_Year",
                                "name": "Month_Of_Year",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eaf08980-998f-4ed4-a09c-d43247ed2265",
                                "id": "Is_Last_Day_Of_Month",
                                "name": "Is_Last_Day_Of_Month",
                                "type": 18,
                                "size": 1,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e492d310-016a-4a90-b9f4-8200ef704c46",
                                "id": "Calendar_Quarter",
                                "name": "Calendar_Quarter",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bc8cd3a8-fcfe-4bd1-9274-e02a1b4565ce",
                                "id": "Calendar_Year",
                                "name": "Calendar_Year",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5fe3968d-eb20-4d59-bf83-e07c9c01e44a",
                                "id": "Calendar_Year_Month",
                                "name": "Calendar_Year_Month",
                                "type": 18,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ecae283-a9ad-435e-a94a-8021d91935bc",
                                "id": "Calendar_Year_Qtr",
                                "name": "Calendar_Year_Qtr",
                                "type": 18,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a782fecb-0a9e-4f6c-9c90-679ec09a6a61",
                                "id": "Fiscal_Month_Of_Year",
                                "name": "Fiscal_Month_Of_Year",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "81a58bd6-fcb3-4fbe-9520-4d48d8717898",
                                "id": "Fiscal_Quarter",
                                "name": "Fiscal_Quarter",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fdc998da-6e83-423f-b4bc-6eab5c4bdef5",
                                "id": "Fiscal_Year",
                                "name": "Fiscal_Year",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da870d4b-059e-4411-8e9f-218b1eec18d4",
                                "id": "Fiscal_Year_Month",
                                "name": "Fiscal_Year_Month",
                                "type": 18,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72179e2b-9f27-4b20-8c6c-829549f993d6",
                                "id": "Fiscal_Year_Qtr",
                                "name": "Fiscal_Year_Qtr",
                                "type": 18,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d40c4bad-dc3d-48f1-b8f1-2d0104b047a4",
                                "id": "Today_Ind",
                                "name": "Today_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b00cf2bd-b8e6-4c44-b66a-281bee43ada2",
                                "id": "Yesterday_Ind",
                                "name": "Yesterday_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a846f2b2-b5cb-4640-8f86-50cd065a785e",
                                "id": "This_Week_Ind",
                                "name": "This_Week_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "127e3502-c905-47e3-9512-c111990c9d1f",
                                "id": "Last_Week_Ind",
                                "name": "Last_Week_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1ca40140-5153-4035-85dc-5cc03416cf5e",
                                "id": "Last7_Days_Ind",
                                "name": "Last7_Days_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "629316d4-541f-4808-b6a9-9a634838c4ce",
                                "id": "This_Month_Ind",
                                "name": "This_Month_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "566d1344-a750-4728-a101-32c475d0cbd2",
                                "id": "Last_Month_Ind",
                                "name": "Last_Month_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "81e366b9-abdd-4aa5-8f3e-08ec6ac1562e",
                                "id": "Last_30_Days_Ind",
                                "name": "Last_30_Days_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "39d6b1f4-134b-48a4-bee2-d44c0be6f2db",
                                "id": "This_Year_Ind",
                                "name": "This_Year_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "496e7239-0a93-4968-9c5f-1677ab1ee90d",
                                "id": "Last_Year_Ind",
                                "name": "Last_Year_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d60ea7f2-1a09-427f-b654-44ba944e1556",
                                "id": "Last_Week_Equivalent_Period_Ind",
                                "name": "Last_Week_Equivalent_Period_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d7b319b3-820f-4631-ac24-b57d92e2d636",
                                "id": "Last_Month_Equivalent_Period_Ind",
                                "name": "Last_Month_Equivalent_Period_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "99fe3fac-b701-4f17-987e-536623cc9447",
                                "id": "Last_Year_Equivalent_Period_Ind",
                                "name": "Last_Year_Equivalent_Period_Ind",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aa9290cb-d5bc-48f9-bff2-11ce5b7243b4",
                                "id": "Retention",
                                "name": "Retention",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "28ebaeb5-8c65-463e-aae2-4c9b8149bcd5",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "ad378c5e-b3f9-4d1a-bf04-53efe8753e22",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd28a56da002c368dd5",
                "provider": "MySql",
                "parameters": "vbzYfS4H8zKaaa63Q8eVyx36cxK7oYg+4Q5WunfT3zgdww2iSGhTLrUnq7V9U0erIOY0jNYmKt9GMi/AOy4uJor53Wy5pKADZZQU4IywmnjHaGH4fezFLpM4Qgb/nP5Qo2z3T75JjWg0asinZRH4nPIpWIWzjBZUhPLin/PXCjhJiUvrOtcx64Deeph0+EQDy1nQEeRpJE9+RWm+KH4ERg==",
                "schema": "ext_mart_prod",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0ba89b2f-5cdb-4993-bcff-a19a44864890",
            "fullname": "MySql:9ac374b0-aff7-4392-afd1-58e0261adcfa",
            "type": "extract",
            "name": "9ac374b0-aff7-4392-afd1-58e0261adcfa",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "033e1927-4b69-4198-a949-b006034788a2",
                        "id": "tq_tEcd4Urdc",
                        "name": "Chelsea_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "4cbe9f72-7821-423e-8193-48afd47b4d25",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa68c322-612e-430c-ba47-94758062f2be",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebf91cc1-57e0-4a5a-b5c3-aa72c62a4802",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "395d755e-c786-4c0c-b2aa-550b9b16d8b5",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a82c3de-9c4c-465f-ab2e-0d674aa5c747",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6118d583-bc50-43a4-9e7d-2b5337df3cdc",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5844834d-a591-4d09-b88c-72f0a07dc27f",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61a798ce-f5a5-4de5-b3bb-4f8087329a77",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d0a29a5-7eda-4466-8b0f-6a8d159f47e6",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a786ba8e-2467-4247-af36-437cc057dc9c",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "82dea4cb-2348-4241-9d1a-ab4793a6b176",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d67b6780f2002c37ec2e",
                "provider": "MySql",
                "parameters": "BE4OxiDqsaVb+1ukLM/AG3kiM0mBmEnf5+RF0FNWdMvVMRLKEGHP7i8Jb4OVv7CAoJrH7a/nkykrGiit3FSG/m85DPOX2IUqB6qOs2clw5riXmxFSMuiF3F8MgrP3MH12R4ofvsfF/fYNHAGVdVhOGjYUgjhzKoG+h+ur0i61f2xq5hHO9UjwqjzFmrYrN8ntau9AUUkD/MC6QOashL2AjWRcvpvZbZikoelSn8/Tb4Qv8PiC23gjgUiJBr0/QAq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0d1d2e76-cd01-41a3-994e-636ec8677320",
            "fullname": "MySql:62e1eff4-7e7b-4e79-8d13-b16e3769cc36",
            "type": "extract",
            "name": "62e1eff4-7e7b-4e79-8d13-b16e3769cc36",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "3b7187a6-24b1-406e-8636-7d5fdfbbb7c0",
                        "id": "tq_prfjdtX4z",
                        "name": "FXVC_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5ed2c4bb-116d-4243-bc31-cbb6bcb870bf",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "121cecf1-82a8-442c-9b2e-105b1afc7e1a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05b05880-102b-4702-b2ea-f780e77b033d",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25be84a1-eb9f-47c1-abaa-a1adc5c5f345",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e76b7a89-0b8b-414f-a64f-19c13ad1123b",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30dc0a75-c758-4cb3-8054-09cf059387bd",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ee050b0-d542-4420-a3b2-f75ecc34d7a7",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9ddd583-999e-4e3d-a2ae-1dc05722862d",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26c88191-714b-4eda-b458-207ad9d76411",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 306,
                                "precision": 306,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c835e33-f8b9-45ee-8c7d-e79077b08966",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d89d7ae4-28ee-464b-86b7-c768ff959169",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5c0eb9ec-be55-486d-9159-4123668f9bec",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b83f7ca9-c224-4a92-b753-3ab3b58a0fdc",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1047eaa-2a5d-47a6-a7ec-af7d03ca7ea0",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "46042a6b-a05d-45d5-b021-748be3697d92",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "127ebbca-4cff-499e-b08e-4cfa4f6b70bb",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "87f987f4-ade6-4214-9277-866e8d4fe7b8",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "409d18aa-1133-4500-b12b-846908b3a504",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb2cb7ac-043a-4e2f-9664-67dd99a68508",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8a73b54-2c6b-4dac-a2d5-b7b042f51b05",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f79ca343-5af3-40fb-9688-e355c99af8f8",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6cab3f71-f113-4b91-a04a-0ca6c21d599a",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91e3d641-54e2-467e-acdc-87c3a7d014f2",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c459245e-c175-47e0-a52f-40b69ad67909",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "926ffc2d-94b8-4ca8-8dba-dc8729568558",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4817c3ec-57b4-43fb-aca0-166f929eca2c",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d0797df9-59fa-40ff-8710-76289328e7f8",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2e6653b1-4288-4a3c-862c-40536b6352e5",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e3d3656-1d75-4e51-ad51-6a1a9e1de8d4",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a4e5febc-aa57-4d89-849c-4017d7c4a5eb",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dbf822a2-1ba2-45e0-be28-008fb8fba558",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3912ebed-e0a1-408d-add1-cca08267ef66",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5723897e-5f36-4fd0-bb1b-1a98503b4874",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8c71150c-a934-43f8-9aa3-056d0cfb8301",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9307ea38-7ff7-4002-b4bd-b557c4823517",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "38fb24b3-4ef1-43f7-aac4-0e12aa90580f",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c78d2ab0-383f-4631-a1d7-caf1ffdcbc2c",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b6590669-139e-4a75-9953-fdfc96b08d96",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a7c15d2c-7127-4321-8b3a-78869798fccd",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "316361f8-9458-40d2-aaf4-3ee76a4bdc53",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "09b0dd8b-c70d-44ad-bc2d-0846926087bb",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84d12a82-449e-4c33-be09-e1f600f5be61",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de4cffc6-5acf-405d-8c9e-828fb448bc96",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "474379cd-8129-497e-ba32-66bed719dbdd",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a93204df-dd00-4cb1-8ee5-029d630f6ccf",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d01bc993-f05d-45d7-9050-5c972cf1e0e2",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6576894a-4c5d-437c-b1f5-4f1827c27944",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "03938fb0-7d52-4cf1-b078-fcb432ed5cfb",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de872b92-3bbd-4921-b8d3-d98858cb9517",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87058ca5-c870-4e4f-8681-c8cc5d5c5128",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "479ca468-0fa5-4e0a-9431-2968be9a2acf",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a1af03c7-c633-49cb-9702-d2f383f73138",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bd5168f7-25f1-4d29-b4ca-63e1b9339ebc",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bd4ba4d2-bf75-481b-90ac-755495bd94b8",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f714e4b-263f-482d-aa08-6ba6d29e1621",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "c459245e-c175-47e0-a52f-40b69ad67909",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "00491f4f-3b5e-4150-8f5e-fbb44568d286",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10006, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10006, trader.user_id ) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20200224\r\n\t\tand trader_marketing_data.utm_aff_id = 94 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20200224\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t'Null') as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tCOALESCE(acc_type.name,'BASIC') as account_type,\r\n\ttrader.lead_score,\r\n\ttrader_status.name as trader_status,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\tdates.days_from_last_deposit,\r\n\tcase\r\n\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\telse dates.days_from_last_deposit\r\n\tend as min_active_day,\r\n\tcase\r\n\t\twhen\r\n\t\t(case\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit\r\n\t\tend) <= 30 then 1\r\n\t\telse 0\r\n\tend as is_active,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen country.name in ('Switzerland',\r\n\t\t'Germany',\r\n\t\t'Austria') then 'Germany'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen country.id in (14,\r\n\t\t86,\r\n\t\t225) then 2\r\n\t\telse 1\r\n\tend as locale_group_id\r\nfrom\r\n\ttrader\r\ninner join brand on trader.brand_id = brand.id\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join trader_status on\r\n\ttrader.trader_status_id = trader_status.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (9,10,11,24,61,208,318,335,336,337,344,379,497,517,547,582,700,720)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (select trader_trade_configuration_group.trader_id,name\r\n\tfrom (\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by 1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_type on acc_type.trader_id = trader.id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tcase\r\n\t\t\twhen group_type.name = 'Branch'\r\n\t\t\tand `group`.name = 'Cyprus EU' then 'Conversion'\r\n\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\telse group_type.name\r\n\t\tend as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\tuser_groups.id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\tand e.name = 'Cyprus EU' then 'Conversion'\r\n\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\telse f.name\r\n\t\t\tend = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id =\r\n\t\t(case\r\n\t\t\twhen e.parent_id is null then e.id\r\n\t\t\telse e.parent_id\r\n\t\tend)\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Cyprus EU' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (9,10,11,24,61,208,318,335,336,337,344,379,497,517,547,582,700,720)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Cyprus EU' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (9,10,11,24,61,208,318,335,336,337,344,379,497,517,547,582,700,720)\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\nand trader.id not in (1235547,1235546,1241054)"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "66bc2610-b234-4bb3-9d2b-8a8d299f9def",
                        "id": "tq_umg0CMiXA",
                        "name": "FXVC_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "04857c68-f636-4bca-b6e1-8d21504c9530",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d2a95256-a025-4a0f-991b-9b3092db9485",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "38d7aa9a-4598-4a1e-9b8d-6a24e21424f0",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f618d2ba-5ed0-477a-befc-a1b32535d69f",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0409cc61-685b-46d5-96d1-6a70a2dcb58d",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c77e5dc9-dab6-41ac-b181-46c27afd9eed",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "59193745-eb55-440d-9ca9-bd45dc7cd680",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b39f604f-619b-40c1-8244-c37c4d738d39",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "750bbfac-be0b-44bd-a144-a7ea8671cc77",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6fd33a29-19a2-40ee-b8de-2a4d3317d874",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "33c52bc5-12b7-4d43-9801-c6764039a729",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10006, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Cyprus EU' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name\r\n\tend as department,\r\n\tgroup_name.name as group_name\r\nfrom\r\n\t`user`\r\nleft join brand on 1=1\r\nleft join (\r\n\t\tselect a.id,\r\n\t\tmin(c.id) as group_id\r\n\tfrom\r\n\t\t`user` a\r\n\tinner join user_group b on\r\n\t\ta.id = b.user_id\r\n\tinner join `group` c on\r\n\t\tb.group_id = c.id\r\n\twhere\r\n\t\tc.parent_id is not null\r\n\tgroup by\r\n\t\t1\r\nunion\r\n\tselect\r\n\t\temp.id,\r\n\t\tmin(user_group.group_id) as group_id\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect proba.id,\r\n\t\t\tsum(ch)\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\telse 0\r\n\t\t\t\tend as ch\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id)proba\r\n\t\tgroup by\r\n\t\t\t1\r\n\t\thaving\r\n\t\t\tsum(ch) = 0) emp\r\n\tinner join user_group on\r\n\t\temp.id = user_group.user_id\r\n\tgroup by\r\n\t\t1) user_groups on\r\n\t`user`.id = user_groups.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id =\r\n\t(case\r\n\t\twhen `group`.parent_id is null then `group`.id\r\n\t\telse `group`.parent_id\r\n\tend)"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "f658b0b6-b7e9-450d-b20e-0bc89cdf8a71",
                        "id": "tq_HtXpdhbt2",
                        "name": "FXVC_PnL",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5f8541d6-abb5-4c9c-9d78-5444595f2fdf",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a66c8b8-1bae-4d75-a485-82f62bb21976",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2be82fb1-1424-463f-89b1-55377e85422a",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1675a26f-0976-41da-ae6a-21ded048ef68",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e2740209-4c1c-4d9e-a356-8cfa7a721230",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "163717a7-f650-464f-a70f-2fc2d7481e38",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "828e068c-6077-40f9-a3a9-a87fbfe898df",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5422ca8d-c57e-46ba-9e34-86186983de02",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "d66830e1-ace0-4723-b7b1-b6f1929e0564",
                        "configOptions": {
                            "importQuery": "select\r\n\tcast(1000 + brand.id as char) as site_name,\r\n\tconcat(cast(1000 + brand.id as char), '10006', b.trader_id) as customer_key,\r\n\tb.trader_id as customer_id,\r\n\tcase when b.id < 540973 then year(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) else year(b.date) * 10000 + month(b.date) * 100 + day(b.date) end as date_key,\r\n\tcase when b.id < 540973 then b.date - interval 1 day else b.date end as date,\r\n\tb.open_pnl,\r\n\tb.open_pnl_diff,\r\n\tcurrency.code\r\nfrom\r\n\t(\r\n\tselect\r\n\t\ta.*,\r\n\t\tcase\r\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\r\n\t\t\telse a.open_pnl\r\n\t\tend as open_pnl_diff,\r\n\t\t@last_id := a.trader_id,\r\n\t\t@last_open_pnl := a.open_pnl\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\t*\r\n\t\tfrom\r\n\t\t\topen_pnl_daily\r\n\t\torder by\r\n\t\t\t2,\r\n\t\t\t3 asc) a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t@last_open_pnl := 0,\r\n\t\t\t@last_id := 0) b on\r\n\t\t1 = 1) b\r\ninner join trader_account on\r\n\tb.trader_id = trader_account.trader_id\r\ninner join currency on\r\n\ttrader_account.currency_id = currency.id\r\ninner join trader on trader_account.id = trader.default_account_id\r\ninner join brand on trader.brand_id = brand.id\r\nwhere trader.id not in (1235547,1235546,1241054)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d3e56780f2002c37e9e5",
                "provider": "MySql",
                "parameters": "WsI2hGSf+dwqwSmh3TwuaO5Wqyut2TolmY92AeMWG08Xb/qjvMSuJGDm7JgDb9ySN0Xzjcz6PcqDViRiguXgcyUcf67U5gmIeajObfUj6tad7qKg1ZyeZwUIoxukmQND00I4zC3BmvjqPn25FTUhgHP3RYM8ArHf/0HcoZWv1DmBWB+C7ubJWy8Uvvn0dZZ2wfbKHoMxLVw5QXqUnoA4Rcv4hPfy04GTGD4JjZKhQpG3q2QKft9MDNcPxMaq0dSx",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0ddce9bc-25a3-40d3-9a35-2bad1ab60a80",
            "fullname": "MySql:3b0c76b3-521d-4937-977e-a7c41322af40",
            "type": "extract",
            "name": "3b0c76b3-521d-4937-977e-a7c41322af40",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "858b54ec-546e-4279-82ff-543c574f159f",
                        "id": "tq_Ef3dCbAXq",
                        "name": "NostraCapital_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "438822aa-f983-4c2d-816e-d28bfbcb66db",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "378bd833-fc47-4bbf-819c-b9f7c68b2c0a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ebcc521-73cf-4c23-a12d-bc28d6d602e1",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd777ca9-57ff-4648-9e61-794e5be0032b",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e9af497-fcf8-4443-ae5d-13dc493ad3c6",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0445f13-0202-4376-a625-a63b0f8fd5aa",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0b45f2f-027b-485e-b079-4ad56f2890e7",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef2f6b29-356c-4cea-908b-3c20f59a2dab",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e4c5725-054f-4f1b-8056-7bd0fd5a4591",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9153fd08-07d7-4720-92cb-81c499ae8456",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72d85bda-9dc4-4f42-9390-67a4c1965ee1",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e79b3503-3392-4c35-9ada-e067c2204d23",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40d5f86c-2b46-4bb5-a088-ec19bbe8d64f",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "43cf868b-84a8-4da0-b9ea-1ef5cac15d81",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31d40d59-bdc5-422a-9501-adc1e408effb",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5db0667f-d8e7-4adc-8eec-da8c2b46a0b9",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1dbede1c-869b-4bc8-83ef-06dbd8db6b56",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9580aea8-6f5d-4384-8476-53c40d1b3d45",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "080f395a-b7f2-4afd-b3b5-62832d078330",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4dcc3b10-0ee6-4ba3-856f-267518c9d683",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8199eb6c-be49-4d79-a0a6-ef1bb4ba3011",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4dbc3b35-93a3-42c5-87c5-97d7d00fa685",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41310688-cfe1-4dcc-bfd0-6487695b22a3",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ddc1a844-10ed-4bf5-9cfc-b00f368d6c09",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "47400896-b19a-4b9b-85cd-14f57644e31f",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "754752ce-a226-435d-b548-0250cf9d5f8c",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48b8356c-ab9d-4f2b-a407-900bb5320dfc",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f929bee7-c985-4ec7-94cf-d926dee0e3de",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8124ef5f-f390-4858-91da-bcc31aa2ddff",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cb08ce3-f6ce-47de-af24-0ac74f8a8205",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f80cdff2-db26-47d3-b091-8f3b6b4f4194",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb6e5159-7434-4e72-8099-a244397d3ef8",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8e70a81-5901-4959-a643-2d29e7620529",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9edc1c2e-b880-4d7e-be7b-b235493da7d7",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bba76d8-7b15-4349-b4ce-1e0375388a52",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cfdb9acc-b931-44ac-88bd-5c3eefd62f36",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6f3eb14-28c5-4513-b4dc-4b9c0f80141b",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5592b244-255f-423e-aab8-47a990246027",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95bcb340-54f1-425b-ac9b-edb58a4305e2",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a44274dc-6b07-4605-98f1-1edd464f8d7c",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b473cbe-4b59-404f-b516-19edae7ea28c",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "143afd53-1d4d-45e6-a011-f9228bc19eab",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f153dd86-1d38-4412-bf46-c46ab81f2648",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e55a7ab3-21b6-4981-be6a-4643dfbdafdd",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "786d2fbd-6717-4b50-bd04-89b797632465",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e3bd44d-2648-44e5-a35b-6d76bbdd587e",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be1d6d1f-aaef-43a8-8a73-cb61a3448d9d",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd28cef3-0ff6-43f9-a2d4-ad338f45c6f5",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1665a56-331f-4967-940d-4cf993a66d46",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77c3d422-7f01-4f82-8399-bf2a17ce11ef",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8db44987-b90e-4fa4-9359-d4619ac1f436",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dae8acda-85b2-42c5-8cfa-1cbf4ce5e025",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f95cee6d-d663-4c77-a7c1-a44ac9f54c69",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e5e1f8f-34a3-40ba-8989-ac8c5442f60c",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4fba61f-cc40-4cfa-90db-c4550351faa9",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "ddc1a844-10ed-4bf5-9cfc-b00f368d6c09",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "885dacde-a439-415e-8df4-f0fdf9e46590",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d2706780f2002c37e9dd",
                "provider": "MySql",
                "parameters": "5zpNi1/ivLrPCYd3lQIeMwzQq5sAuc2YxZlngeeRz8hpTWd0H8LeepAHS57ZrJJbLGMhcYYJi5jTdTs58x9Ifb38GYxx5LABrwlbp4PgUKEopCjg+Bdl9PQiGCx8H7K7nWAdNIkesmJqig4SBGeNKtw1XDvwnBW3u/rrXgFKnw1iQo69EEWu7CqZHboIqgmOLsXk4QP+RQIQ0ffDKky9F0uishDV78kkCxoNl+Mfe8tBKYck/ulmOghb0RL9ZKCb",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0de89b60-ad57-487b-89dd-243d55054cb6",
            "fullname": "custom-0de89b60-ad57-487b-89dd-243d55054cb6",
            "type": "custom",
            "name": "custom-0de89b60-ad57-487b-89dd-243d55054cb6",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b72865b7-b46f-410d-a594-b73db6ee183b",
                        "id": "Sites",
                        "name": "Sites",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "55f4c5e6-fa19-4cc8-be18-89626df34894",
                            "expression": "select\r\n'1001' as site_id, 'YorkCG' as site_name\r\nunion all\r\nselect '1010', 'StocksCM'\r\nunion all\r\nselect \r\n'1003', 'PrimeOT'\r\nunion all\r\nselect '1012', 'CVMarkets'\r\nunion all select\r\n\t'1006',\r\n\t'IvyTrusts'\r\nunion all \r\nselect '1020','London-Gates'\r\nunion all select\r\n\t'1007',\r\n\t'MarketCG'\r\nunion all select\r\n'1005','FXVC EU'\r\nunion all select '1023','GstaadBrokers'\r\nunion all\r\nselect '1013','TheWealthCore'\r\nunion all\r\nselect '1014','ArrowTeks'\r\nunion all\r\nselect '1022','Iron Bits'\r\nunion all\r\nselect '1015','AussieTrust'\r\nunion all\r\nselect '1018','WaltonChase'\r\nunion all select '1024','GlobalTrading26'\r\nunion all select '1025','TopMarketCap'\r\nunion all select '1026','RichmondSuper'\r\nunion all select '1027','InvestmentCenter'\r\nunion all select '1028', 'InfinityCapitalg'\r\nunion all select '1030', 'Golden-Gate'\r\nunion all select '1029', 'Bitteks'\r\nunion all select '1031', '365TradingFX'\r\nunion all select '1035', 'TradeTheBit'\r\nunion all select '1038', 'GreenTowerInv'\r\nunion all select '1036', 'FXVC INT'\r\nunion all select '1039', 'NostraCapital'\r\nunion all select '1040', 'TheBPCA'\r\nunion all select '1041', 'GeniusIG'\r\nunion all select '1042', 'Chelsea-Investments'\r\nunion all select '1043', 'Victoria-Coins'\r\nunion all select '1044', 'AshfordCapitalInv'\r\nunion all select '1045', 'TrueNorthBit'\r\nunion all select '1046', 'FinancialCentre'\r\nunion all select '1047', 'WinGroup'\r\nunion all select '1048', 'Tower-Bridge'\r\nunion all select '1049', 'Btcmarketcap'\r\nunion all select '1050', 'CapitalMaximus'\r\nunion all select '1051', 'BendigoCoins'\r\nunion all select '1052', 'TheFinancialIG'\r\nunion all select '1053', 'BitFinityFX'\r\nunion all select '1054', 'BigBitMarket'"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "14930bd8-6fc8-4c2a-a189-e2fa4354f547",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d6f36e2-bec5-4a21-ba84-44dd4682196e",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "32c526f6-9881-4afa-8c16-84f0f7b3bddc",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "0f0e22ca-9560-48e3-948e-51eeb700cd90",
            "fullname": "MySql:f78ea453-bbce-4ada-b8c1-6fed3cd4cd4a",
            "type": "extract",
            "name": "f78ea453-bbce-4ada-b8c1-6fed3cd4cd4a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9ca6b1c4-80fb-4e90-9ba1-f62b162dafb3",
                        "id": "tq_WaUWlMleh",
                        "name": "365TradingFX_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "44406a39-9d76-4874-bf8f-ad2075210428",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b34ff19-9bba-4d48-8f8c-80b908bc935b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c76f0a84-a408-4a10-b9a2-78320f7e7380",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a608af27-3b24-43c0-b41b-e1f15afe25d6",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55b41b0a-5228-4ce6-b202-ab9337335e73",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ab425ad-c883-49bc-9f82-75ef001d9dd3",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f99e668f-81ab-4b46-aced-5b1385374885",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1d67e1e-2ee5-4016-8b69-9ca3ac755df4",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b2e1296-24ae-4f2a-bd47-7a87718a8fd3",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29fc35a7-b886-4439-8d51-c8e8f47dc5bc",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32665e3c-c3ea-4344-a5ad-97aec766e714",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74b844cb-8c55-485c-bbe1-7b4055e7b9d9",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80803bbb-1895-4b58-b094-5769d6018e50",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74f31405-b694-4734-bf5c-ec343e887469",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "960ce812-b561-4c6a-986d-aa5fcceb9055",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f090597a-8377-401c-81bf-7b457cab17a6",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f88f026-f730-4e96-b39c-f31b51bd4309",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c337ac00-2652-4d24-968d-b0be06f46379",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8ebec8c6-c752-4773-bb38-8a360965a2b4",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f877a8b8-1f5e-4515-bb1b-bd486af3d629",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd1f3d6b-b403-4c99-97f2-823929017d3a",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe3bebe5-8fa3-4341-bcb1-2b4057775017",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc6ea3da-4a91-4e36-85cf-d7be59aa559c",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22e28f2d-07ab-42b3-bd50-87a6f94a4c45",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b00b8ef-919b-4732-b5c8-d28aaa849845",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e9b68d72-88f4-4df4-9366-2f2c58fe63de",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c25d778-04e6-4c2e-ac94-1418304d534e",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4bce3887-662c-4763-b956-df0f5d43d6cb",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed47aebe-57c0-4305-a8b4-3a6dbad99a89",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc58c72a-ccc2-4465-9c89-15958868dfe1",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8fb79f6-3d78-418f-9342-d02a8bc732b2",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8e99347-a23f-43ff-a047-b1189f0303b3",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58a8b381-52eb-47bb-a655-b3549468bb38",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64e09aab-a242-4e3d-b468-f64b28092636",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dbd4f78-f909-42ae-a8a8-0becc4d70b25",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81bcf8e7-1c42-4a37-8a85-9cac2b7e6d8e",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3dedbe4-25e2-49a3-84c7-8de14561423b",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ecd07d06-1e60-41be-bae8-1ec91ff7095c",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a970608-23c6-4f6a-b6e4-796ad568f625",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7cd7f45-978f-42c4-88ac-e338f3c10d66",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4768e7a-af11-4b0d-8e5d-9e47f455b48a",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f08c658-eacb-4dd8-b3be-c511259ff07e",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08c9d133-6d64-4a60-b8de-2673023398b6",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0863d4a5-a11b-40f2-b4bb-47205f30d5f8",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "811026b0-1c6c-49da-aa18-21e81572c4ce",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c33857ee-3724-48e9-91a8-7133cee4da9f",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6971e897-0972-4182-a209-54fb3e6e9341",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e533802b-a5f5-4d61-baf1-5b3a2d556b88",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61a004cd-2b0b-4e17-bb7e-f22478fdfe37",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e26e1541-2c92-4523-b252-9b8c5a369e80",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e94f311-fce5-45a1-af6f-3042f393f9e7",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0d75bad-6299-43ef-8135-384a93b74185",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee2a75a6-83e8-463a-9f2e-fef10bb09769",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "670d6e78-9acf-4fd1-ad54-cbf52cf34db7",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94bde887-4805-41b6-93ec-61e5eddefeef",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "22e28f2d-07ab-42b3-bd50-87a6f94a4c45",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "d6c66423-16b0-4e6c-a06e-9d7fcbb5e32f",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32,68,76)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,68,76)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,68,76)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d7fa6780f2002c37ec3f",
                "provider": "MySql",
                "parameters": "WpjwuHhqzfDIdAFVxxbzsI0YjwvC+DbfC5SOQEIG9Hv/ov90B4e996K5jgUO+RnMIymf8vUv4ZkKAz3a9ZjFWfFx0Vo47BjpHtnTXLtkifQRqyaZfd4D6O1eqmErosIKNYe9BaLz/Dcd/UP9mDlqVceymGdLGHoVvU8f/jie8mwEQUF6aAirIkBFxSa+GAc1y/33qpuBkVC0lkCPxLhwxjFEew4CVf7nWq1YJkAA++dxReSWYPaOBwUZ1W5/aDZr",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "1bb0efa4-ebc6-40ac-a702-05ea375429ed",
            "fullname": "custom-1bb0efa4-ebc6-40ac-a702-05ea375429ed",
            "type": "custom",
            "name": "custom-1bb0efa4-ebc6-40ac-a702-05ea375429ed",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "22fa6e2d-a79e-48ad-9881-87df2c9d69b1",
                        "id": "Eom_open_pnl",
                        "name": "Eom_open_pnl",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "af9fa0ec-7f2c-4add-9150-2f73baffae18",
                            "expression": "select eom.*,\r\ncase when isnull(case when code = 'USD' then open_pnl\r\nwhen code in ('EUR','GBP') and isnull(Rates.[rate]) then open_pnl * Ratesa.rate \r\nelse open_pnl * Rates.[rate] end) then 0 else case when code = 'USD' then open_pnl\r\nwhen code in ('EUR','GBP') and isnull(Rates.[rate]) then open_pnl * Ratesa.rate \r\nelse open_pnl * Rates.[rate] end end as open_pnl_usd,\r\n'-100' as customer_key\r\nfrom\r\n(select York_eom_open_pnl.*\r\nfrom [York_eom_open_pnl]\r\nunion all\r\nselect PrimeOT_eom_open_pnl.*\r\nfrom [PrimeOT_eom_open_pnl]\r\nunion all\r\nselect FXVC_eom_open_pnl.* \r\nfrom [FXVC_eom_open_pnl]\r\nunion all\r\nselect Ivy_eom_open_pnl.* \r\nfrom [Ivy_eom_open_pnl]\r\nunion all\r\nselect MarketsCG_eom_open_pnl.*\r\nfrom [MarketsCG_eom_open_pnl]\r\nunion all\r\nselect AussieTrust_eom_open_pnl.*\r\nfrom [AussieTrust_eom_open_pnl]\r\nunion all\r\nselect Arrow_eom_open_pnl.*\r\nfrom [Arrow_eom_open_pnl]\r\nunion all\r\nselect Wealth_eom_open_pnl.*\r\nfrom [Wealth_eom_open_pnl]\r\nunion all\r\nselect InfinityCapitalg_eom_open_pnl.*\r\nfrom InfinityCapitalg_eom_open_pnl\r\nunion all\r\nselect [365TradingFX_eom_open_pnl].*\r\nfrom [365TradingFX_eom_open_pnl]\r\nunion all\r\nselect TradeTheBit_eom_open_pnl.*\r\nfrom TradeTheBit_eom_open_pnl\r\nunion all\r\nselect NostraCapital_eom_open_pnl.*\r\nfrom NostraCapital_eom_open_pnl\r\nunion all\r\nselect TheBPCA_eom_open_pnl.*\r\nfrom TheBPCA_eom_open_pnl\r\nunion all\r\nselect GeniusIG_eom_open_pnl.*\r\nfrom GeniusIG_eom_open_pnl\r\nunion all\r\nselect Chelsea_eom_open_pnl.*\r\nfrom Chelsea_eom_open_pnl\r\nunion all\r\nselect ashford_eom_open_pnl.*\r\nfrom ashford_eom_open_pnl\r\nunion all\r\nselect wingroup_eom_open_pnl.*\r\nfrom wingroup_eom_open_pnl\r\nunion all\r\nselect BendigoCoins_eom_open_pnl.*\r\nfrom BendigoCoins_eom_open_pnl\r\nunion all\r\nselect BitfinityFX_eom_open_pnl.*\r\nfrom BitfinityFX_eom_open_pnl\r\nunion all\r\nselect BigBitMarket_eom_open_pnl.*\r\nfrom BigBitMarket_eom_open_pnl\r\n) eom\r\nleft join Rates on Rates.[date_key] = eom.[date_key] and Rates.[symbol] = eom.[code]\r\nleft join Rates as Ratesa on Ratesa.[date_key] = getyear(adddays(eom.[date],-1)) * 10000 + getmonth(adddays([eom].[date],-1)) * 100 + getday(adddays([eom].[date],-1)) and Ratesa.[symbol] = eom.[code]\r\n"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0f6e1c53-c178-41ea-8649-56899e813cfa",
                                "id": "date",
                                "name": "date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "069909fa-50c1-4081-b896-433e1bf07a3c",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1801cf1f-faad-4c02-a290-6dbe3537df1f",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b2f80ba-ce5c-4114-b051-6eacd606c9ba",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccc416e2-6734-4913-889f-11032629c95f",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b01163d-2e37-48d5-af57-02aa265078a3",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee3ee243-4876-4f1a-80d0-e84a70dff133",
                                "id": "open_pnl_usd",
                                "name": "open_pnl_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c2499c2d-b73c-4c28-97ae-e2770827cf32",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "de7faaa4-f22a-46b1-b3f4-dc32daeb1992",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "1f10fe22-b391-415d-a993-9d03613276f1",
            "fullname": "MySql:23bd0fc6-0bca-4bb3-aba8-1c546de01952",
            "type": "extract",
            "name": "23bd0fc6-0bca-4bb3-aba8-1c546de01952",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "952ea232-b512-4f2d-ae9f-063543cd7851",
                        "id": "tq_X23BvcHi4",
                        "name": "Ashford_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "321c869d-57ef-4d7c-8658-039036f27c4f",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad90e038-42ef-4cc2-adb5-13e523707b5d",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a52d82f5-d587-42a0-9563-27f2dbb3886a",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1427edc-9a58-4c03-9398-f5c0c752deb8",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d405119a-e71b-4dcc-8659-a0ac2b17cdfe",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62ad50b8-7856-4d8e-81b9-020190833342",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3138d816-155e-475d-bd01-4a14e12a8720",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1fec82a-521f-4ddc-b213-c26b272185ec",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1047fd4-208a-478a-a1fb-98191c3278d1",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46d94d1e-c005-4352-bf90-d18ea1098bab",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d9842ba-7ab8-493a-9dd5-a8d004d87391",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98b5a5c1-3f60-4485-8043-175cc4a80e38",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4fe4bf51-712c-4899-8ec8-7a8372f8c8b1",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9ec45ca-6e24-4a39-bdfe-3768b362ce10",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2683141-fb5c-4d27-83bb-b21626c01bfb",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8a8dc02-82e1-4eef-b787-047356d05882",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ebb40284-9aa7-415b-b758-db633af98962",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8875eb76-a2f0-4762-9064-2ca0d00be720",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3a633b8f-4ff5-4b8d-bd37-d69a258e653e",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2fea00ae-5350-43ea-bfbf-6863621988bb",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55c26b68-1353-4f58-b113-8114e177e299",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77e116ef-cc17-4fd2-acae-bdfca8bf2a60",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d8b2871-c3d0-4689-8be1-1cdf6b8efd6a",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50c8a565-17d3-4c4a-b9f3-287207faebfa",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2cc3d01b-ec24-41e0-a9c8-108f4c4c09fc",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ee364fa-2ab8-4013-805f-6d54a51f46a7",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08013437-ef1c-45c4-86a3-4444b45af859",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7987d131-dc7f-4ad4-bb0a-e745c1da3af0",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e766b2dc-84bd-4f6c-af19-5d87b20dc416",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "854edf33-ee8e-4489-9bc4-80ad8d2d0dbe",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "050bef05-c7be-446f-a3f8-7900c5978f67",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71d55829-9a2a-4038-a467-1f10ae2b6f11",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25a88dcb-7999-452e-8565-a8b8e3ab679e",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ba418f2-be64-440d-aabb-44116a50d6b2",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52a2f59f-bde8-415c-8ed1-02792749e643",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e67bb5b1-b611-4d8c-9d0f-023006f52827",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "04316a44-38bb-480b-b742-164ff79abffe",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cac06a03-b2fd-4b3b-9cc4-7ebb3032431d",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83b848db-91a7-45b8-9a95-9edacf47b0cc",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7defdf40-938f-455f-871e-b2b2b717cbdf",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50e39d46-5c62-44e9-a18d-e82774877f82",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c55437fc-1f8d-4180-bbee-1e4911e26d1d",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e96da7c7-b92a-4557-a292-2df11af6bbc8",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e65fc870-7a76-44aa-8b8c-e3117f43f4f6",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de0f479e-7763-4b84-b1e5-9776e750fe98",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ebbe29a-973d-4d24-a529-8c58457de78d",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fb40df1-660d-47b2-824c-77246610be51",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "130fe559-c9f6-443b-9e73-35ca9adc3f95",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a15dde0-50f6-4674-b397-edb7fa319d1c",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5bd0aca4-ad05-45c1-9ef6-eea40508ceef",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19224c01-4180-490b-b970-20a4064ef65e",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe430a43-d8b6-4cb9-9740-e2ed86cd17f9",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03d2cf03-6f37-4780-a169-8a33bb544716",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34658fb0-b4f5-402e-8b3f-8854d34de55d",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f42c90e-6202-41b1-a6e6-939cc4144d97",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "50c8a565-17d3-4c4a-b9f3-287207faebfa",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "ecda43e2-3ffb-4d01-a01a-5605e102b695",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d4e36780f2002c37e9ec",
                "provider": "MySql",
                "parameters": "Oz2AfvRo3srlztUw24mN8xjULQgCsDxE8xdGvyNUDfDIDVlPEvzGPi9X1pOk7WkJorypT3vAhcaensqPr3DxJWq4DMDr4Ntq8hg/ST/QG/Ry+Mc5Itvb7ssjapRdR/f5pJGa1CgTA4+V9S7ZAeHlkIJ8fCivOQ1bPR1RbzXK2+kyaVjENBts5VNtP4yYjGtpqTycZGcbTdSdI98JCq+mp2IzDRzS7cexXuu83rKl7MG3hlCMfvhn4khms5onk7u7",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2324bd67-580c-4ccb-9302-7193ec1185e4",
            "fullname": "MySql:f9ee3ef4-1612-47dc-882b-205f7eac0ad4",
            "type": "extract",
            "name": "f9ee3ef4-1612-47dc-882b-205f7eac0ad4",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "690b5ed9-e0eb-4686-bd32-a76556354957",
                        "id": "tq_ZJb5Zy8d1",
                        "name": "IvyTrusts Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ef6e1e27-823e-4c26-a84f-eb8029c178c6",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "845339e7-1faa-4a57-8d13-0f1423375ef5",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b7b0a82f-2a70-4217-8389-095b323de6ca",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cd8d1a3-527f-4b41-b7c3-b8e4f08c4f04",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e901d8b4-fa93-4c63-9be2-66dad4919128",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4385d4d-4a21-4e67-be0a-59dd7b7f75b6",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb378309-7f43-4d80-ad05-619ba47d2cd1",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d01e1a8-2434-4263-8bc6-b2809c6c1594",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df0f1f35-5fee-4f36-9519-8539e6de692e",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 306,
                                "precision": 306,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c58e4257-8234-44a5-bf90-e0ff55de486f",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c492b08-a461-43d0-8436-709dd40ac9ec",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d26edd76-516e-40fb-b6c4-3e93eb93e2fc",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "80ed4646-97c4-487b-a1e6-1d263f7fdde3",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4a3ca410-e928-4160-8e5f-262b135507e8",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4ec9d720-6354-4f2e-b1b0-7ff58335aa80",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70b11da2-9bd6-485f-ad56-94c993779069",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8baed08c-a8a5-4607-bad2-8cadaf516c08",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69d4ea64-ec43-4134-b3b5-5dcf75fa7d01",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa0a88a6-deb2-4b3d-9aac-3e2341cf1c0b",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2cc91fe5-917e-46ac-8d7d-7dee2c4ca257",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "89cc8d3b-7499-4661-96b9-339d49bb6b97",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1759a725-9589-4735-9ff8-db31ab0ec08b",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70f69022-c890-41be-8374-c692605f4c93",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e13998d1-fe18-4daf-8202-7b4a70d9b17a",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "424d5c22-3ed9-4e32-9a5c-c2936a2fa071",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f7dc566-dfca-43e7-a41c-a0e7757fe7f1",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1b977af-dbf4-45cf-8cfc-af04328e3178",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0fe17d65-7b61-4ea0-8ab6-f71fbd6a8585",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a111f8b6-1599-4ed2-9678-f28db03a2ccb",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "11057394-0e0c-4458-8ed0-db066030578a",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "43c4bdf1-acbf-4d88-a139-e5f726e04d0f",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c3b600a-7244-4d48-a0d9-d529a9af81b9",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a1373dd1-0202-4875-b1af-363bffa519a3",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e0cefc7f-5565-488e-9aee-e2e1d8c65026",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "794e8589-9cd0-45f2-a051-df0254c04bb9",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d2443a46-6dda-462d-8f9c-0e9ac5bc4ec6",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7fed78eb-927b-4efe-bef4-bd51cb9a8419",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4eec63ae-348e-42c9-af92-66e039a81afe",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4c3662fd-f247-4205-9745-e3c8aa8b6158",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ec01d38e-6401-4508-930b-5ecea0c46ba3",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f2c487d0-dc83-416d-94f7-f4517dcc4833",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa6c968a-342a-4427-a983-0d985f8ae55f",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7aaa9cb4-f543-4d41-93ac-1b203207ebfb",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f99fc75a-ba6a-4d02-937f-fda822173beb",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc5e1afe-0cb5-4cda-b0a6-b9cbe6d3dd4d",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f0774ba1-1021-4a9a-a7ac-b74805c0a7f8",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0a347c3e-3282-497e-b080-746308a0ad15",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c56231f9-4201-4dc6-ac12-b8ac9d6474ab",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1670130-4ea7-4ed9-9c70-b93f91f9cb11",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af6d0817-3775-4cda-b0eb-fd305bfb4ed9",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0a79470-8379-4db2-98ec-a7777babc623",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3c7f2b87-68ac-4647-b056-e261b8834800",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c4c2f069-5593-4cf4-9df8-5764044b73ff",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "48fe1034-9fc5-4c19-9d15-cf48d9cb4982",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db93cbf4-bc41-498f-9c96-3e936190b36e",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "e13998d1-fe18-4daf-8202-7b4a70d9b17a",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "6ec8c467-fa55-40fa-b877-68bbc88cb7c8",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10003, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( brand.id + 1000, 10003, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t'Null') as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\ttrader_status.name as trader_status,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\tdates.days_from_last_deposit,\r\n\tcase\r\n\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\telse dates.days_from_last_deposit\r\n\tend as min_active_day,\r\n\tcase\r\n\t\twhen\r\n\t\t(case\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit\r\n\t\tend) <= 30 then 1\r\n\t\telse 0\r\n\tend as is_active,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_redeposit_1k,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen country.name in ('Switzerland',\r\n\t\t'Germany',\r\n\t\t'Austria') then 'Germany'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen country.id in (14,\r\n\t\t86,\r\n\t\t225) then 2\r\n\t\telse 1\r\n\tend as locale_group_id\r\nfrom\r\n\ttrader\r\ninner join brand on trader.brand_id = brand.id\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join trader_status on\r\n\ttrader_status.id = trader.trader_status_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,208,325,478,511,664)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tcase\r\n\t\t\twhen group_type.name = 'Branch'\r\n\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\telse group_type.name\r\n\t\tend as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\tuser_groups.id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\telse f.name\r\n\t\t\tend = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id =\r\n\t\t(case\r\n\t\t\twhen e.parent_id is null then e.id\r\n\t\t\telse e.parent_id\r\n\t\tend)\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,208,325,478,511,664)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand COALESCE(transaction_deposit.payment_provider_id,0) not in (24,208,325,478,511,664)\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d4176780f2002c37e9e6",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiNCcMibb1+BB8XVxNqk1WzyO+TFmKpoM2bSX/Ivm7/xq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2739e5d2-b5e3-41f1-b0de-7ea6770c78f1",
            "fullname": "MySql:c766675a-1287-4062-a29b-0f0d5474f4df",
            "type": "extract",
            "name": "c766675a-1287-4062-a29b-0f0d5474f4df",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "19f21e21-c7ce-4fcb-a1d2-99c0d00cee3d",
                        "id": "tq_8YJAorSx9",
                        "name": "NostraCapital_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "822ba695-5dfb-4e5f-adab-27e91e712942",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8be5a2f8-ec2e-4af7-8da2-344ce1dfb7c5",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3405710-5830-4d34-8183-5558f2e32d77",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "835a7c97-94b5-4e41-b850-500755e40a37",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8205040e-7201-4dac-b4b5-cfc8fac82907",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61a0e952-3c07-4971-a4f5-2ee1890583c7",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f893ac2-99cc-4e2a-a9cb-6a754a9c3d65",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbfa6ee7-a236-4f8f-a043-60313875fd1c",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1853e79-8d62-457e-8b7f-0b109342f7e7",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a7bd67b-2a40-4a51-8f7e-30108cb4f12e",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "cf416074-4762-4eab-9eea-566066e60b7b",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d2d76780f2002c37e9e0",
                "provider": "MySql",
                "parameters": "5zpNi1/ivLrPCYd3lQIeMwzQq5sAuc2YxZlngeeRz8hpTWd0H8LeepAHS57ZrJJbLGMhcYYJi5jTdTs58x9Ifb38GYxx5LABrwlbp4PgUKEopCjg+Bdl9PQiGCx8H7K7nWAdNIkesmJqig4SBGeNKtw1XDvwnBW3u/rrXgFKnw1iQo69EEWu7CqZHboIqgmOLsXk4QP+RQIQ0ffDKky9F0uishDV78kkCxoNl+Mfe8tBKYck/ulmOghb0RL9ZKCb",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2788fcfb-cd9a-468b-b56c-b89c92231ad2",
            "fullname": "MySql:4290f908-380a-4750-936c-1aef26e08f2d",
            "type": "extract",
            "name": "4290f908-380a-4750-936c-1aef26e08f2d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c094ea94-eeff-4aee-99a7-c161dbba0c3c",
                        "id": "tq_wmi2hMn0g",
                        "name": "BitfinityFX_Employees",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "faef4bd6-8b5c-4859-89e4-72fa2bd5a946",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74322b84-33eb-49e3-8419-5f0c53240e42",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e58c51d7-8cbe-4468-ac98-9fbbf93c2843",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7fb16800-42e2-4081-b88e-38fa8220a3d0",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b1b359e-5e9a-4169-a959-56c3d0f0cf17",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2579342c-0b74-4175-b968-8976d9820f10",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57ca739f-6204-438d-806c-88b5f0db3b13",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7955c9de-eb52-47ea-8825-6fa345b68a16",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "027ce5e1-b261-4368-817e-03da171cb4ef",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5327faf-e406-4a5d-9342-806d82f36c70",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "bf2e3ada-3832-4ee8-b62a-6b00e33c2194",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619516bbfd9249002de3c529",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8C2q0mVY+o2WF4+UVAyIhGiWhSY3+Y93kyI+zrKj2Bg5HiBiNB45Ta2GGPAsEoYp8/7dK0B1NeCzhErO6Xxg3c338i0MevnkC9Yi9QGlRnh1xn5Kjp5TuCxX28iusyU+paJ5wPXzkAPGHPDNhGasnoxvMsxipUWeTclTSatITjv9eQNNH4tFpXr1gskkcrIfglENUveS4Og+oLFLIuz1xQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2aabfdaf-a783-4f27-b09f-cac7a55472c6",
            "fullname": "MySql:MySql-2aabfdaf-a783-4f27-b09f-cac7a55472c6",
            "type": "extract",
            "name": "MySql-2aabfdaf-a783-4f27-b09f-cac7a55472c6",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "356b4047-2643-4298-b06d-8700c8e6bab7",
                        "id": "tq_Upjw1CNuo",
                        "name": "Ivy_eom_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a9d9997c-afdb-46e1-a836-48b76958157b",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a4134879-0c12-4dd2-b423-4a29360a4349",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4d9add8c-3816-49e9-a468-5d109055606b",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac31f4e9-7fb8-45f2-8912-309a0e0a2585",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d9f6d97-00b1-4c70-bff7-1a3622dd767f",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "230115a9-c150-4475-b92c-d8c42b07a0ef",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "766f0fc3-0b3f-49f9-85f7-114920713112",
                        "configOptions": {
                            "importQuery": "select `date`, YEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key, code, site_id,employee_key, open_pnl\nfrom\n(select open_pnl_per_day.*, case when `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date` else last_day(`date`) end as eom_date \nfrom\n(select  `date` - interval 1 day as 'date',c.code, cast(e.id + 1000 as char) as site_id, concat(e.id + 1000,10003,d.user_id) as employee_key, sum(open_pnl) as open_pnl\nfrom open_pnl_daily a \ninner join trader_account b on a.trader_id = b.trader_id \ninner join currency c on b.currency_id = c.id\ninner join trader d on a.trader_id = d.id\ninner join brand e on d.brand_id = e.id\ngroup by 1,2,3,4) open_pnl_per_day) eom_pnl\nwhere `date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd28a56da002c368de5",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFA9JlqyFqZAeoogKne8sIUpkNMpEfeosVFHWt/W5yFiTD8p9Ffjn88IlJC5Q1xQ59qiXHtoy1GBjMIBIltk++fzbFEfPbsvpm0EnoyEAOYQ2",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2e648681-6f13-410a-b6a7-b6c21b122b14",
            "fullname": "MySql:MySql-2e648681-6f13-410a-b6a7-b6c21b122b14",
            "type": "extract",
            "name": "MySql-2e648681-6f13-410a-b6a7-b6c21b122b14",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0af0f33e-5df1-4e9e-940b-e26e990bc89c",
                        "id": "tq_l9ZDvYcTi",
                        "name": "Rates",
                        "type": "base",
                        "schemaName": "tmp",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "fa921821-3132-4367-94a8-6449e385c049",
                                "id": "symbol",
                                "name": "symbol",
                                "type": 18,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "738307cb-1675-49ad-8a59-f40f36b36451",
                                "id": "date",
                                "name": "date",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fcf48c10-1910-431f-a3b9-4692fe818d37",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "81bc3384-6339-46d0-8170-4e87ae70b014",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c657fee9-1422-477b-86c7-2ea08094c9e8",
                                "id": "rate",
                                "name": "rate",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "854cd514-9554-47df-b0a4-029c1893656e",
                        "configOptions": {
                            "importQuery": "select\n\tleft(rates.symbol,\n\t3) as symbol,\n\trates.`date`,\n\tyear(rates.`date`) * 10000 + month(rates.`date`) * 100 + day(rates.`date`) as date_key,\n\trates.id,\n\texchange_rates.`mid` as rate\nfrom\n\t(\n\t\tselect symbol,\n\t\tdate(eventTime) as date,\n\t\tmax(id) as id\n\tfrom\n\t\ttmp.exchange_rates\n\twhere\n\t\tsymbol = 'eurusd'\n\t\tor symbol = 'gbpusd'\n\tgroup by\n\t\t1,\n\t\t2) rates\ninner join exchange_rates on\n\trates.id = exchange_rates.id\n\tunion\n\tselect 'EUR','2020-12-25',20201225,0, 1.2185\n\tunion \n\tselect 'GBP','2020-12-25',20201225,0, 1.35549\n        union\n\tselect 'EUR','2021-01-01',20210101,0, 1.22166\n\tunion \n\tselect 'GBP','2021-01-01',20210101,0, 1.36632"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "0ff11d1d-1161-4a5e-97bb-05bbe404140e",
                        "id": "tq_NlD1WJFOi",
                        "name": "rates_tp",
                        "type": "base",
                        "schemaName": "tmp",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "cbb835bd-1e99-4897-b5a8-c8e01a047c8d",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d25da33-863e-4e6f-b679-5d6b09f139e8",
                                "id": "rate",
                                "name": "rate",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "ede151a0-4cc5-403c-8bff-ce1fe0306b89",
                        "configOptions": {
                            "importQuery": "select\n\tleft(exchange_rates.symbol,\n\t3) as currency,\n\texchange_rates.mid as rate\nfrom\n\texchange_rates\ninner join (\n\t\tselect symbol,\n\t\tmax(eventTime) as latestRate\n\tfrom\n\t\texchange_rates\n\twhere\n\t\tsymbol in ('EURUSD',\n\t\t'GBPUSD')\n\tgroup by\n\t\t1) maxR on\n\tmaxR.symbol = exchange_rates.symbol\n\tand maxR.latestRate = exchange_rates.eventTime\nUNION select\n\t'USD',\n\t1"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "f1e46bde-b818-419e-8d1d-163029b3f20d",
                        "id": "tq_sS3Y7pAxR",
                        "name": "rates_eom",
                        "type": "base",
                        "schemaName": "tmp",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f504ae8c-9c2f-43ae-9a6a-a48ab0aee6f1",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cfad0b42-25ca-4c19-911d-4646ed82035b",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "28c96162-346c-4c00-ab4f-1b9a9a481731",
                                "id": "year-month",
                                "name": "year-month",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7f482a0-9e0e-4863-ae55-adc024aa8fa3",
                                "id": "rate",
                                "name": "rate",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "d9ee4a87-81cb-4811-b406-04c39ff31b1c",
                        "configOptions": {
                            "importQuery": "SELECT left(tmp.exchange_rates.symbol,3) as currency, tmp.exchange_rates.id, date_format(tmp.exchange_rates.eventTime,'%Y-%m') as `year-month`, tmp.exchange_rates.mid as rate\n    from tmp.exchange_rates\n    inner join\n    (select symbol, DATE_FORMAT(eventTime,'%Y-%m') as `year-month`, max(id) as id \n    from tmp.exchange_rates \n    where symbol in ('EURUSD','GBPUSD') \n    group by 1,2) max_rates on max_rates.id = tmp.exchange_rates.id"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd28a56da002c368de9",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE90UNwM/2NA/NMisgg5JywZJL7FoG5oR/s4/rhmZalcbw3r2qaFz+PSC6H1c5oQReFWBDAOIocgMvQpzy5sbsRM2P+HTa53lg5+fRMO52l1+sKuhufhU4irueTFK9XWTH+NX12s2Q7qgvu3q6jf59lV21xyk96Laws+Wk/Rh7IS7bh+eYf6IlMJCeO4l26L0Tb",
                "schema": "tmp",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2fc5a4e4-de47-4b94-820a-a7c20a97406f",
            "fullname": "MySql:ff0db5db-b692-4a9d-a448-763254ceeb46",
            "type": "extract",
            "name": "ff0db5db-b692-4a9d-a448-763254ceeb46",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "184b85a5-ba8e-498e-b01e-02ef31594635",
                        "id": "tq_dEYXXpYX8",
                        "name": "WinGroup_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "3c25f1ee-2807-4e40-b25a-12a08a8f26f1",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1bfea7c-ef4a-4829-a85f-88a0e7df9a34",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1bc966c-aea7-43dd-9aa7-2cb2b5595a0e",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81564980-948e-41d6-8acc-3ae5178bfb91",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d4388cb-072c-4926-9eb8-11eb27a7ccee",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f061f3a7-343e-4248-be94-67cf7e6bf867",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "597207f7-7510-4803-9fbc-b1e605068c71",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "362c1f3c-ab17-497d-8191-ae713a6268b3",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dfab99a2-105c-430c-8eba-2e66f32655a9",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "717c6676-70c1-4bc7-ad9d-6d2dc963edb6",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab10dbbe-406a-4056-bdaa-b5a80d617a88",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c43466fc-ebe8-4615-8a2c-05115a55d2c6",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ce1b9cf-05b4-4755-b331-7e4c2f179ecc",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93d92c7f-3326-4a99-bbb9-f7effea79e97",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ddaf82e-b97d-4b45-a706-15808a4becac",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e352bae-3eb0-4979-9863-c4c143946994",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f0c854c8-3a12-4c2d-8486-34be1066651d",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d2f18bcb-d906-4af5-93fd-c43a03f22e66",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a5b94c73-c24b-4253-92e9-7ec91a6e509d",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "113e0a6c-5561-4d48-8317-29a3dc164707",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ac08147-2dcd-496e-a48d-eacc41934636",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "945c6f8f-93e3-4580-bded-b26957cebc3d",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77dc2fdb-407a-4977-bdb1-afae7f8eb09d",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42fcb7af-0b8d-44e3-9f37-551d381e5e21",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb02c749-8b44-4c9c-8bdf-2864347c30b0",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffe2bfd2-a179-4813-8cd0-3cd91b312439",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dcc3c828-24a9-469f-bd96-b7ff4ccbaff1",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "165cb966-4f0a-45cb-9528-53d55e33514b",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f026d49e-b5cf-4bd4-9390-2993295525a5",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "acb80a9f-5059-49fb-a879-52d411183a8e",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ea5aaf5-e916-4265-beb6-265045fab43a",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0723fd6-2c98-41a9-a041-d974046c89a0",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "931a9b63-1cf4-4580-9608-8c622635f20e",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60364eb7-e07a-4d9d-9057-606a006c1674",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "493fce8b-78a6-4496-87b1-7abea15d47db",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d51cd66-188d-4059-824b-3e3cd210a5ae",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "678bf223-5a4f-4d3d-b354-16a6d5be05ef",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a4f07f2-6128-4842-a9e7-b5cb111e2d78",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3c925b5-b788-4c34-867f-64c0486227b5",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d919772-5a54-4599-951c-cf16c33e542e",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc6a2e89-beb6-48c6-9e46-04c155eb4551",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63159232-35bb-4e05-8787-166316b649d5",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5e485c5-001f-4fb2-ba18-31131ca3193b",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88001ad2-3d9d-4ec8-8d64-49bccc9a3a81",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa89302b-9add-42be-8950-2806218535c7",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "904b13dd-2227-47e8-a239-3691d3d4186a",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad4c494f-1789-43ac-8bd7-d51f41cee2f3",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20944dcd-6a0e-4c04-94bc-9d3c0c4c821c",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b48041ad-54c6-4730-954a-bc5370d9f61a",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67ff9d41-d897-4202-9e4c-0a89e785b5de",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af268568-768b-4c5c-8a39-ae7a3c6b778c",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7778096-5695-4818-bf4e-850425a7f3ce",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcd92de8-480b-41e0-bb57-b415d943ea91",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "171bcac2-0dfd-4e18-8ed1-5bed7d812210",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a70adef-b872-4c65-aa7f-ffc3f725d989",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "42fcb7af-0b8d-44e3-9f37-551d381e5e21",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "c0bd3dd0-8bd3-405a-95a4-e877b58c2d2d",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d7d56780f2002c37ec3e",
                "provider": "MySql",
                "parameters": "7niuYEzJZH44LaPxXSBFhgupfobVTnd8RwuqT0tnpje5KDJ7gduGgbtju1DOzrlHXyxYXX725adKvwo0Axykr9WoMGo9e6lj1avkQiOehykewRR3dL0bFhZy2PD1D/s214ZB/FP6EjZLCw1IBo8M2ECB8F5338o8R/suGfqjWRnOflsq2MUpBYr+Wc7GJM/Dz7GG94Zi/zFyYcZz2sw/RvGv2nW3dmxfd2U2fn5h1ubfdO27mRkN4g+kxmvyY8s8",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "303b135b-1fce-457a-a0ab-2e98442e0bc1",
            "fullname": "MySql:824be12e-fc51-445e-9389-b6d6cd76efc9",
            "type": "extract",
            "name": "824be12e-fc51-445e-9389-b6d6cd76efc9",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "61190cd38a56da002c368ded",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoholBm9zTgPkWmVjr8ZqHeK",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "314337f5-2736-4463-bce2-86543506ff30",
            "fullname": "MySql:216bf3cc-32a8-4486-8232-95f5d61229f6",
            "type": "extract",
            "name": "216bf3cc-32a8-4486-8232-95f5d61229f6",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "dd50dee1-e347-49df-97b8-851b9c286935",
                        "id": "tq_Vm5LIQwCx",
                        "name": "GeniusIG_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b959a8da-0487-45ab-acaa-6af6bd74515f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "348546a7-2ce3-44b4-b9b5-bfc1a93619ad",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8f3ed60-bc4a-449e-b78a-0e5f074a5b58",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f324ea3-4000-4939-99a4-323d61cd2708",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07f132cf-b06d-40d4-80c7-a4dacf968cb6",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab996ad5-8929-45b8-9876-f6971f5104df",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e7c3007-3e05-4e4c-827d-90cefcbccbb2",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7eb775d-1535-45f9-b808-641927638de1",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "345ef33f-c86b-4b59-a31b-954c248dc964",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368def",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lNqu9YjU4aq2UrD1B4elNg9lVKQFHRdfOjSDmdho2O0BcE4ZGSnDY66nmV13xmTftBiPAwAPjQRY3WaG8+JajVjq0bDUxyyXSBahftWfD+BqWv3e7qI4k/hTBGAZLgcMyNOeLODquQbmqREECx1kSDm5qX7TJaisk1mvdLWSNPK",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "346f4039-3cf8-4bf6-b108-4dc3d5f60c6a",
            "fullname": "c1dc1150-f6c1-4e4d-9f32-a24325e57d34",
            "type": "custom",
            "name": "c1dc1150-f6c1-4e4d-9f32-a24325e57d34",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "10b8599f-82ab-423b-a671-f7e32f13c5a1",
                        "id": "Customers (1)",
                        "name": "Customers",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "00bf4748-a20c-4864-ad30-fed9a04b75e8",
                            "expression": "select \r\n    customers.*,\r\n    daydiff(now(),customers.last_deposit_date) as Days_from_last_deposit,\r\n    0 as customers_join\r\nfrom\r\n(select\r\n\t[YorkCustomers].*\r\n\tfrom\r\n\t[YorkCustomers]\r\nunion all\r\nselect\r\n\t[PrimeOTCustomers].*\r\n\tfrom [PrimeOTCustomers]\r\nunion all\r\nselect\r\n\t[IvyTrusts Customers].*\r\n\tfrom [IvyTrusts Customers]\r\nunion all\r\nselect\r\n\t[MarketCG Customers].*\r\n\tfrom [MarketCG Customers]\r\nunion all\r\nselect\r\n\t[FXVC_Customers].*\r\n\tfrom [FXVC_Customers]\r\nunion all\r\nselect\r\n\t[Wealth_customers].*\r\n    from [Wealth_customers]\r\nunion all\r\nselect\r\n\t[Arrow_Customers].*\r\n\tfrom [Arrow_Customers]\r\nunion all\r\nselect\r\n\t[AussieTrust_Customers].*\r\n\tfrom [AussieTrust_Customers]\r\nunion all\r\nselect\r\n\tInfinityCapitalg_Customers.*\r\n\tfrom InfinityCapitalg_Customers\r\n\t\tunion all\r\nselect\r\n\t[365TradingFX_Customers].*\r\n\tfrom [365TradingFX_Customers]\r\nunion all \r\nselect\r\n\tTradeTheBit_Customers.*\r\n\tfrom TradeTheBit_Customers\r\n\tunion all \r\nselect\r\n\tNostraCapital_Customers.*\r\n\tfrom NostraCapital_Customers\r\n\tunion all \r\nselect\r\n\tTheBPCA_Customers.*\r\n\tfrom TheBPCA_Customers\r\n\t\tunion all \r\nselect\r\n\tGeniusIG_Customers.*\r\n\tfrom GeniusIG_Customers\r\n\tunion all \r\nselect\r\n\tChelsea_Customers.*\r\n\tfrom Chelsea_Customers\r\n\tunion all \r\nselect\r\n\tashford_Customers.*\r\n\tfrom ashford_Customers\r\nunion all \r\nselect\r\n\twingroup_customers.*\r\n\tfrom wingroup_customers\r\nunion all \r\nselect\r\n\tBendigoCoins_customers.*\r\n\tfrom BendigoCoins_customers\r\nunion all \r\nselect\r\n\tBitfinityFX_customers.*\r\n\tfrom BitfinityFX_customers\r\nunion all \r\nselect\r\n\tBigBitMarket_customers.*\r\n\tfrom BigBitMarket_customers\r\n) customers\r\n\t\t\t\t\t\t\t\t\t\t"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "87f20625-445a-4495-9193-b5754b86a0ef",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c9bce83-2071-43a0-891a-274d4d9f1197",
                                "id": "02f68cf1-74d2-49c8-9513-0acc2476702b",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4915dc3-ed8c-4dea-a00a-87d57abeed4c",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02f59f4b-64e1-4369-8438-b75a8fd7ce10",
                                "id": "088d692a-9135-4da4-b049-9b541908cf61",
                                "name": "customer_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed74ffc3-ccd9-44f6-842c-f1f4a3b8600d",
                                "id": "9518a327-a5a0-4eca-a6ae-b8bae194c417",
                                "name": "hash_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8a191ac-93ae-4d7d-be84-9489db97d19d",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6cffebe4-ff14-4392-bc15-048b706c6ee4",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6d3b1c3-3388-4b94-b67c-2e7d40e8ed7a",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4953438-7833-4586-9053-ccecab77a3f7",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4105e651-3718-4e51-b688-5cc2c7c65477",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e61381d-4d29-49be-b8d3-04449884a2a7",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75dbb361-1729-41af-80d5-e7c79369b60f",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d6a486d-d3a3-4fd4-ab81-656d78da9ad8",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eb51a2cd-f6de-411f-a657-aab48b7bdea0",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "56348ee5-8b2a-4c85-939e-76e40e728f69",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8d95e72-0887-437b-a22a-907fa6760b4b",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d319c9f-2d3d-4a7d-8f49-2a68718282d5",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24fd7408-9771-47a1-9239-464555cd34bb",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "75d2ac4c-b23b-4601-9d2d-42373f5b9b7e",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99153422-2c6b-4e61-8048-615549e965a5",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca0b5072-8e79-43a6-9a22-42cdb021b347",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa3e215b-9d11-40b0-b09f-24d414ca1f4b",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f2a16840-a985-40ee-be70-f51ad702c877",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0d4b597-2c06-4e57-8480-a2330c57c0cb",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37520335-bc88-4e7f-b808-37ac38306c86",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff68ee16-03d2-4ae3-b211-affb6577ae1d",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "84a4d263-d635-4a78-aac1-08f5786e6750",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ebb46a2a-1846-42cc-a80a-ad4fffe4e233",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5f80388-5e22-4124-9a79-9ac697348dad",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a02c4218-bc31-4e42-85a7-1e4dcde9d473",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba596ee9-3cc7-4013-a644-15421a755df1",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ff304bf1-7240-441a-a185-279c10a4b0f6",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "420a4353-f786-47ec-b4f3-80b6cec3db43",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6da87eaf-c539-4add-8ce2-c3cb8d7c94eb",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "764eb238-a46c-4665-94de-fc7061746ecb",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6eae2643-f7ed-4e2a-9feb-07d098d76a5f",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e41d4a4-d6a3-40b8-9077-eedbbfb73ec4",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d19de55-84d5-48c4-900d-b16ffe08cc66",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "330931f4-4d2a-4689-ba3c-34a7571c2a5d",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92064d83-6ad9-4a00-aa34-e556bf32011e",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a47df6bd-94a5-4688-bb7e-3d1be37afa7e",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cffe7fff-2956-45a8-8bcd-1ea4cf2c5799",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7907f72-3c8c-4b35-8877-0745294e1f29",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5ea7c93-b751-4716-a345-a6f5f7a0071f",
                                "id": "1a757314-9fd9-40a9-9427-c4f52adc7be8",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4fddd579-7d4d-4d6c-bed9-584942b6fce4",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "04d2db51-4661-487c-877d-71df004ccacd",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "85e0fab6-6e44-4c1d-8cc3-cd937c769cba",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "215c0338-5197-4e4f-b89d-65de7bbb9963",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f46e3d6b-c5a9-4c03-b5ff-8b432662f6d0",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93fee7c0-751f-4d24-af5b-c976211bda3e",
                                "id": "3ea03d1f-774b-4604-a808-f14e258ab79f",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67423325-7d9a-4dc2-908f-21686c3f0acf",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9860e60-eaf7-4484-8fce-5e72e320e37c",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "824c45b6-96b5-433f-a5d6-5358e297a4a4",
                                "id": "e7835aa5-7072-4bf8-adc6-f227c8b20372",
                                "name": "locale_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad376427-1826-458e-bbc9-20108e3da495",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b754ad53-c5cf-4fe3-b0bb-08f96028c266",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "371f53cf-ddf4-4489-82e8-f382f8df6776",
                                "id": "Days_from_last_deposit1",
                                "name": "Days_from_last_deposit1",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7eddd746-3f2f-4c74-b6e5-2af9c53636e9",
                                "id": "customers_join",
                                "name": "customers_join",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "8f8dcc00-9d00-489d-a073-37292657b843",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "37b7b027-10e5-45ef-b1f1-57d5fae027ea",
            "fullname": "MySql:957a87cc-23ff-4199-a9f1-ab6b7e6c0847",
            "type": "extract",
            "name": "957a87cc-23ff-4199-a9f1-ab6b7e6c0847",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "17a4a580-1b23-4620-bf58-637d6964e165",
                        "id": "tq_wl1EoD0Pg",
                        "name": "Wealth_customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0d6c0af2-7310-482b-a0e3-49f7dc3870a1",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1097430-80b6-41cd-8ce4-193740e05eb9",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c77ca4d3-fe76-43c6-ab90-22a65994cadb",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35f3730d-368e-463c-ab25-a509d1d67a5c",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "df86accd-872d-45da-bc2a-cc5e9b995630",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "55e70ad5-8f76-4099-a2d8-ff4f05bbd218",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ece19430-bae4-4e81-9c8a-1d78cead806b",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1e399cf-0885-4d4b-adf4-4705823c5038",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2bd2bd71-92d8-4452-bdf9-67478ccbd61b",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86f63a90-186b-4a5d-8e4b-a50d43e25397",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a4feb96-3a30-4b9d-8e28-caeb62ca85da",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ddf549a6-68e0-43de-adef-158c402c3f8e",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "11ec33b2-6514-43b1-887b-ce699a52713c",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f68713eb-3b67-4f3e-a619-a52807d1d70f",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "687cc07e-f368-4a95-8956-65982909c7c0",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "efb36c20-3cf9-4623-b9c7-a4d3a5443bf7",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83e9fb14-511c-4604-9975-0e09a4669688",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8fdd67e2-dbad-4316-bf0d-44b2d0e4af6a",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf74c7d5-2697-40d2-b170-f8500f79855a",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5702d22-6aa5-46cf-adfe-fb717cb67c9e",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1585c8c3-6978-4d8c-8d37-4963b34c7feb",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d59f6cf-491b-451c-a06d-a39ec7122cfe",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d71d186f-b101-44f7-a2d1-aba9ac5eda99",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b77bb33e-74cb-43f5-bcbd-846c53498197",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b081123d-6647-442b-8158-e9229b816ff7",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "195ab834-ce20-4344-a225-ac7cda2f2b59",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e9a07b9-5a3c-49d4-acac-2dee0a87d6ea",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dbf3e4f1-7920-47fe-90f5-0af987adb1ce",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "742fef61-05a7-491e-ac10-30253c4d29f9",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "38cf037f-bddf-4290-9c84-7e631368b59e",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "73a8a05a-8776-4b28-b8ed-8e01e9d9f227",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f3b0a08-aade-44af-aca9-ca560ec19b60",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4aa1ea82-ad7d-40c2-a9c8-5f27d032b59d",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "48b266cc-b342-4b3a-b947-5c4135d81a3c",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "93e09ff2-bc4b-4531-81c0-5ec097348bee",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c178444b-2425-46f4-a102-44dd731a2512",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "90ca3e00-b69a-48ff-bb95-29c03eb2e2a3",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4462ebd4-186a-4ea7-a77f-7056aba86dba",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "149f4a37-7c75-4ee4-9a89-28f665490718",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "65876d23-0339-4b50-af16-09075ec8e63e",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "869ee7d2-0f00-4742-b65f-42197adf8acb",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71562a60-f726-4135-9b56-7b31a07bb3cf",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "803ff059-800e-4348-82ad-581546275a0f",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3657c294-9753-4753-8930-561038c06b64",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "231eaf40-26d5-467d-9abd-d6c7ac20e19e",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a20aab34-8f55-4314-9eec-8f42c18da23c",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f360464f-5d5e-4093-81f2-8f9148da164e",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9c9fe6b-2ac9-48d4-9ac3-7f8cf74b9123",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8024acca-2a34-410b-a6b1-11c4a5f5e726",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e33cdb9-d9b0-468b-ad25-672ef79a0091",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ed38ba4-cc2e-488e-846d-424613e22793",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05fb8517-9d50-475a-8821-0312e1493cc9",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9f6e3b2-f063-4a61-b82c-20d26861f251",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6cd888e3-097b-4001-8b1a-c656ae0397ce",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bf569c1-950a-45b9-b62d-5cfc96b3b1e4",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "b77bb33e-74cb-43f5-bcbd-846c53498197",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "b0447c7f-d335-41c9-9e35-a1933ca98f53",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t'Null') as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\ttrader_status.name as trader_status,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\tdates.days_from_last_deposit,\r\n\tcase\r\n\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\telse dates.days_from_last_deposit\r\n\tend as min_active_day,\r\n\tcase\r\n\t\twhen\r\n\t\t(case\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit\r\n\t\tend) <= 30 then 1\r\n\t\telse 0\r\n\tend as is_active,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen country.name in ('Switzerland',\r\n\t\t'Germany',\r\n\t\t'Austria') then 'Germany'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen country.id in (14,\r\n\t\t86,\r\n\t\t225) then 2\r\n\t\telse 1\r\n\tend as locale_group_id\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join trader_status on\r\n\ttrader.trader_status_id = trader_status.id\r\ninner join brand on\r\n\tbrand.id = trader.brand_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32,68,76)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tcase\r\n\t\t\twhen group_type.name = 'Branch'\r\n\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\telse group_type.name\r\n\t\tend as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\tuser_groups.id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\telse f.name\r\n\t\t\tend = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id =\r\n\t\t(case\r\n\t\t\twhen e.parent_id is null then e.id\r\n\t\t\telse e.parent_id\r\n\t\tend)\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,68,76)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,68,76)\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d75f6780f2002c37ec3b",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3b0c9b65-77cf-48a4-84d6-a36d2b623e84",
            "fullname": "MySql:aa88b3db-8906-479f-a9dc-d4a760d6fa41",
            "type": "extract",
            "name": "aa88b3db-8906-479f-a9dc-d4a760d6fa41",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ca249909-b83e-48b7-b16c-751aa3945cd2",
                        "id": "tq_uUBuSkMox",
                        "name": "TheBPCA_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "11e49031-1735-4370-bbaa-9631d4a9e058",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7387c9c-4a8e-4c71-b297-6d51a7482cf6",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e8e4ad3-8fcf-4e78-a78c-fb27fe82f425",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2d247c0-56cb-45e0-afba-2f55b719267a",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c1ec720-5b02-4114-b04c-9d22c41819eb",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cebc44ce-0948-441e-8a2f-783f242b1fd1",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7fd12d7-1c29-4d77-a052-17fb99593b2f",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6260dfb-22fd-461f-bb77-1fe0c5675c8c",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "4618ab2d-6d33-4db7-9320-ef6f582c8185",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368df6",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oSBHqROSJqfbavRql9qKiSLEmwl7IhJ9c6fsHLIM0OwCRHrJNGuAkZHFejMZg4JRw0O3fODsXnYpi2hUBhBsbmkJv6Fp6AFNzUCzYUMwbHmTHLlXM9s4v79bGMK/5v8OLM1d6GkztCEoQnoKHxxgdL5bqbfcU8jEEZ4JlNgR8Mv",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3bf6893a-f125-4bc1-aa31-33ec2372d0a8",
            "fullname": "MySql:9e040d39-6f22-4b7b-9548-9ffff6288dae",
            "type": "extract",
            "name": "9e040d39-6f22-4b7b-9548-9ffff6288dae",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "36f39124-df09-42b3-8b83-39691933e6ac",
                        "id": "tq_cFo8rTktb",
                        "name": "AussieTrust_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "de1c00d0-299c-4036-bf3c-a3a41798e8a4",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eeee19f5-5dab-4e61-a494-914b59fdfc4e",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "faab54c8-698a-4e70-9eae-9c9b459fa1cf",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67dac046-54ac-450a-a6ec-34b8f3a1538f",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a68b64f-0f14-42d7-be76-68e870cc9170",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd73958a-d2a9-46ca-8347-c6e445e84fd8",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0946574d-d791-4015-9c33-fc521f5b6f27",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb1dc49a-41b0-4133-b35a-d481df2659f3",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5e8a7e56-485e-4b6a-aa10-e751372a7b57",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9a4e281b-fce0-4965-86a6-f46e326cab7b",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "049b5c5e-9328-43eb-aebe-0a3c94651433",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95d003ff-0abb-4a2a-a235-a7edee6d275b",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "423a8e9a-7b23-49d7-963b-c523bb67d443",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7cb2216d-7eac-4516-9c1b-3985f311a695",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b80afb28-04aa-47ba-ba83-f995f124e31d",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "134bf372-94a6-442e-87a5-1f12b8e30485",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1bd64cbf-de0c-4ded-8bf6-f30e98bd47c4",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "baafc61f-1b61-4e00-b910-6e213f2f8b5c",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83678c89-98e0-4d27-90c2-5c304da46c1a",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fac9670b-96f4-4799-ba84-45d4487b4b4a",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab861fef-6b7d-4e19-be5f-62ce33b43077",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "166ddb77-f40c-4cdb-ae07-b3e0f0767e47",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d46c170d-7afb-4b14-be12-2558854190ad",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "59616418-7aa7-43fc-9c2d-6a87debdb0bc",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "059e8502-b67b-495d-9b8e-789895dc8993",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "48bea1b7-e80f-4c11-ae6a-d2a71dac3c89",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1b686324-4cb6-4ae9-9af4-66be16c04151",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75d1a00c-7c4a-4e75-b36c-9cb75acd2a14",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a0032f1b-5f3f-4b53-9548-4eb9c2e82f1d",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "641b8710-f46d-4290-9e61-f59927649181",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "480993a1-3ede-443b-b30a-1435d53b3736",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7cd17a1e-5127-423a-b1f5-b3318a6a9880",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fa5f25ab-dc6a-4295-a05c-fe8951d16934",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5d376546-d024-4c1f-8b11-e7341a8317b5",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7972f7d6-48fc-4f6a-9321-8a37e4f55257",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "123495fa-b5fe-4832-84b0-634771e83944",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fcb20597-b874-406e-a11e-48a613ca2bfd",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e574ba87-5a92-495a-9967-ea3827368715",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e2ed061-0242-401b-87f0-00e5a98885fe",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3333f7b7-a281-4914-a025-3d7d12310f6c",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f66fd1e4-6312-401b-86e5-36eccce7e13d",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9c18331a-1307-45d0-8b51-abd3c4e83536",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b4593918-e6c8-41fe-99da-cd8dedc32d9b",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "15368b0b-08d9-45df-84e8-2b97ee473121",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0beb9c61-2f1f-42b9-b997-ef8dbe215820",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0909681b-437e-4f1b-81f9-add2a7a445cc",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5679e721-744d-4bd9-a610-698580535f5e",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4dda58a6-deb5-47e6-9a9a-ee8df0bf4ae5",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5afe1f70-f4a5-4ba2-841e-753e4eeaeb93",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "68567e85-d488-47a8-85a8-ac515a8d1925",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a371afa-b63b-41e8-8d23-e3f8f2377605",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71ed6cbd-0b9a-41ff-b1b0-206c5dc502d9",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a4d7ed0d-3bc6-41f7-a35d-7ee847cedab6",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d01c4a5-5a3c-49f1-8aa6-012307944525",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e2e83b1-2aff-4f68-88c7-67662376e52f",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "487333f6-848e-478f-8a6c-5c7993a07a20",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f48792b-1d8c-4f13-afef-2d12f7936bab",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0cec3972-c40a-45fc-bc52-4398602129f0",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e855a3a4-f440-457c-b776-83515e0767de",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e09b2c0-e0d6-4ed1-85c9-9919e0941254",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7fb96407-7f72-4129-be1f-65e0875844f0",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ea00a8bc-0a1f-4a6c-9c7b-1d9ccb991f39",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f7008dc-1bb1-46c6-872c-2a0199038b6d",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0db82c75-38e4-4f0a-9428-e4cdd1c836c6",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b612abc-6392-4329-98bf-5f6749923da7",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "59a8c557-969c-40e3-beb4-7da2fdbd339e",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92adb1e6-1237-4394-abde-06a9d749ac29",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d2756f55-f2bc-485b-8a86-952f4c066f47",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d59f202-4963-426d-bafc-8aa7be6d836e",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a303ab88-7be9-465b-a328-0a4676a4a150",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4844c32b-6091-4c68-b6a4-6015417d105c",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cde10897-0a35-448b-9781-b9da1c534a02",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c5583eb-d185-406f-be3d-09e0fee27b86",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "931fd71b-6259-4d63-9431-36536d6a76d4",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "805aa903-51ed-4f0e-a115-391f1711f533",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d96890ad-2841-4421-9a39-f164d311e838",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8bd9974b-e7c9-4093-893c-2efa64479752",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "325dd31a-0cb7-4bf7-a38f-3b316d87c198",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6486802f-6459-41d3-9d15-5f6c51b6c16c",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c00f28a8-4242-46ab-adf8-ae47dcaf637e",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\tselect\r\n\t\tt.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,67,75,138,146)\r\n\t\t\t\tand coalesce(d.name,\r\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,67,75,138,146)\r\n\t\t\t\tor coalesce(d.name,\r\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,67,75,138,146)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,67,75,138,146)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0945 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2582 as GBP,\r\n\t\t\t\t'2020-04 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1115 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2349 as GBP,\r\n\t\t\t\t'2020-05 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1234 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2389 as GBP,\r\n\t\t\t\t'2020-06 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1772 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3087 as GBP,\r\n\t\t\t\t'2020-07 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1938 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3364 as GBP,\r\n\t\t\t\t'2020-08 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1819 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3163 as GBP,\r\n\t\t\t\t'2020-09 ' as ym) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 6\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\tselect\r\n\t\ta.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368df8",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3c4dbe84-cda1-4c83-afd1-e33dd8d10275",
            "fullname": "MySql:b6472111-847f-4d47-b58a-365ea743e926",
            "type": "extract",
            "name": "b6472111-847f-4d47-b58a-365ea743e926",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "98e966ef-8945-4e9f-8fb1-607276671e3c",
                        "id": "tq_t6R3CpGdF",
                        "name": "AussieTrust_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "262bbcd7-4844-4934-8e69-d7fe9eb6632a",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed357f9f-d30d-4e91-ae0a-ce4e12567bf6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "036aa28e-0fc2-49b6-8e96-d14b11b0d95a",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18b952d1-faab-489e-b3cf-e82d8ff0bc86",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "85554920-38b3-4030-80ca-a333fed206df",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01f562f4-4d0b-4959-a2f6-168829638268",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a728bbe7-1d23-4d2f-a285-8dd53b9ff97a",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a903f26c-46da-4ae8-b220-06b5f0593047",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40a03d37-b7c7-4b4f-a7d9-c82111b969ac",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4503ba42-b610-4fdb-8a77-82a95a1a01e1",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b27389d4-51c4-4c9b-8901-130dac9d1856",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1533c18-03bd-47ef-94b1-9d40b1bba6b8",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c5dad88f-63d0-4966-aa04-63a6d1ee0cd1",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7342383a-7e21-4377-b4c8-34d7ca6c5674",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5bc12053-c784-421c-b091-33eb77635bbb",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ed3da87-9975-4ce4-a098-23297a1d74c4",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "90d9153c-4f9a-4a36-bf7f-ab73a35f6556",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "34ee0cc4-0d4c-4c5f-935f-75bf17d3bcbe",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60053800-0f64-47e2-a567-26649212f399",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e154fa6b-ded3-4754-9162-8bce2be6a21f",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ae43041-7060-482c-8137-99652d920524",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0e3dfc7-d8c9-4689-bdcc-6456b3a9f259",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c6ada18-0500-45d3-b253-7f55c801897d",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f85fd78-5cd7-4e72-8351-04d1b406384a",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6d5ee99d-6a12-4081-8141-b17e470274d0",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebbdf7a2-5e86-4bf0-be38-e7f661e115cd",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ecb3379a-910c-4c08-aa7b-c4dec13161e7",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "21706770-98cc-4332-9cf4-9d6c52a42fc6",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35cb1e4f-2a9a-400e-97d9-7871a8623e5a",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e90e37b6-478d-4b68-ab87-53851c6f902e",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b87fa06-5420-4f53-8b04-c43693465deb",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "93eca05c-d922-41d0-b47d-39951b183e92",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a3a68a84-33ea-4709-bacf-64d2cc9c8f9e",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "78330e15-9ab7-43a7-b85c-d47fb30f7d61",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5c3bfea5-42b3-4b5b-8b31-d951be4b21e6",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cf86def0-1d2c-45fe-9041-2be82cfe9d71",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7feb744c-2c65-46b1-a719-aa98ab83b451",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5664a3d4-f5fe-46b5-8365-4b8ff32dbdd8",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ced43d22-63a9-45f7-abb8-fc9771349a1e",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e3a2db6-5876-4a52-936e-eec7cfae5b2b",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ac6e9b7c-28d7-4eac-98c9-3a6177637ce8",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd9e4477-1400-406b-b4a5-f87dd1f57f87",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25f21211-ed89-44a1-bd77-0c9630e4cfff",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb14e39c-c369-49d7-8aa8-f5808a78c859",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e1abdd0-5098-4256-bc40-9887badfe9ab",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "092cb670-4d4d-4c75-b8b8-f8c9add4f04a",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c06feeee-02f5-4303-8c85-625186f667ce",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3acd6e4d-4d11-45d6-b1ef-eeff59b27a4b",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bfa80820-8f8b-40b9-87fc-3e38be0b3c1f",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7087f25-6b17-462c-8823-4e6f24fecbe4",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca6f3d6a-4883-4342-99cd-aceb769ec2d2",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eb229319-0ebb-4668-bc76-b6dc8d07b042",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aaca142e-d166-4897-8704-c02eaa1a2f3c",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd2bebdb-bfac-4d60-934f-d2f02ecd769d",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f0216d5-65b9-4ac5-80c4-500337c106d1",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "7f85fd78-5cd7-4e72-8351-04d1b406384a",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "5f2c6dfc-7238-40bd-a157-c20b9c957d4b",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttransaction_deposit.payment_provider_id not in (24,32,67,75,138,146)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,67,75,138,146)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,67,75,138,146)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d5906780f2002c37e9f1",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3e69d672-b7b2-40b0-9423-312f4591120a",
            "fullname": "MySql:41b35cfc-4c43-488d-8dae-9beef0553c16",
            "type": "extract",
            "name": "41b35cfc-4c43-488d-8dae-9beef0553c16",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "2a90c17a-ad5c-4e87-bbd7-08131b59705f",
                        "id": "tq_hRSK0Lm8O",
                        "name": "TheBPCA_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "39640cd0-0650-45be-8e46-fa8cac39c0a9",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c38da415-7148-49dc-a7d8-25673283f01b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a231647-52a2-417b-8e67-8f1b3fa5ca65",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "932b83d6-61fd-4062-94cc-2538d61673a5",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d8d3639-fed1-429f-b242-73731e87327f",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90024118-655d-4365-b8b6-6a2a1c9415b3",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40a9e9a0-8a80-4139-9916-78a5a2be79eb",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42e37e68-95be-4461-ad0d-7f840f1d6cdb",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45cfd312-50d7-4477-9d34-e3c892fa18bc",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c475b30-4e63-4ba4-841b-1752e0594936",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e91e9fbb-3e11-4b31-8cb4-d7408de31f29",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ca51217-a04a-4f0a-9322-8f92afe691e6",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac10f90a-946f-47df-b5be-0f839ef2f449",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53f2e285-5162-4c2b-b4fd-0b397a8e5622",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1418405-fc1b-4fac-8fe5-3a18cb80af5d",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2049b680-2e0d-40db-95ae-a1c10bc6da27",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e93e9490-80e3-471e-8917-7e4dfa778b95",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "10826b2d-80ff-4511-9342-41ed816488b1",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b64f0df-c670-4342-bbad-422b44b48154",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ed6dbe3-c4f3-4396-9793-4d54f25864d7",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1eb718da-2f6d-4a5f-ad36-cb09bd525367",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d6f3b88-43fd-4170-a523-fc03c589eb1e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "976895d4-c747-4f2d-84bc-6c3bb2c247f4",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07df094f-2784-4490-909d-4879fd04e9ef",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a47c206f-9ac0-4cf8-9679-4490bf5d9a0b",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "068a90c1-f97c-4d04-a17b-c3219dc8dccc",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2885b0ee-da7a-43bc-a9b0-292dea5a5aa8",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4754d7ef-425a-40bd-9b51-32fe7ca7d0bb",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f4b2fa2-5d0a-413b-ac99-36e4c9cbe167",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58b3f980-d726-4fdd-9211-7dd2fcc60787",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52bc5aa4-349f-4260-8301-8990e753c1e1",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2eedc5d2-74de-4484-8a95-b64c1d67010e",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f383d5e6-02f9-45c5-9f07-2a0465359c14",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1824d438-d86e-47a4-aab3-983a6a994812",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e0bce4f-c3d8-4524-8f9e-e263460eb528",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df123bdc-39b9-4ca7-83a7-d8c05a1c3898",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90c66da4-dd4b-467d-bfe6-4a1db8311b76",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88edbf14-f716-4448-9dc4-a5ae96169a03",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f9f5b5b-efb9-4c80-bd4c-15b9521d2b36",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "adb01ace-6e3c-4f9b-8c08-45da25a4fb30",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de58d6e5-974e-48e1-bbbd-0afc7b1dfc34",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a31351dc-9dad-45cf-ac95-231f973c3303",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc9c6d28-0cba-4370-8ebf-e8b96cee1bd0",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72e43bba-ed52-47e1-92bd-fe7516600ca6",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef275885-9967-4780-9125-61f7dda0bd4a",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0788c18-be33-433a-ab39-74bd73bbf71a",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "edf27c26-9e74-4b2f-bff0-fefe7169e64b",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0a27517-c1a1-435d-a0c9-8110db5b4a3b",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5fe605b4-f0b8-4c86-a564-d1ff327a5543",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39ad5d03-5fb7-49c7-a2a0-9f536150a7d2",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4388dac9-d6e0-4040-9b4c-f3e5a82b364b",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c5f3f32-201f-4229-93d2-c7d937eb7998",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e98413b7-4a3d-4ddb-8ce3-05feee097091",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4eb89695-feff-4ef1-b515-45c88fc4a006",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcf56304-2056-499e-86f1-a46f15c7f234",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "07df094f-2784-4490-909d-4879fd04e9ef",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "11426c70-4a10-44f5-bcea-6172a93bb96a",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d7836780f2002c37ec3c",
                "provider": "MySql",
                "parameters": "Li2FpOBZkuQVFHmglvVO3unF3cyE7uQhXYenrn6ytNP08dPSNopcrZhCPhIEZbJq3GHeZmZNPZrQfHZy7Mo7S3QwZl+lJvy8mcXjoPWADHn7fHD/TXsGlpkaRPNOQnFO1tEd5xDHMHRh7i0mnvMheVsy39u8/PLd+UW23hnoTWzeGuy1jl1t9vmXt8xw1uh0Lw271DKaGVhOc5Lst9nqXnRu5pPfVPjIho4oBLMYdZDsXAdGAFkgsULvW5O9Ut8l",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3e9c22d0-edb7-4fa3-8c17-7e1db6b17be6",
            "fullname": "MySql:0b5cbfca-e9f4-4780-bfdc-a7fd87c8b630",
            "type": "extract",
            "name": "0b5cbfca-e9f4-4780-bfdc-a7fd87c8b630",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "61190cd38a56da002c368dfe",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE9NO30CEtYeuiYUtaqTnnfAU2tZy1ts9m5PIlekjZKdki2gvPSjPn2u0iSrDXJC+xbWLjBWVt4g1f/qtvxZuVR19smZ+tTs0uprPImCX8nzR/VOeNl8+7KflR1RKyca1wx+li5+8Ruj8rXQ0wUTfnBZokghOiQxjFRG3tuMv98XW0EAXJx4dtg6DO3R9p/vZ7R",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "40ac1c86-5603-4ac8-9531-867ec4d31cb2",
            "fullname": "MySql:MySql-40ac1c86-5603-4ac8-9531-867ec4d31cb2",
            "type": "extract",
            "name": "MySql-40ac1c86-5603-4ac8-9531-867ec4d31cb2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a6242e45-c972-4796-84ad-6de0b0dca40b",
                        "id": "tq_LiGKfhikA",
                        "name": "York_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "96ddfe65-a0ff-4e3e-a6d3-8903246d2c69",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95240bbc-49ed-42e7-9428-9a02018c9904",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c6f4e78-4fcb-43cc-9756-963414f8eb61",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "15e02894-0e1b-4425-94cc-5bb405a1e8f2",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "975443b9-428d-4e26-b460-d43efa0b8880",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3cd99b02-0115-47cd-83e5-8f37cfeedebf",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1e13e8ab-fecf-4852-9a65-9eac4076e411",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fb0ef867-be26-45dc-9226-d64e7ebc3d48",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "abfa1236-f9da-4064-b931-0c2675cbd8f5",
                        "configOptions": {
                            "importQuery": "select cast(1000 + brand.id as char) as site_id, concat(1000 + brand.id,'10000',b.trader_id) as customer_key,  b.trader_id as customer_id,  year(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,  b.date - interval 1 day as date,  b.open_pnl,  b.open_pnl_diff,  currency.code from  (   select a.*,   case    when @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)    else a.open_pnl   end as open_pnl_diff,   @last_id := a.trader_id,   @last_open_pnl := a.open_pnl  from   (    select *   from    open_pnl_daily   order by    2,    3 asc) a  left join (    select @last_open_pnl := 0,    @last_id := 0) b on   1 = 1) b inner join trader_account on  b.trader_id = trader_account.trader_id inner join currency on  trader_account.currency_id = currency.id inner join trader on trader_account.id = trader.default_account_id  inner join brand on brand.id = trader.brand_id  ",
                            "PrivateKey": "",
                            "Protocol": "",
                            "AuthorityCertificate": "",
                            "ClientCertificate": ""
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368e00",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFEmT/bcq/EycnRME8TGHq9ZgxIX6mgDymM7dLWqZsj+nMrkwVMLpfpzNPsDmI7cOkRQnzJaPUds0v9PrU88QoGRHGlJjg63hBYjWhso2ruIK",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "4165b06c-4744-461d-8903-5c55d82d7f45",
            "fullname": "MySql:b27f6d91-9777-4560-a4f9-84af3ab41a6e",
            "type": "extract",
            "name": "b27f6d91-9777-4560-a4f9-84af3ab41a6e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "36274f66-bd8a-4d37-8021-2ce422507e51",
                        "id": "tq_bp2WHGYM0",
                        "name": "WinGroup_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "584284ba-d55e-4795-8425-837c09ade305",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16a75568-12ef-4f82-b639-89b117105e74",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03680c31-9406-4afe-b8ad-5a905d2e2566",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5230fec4-c828-4a07-a5e6-b8ffbe7902f9",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79e13c40-eab8-4742-b9d2-59379c2d6fb0",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f28d0270-6ba7-424d-9b02-764fdb0cb923",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "971f6333-13bf-4808-acb4-bb00b4a9734a",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "087775b3-09bc-4089-afb6-944be0c23821",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0410b2e1-4508-411a-a158-c5d2a933b6e0",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a207540-17f7-4bf7-8868-d8b2d92ac596",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "65afdad5-2377-4af1-828a-569198c84c8d",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6b26780f2002c37ec34",
                "provider": "MySql",
                "parameters": "7niuYEzJZH44LaPxXSBFhgupfobVTnd8RwuqT0tnpje5KDJ7gduGgbtju1DOzrlHXyxYXX725adKvwo0Axykr9WoMGo9e6lj1avkQiOehykewRR3dL0bFhZy2PD1D/s214ZB/FP6EjZLCw1IBo8M2ECB8F5338o8R/suGfqjWRnOflsq2MUpBYr+Wc7GJM/Dz7GG94Zi/zFyYcZz2sw/RvGv2nW3dmxfd2U2fn5h1ubfdO27mRkN4g+kxmvyY8s8",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "4228d254-8853-4430-9a9f-2e1f7ac24d2e",
            "fullname": "MySql:709268b7-e86f-4a43-b00b-0dad1d9a9015",
            "type": "extract",
            "name": "709268b7-e86f-4a43-b00b-0dad1d9a9015",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4b2b8f1d-8369-417c-9aea-29b412a5c2b7",
                        "id": "tq_MHuCg16MO",
                        "name": "YorkCustomers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "562907cc-ac6c-48ce-b68b-05a36200d487",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69c7b63b-7310-4ad6-921a-56ab46754c40",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a764df1a-2ea7-4601-89ed-743e27728a53",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a03a31df-a96c-47e5-8331-1d63ede18e83",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3928a8b7-c35d-426d-8340-c0b320c090bf",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fe0bb175-4ba7-4d7c-8660-9a3e285a1aec",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e0a607f-7102-4ee1-88fb-b92d6735ea91",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "786dbaf7-3188-47ed-a550-3fd6daffe632",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae5b4aa4-6c51-41fa-a623-9fb00a9def70",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23e832ed-c0ca-4cab-9a3d-eb4ed35b6cf6",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "571bc1be-b0d2-471b-859c-e6ab803c454f",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ad32bd5c-6c9f-4e56-ba47-2ed8ba628ec5",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1da92d7f-81c0-4f56-ad00-39cbeb202551",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b7e98970-b971-4168-9269-df8e33f7cca0",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db1eb19d-af1e-4dc3-930a-3969ab87edba",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "296f7d21-ab87-4260-9532-30f19fa2f975",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b05ed806-a5dc-40f7-9df1-767afdf5b6f4",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06d96392-bedb-44ad-8232-c63eb976c394",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6631c617-a212-4ba1-9a94-820a16963bd4",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1184d03-c62a-4d05-9791-e2e4566db47b",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b63f9e7e-126d-4e9c-9d4d-8080aca3f1b8",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec3ee734-f8f5-4cc3-a403-2c8172efc86d",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d758622d-fa32-4ea2-991a-42282bf719cf",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f7b5179-2af0-4099-8f1b-b9d74216f146",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c2b28c95-4dfa-4ec9-972a-c96f26ff5fcc",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d05f9cff-0ac4-445d-bce7-c4c5b1b200fb",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dc5c7b0f-3160-447a-9472-427d9ae81417",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ef7f80ae-d858-49a6-b0ce-76a1c715f979",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "248b584b-b92a-4788-bda8-c17a341e4fb1",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b9e32bb7-f76a-429e-ac27-34d0ed153e03",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "57042ead-3c77-4d43-86b0-615cc3bd5a68",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0dc21888-5334-401a-b2b7-eb1a8a625310",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "61799c6d-7d2c-4778-9cd2-01cd5ff9c273",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4b6821c9-86b0-49c3-a05c-d683024ab29d",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f737519a-72a2-40ab-b2a7-671fa7912161",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "17737a13-a69f-4afd-b2d7-0b1dc60e9070",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30111817-64d3-405e-9595-445980bd9e79",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f46fe0fb-f741-4f85-a7c7-1f58bb0ded94",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c9e53724-1623-46af-9c2f-a564e6d5be6c",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da8cd1c5-333f-4471-969c-02b1442a45cc",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83345cae-d89f-437a-af38-fc0339546a45",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abae2126-55a2-4f03-a47e-70ae5c3d3869",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0608d04-124b-4d36-8628-158d80b06f32",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e4fc5b6-4195-4616-8e13-55014979c6a9",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ad8e267-1c87-4896-990c-9edc403de74c",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d24b6edd-a9da-474d-a4d6-e0ffe7c69dd9",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "755a2e5f-2987-42d4-bb53-44d7f17f363a",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b7e7dfa-11d5-464e-8c87-0f908f83df08",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3255a28-f35c-436d-9364-c8ca568c44dd",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22214076-f656-48b3-afb5-66bb2aa7a231",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c9712d1-123e-482c-99ab-a9e4ed771623",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2db277e-5a0a-4974-8630-210fd1075c34",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "21fcc410-29de-404c-8449-9fee4ab6f209",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8608082d-0ce5-4b8d-9ff8-d20ae5dc0e5f",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "686741c6-e46d-4062-87c3-79ef46fe19a2",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "7f7b5179-2af0-4099-8f1b-b9d74216f146",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "b83825af-51b8-42b1-baca-e1de31c3e41a",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t'Null') as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\ttrader_status.name as trader_status,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\tdates.days_from_last_deposit,\r\n\tcase\r\n\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\telse dates.days_from_last_deposit\r\n\tend as min_active_day,\r\n\tcase\r\n\t\twhen\r\n\t\t(case\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit\r\n\t\tend) <= 30 then 1\r\n\t\telse 0\r\n\tend as is_active,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_redeposit_1k,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen country.name in ('Switzerland',\r\n\t\t'Germany',\r\n\t\t'Austria') then 'Germany'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen country.id in (14,\r\n\t\t86,\r\n\t\t225) then 2\r\n\t\telse 1\r\n\tend as locale_group_id\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join trader_status on\r\n\ttrader_status.id = trader.trader_status_id\r\ninner join brand on\r\n\tbrand.id = trader.brand_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32,54,68,96,128)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tcase\r\n\t\t\twhen group_type.name = 'Branch'\r\n\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\telse group_type.name\r\n\t\tend as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\tuser_groups.id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\telse f.name\r\n\t\t\tend = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id =\r\n\t\t(case\r\n\t\t\twhen e.parent_id is null then e.id\r\n\t\t\telse e.parent_id\r\n\t\tend)\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,54,68,96,128)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,54,68,96,128)\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d2a06780f2002c37e9df",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiUuE2nWqYtNik98wCcYKjHVFDivbJrt4nOjZsBy+hIwTw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "42679946-9ce2-41cd-bd6b-06a815392bf9",
            "fullname": "MySql:8a670d26-8709-45a8-a1fb-79abdffa1a6f",
            "type": "extract",
            "name": "8a670d26-8709-45a8-a1fb-79abdffa1a6f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a4a34f53-1611-4e1c-8d1f-e015e2bf6bc0",
                        "id": "tq_3PcENeBQf",
                        "name": "TheBPCA_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a2fa7831-c895-4fe0-81b7-632e98fa69ba",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d09a746-8a54-43c0-9be6-540367accbdf",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a0c1376-761d-468a-9873-d1b77498c5c9",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2181be92-0448-43ce-abc7-a8e763e80a50",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b543c55-6bed-426d-873e-7958d9fc1b5c",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "971f4ed9-9833-4f0e-b02e-d5fc3b2cfa71",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f79be8a0-2a46-4b50-91e2-0ef760db2d0c",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d0e3254-c7ec-47db-8b54-d76eb5b0cfc1",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3ea2674-e644-44e0-948e-6bbe234e6776",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53f7e0eb-decc-4959-9ad2-77862bdccd9a",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3ae99ebc-7d34-4106-af8f-6f796f0817f6",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6976780f2002c37ec31",
                "provider": "MySql",
                "parameters": "Li2FpOBZkuQVFHmglvVO3unF3cyE7uQhXYenrn6ytNP08dPSNopcrZhCPhIEZbJq3GHeZmZNPZrQfHZy7Mo7S3QwZl+lJvy8mcXjoPWADHn7fHD/TXsGlpkaRPNOQnFO1tEd5xDHMHRh7i0mnvMheVsy39u8/PLd+UW23hnoTWzeGuy1jl1t9vmXt8xw1uh0Lw271DKaGVhOc5Lst9nqXnRu5pPfVPjIho4oBLMYdZDsXAdGAFkgsULvW5O9Ut8l",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "46392ea6-6a1a-4094-9bd8-86ec061a80b8",
            "fullname": "MySql:f810a000-0512-4408-b941-a35cb7a6097d",
            "type": "extract",
            "name": "f810a000-0512-4408-b941-a35cb7a6097d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "89fbdb2c-1d07-4e73-a14a-7b6b23ec6d9a",
                        "id": "tq_UghCvS2EL",
                        "name": "Chelsea_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "24536162-3c65-4f83-b0bb-0527453a6390",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b9e15de-5b0b-4f4f-afcc-0810ab060019",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e414ced-774d-440b-af7c-45fa95ca2134",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0306cb87-1fe2-42ab-8571-b2308caf70aa",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7feef324-42a7-4000-ae36-fd8d3b3b5fa5",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fa2fb54-e2c7-4968-814a-ea9288566e16",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25dfc3a6-7dc4-4c4e-abc8-072ea2201283",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05c67a69-bd06-436d-8d8f-e84fdb4be994",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dcb1d855-299c-4c71-b344-dc04f9dab5dd",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3543cef2-8acf-4e41-b2fe-6ab25526b739",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c4bb022-d491-4c40-83bd-ae38edaef78b",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da860754-b4a9-4cfa-9f9a-c1c4b1c1b7f3",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "108b1c6e-2744-46a9-85d8-b85661983a88",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02e85389-6771-424f-9426-2e7194e6d600",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "302fd906-f01c-4a05-8a40-9debe02730dc",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef994c24-4da1-4f38-8cb6-d68e199a94f1",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9420fa3e-7f5c-448c-8ff1-d94c1d38f34d",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8833a403-3d25-40ff-bcd1-88d59ac57001",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f197f58a-2207-4dce-9e25-90237236b15e",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a67d6ea1-ef65-40e4-9d09-8a03aeccaaba",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "637f2f58-2503-4b2a-9bc0-0791d869b1e7",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "279a0910-e5a1-4693-9a7c-54e7d668ff50",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f47965b-1297-486a-84d8-85945e1e8176",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a51976e-6d12-41c2-89df-8b49ac3c4bbd",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af065690-4923-420d-b68c-b79c84a1f40e",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2324a20-4255-4ba6-a04e-20d1995dd7b6",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbc5dd37-a271-4926-9f8b-cfae61156e57",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84a476d1-4979-4ad7-9f07-f6ab97abc832",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3acbe7ec-91b8-47a3-9bfb-5294c656edd0",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2fccf82-bc55-4015-b1a8-786fe04c26f4",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23a6617a-c180-41f4-a2c5-062a62946805",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9efb91e-752c-4450-9f10-523e1bb48dcd",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56b7f4a1-5848-476b-8723-5af52e39d979",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9de40816-ce5a-41f8-85a5-3ba7476fb563",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13945020-d53a-4b6e-9e5b-8df4bcbd1526",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cdcab9fc-6636-4d49-8b68-94108a1ff409",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5158362b-42de-40fd-88f3-efe73f2a3ddf",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c3ac398-4a61-4365-9960-2fe7dde26632",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8289d982-da8e-45c0-b560-9d06b2a482b1",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be9a534e-e8a7-4561-acf3-89f5720737a5",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ffc716a-62df-4ffa-bfc4-600e8e5b882f",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81a60a62-8f7a-4ea4-8479-60b21a777794",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6da8cd2b-b551-4256-bf32-326fee5c1828",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f85868dc-2401-45c5-a60e-5c64c288ee60",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4947ce0-7887-4977-b7e4-5a7d1fa48583",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbc4a597-7a13-407a-89b7-5ef60fec16c2",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0fd68dad-0c40-4813-a814-d4372a026394",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af596423-4a67-425b-a38b-4416fea10b2f",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3783eb7f-ca16-4d40-8912-29d7fcce0b4f",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f21db34-ceaf-44b2-8443-3ac457711171",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b9bdcee-3dfb-4923-8a5a-a0bd0073ddc9",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5896d75-7de0-40c5-9a1d-9fe256918527",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a05dca1-326f-436f-8faf-4c8ca5f392c2",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1070f934-2bcb-4069-a63b-ae1dfd4274a5",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d56b152-7922-4aaf-9278-dfe60f723430",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd217834-17f9-4245-ae89-978ad5561874",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f36e80ce-daed-475d-8a57-18e3a5f03b79",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "294b611e-727b-42a4-8a3b-f002980d71af",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb937261-613e-46d8-9502-a40cf8022abe",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc694d1f-406f-4e38-b15b-ea222e852157",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40831899-3abc-4a33-8b23-b7dfc333dce9",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84d4c0de-61d0-4b83-b431-e75ff125fc3d",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8673c58-662c-4326-9153-7be0c86c5bcc",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32fc137c-2b18-469c-a9fa-1007b8823bfc",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19777d9d-767b-46e8-8c05-b61876a3af9c",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ccc7cfd-6669-403d-b129-4e456b815892",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4451272d-f8a9-4e8c-b11c-91721012abe6",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5dcf2988-2aec-48d5-a9ea-1bb80df388db",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e223baef-e387-46d8-ba11-fd1848f9e0d4",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d091611-54b8-4436-b0ce-6c800987dccc",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6569298a-cb71-4001-aec3-36638f646735",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "89816669-a6b5-4cea-866a-3edb34bef470",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6cf48afb-6635-47d5-a94a-69350a775697",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "725f50cc-dd31-49a7-b472-fe409db3f1b5",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d65c84dc-d54f-4047-9e6d-2ae60d066589",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da338149-dfa2-4126-96da-83a1612b2125",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cba89c0c-1082-4285-af50-8e251a851d51",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb863e91-b0ce-40b4-a7c9-2ee5bfb1a727",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e7637c0-603b-4914-9d39-7b68518b413d",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c2338143-77f1-44a9-961c-9c04438fbb14",
                        "configOptions": {
                            "importQuery": "SELECT\n\taggCustomer.id,\n\taggCustomer.site_name as site_name,\n\taggCustomer.site_id as site_id,\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\n\taggCustomer.customer_fullname,\n\tco.name,\n\taggCustomer.currency,\n\taggCustomer.created_at,\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\n\taggCustomer.date,\n\taggCustomer.YearMonth,\n\tcase\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'GBP' then 1.3\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'EUR' then 1.1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'USD' then 1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\n\tend as rate,\n\tMaxDep.LastDepDate,\n\tMaxInv.LastTimeInvestment,\n\taggCustomer.tr_id,\n\taggCustomer.origin_type,\n\tMinDep.FTDDate,\n\tcase\n\t\twhen FTD.FTDind is null then 0\n\t\telse 1\n\tend as FTDInd,\n\taggCustomer.user_id,\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\n\taggCustomer.deposit_curr,\n\taggCustomer.deposit_usd,\n\taggCustomer.cashback_curr,\n\taggCustomer.cashback_usd,\n\taggCustomer.withdrawal_curr,\n\taggCustomer.withdrawal_usd,\n\taggCustomer.withdrawal_curr_new,\n\taggCustomer.withdrawal_usd_new,\n\taggCustomer.cashback_withdrawal_curr,\n\taggCustomer.cashback_withdrawal_usd,\n\taggCustomer.withdrawal_fee_curr,\n\taggCustomer.withdrawal_fee_usd,\n\taggCustomer.chb_curr,\n\taggCustomer.chb_usd,\n\taggCustomer.inactivity_fee_curr,\n\taggCustomer.inactivity_fee_usd,\n\taggCustomer.overnight_fee_curr,\n\taggCustomer.overnight_fee_usd,\n\taggCustomer.fees_curr,\n\taggCustomer.fees_usd,\n\taggCustomer.pnl_curr,\n\taggCustomer.pnl_usd,\n\taggCustomer.duplicated_pnl_curr,\n\taggCustomer.duplicated_pnl_usd,\n\taggCustomer.swap_curr,\n\taggCustomer.swap_usd,\n\taggCustomer.contract_usd,\n\taggCustomer.rbonus_curr,\n\taggCustomer.rbonus_usd,\n\taggCustomer.cancelled_bonus_curr,\n\taggCustomer.cancelled_bonus_usd,\n\taggCustomer.pending_bonus_curr,\n\taggCustomer.pending_bonus_usd,\n\taggCustomer.fixed_balance,\n\taggCustomer.fixed_balance_usd,\n\taggCustomer.negative_balance_fix_curr,\n\taggCustomer.negative_balance_fix_usd,\n\taggCustomer.refund_curr,\n\taggCustomer.refund_usd,\n\taggCustomer.education_deposit_curr,\n\taggCustomer.education_deposit_usd,\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\n\taggCustomer.balance_after_curr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\n\tb.balance as CurrencyBalance\nfrom\n\t(\n\tselect\n\t\tt.*,\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\n\t\t\telse @netdepositcurracc := @netdepositcurr\n\t\tend as NetDepCurrAcc,\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\n\t\t\telse @netdepositusdacc := @netdepositusd\n\t\tend as NetDepUsdAcc,\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastab < 0\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\t\telse @RealABAccHelp := @RealAB\n\t\tend as RealABAccHelp,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastabusd < 0\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\n\t\tend as RealABAccHelpUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\t\telse @realreal := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\n\t\t\telse @realrealneg := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\telse @realrealusd := @RealABUsd\n\t\tend as RealAccountBalanceAccumulatedUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\t\telse @RealABUsd\n\t\tend as RealABDiffUsd,\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\n\t\t\telse @realpnlcurr := @realpnlcurracc\n\t\tend as RealPnLCurr,\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\n\t\t\telse @realpnlusd := @realpnlusdacc\n\t\tend as RealPnLUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\n\t\t\tend as education_deposit_total,\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\n\t\t\telse @eligible end as EligibleDiffCurrency,\n\t\t@lastreal := @realreal,\n\t\t@lastrealusd := @realrealusd,\n\t\t@lastrealneg := @realrealneg,\n\t\t@lastab := @RealABAccHelp,\n\t\t@lastabusd := @RealABAccHelpUsd,\n\t\t@lastId := t.id,\n\t\t@lastrealpnlcurr := @realpnlcurracc,\n\t\t@lastrealpnlusd := @realpnlusdacc,\n\t\t@lasteligible:= @eligible\n\tfrom\n\t\t(\n\t\tselect\n\t\t\tbrand.name as site_name,\n\t\t\tcast(brand.id + 1000 as char) as site_id,\n\t\t\tb.id,\n\t\t\ta.id as tr_id,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\n\t\t\t\telse a.created_at\n\t\t\tend as created_at,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\n\t\t\t\telse date(a.created_at)\n\t\t\tend as 'date',\n\t\t\tb.user_id,\n\t\t\td.code as currency,\n\t\t\ta.origin_type,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend as YearMonth,\n\t\t\tcase\n\t\t\t\twhen d.code = 'USD' then rates.USD\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\n\t\t\tend as rate,\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\n\t\t\ta.balance_after as balance_after_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\n\t\t\t0) as deposit_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\n\t\t\t0) as deposit_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\n\t\t\t0) as cashback_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\n\t\t\t0) as cashback_usd,\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\n\t\t\t0) as withdrawal_curr_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\n\t\t\t0) as withdrawal_usd_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_usd,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) as fees_curr,\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) as fees_usd,\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\n\t\tfrom\n\t\t\ttransaction_record a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount,\n\t\t\t\ta.realized_at\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 1) rbonus on\n\t\t\trbonus.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 0\n\t\t\t\tand a.status = 'approved') pbonus on\n\t\t\tpbonus.id = a.id\n\t\tinner join trader b on\n\t\t\ta.trader_account_id = b.default_account_id\n\t\tinner join trader_account c on\n\t\t\tb.id = c.trader_id\n\t\tinner join currency d on\n\t\t\tc.currency_id = d.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand coalesce(d.name,\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\n\t\t\twithdrawals.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tor coalesce(d.name,\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\n\t\t\twithdrawals_cashback.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tand COALESCE(b.psp_reference_id,\n\t\t\t\t'') <> 'CH SR Cashback'\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\n\t\t\tdeposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tb.status = 'completed'\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\n\t\t\teducation_deposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tor COALESCE(b.psp_reference_id,\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\n\t\t\tcashbacks.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\n\t\t\twithdrawal_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 8\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\n\t\t\tovernight_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\n\t\t\tinactivity_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tswap as swaps_curr,\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\n\t\t\tfrom\n\t\t\t\ttrader_account_position a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id) swaps on\n\t\t\ta.id = swaps.ftr_id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t1.1448 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3108 as GBP,\n\t\t\t\t'2019-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1376 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3263 as GBP,\n\t\t\t\t'2019-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1224 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3021 as GBP,\n\t\t\t\t'2019-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1214 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3038 as GBP,\n\t\t\t\t'2019-04' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1197 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2637 as GBP,\n\t\t\t\t'2019-05' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.136 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2691 as GBP,\n\t\t\t\t'2019-06' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1071 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2152 as GBP,\n\t\t\t\t'2019-07' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1009 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2157 as GBP,\n\t\t\t\t'2019-08' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0899 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2287 as GBP,\n\t\t\t\t'2019-09' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1157 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2937 as GBP,\n\t\t\t\t'2019-10' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1019 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2928 as GBP,\n\t\t\t\t'2019-11' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1124 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3351 as GBP,\n\t\t\t\t'2019-12' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1095 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3205 as GBP,\n\t\t\t\t'2020-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1089 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3181 as GBP,\n\t\t\t\t'2020-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.13513 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.30362 as GBP,\n\t\t\t\t'2020-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0945 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2582 as GBP,\n\t\t\t\t'2020-04 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1115 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2349 as GBP,\n\t\t\t\t'2020-05 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1234 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2389 as GBP,\n\t\t\t\t'2020-06 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1772 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3087 as GBP,\n\t\t\t\t'2020-07 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1938 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3364 as GBP,\n\t\t\t\t'2020-08 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1819 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3163 as GBP,\n\t\t\t\t'2020-09 ' as ym ) rates on\n\t\t\trates.ym =\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tsystem_currency_vol\n\t\t\tfrom\n\t\t\t\ttrader_account_position) contract on\n\t\t\tcontract.ftr_id = a.id\n\t\tinner join brand on\n\t\t\tb.brand_id = brand.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t113 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t178 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t431 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t444 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t667 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t669 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t719 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t722 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t725 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t728 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t730 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t739 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t3 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t742 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t4 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14017 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14185 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t15286 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t17222 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18557 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18633 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t51094 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t53021 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t55189 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56011 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56598 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t58533 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59217 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59564 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59921 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59936 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59940 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59976 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t60973 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62255 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62602 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64700 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64903 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66341 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66653 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t67606 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68025 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68732 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69281 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69501 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t70036 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t71348 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t73585 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t74087 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76808 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76830 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77591 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77992 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t78569 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79158 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79751 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79776 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79861 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80148 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80149 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t81789 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t82187 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83126 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84647 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84882 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84994 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t85474 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86488 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86959 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t87442 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88286 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88547 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88580 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88608 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88934 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88957 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88960 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89028 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89048 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89527 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t90983 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91231 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91599 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92083 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92119 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92272 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92436 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92529 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t93156 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t94765 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95003 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95417 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95533 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95552 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95696 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96039 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96082 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96442 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96444 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96903 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97559 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97715 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98608 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98799 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98801 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98939 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98941 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99276 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99382 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99383 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99943 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101045 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101071 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101252 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t141562 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142017 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142046 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142054 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142060 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142077 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142082 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142264 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142430 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142628 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143897 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143985 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144173 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144779 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t146491 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147091 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147685 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148023 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148087 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149446 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149654 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t150882 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151089 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151363 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151386 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152005 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152069 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152804 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153023 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153576 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153588 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153631 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154646 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154692 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155297 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155382 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155827 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156184 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156235 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156868 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t157794 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158445 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158887 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159205 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159555 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159821 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160010 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160727 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160963 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t161450 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162530 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162532 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163044 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163285 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163535 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163689 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164246 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164829 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164864 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164909 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165119 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165178 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165335 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166717 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t7 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166741 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168116 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168721 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168736 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t169843 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\n\t\t\tduplicated_transactions.origin_id = a.origin_id\n\t\t\tand duplicated_transactions.brand_id = 6\n\t\twhere\n\t\t\tb.is_test = 0\n\t\tgroup by\n\t\t\t1,\n\t\t\t3,\n\t\t\t2,\n\t\t\t4,\n\t\t\t5,\n\t\t\t6,\n\t\t\t7,\n\t\t\t8,\n\t\t\t9,\n\t\t\t10,\n\t\t\t11,\n\t\t\t12,\n\t\t\t13\n\t\torder by\n\t\t\t3,\n\t\t\t4,\n\t\t\t5 asc) t\n\tinner join (\n\t\tselect\n\t\t\t@lastab := 0,\n\t\t\t@RealABAccHelp := 0,\n\t\t\t@lastRealABAaccHelp := 0,\n\t\t\t@lastId := 0,\n\t\t\t@realreal := 0,\n\t\t\t@lastreal := 0,\n\t\t\t@RealABUsd := 0,\n\t\t\t@lastabusd := 0,\n\t\t\t@RealABAccHelpUsd := 0,\n\t\t\t@realrealusd := 0,\n\t\t\t@lastrealusd := 0,\n\t\t\t@netdepositcurr := 0,\n\t\t\t@netdepositcurracc := 0,\n\t\t\t@netdepositusd := 0,\n\t\t\t@netdepositusdacc := 0,\n\t\t\t@realpnlcurr := 0,\n\t\t\t@realpnlcurracc := 0,\n\t\t\t@lastrealpnlcurr := 0,\n\t\t\t@realpnlusd := 0,\n\t\t\t@realpnlusdacc := 0,\n\t\t\t@lastrealpnlusd := 0,\n\t\t\t@currentrate := 0,\n\t\t\t@realrealneg := 0,\n\t\t\t@lastrealneg := 0,\n\t\t\t@education_deposit_total:= 0,\n\t\t\t@eligible:= 0,\n\t\t\t@lasteligible:= 0) v) aggCustomer\ninner join (\n\tselect\n\t\ta.id,\n\t\tb.name\n\tfrom\n\t\ttrader a\n\tinner join country b on\n\t\ta.country_id = b.id) co on\n\tco.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.id) as FTDInd\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) FTD on\n\tFTD.id = aggCustomer.id\n\tand FTD.FTDInd = aggCustomer.tr_id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.created_at) as LastDepDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MaxDep on\n\tMaxDep.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.open_at) as LastTimeInvestment\n\tfrom\n\t\ttrader_account_position a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1) MaxInv on\n\tMaxInv.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.created_at) as FTDDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MinDep on\n\tMinDep.id = aggCustomer.id\nleft join trader_account b on\n\taggCustomer.id = b.trader_id\norder by\n\t1,\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368e08",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lmoVQsTevINebgL5jFjt37tZHVE1yfCNBl6wIlYq6wI7NUggy3EK86zDSbM4Fw27FcQ7WJjO+t052mJVx7AZ+Z6gWRvGvZ4n1PPPLo5KaSvMstq72ErNzPegcuzwKce1NBllSBZUAXHjSilY0GlglY61i6z48l5MvN5HzcxxLj8",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "49938531-8495-41c2-9792-d39cc77ec1d1",
            "fullname": "MySql:51ef4147-907e-4131-91dd-0d8b705025f0",
            "type": "extract",
            "name": "51ef4147-907e-4131-91dd-0d8b705025f0",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "773b3d1f-8a29-435d-90e8-49cb58047426",
                        "id": "tq_9Y6FkVCDE",
                        "name": "BendigoCoins_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1ee63f1d-a976-454f-aab9-952d0d67a125",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a97bea0b-e41f-403d-a088-6571498bd25c",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb1b0c9b-ecba-4c7f-b4bb-57424109bcd9",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2c07ccc-f54e-4b95-89dd-8c1cd69767dd",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "712a6ca4-850b-4b92-8f92-413fe05d0f2c",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bee7a58a-4150-40af-992d-81c899af7a2f",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "4749316b-6e78-42de-931e-2a2d2c063082",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "616021809d5c67002c6f1964",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLYe2SGfT8Lds+akycpW5+K9YO+8fTekLNVbA78DM/OCWbxUblK2Id8YJvnNXUQ+eTIAHMN/W71sURfgBeS0WwQxNOqj84HBxwBZ6il+EKFmHJ9FWKQZm+UDy5OxqZbFAkXbpIyiPYxJBez63/L55hNPwBFOT2h2PzJQNrmoEZCdMcWAZeNnU55kjKL1mdEhkXeRVJc9RJItZ3XYlFNc1pmocYfl2UZpPJAOkcdJcbO/5",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "4cb823d6-105c-41dd-8a7e-2f9e998e077a",
            "fullname": "MySql:MySql-4cb823d6-105c-41dd-8a7e-2f9e998e077a",
            "type": "extract",
            "name": "MySql-4cb823d6-105c-41dd-8a7e-2f9e998e077a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "2bfe1eee-722b-49fa-addc-c37629e820ab",
                        "id": "tq_3f3aUjRRr",
                        "name": "Wealth_eom_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e580bf21-4e03-49c1-b83b-784b1b4fa56c",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4c92aa06-36f4-4ff0-a8ab-54601c68880e",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "61a79044-b4da-43fa-92be-ec976bc67b43",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3046cdd3-53f7-4563-89e4-42c9b7ff124f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "341d9586-b49b-4119-84a6-11e898567da2",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78b074f3-a94e-4a22-9a62-7a9ea734d800",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "1fa039c4-9db3-464c-824e-99fa409aabc9",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "d14120bf-b3fe-46c5-b834-e24dea569cc5",
                        "id": "tq_QNCSoOwOp",
                        "name": "Wealth_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "326002a7-fd74-4d66-a8e3-dd74ad3925fc",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0dd1c92b-8d51-4db0-b5d2-c4e948770079",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32e29c9c-f70f-4d08-96d4-3113bc88ac18",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cfd73aee-1de9-4c48-8666-fbe462f5fe19",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5730d38-10bd-4ca1-9def-7bc36bd8d56c",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "705dd453-5a4c-4fa6-b7c0-e02dc9fcf8c1",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7958153a-1c5e-4311-b885-74c4a733ddf7",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b8fe88a9-1581-46ba-85d5-6c2727792b4b",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "4720e46a-2710-4c47-a2b5-87a8e7b302d6",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id \ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368e0a",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFGeJv+29GMau5bsRJvrdsSZzLpCamV/EZtB0tOn3UiTkfEdBWBnBcIuotj9y1SfLA7+AQXAOy8oF31KEpdelTX7r18oo2G/kOI8SzM55/XVfOKjxYQ9olMr/vMXf2a4xGQ==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "4fe813ef-d2b9-4e2a-84b0-974cc57bba97",
            "fullname": "MySql:d6fc5291-7500-400b-9272-5c2d5a8630eb",
            "type": "extract",
            "name": "d6fc5291-7500-400b-9272-5c2d5a8630eb",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ecbadfcd-3a7f-489d-872f-f3ed75f310ca",
                        "id": "tq_IAXzOSTIm",
                        "name": "TradeTheBit_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "76700e14-241a-4aa8-bc33-a99337433b02",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3009a337-3ba9-4832-9aba-3a9829f186ae",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35848382-88f9-48c6-b47b-a8fd178c8798",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b8718c6-8adf-40f4-bdd2-806513166fa5",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55b81b1d-04d0-4243-aea1-8b21baa65e99",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "554d228c-cb0c-4eda-9d8e-d035e7b15bf3",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b2ec3ca-0020-4954-8489-4533deabfa0e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "518e6003-6bed-4506-98bb-049ecf7f5df7",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d6d3b2d-6d29-40e7-8000-2b5315551c2e",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "316eb216-797f-4aa3-aaee-7278637cd801",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6afd9947-94d1-4127-87f6-30c6e1231825",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1ca43b9-29da-445d-9d91-86170443944c",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "439a4b0b-00d8-47b5-9d0e-a2d961b09e20",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f7190ff-5f2c-453a-9ae6-51ce842bd853",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "630bb12b-db28-4d9c-a28f-ae4a41617994",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b0310c8-ce17-41e0-a274-ad2cf45cb566",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "061c11a9-c4db-4dca-8318-e8961f3dc1a5",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc38ddc1-1a81-4b3a-aab5-85496f2e7fab",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac6f5ce5-c6dc-4cad-89aa-7bf58346c305",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08cb5666-7a78-4ba6-92b5-42a204649bf1",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f65b8150-bef4-4211-927b-3920a1f43dea",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30a3475b-7d47-4746-be54-753504f46d9d",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01242e9e-d9eb-4f54-bb4d-6d9e2a841ae9",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee01416e-3995-4ff7-8814-b3ab36ef42f3",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "061f1866-253e-4adb-8f3c-fa8c62527bb7",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54c255be-51b5-4c22-ad01-2aa063cfa76d",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f259520c-ff13-443a-b09f-5af98a5b001d",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f257ae28-561f-43b1-89b9-06000cadc493",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0b2a6b5-db96-44c2-a910-de1f85126f51",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f86af31b-a5ad-474c-a8d1-a76bc4d64cb3",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7727203b-2884-489a-8593-4e0af517ffe4",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28465c33-040e-4c01-ab0a-9072cb04179b",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "300e1888-6f7c-41d0-93a2-1e60bf69eb80",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f29a0e4-e388-40c0-a44f-5e0aa7877043",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cadf8499-34e2-413b-8584-60222e3930a9",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11c9e56c-a0d6-4eef-a0c5-fedbc1435e86",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "becf4acf-b7c3-428b-bab5-f0d9dfca1329",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff84f018-8302-4c9a-ac74-a632a3f25c6a",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2bd6cf9a-dc8a-40a8-9634-1329a61af48e",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7809bd3e-e681-4217-b089-7d07036a470f",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ac6b949-cf1b-4bfd-84b6-8175e7b09f06",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22de870c-5be1-48a5-8316-96b3f6439282",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e633c70c-6797-428f-a0e8-f663ad4cab7b",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34d18778-847e-4f92-a3ca-662ca9b3c532",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d7ec86d-bd65-4f66-b947-7676912e5c90",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55b21780-4091-45e1-9ec7-8c72589b4ba7",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd93da8d-31ac-4fd2-ba53-20f87ff7bf14",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "225720ab-a583-4747-9375-e2ad857bca76",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2b7ffad-a6ad-4f40-83b8-fc5086058ef7",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b89193d4-719a-45be-92bb-3dfc2377cf8a",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "505d4bb3-f8bb-4466-8bc9-a3d1177ee1dd",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f15e806-7f12-4c48-9822-e2bfcab00735",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6d8ca56-0cb4-4409-be41-1170364128cd",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a71e0d6e-e9e4-48b9-abe5-9c3c6d612bbd",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8b97307-e1a0-4e6b-aaf3-56d721679e1f",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c942c655-b2ff-4930-bb1c-6832f7e7277e",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce69f21d-1c91-419f-8c1d-0ea141e7a467",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "427f085a-e87f-4da8-b093-267425c22ac1",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dde545f7-c6e1-413c-ab80-cf637da33593",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0044636-ce9a-4ffb-9f22-4a79472d231f",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69d7610f-f8ef-4d27-a8e6-f46cea256436",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34a060ed-32fd-4209-bbbe-f73b08344215",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5878901d-4024-40b7-a0ca-0bcc0437d425",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e9219272-39e8-42d8-9231-814697fde721",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78fa3c95-23d4-43da-8f60-18e9baac751a",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b45e332-0cbb-4fcc-9296-d00323daf9dc",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab698b99-0a66-4a14-a374-d06966d52afa",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d92352d-8727-4680-8e0d-c48b30469fdf",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bfd0f2ff-3dcd-4a5c-a14b-830d1855f37d",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6dbbf83-0b14-48a0-852d-c3ce925c92a1",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38158a1e-267c-44b9-b07a-79ede6d40dc4",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "234305ca-c4e1-4736-8635-34b3f79a3b6a",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25bd554f-8c0d-4c95-b955-b1212873a264",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "566905a3-3cb1-4407-8fed-405adce34d06",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d592726-46b5-407e-b509-8551ad57bb31",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b494502e-da52-4242-8559-b4d720217ee5",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7daba79c-f976-4a5e-a599-1de20d3a0632",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68c9aed5-a193-4d2f-83ce-7faf9c458b02",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9bca87c2-61b7-4b1a-b624-77ddf52469b1",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "69b71396-910f-4589-b9f0-26a3c2aae897",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\tselect\r\n\t\tt.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,\r\n\t\t\t\t32,70,78)\r\n\t\t\t\tand coalesce(d.name,\r\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,\r\n\t\t\t\t32,70,78)\r\n\t\t\t\tor coalesce(d.name,\r\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,\r\n\t\t\t\t32,70,78)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,\r\n\t\t\t\t32,70,78)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0945 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2582 as GBP,\r\n\t\t\t\t'2020-04 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1115 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2349 as GBP,\r\n\t\t\t\t'2020-05 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1234 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2389 as GBP,\r\n\t\t\t\t'2020-06 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1772 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3087 as GBP,\r\n\t\t\t\t'2020-07 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1938 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3364 as GBP,\r\n\t\t\t\t'2020-08 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1819 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3163 as GBP,\r\n\t\t\t\t'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 6\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\tselect\r\n\t\ta.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "616681db859aed002ce67d41",
                "provider": "MySql",
                "parameters": "F954Cqx2+xpp7cv613X4To3KDLtYkIILY9DKa7o2J6iwT7Hhp/LuVGR7WVoXuAJR6pANxIXoQ9aWeJiI7OcJP72ZHBxG9xyN42erULpN5ZuqvWQ4Ab7IRfQ6FHGxrmIec/RVbJ5P1EBneN6L0WOHnZFugjR8UPuM7oh3rwSSnzvjLJFOJ0c2gxjMsXRaCgVGAB0Pjz5j/uHDcFPg85fyrANVftdnJomPKg7Rk6G5kbKEybu1E9znVlAXap1CpXX6",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "526d70a9-dba2-403b-9d49-d059040f1302",
            "fullname": "MySql:ba275e9e-12c4-4d8a-b09c-83a2ab562e05",
            "type": "extract",
            "name": "ba275e9e-12c4-4d8a-b09c-83a2ab562e05",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c993d592-5e97-4ab5-a3f2-1a926ec3d1cf",
                        "id": "tq_BQAolLqvh",
                        "name": "365TradingFX_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1eb4318b-3fde-47f0-b756-f796995faeb7",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b4ee6c9-2528-4425-b0ae-49a5a48ec71c",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60a1c3e5-8d64-49f3-88a8-5ac0c16f5d53",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52ecb282-283b-429a-b6f5-f0f3f7904345",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbbda218-26e3-4b13-a8bd-91815eade438",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a605f928-8cf2-4215-9986-d3a59817ceb9",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "7d3df516-8f0c-4d5c-8e1c-5b138391e132",
                        "configOptions": {
                            "importQuery": "select\r\n\t`date`,\r\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\r\n\tcode,\r\n\tsite_id,\r\n\temployee_key,\r\n\topen_pnl\r\nfrom\r\n\t(\r\n\tselect\r\n\t\topen_pnl_per_day.*,\r\n\t\tcase\r\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\r\n\t\t\telse last_day(`date`) end as eom_date\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\t`date` - interval 1 day as 'date',\r\n\t\t\t\tc.code,\r\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\r\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\r\n\t\t\t\tsum(open_pnl) as open_pnl\r\n\t\t\tfrom\r\n\t\t\t\topen_pnl_daily a\r\n\t\t\tinner join trader_account b on\r\n\t\t\t\ta.trader_id = b.trader_id\r\n\t\t\tinner join currency c on\r\n\t\t\t\tb.currency_id = c.id\r\n\t\t\tinner join trader d on\r\n\t\t\t\ta.trader_id = d.id\r\n\t\t\tgroup by\r\n\t\t\t\t1,\r\n\t\t\t\t2,\r\n\t\t\t\t3,\r\n\t\t\t\t4) open_pnl_per_day) eom_pnl\r\nwhere\r\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368e0e",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6h2kEQfj06tSGpyh+xEzmk6Iq8paTu3ip6/rB+N1MFIYN59/xJKyq6s2pJ06bUpzhAANrOSGSl8zpPlUO8IwiG8A7d+Vz+KCoZhjqP9L+KHT5GfaypnOnu+badv06TGAXIJlaegbboPbyBtw46kZTRfJ2bJyakx/q48snRhZp8Cm",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "53904c70-a59c-4e36-b734-fa8cc692fb57",
            "fullname": "MySql:ca7f683c-d75a-453c-89fb-7aa820a10441",
            "type": "extract",
            "name": "ca7f683c-d75a-453c-89fb-7aa820a10441",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0de409af-153f-4f5e-a8db-6431b9a6e4c4",
                        "id": "tq_qQTPmZjJR",
                        "name": "InfinityCapitalg_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6310cbf7-f90d-4ad7-b619-8339cf6b6ae1",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e3181a69-b0a2-4320-9952-b959ca65da3a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d12d1cb9-025c-4e56-b49d-b06e2cfad5ad",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4a9179a-fedf-47d9-bbbc-215bc3844964",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c5b2b45-e16f-44c0-87bc-6d29b3794a27",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "142d2d42-b845-4203-bdae-9baa526381c2",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad7eaa4b-8fa7-4f15-8ec4-e101e9587e58",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5934adfd-87be-4056-a980-d3c93d2fe234",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19edaa51-42e2-4d22-9582-7aff86a3c5d9",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3e99410-d3dc-419b-9a30-8146f36a8b1c",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c59d0713-2d3b-4de3-8b51-fdcaeeca89d4",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat(1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d5636780f2002c37e9ef",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "54d68c53-584c-47b0-8292-c798cabe84ef",
            "fullname": "MySql:6845c70c-3055-4793-af29-1ec556a0ad6a",
            "type": "extract",
            "name": "6845c70c-3055-4793-af29-1ec556a0ad6a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7c0d5d8a-18f6-42b1-92f8-db3589d82692",
                        "id": "tq_PP7Tu8TLt",
                        "name": "PrimeOTEmployees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "191ae100-4a3f-4561-a06f-b5935887b917",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "806a0407-c883-4d22-93f4-824cb7337245",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fce665d3-9697-4e3f-9c67-1ed7a0e77b3c",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de0bbb77-881d-4645-96c4-282a45fc71e0",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a17bb70-4749-490a-8eaf-652dd4e5351b",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd9f83a8-15f9-4f4d-85ac-b95567dc34f8",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76b5fab0-3dfb-4897-8bba-f99ab11c6107",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "459fc60d-26ab-4cfd-84df-590f895e9d24",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce9c2bff-6d7d-40a1-9bc6-397f490d96c1",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ceaf51dd-f24f-4eff-8b5b-d7e63ad97f78",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "ab8be793-69b8-47e9-ac4d-c192a3a39658",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE( `user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name\r\n\tend as department,\r\n\tgroup_name.name as group_name\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect a.id,\r\n\t\tmin(c.id) as group_id\r\n\tfrom\r\n\t\t`user` a\r\n\tinner join user_group b on\r\n\t\ta.id = b.user_id\r\n\tinner join `group` c on\r\n\t\tb.group_id = c.id\r\n\twhere\r\n\t\tc.parent_id is not null\r\n\tgroup by\r\n\t\t1\r\nunion\r\n\tselect\r\n\t\temp.id,\r\n\t\tmin(user_group.group_id) as group_id\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect proba.id,\r\n\t\t\tsum(ch)\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\telse 0\r\n\t\t\t\tend as ch\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id)proba\r\n\t\tgroup by\r\n\t\t\t1\r\n\t\thaving\r\n\t\t\tsum(ch) = 0) emp\r\n\tinner join user_group on\r\n\t\temp.id = user_group.user_id\r\n\tgroup by\r\n\t\t1) user_groups on\r\n\t`user`.id = user_groups.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (\r\n\tcase\r\n\t\twhen `group`.parent_id is null then `group`.id\r\n\t\telse `group`.parent_id\r\n\tend )\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d2036780f2002c37e9db",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CAgo/mhzsyh0uxU+gptUMPWJyvCkVdqgrWNxqHTIoQ0w",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "57eaec9f-1b7e-473e-b183-c9772c96316c",
            "fullname": "custom-57eaec9f-1b7e-473e-b183-c9772c96316c",
            "type": "custom",
            "name": "custom-57eaec9f-1b7e-473e-b183-c9772c96316c",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4965aea6-148c-4b5f-9563-da2382b062a1",
                        "id": "New Custom Table",
                        "name": "EmployeeInCharge",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "59d6ca3a-f8b1-46da-b288-1251a8b74390",
                            "expression": "select *, 0 as employees_join from [YorkEmployees]\r\nunion all\r\nselect *, 0 as employees_join from [PrimeOTEmployees]\r\nunion all\r\nselect *, 0 as employees_join from [IvyTrusts Employees]\r\nunion all\r\nselect *, 0 as employees_join from [MarketCG Employees]\r\nunion all\r\nselect *, 0 as employees_join from [FXVC_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [Wealth_employees]\r\nunion all\r\nselect *, 0 as employees_join from [Arrow_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [AussieTrust_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [InfinityCapitalg_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [365TradingFX_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [TradeTheBit_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [NostraCapital_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [TheBPCA_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [GeniusIG_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [Chelsea_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [Ashford_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [WinGroup_Employees]\r\nunion all\r\nselect *, 0 as employees_join from [BendigoCoins_Employees]\r\nunion all\r\nSELECT 0,1001,'1001100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1003,'1003100020', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1007,'1007100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1010,'1010100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1011,'1011100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1012,'1012100020', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1013,'1013100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,110,'110100100', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1015,'1015100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1018,'1018100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1014,'1014100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1022,'1022100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,119,'119100190', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1024,'1024100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1025,'1025100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1026,'1026100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1027,'1027100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1028,'1028100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1029,'1029100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1030,'1030100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1031,'1031100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1033,'1033100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all\r\nSELECT 0,1034,'1034100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1035,'1035100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1038,'1038100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1039,'1039100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1040,'1040100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1041,'1041100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1042,'1042100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1043,'1043100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1044,'1044100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1045,'1045100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1046,'1046100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1047,'1047100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1049,'1049100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1051,'1051100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1052,'1052100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1053,'1053100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\nunion all \r\nSELECT 0,1054,'1053100000', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie',0\r\n"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1910b3c7-0686-4b52-88eb-61746fcf0aa6",
                                "id": "299f9e4f-8933-4205-834d-65f4182b5e2f",
                                "name": "employee_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ff3602a-29b7-48b4-91c0-527b2c984763",
                                "id": "3700cf60-d6a5-449d-a4cc-c589eadc7554",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0253cfe3-5b6b-4c92-98bb-503dceb64da4",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "236bf640-1c39-4d33-a245-dc1c693da8e0",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e25e3f6-8348-4e42-aac6-409c9e38331e",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "caee1d0c-40a3-4a9f-a688-4fd4051b5556",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15cd902f-ae4c-4792-80f8-d809edebf38d",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7171bf3-99dd-4a10-9927-72521c46c4e3",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "043cc8b0-9add-409b-a24f-ff41f16ca8c7",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "100f0a98-eed6-4c7d-993a-679f95bedf2f",
                                "id": "16e32a53-db2b-41ce-a195-b700d1beb46b",
                                "name": "group_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a612143f-fb4b-4896-ac41-1730fde616f3",
                                "id": "employees_join",
                                "name": "employees_join",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "fd5cb1ea-f1fa-48c1-95eb-27593575e757",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "59231957-98e2-49d8-a939-5259eb1cae2c",
            "fullname": "MySql:d9e5f4b0-eec7-4783-965e-33ccae3d34e2",
            "type": "extract",
            "name": "d9e5f4b0-eec7-4783-965e-33ccae3d34e2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "670e9e0a-1390-491e-9fdd-d1041e86677a",
                        "id": "tq_MJzMhYJRr",
                        "name": "Ashford_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "72276bf5-298a-4f5e-bd67-c5df3ac51f1b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19904ffd-be37-4044-a438-dad9ee398259",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a62dbfd1-b5c1-48a8-91df-d692abd11eb8",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5fe5e241-a621-427c-81e4-7c3eaff4643d",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2187abbc-1b07-4923-b3d3-6037c60edd11",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aee8b8eb-5f70-451a-aaa0-e9b3776698b6",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce0e5807-4c9d-4aa8-bbd5-d92d7e0a48a2",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64e90623-ef63-4012-b15b-47b878f731e2",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "6f353ece-ec6f-48bd-92cf-d45579d0cf27",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368e11",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6qAqQ4wTrAjQNYhfY7egrcPCKm7Rh9+irvJBmxkN4y5OWK0b1ABUI6cX4BynT/Bb57V8dXjpQ/i465b9A+cO9KF/5WSBj4Act8xbVcAg/2E4DCkuyCXF+OKugn3wI+gXAF02li6ZiOESl71+QZkncPGh5q9fZWYJlgnkJvoKDP2C",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "59ee1f1a-fac6-475c-8392-e086ea5fddf2",
            "fullname": "custom-59ee1f1a-fac6-475c-8392-e086ea5fddf2",
            "type": "custom",
            "name": "custom-59ee1f1a-fac6-475c-8392-e086ea5fddf2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a9a08c29-c754-4aac-ace0-44db6e0006c6",
                        "id": "RealAB",
                        "name": "RealAB",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "e6772df9-c303-4d02-afc4-fe8acbc2034c",
                            "expression": "select YorkRealAB.*, case when isnull(rates_eom.[rate]) then \r\n     case when YorkRealAB.[currency] = 'USD' then RealABDiffCurrency when YorkRealAB.[currency] = 'EUR' then 1.1 * YorkRealAB.[RealABDiffCurrency] when YorkRealAB.[currency] = 'GBP' then 1.3 * YorkRealAB.RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, case when isnull(rates_eom.[rate]) then \r\n     case when YorkRealAB.[currency] = 'USD' then RealPnLCurr when YorkRealAB.[currency] = 'EUR' then 1.1 * YorkRealAB.[RealPnLCurr] when YorkRealAB.[currency] = 'GBP' then 1.3 * YorkRealAB.RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, YorkRealAB.[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, case when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * YorkRealAB.[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when YorkRealAB.[currency] = 'USD' then 1 when YorkRealAB.[currency] = 'EUR' then 1.1 when YorkRealAB.[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [YorkRealAB]\r\nleft join rates_tp on YorkRealAB.[currency] = rates_tp.currency\r\nleft join rates_eom on YorkRealAB.[currency] = rates_eom.[currency] and YorkRealAB.[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect PrimeOTRealAB.*, case when isnull(rates_eom.[rate]) then \r\n     case when PrimeOTRealAB.[currency] = 'USD' then RealABDiffCurrency when PrimeOTRealAB.[currency] = 'EUR' then 1.1 * PrimeOTRealAB.[RealABDiffCurrency] when PrimeOTRealAB.[currency] = 'GBP' then 1.3 * PrimeOTRealAB.RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when PrimeOTRealAB.[currency] = 'USD' then RealPnLCurr when PrimeOTRealAB.[currency] = 'EUR' then 1.1 * PrimeOTRealAB.[RealPnLCurr] when PrimeOTRealAB.[currency] = 'GBP' then 1.3 * PrimeOTRealAB.RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\nPrimeOTRealAB.[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * PrimeOTRealAB.[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when PrimeOTRealAB.[currency] = 'USD' then 1 when PrimeOTRealAB.[currency] = 'EUR' then 1.1 when PrimeOTRealAB.[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [PrimeOTRealAB]\r\nleft join rates_tp on PrimeOTRealAB.[currency] = rates_tp.currency\r\nleft join rates_eom on PrimeOTRealAB.[currency] = rates_eom.[currency] and PrimeOTRealAB.[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect [IvyTrusts RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [IvyTrusts RealAB].[currency] = 'USD' then RealABDiffCurrency when [IvyTrusts RealAB].[currency] = 'EUR' then 1.1 * [IvyTrusts RealAB].[RealABDiffCurrency] when [IvyTrusts RealAB].[currency] = 'GBP' then 1.3 * [IvyTrusts RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [IvyTrusts RealAB].[currency] = 'USD' then RealPnLCurr when [IvyTrusts RealAB].[currency] = 'EUR' then 1.1 * [IvyTrusts RealAB].[RealPnLCurr] when [IvyTrusts RealAB].[currency] = 'GBP' then 1.3 * [IvyTrusts RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[IvyTrusts RealAB].RealABDiffCurrency * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [IvyTrusts RealAB].rate else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [IvyTrusts RealAB].[currency] = 'USD' then 1 when [IvyTrusts RealAB].[currency] = 'EUR' then 1.1 when [IvyTrusts RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [IvyTrusts RealAB]\r\nleft join rates_tp on [IvyTrusts RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [IvyTrusts RealAB].[currency] = rates_eom.[currency] and [IvyTrusts RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect [MarketCG RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [MarketCG RealAB].[currency] = 'USD' then RealABDiffCurrency when [MarketCG RealAB].[currency] = 'EUR' then 1.1 * [MarketCG RealAB].[RealABDiffCurrency] when [MarketCG RealAB].[currency] = 'GBP' then 1.3 * [MarketCG RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [MarketCG RealAB].[currency] = 'USD' then RealPnLCurr when [MarketCG RealAB].[currency] = 'EUR' then 1.1 * [MarketCG RealAB].[RealPnLCurr] when [MarketCG RealAB].[currency] = 'GBP' then 1.3 * [MarketCG RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[MarketCG RealAB].RealABDiffCurrency * rates_tp.[rate] RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [MarketCG RealAB].rate else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [MarketCG RealAB].[currency] = 'USD' then 1 when [MarketCG RealAB].[currency] = 'EUR' then 1.1 when [MarketCG RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [MarketCG RealAB]\r\nleft join rates_tp on [MarketCG RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [MarketCG RealAB].[currency] = rates_eom.[currency] and [MarketCG RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect FXVC_RealAB.*, case when isnull(rates_eom.[rate]) then \r\n     case when FXVC_RealAB.[currency] = 'USD' then RealABDiffCurrency when FXVC_RealAB.[currency] = 'EUR' then 1.1 * FXVC_RealAB.[RealABDiffCurrency] when FXVC_RealAB.[currency] = 'GBP' then 1.3 * FXVC_RealAB.RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when FXVC_RealAB.[currency] = 'USD' then RealPnLCurr when FXVC_RealAB.[currency] = 'EUR' then 1.1 * FXVC_RealAB.[RealPnLCurr] when FXVC_RealAB.[currency] = 'GBP' then 1.3 * FXVC_RealAB.RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\nFXVC_RealAB.[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * FXVC_RealAB.[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when FXVC_RealAB.[currency] = 'USD' then 1 when FXVC_RealAB.[currency] = 'EUR' then 1.1 when FXVC_RealAB.[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [FXVC_RealAB]\r\nleft join rates_tp on FXVC_RealAB.[currency] = rates_tp.currency\r\nleft join rates_eom on FXVC_RealAB.[currency] = rates_eom.[currency] and FXVC_RealAB.[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect [Wealth_Real_Ab].*, case when isnull(rates_eom.[rate]) then \r\n     case when Wealth_Real_Ab.[currency] = 'USD' then RealABDiffCurrency when Wealth_Real_Ab.[currency] = 'EUR' then 1.1 * Wealth_Real_Ab.[RealABDiffCurrency] when Wealth_Real_Ab.[currency] = 'GBP' then 1.3 * Wealth_Real_Ab.RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when Wealth_Real_Ab.[currency] = 'USD' then RealPnLCurr when Wealth_Real_Ab.[currency] = 'EUR' then 1.1 * Wealth_Real_Ab.[RealPnLCurr] when Wealth_Real_Ab.[currency] = 'GBP' then 1.3 * Wealth_Real_Ab.RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[Wealth_Real_Ab].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [Wealth_Real_Ab].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when Wealth_Real_Ab.[currency] = 'USD' then 1 when Wealth_Real_Ab.[currency] = 'EUR' then 1.1 when Wealth_Real_Ab.[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [Wealth_Real_Ab]\r\nleft join rates_tp on [Wealth_Real_Ab].[currency] = rates_tp.currency\r\nleft join rates_eom on Wealth_Real_Ab.[currency] = rates_eom.[currency] and Wealth_Real_Ab.[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect [Arrow_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when Arrow_RealAB.[currency] = 'USD' then RealABDiffCurrency when Arrow_RealAB.[currency] = 'EUR' then 1.1 * Arrow_RealAB.[RealABDiffCurrency] when Arrow_RealAB.[currency] = 'GBP' then 1.3 * Arrow_RealAB.RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when Arrow_RealAB.[currency] = 'USD' then RealPnLCurr when Arrow_RealAB.[currency] = 'EUR' then 1.1 * Arrow_RealAB.[RealPnLCurr] when Arrow_RealAB.[currency] = 'GBP' then 1.3 * Arrow_RealAB.RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[Arrow_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [Arrow_RealAB].[rate] else 0 end as RealPnlUSDDuplicate ,\r\ncase when isnull(rates_eom.[rate]) then case when Arrow_RealAB.[currency] = 'USD' then 1 when Arrow_RealAB.[currency] = 'EUR' then 1.1 when Arrow_RealAB.[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [Arrow_RealAB]\r\nleft join rates_tp on [Arrow_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on Arrow_RealAB.[currency] = rates_eom.[currency] and Arrow_RealAB.[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect [AussieTrust_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when AussieTrust_RealAB.[currency] = 'USD' then RealABDiffCurrency when AussieTrust_RealAB.[currency] = 'EUR' then 1.1 * AussieTrust_RealAB.[RealABDiffCurrency] when AussieTrust_RealAB.[currency] = 'GBP' then 1.3 * AussieTrust_RealAB.RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when AussieTrust_RealAB.[currency] = 'USD' then RealPnLCurr when AussieTrust_RealAB.[currency] = 'EUR' then 1.1 * AussieTrust_RealAB.[RealPnLCurr] when AussieTrust_RealAB.[currency] = 'GBP' then 1.3 * AussieTrust_RealAB.RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[AussieTrust_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [AussieTrust_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when AussieTrust_RealAB.[currency] = 'USD' then 1 when AussieTrust_RealAB.[currency] = 'EUR' then 1.1 when AussieTrust_RealAB.[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [AussieTrust_RealAB]\r\nleft join rates_tp on [AussieTrust_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on AussieTrust_RealAB.[currency] = rates_eom.[currency] and AussieTrust_RealAB.[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect [InfinityCapitalg_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when InfinityCapitalg_RealAB.[currency] = 'USD' then RealABDiffCurrency when InfinityCapitalg_RealAB.[currency] = 'EUR' then 1.1 * InfinityCapitalg_RealAB.[RealABDiffCurrency] when InfinityCapitalg_RealAB.[currency] = 'GBP' then 1.3 * InfinityCapitalg_RealAB.RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when InfinityCapitalg_RealAB.[currency] = 'USD' then RealPnLCurr when InfinityCapitalg_RealAB.[currency] = 'EUR' then 1.1 * InfinityCapitalg_RealAB.[RealPnLCurr] when InfinityCapitalg_RealAB.[currency] = 'GBP' then 1.3 * InfinityCapitalg_RealAB.RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[InfinityCapitalg_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [InfinityCapitalg_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when InfinityCapitalg_RealAB.[currency] = 'USD' then 1 when InfinityCapitalg_RealAB.[currency] = 'EUR' then 1.1 when InfinityCapitalg_RealAB.[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [InfinityCapitalg_RealAB]\r\nleft join rates_tp on [InfinityCapitalg_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on InfinityCapitalg_RealAB.[currency] = rates_eom.[currency] and InfinityCapitalg_RealAB.[YearMonth] = rates_eom.[year-month]\r\nunion all\r\nselect [365TradingFX_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [365TradingFX_RealAB].[currency] = 'USD' then RealABDiffCurrency when [365TradingFX_RealAB].[currency] = 'EUR' then 1.1 * [365TradingFX_RealAB].[RealABDiffCurrency] when [365TradingFX_RealAB].[currency] = 'GBP' then 1.3 * [365TradingFX_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [365TradingFX_RealAB].[currency] = 'USD' then RealPnLCurr when [365TradingFX_RealAB].[currency] = 'EUR' then 1.1 * [365TradingFX_RealAB].[RealPnLCurr] when [365TradingFX_RealAB].[currency] = 'GBP' then 1.3 * [365TradingFX_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[365TradingFX_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [365TradingFX_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [365TradingFX_RealAB].[currency] = 'USD' then 1 when [365TradingFX_RealAB].[currency] = 'EUR' then 1.1 when [365TradingFX_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [365TradingFX_RealAB]\r\nleft join rates_tp on [365TradingFX_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [365TradingFX_RealAB].[currency] = rates_eom.[currency] and [365TradingFX_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [TradeTheBit_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [TradeTheBit_RealAB].[currency] = 'USD' then RealABDiffCurrency when [TradeTheBit_RealAB].[currency] = 'EUR' then 1.1 * [TradeTheBit_RealAB].[RealABDiffCurrency] when [TradeTheBit_RealAB].[currency] = 'GBP' then 1.3 * [TradeTheBit_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [TradeTheBit_RealAB].[currency] = 'USD' then RealPnLCurr when [TradeTheBit_RealAB].[currency] = 'EUR' then 1.1 * [TradeTheBit_RealAB].[RealPnLCurr] when [TradeTheBit_RealAB].[currency] = 'GBP' then 1.3 * [TradeTheBit_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[TradeTheBit_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [TradeTheBit_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [TradeTheBit_RealAB].[currency] = 'USD' then 1 when [TradeTheBit_RealAB].[currency] = 'EUR' then 1.1 when [TradeTheBit_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [TradeTheBit_RealAB]\r\nleft join rates_tp on [TradeTheBit_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [TradeTheBit_RealAB].[currency] = rates_eom.[currency] and [TradeTheBit_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [NostraCapital_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [NostraCapital_RealAB].[currency] = 'USD' then RealABDiffCurrency when [NostraCapital_RealAB].[currency] = 'EUR' then 1.1 * [NostraCapital_RealAB].[RealABDiffCurrency] when [NostraCapital_RealAB].[currency] = 'GBP' then 1.3 * [NostraCapital_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [NostraCapital_RealAB].[currency] = 'USD' then RealPnLCurr when [NostraCapital_RealAB].[currency] = 'EUR' then 1.1 * [NostraCapital_RealAB].[RealPnLCurr] when [NostraCapital_RealAB].[currency] = 'GBP' then 1.3 * [NostraCapital_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[NostraCapital_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [NostraCapital_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [NostraCapital_RealAB].[currency] = 'USD' then 1 when [NostraCapital_RealAB].[currency] = 'EUR' then 1.1 when [NostraCapital_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [NostraCapital_RealAB]\r\nleft join rates_tp on [NostraCapital_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [NostraCapital_RealAB].[currency] = rates_eom.[currency] and [NostraCapital_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [TheBPCA_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [TheBPCA_RealAB].[currency] = 'USD' then RealABDiffCurrency when [TheBPCA_RealAB].[currency] = 'EUR' then 1.1 * [TheBPCA_RealAB].[RealABDiffCurrency] when [TheBPCA_RealAB].[currency] = 'GBP' then 1.3 * [TheBPCA_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [TheBPCA_RealAB].[currency] = 'USD' then RealPnLCurr when [TheBPCA_RealAB].[currency] = 'EUR' then 1.1 * [TheBPCA_RealAB].[RealPnLCurr] when [TheBPCA_RealAB].[currency] = 'GBP' then 1.3 * [TheBPCA_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[TheBPCA_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [TheBPCA_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [TheBPCA_RealAB].[currency] = 'USD' then 1 when [TheBPCA_RealAB].[currency] = 'EUR' then 1.1 when [TheBPCA_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [TheBPCA_RealAB]\r\nleft join rates_tp on [TheBPCA_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [TheBPCA_RealAB].[currency] = rates_eom.[currency] and [TheBPCA_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [GeniusIG_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [GeniusIG_RealAB].[currency] = 'USD' then RealABDiffCurrency when [GeniusIG_RealAB].[currency] = 'EUR' then 1.1 * [GeniusIG_RealAB].[RealABDiffCurrency] when [GeniusIG_RealAB].[currency] = 'GBP' then 1.3 * [GeniusIG_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [GeniusIG_RealAB].[currency] = 'USD' then RealPnLCurr when [GeniusIG_RealAB].[currency] = 'EUR' then 1.1 * [GeniusIG_RealAB].[RealPnLCurr] when [GeniusIG_RealAB].[currency] = 'GBP' then 1.3 * [GeniusIG_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[GeniusIG_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [GeniusIG_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [GeniusIG_RealAB].[currency] = 'USD' then 1 when [GeniusIG_RealAB].[currency] = 'EUR' then 1.1 when [GeniusIG_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [GeniusIG_RealAB]\r\nleft join rates_tp on [GeniusIG_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [GeniusIG_RealAB].[currency] = rates_eom.[currency] and [GeniusIG_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [Chelsea_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [Chelsea_RealAB].[currency] = 'USD' then RealABDiffCurrency when [Chelsea_RealAB].[currency] = 'EUR' then 1.1 * [Chelsea_RealAB].[RealABDiffCurrency] when [Chelsea_RealAB].[currency] = 'GBP' then 1.3 * [Chelsea_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [Chelsea_RealAB].[currency] = 'USD' then RealPnLCurr when [Chelsea_RealAB].[currency] = 'EUR' then 1.1 * [Chelsea_RealAB].[RealPnLCurr] when [Chelsea_RealAB].[currency] = 'GBP' then 1.3 * [Chelsea_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[Chelsea_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [Chelsea_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [Chelsea_RealAB].[currency] = 'USD' then 1 when [Chelsea_RealAB].[currency] = 'EUR' then 1.1 when [Chelsea_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [Chelsea_RealAB]\r\nleft join rates_tp on [Chelsea_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [Chelsea_RealAB].[currency] = rates_eom.[currency] and [Chelsea_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [Ashford_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [Ashford_RealAB].[currency] = 'USD' then RealABDiffCurrency when [Ashford_RealAB].[currency] = 'EUR' then 1.1 * [Ashford_RealAB].[RealABDiffCurrency] when [Ashford_RealAB].[currency] = 'GBP' then 1.3 * [Ashford_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [Ashford_RealAB].[currency] = 'USD' then RealPnLCurr when [Ashford_RealAB].[currency] = 'EUR' then 1.1 * [Ashford_RealAB].[RealPnLCurr] when [Ashford_RealAB].[currency] = 'GBP' then 1.3 * [Ashford_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[Ashford_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [Ashford_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [Ashford_RealAB].[currency] = 'USD' then 1 when [Ashford_RealAB].[currency] = 'EUR' then 1.1 when [Ashford_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [Ashford_RealAB]\r\nleft join rates_tp on [Ashford_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [Ashford_RealAB].[currency] = rates_eom.[currency] and [Ashford_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [wingroup_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [wingroup_RealAB].[currency] = 'USD' then RealABDiffCurrency when [wingroup_RealAB].[currency] = 'EUR' then 1.1 * [wingroup_RealAB].[RealABDiffCurrency] when [wingroup_RealAB].[currency] = 'GBP' then 1.3 * [wingroup_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [wingroup_RealAB].[currency] = 'USD' then RealPnLCurr when [wingroup_RealAB].[currency] = 'EUR' then 1.1 * [wingroup_RealAB].[RealPnLCurr] when [wingroup_RealAB].[currency] = 'GBP' then 1.3 * [wingroup_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[wingroup_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [wingroup_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [wingroup_RealAB].[currency] = 'USD' then 1 when [wingroup_RealAB].[currency] = 'EUR' then 1.1 when [wingroup_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [wingroup_RealAB]\r\nleft join rates_tp on [wingroup_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [wingroup_RealAB].[currency] = rates_eom.[currency] and [wingroup_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [BendigoCoins_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [BendigoCoins_RealAB].[currency] = 'USD' then RealABDiffCurrency when [BendigoCoins_RealAB].[currency] = 'EUR' then 1.1 * [BendigoCoins_RealAB].[RealABDiffCurrency] when [BendigoCoins_RealAB].[currency] = 'GBP' then 1.3 * [BendigoCoins_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [BendigoCoins_RealAB].[currency] = 'USD' then RealPnLCurr when [BendigoCoins_RealAB].[currency] = 'EUR' then 1.1 * [BendigoCoins_RealAB].[RealPnLCurr] when [BendigoCoins_RealAB].[currency] = 'GBP' then 1.3 * [BendigoCoins_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[BendigoCoins_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [BendigoCoins_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [BendigoCoins_RealAB].[currency] = 'USD' then 1 when [BendigoCoins_RealAB].[currency] = 'EUR' then 1.1 when [BendigoCoins_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [BendigoCoins_RealAB]\r\nleft join rates_tp on [BendigoCoins_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [BendigoCoins_RealAB].[currency] = rates_eom.[currency] and [BendigoCoins_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [BitfinityFX_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [BitfinityFX_RealAB].[currency] = 'USD' then RealABDiffCurrency when [BitfinityFX_RealAB].[currency] = 'EUR' then 1.1 * [BitfinityFX_RealAB].[RealABDiffCurrency] when [BitfinityFX_RealAB].[currency] = 'GBP' then 1.3 * [BitfinityFX_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [BitfinityFX_RealAB].[currency] = 'USD' then RealPnLCurr when [BitfinityFX_RealAB].[currency] = 'EUR' then 1.1 * [BitfinityFX_RealAB].[RealPnLCurr] when [BitfinityFX_RealAB].[currency] = 'GBP' then 1.3 * [BitfinityFX_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[BitfinityFX_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [BitfinityFX_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [BitfinityFX_RealAB].[currency] = 'USD' then 1 when [BitfinityFX_RealAB].[currency] = 'EUR' then 1.1 when [BitfinityFX_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [BitfinityFX_RealAB]\r\nleft join rates_tp on [BitfinityFX_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [BitfinityFX_RealAB].[currency] = rates_eom.[currency] and [BitfinityFX_RealAB].[YearMonth] = rates_eom.[year-month]\r\nunion all \r\nselect [BigBitMarket_RealAB].*, case when isnull(rates_eom.[rate]) then \r\n     case when [BigBitMarket_RealAB].[currency] = 'USD' then RealABDiffCurrency when [BigBitMarket_RealAB].[currency] = 'EUR' then 1.1 * [BigBitMarket_RealAB].[RealABDiffCurrency] when [BigBitMarket_RealAB].[currency] = 'GBP' then 1.3 * [BigBitMarket_RealAB].RealABDiffCurrency end\r\n     else rates_eom.[rate] * RealABDiffCurrency end as RealABUSDFix, \r\ncase when isnull(rates_eom.[rate]) then \r\n     case when [BigBitMarket_RealAB].[currency] = 'USD' then RealPnLCurr when [BigBitMarket_RealAB].[currency] = 'EUR' then 1.1 * [BigBitMarket_RealAB].[RealPnLCurr] when [BigBitMarket_RealAB].[currency] = 'GBP' then 1.3 * [BigBitMarket_RealAB].RealPnLCurr end\r\n     else rates_eom.[rate] * RealPnLCurr end as RealPnLUSDFix, \r\n[BigBitMarket_RealAB].[RealABDiffCurrency] * rates_tp.[rate] as RealABUSDLifetime,\r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then RealPnLCurr + pnl_curr else 0 end as RealPnlCurrDuplicate, \r\ncase when duplicated_pnl_curr <> 0 and RealPnLCurr + pnl_curr > 0 then (RealPnLCurr + pnl_curr) * [BigBitMarket_RealAB].[rate] else 0 end as RealPnlUSDDuplicate,\r\ncase when isnull(rates_eom.[rate]) then case when [BigBitMarket_RealAB].[currency] = 'USD' then 1 when [BigBitMarket_RealAB].[currency] = 'EUR' then 1.1 when [BigBitMarket_RealAB].[currency] = 'GBP' then 1.3 END else rates_eom.[rate] end as rate_fixed\r\nfrom [BigBitMarket_RealAB]\r\nleft join rates_tp on [BigBitMarket_RealAB].[currency] = rates_tp.currency\r\nleft join rates_eom on [BigBitMarket_RealAB].[currency] = rates_eom.[currency] and [BigBitMarket_RealAB].[YearMonth] = rates_eom.[year-month]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "62dc4dcb-d72e-4e34-b7cf-049233bdcdd8",
                                "id": "dc28152f-e677-456a-9652-88ae983a4c2f",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "395ced02-0d9c-4ba7-a8b4-9921efc2363c",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c64b87f9-7512-438f-a94c-54eaff038b4a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9932987c-2449-4aa9-828c-6afed87d02c6",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa5a6ea6-004d-48ce-bb9a-848a1a961648",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71be843b-0c48-47a5-8373-6b19b8e47377",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6ac5632-ba5c-4624-b1e0-f35d5fd5614c",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30a56705-3f84-466f-b459-0a6a86e9ca86",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eee88e36-881f-42e5-972f-226a5e80050d",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "774782cb-712d-4263-a6a3-6edbf45e9124",
                                "id": "date",
                                "name": "date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71042f42-259a-433f-93db-b8f9ae7ad011",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fb1fa4a-4f41-48c4-8b35-050ab2cd8ded",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f046a89f-3b5f-415f-ab31-c31bf3b8a477",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bba887c4-8db8-4cdd-9946-7c4513b4faa8",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "52875265-82b4-4925-bb1a-07b2cf07136d",
                                "id": "c192b6e4-fc37-4f2c-a552-3af60724109f",
                                "name": "tr_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "914ec688-4893-4286-854f-41724dbe29d3",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88652c95-36be-40c8-b5b0-c628e293470f",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c4af75be-38ce-4a37-b6df-22856a43b334",
                                "id": "6f0c04e9-f269-4a75-9763-e270da223edd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "077d97ca-521c-4d1d-bac4-25b00d5cd116",
                                "id": "767f28e6-fe93-4e3c-a871-97239d9e25f6",
                                "name": "user_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "022b6178-3956-4904-a294-0a1c93e875f5",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06615cd7-ea21-4c2f-b133-f22da2446016",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6dc116ea-c96a-4fa0-91f1-3d098dd01c14",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ba74c89-9380-4b6c-8c89-3c53db3254a7",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cbdae4e2-d7df-41dc-893b-b432a1f66426",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1aefdf3a-5fbc-4210-85f8-af63b285382f",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0bdd8632-a684-4bd2-9fb8-569d894c4399",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4876008e-3090-42e2-958b-f229cde40e40",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2204ed09-3b12-457a-8a6f-c3116f8e31f2",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f388fe0-a95f-46a7-b6b5-536808c4b853",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4821a975-fe71-4855-a989-7e5698484b44",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c7f075a1-e215-438d-9d9d-eddc436d8c97",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "03b0ff3a-78c9-40ad-a1e7-24f8c93649df",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ebc2bd26-55ad-4772-8ea7-daef87dc7d1b",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "06a38311-37ca-4a2d-a8ef-5839427e60fe",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fd31a796-5e0d-46ec-b495-cc225166e6aa",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d43186fc-129c-472a-9ee4-5d18bad420d3",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0fb6c320-cbd9-49f3-b147-609a44b8de96",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8506b26c-56c5-4f39-ae44-329a6e4a52e5",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ca2fd196-e4be-47e4-aa66-2632c44cf4f6",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3855a981-fa85-4118-b767-2c56081adb2b",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b713b1bd-a466-4a29-9e24-d1c98747a0ac",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b6c6ed5-6171-462a-a767-b68cc6e218d4",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "364392f3-7aec-4561-85c7-d6fa3a8880b6",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "09df0509-1e1b-4267-9d23-1eebe117bc30",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8a46c627-6838-438d-839d-b29ec27d9e68",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aaed2a8b-bc81-4f40-8e14-d0b4d741b866",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee4f572a-1c46-4944-bacb-e48432b849e3",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e872a317-960e-4efe-9ec1-4120f10fbf36",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "23018c87-1764-415a-992f-358304e13aa3",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "94b21dd6-d5fa-4f9c-bb57-a097f7793eac",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "64471354-28a4-46df-8927-c20cbd5ed5c4",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "005fec94-16da-46a9-97d6-6f32aa480609",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "898298ca-8240-42b6-accd-9231a50f9e74",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eb5b12c3-626c-4204-8b1e-4a98cd347cfa",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "008cca7d-357d-48bd-b854-c4d4c2df2f99",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "36f37816-f504-489a-8158-c764afc220ca",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ccd1bdee-3b3a-4eb4-a821-e6e8442657b8",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c98a9b4c-0dd8-42d4-8957-1e89b0f8213b",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ddbd3a18-fcaa-482c-9032-00b738e80fab",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8e3d3fc6-d376-4432-ac02-68598d99345e",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "58db1877-957b-4b7f-9995-47e6c16d8086",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3f8a9e19-4144-4376-bf71-83e380ccfcf2",
                                "id": "3b50c306-9636-459c-928f-7ce6944e59b4",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d5daa1c-f915-41b0-9801-0adc247ee654",
                                "id": "02a3c91f-b978-4831-9e39-14f337fadc5b",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73990549-2f05-4499-b82f-5ab52a244f86",
                                "id": "a0a838ce-14b8-4c64-badb-3991f00e3334",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37f9d6f5-0536-42eb-adc4-42d42fd26f62",
                                "id": "60f61c65-4a9c-478c-ae63-57baa30f614e",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8baf2084-ea12-401a-91ba-544cb14ce57e",
                                "id": "be008011-f3c8-4d28-842a-d7c74e34c0c9",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b721d81-1ee0-4117-ac62-f52f491329f1",
                                "id": "f7ad6a35-2998-446f-b854-a8e5952e9357",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "970e3e26-c57b-4e98-9546-c4b295565562",
                                "id": "fefe4948-f604-4dba-9eae-50bd6bc7d52c",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "028a76ab-4ede-4950-9832-83210b053d3c",
                                "id": "fb454b9d-5359-4774-a679-7ec7ef45c2b9",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bfb2bcd0-a802-45a7-9397-c519ff7a0157",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b3638e7-4196-45a0-b85c-0e7aa93dd1f9",
                                "id": "bab83f39-fa28-4890-b556-e655c42fb46e",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e53f0a38-0799-463a-a29b-adeb6e269123",
                                "id": "09eaa4c6-47d5-454a-b381-f022c119dfc9",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5125098-aac6-4bff-be14-9d7c2b200af3",
                                "id": "308f3c97-52c9-49ec-b97c-2cd22b70f1cf",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6dc5ae4e-3688-4686-9cb1-1206f7f38d2a",
                                "id": "0015b173-6eae-4ed7-b5b1-87f6d349ad05",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "133443ae-2edd-40ec-9355-4256fe58b4c8",
                                "id": "38b9d86e-4a52-4c69-9c9e-b4dcd19339a3",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98748ecc-065c-4df5-a321-396a33b9c9cb",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c04e4bcb-239f-4364-8cdd-c0878a3a75e8",
                                "id": "756147ee-abdb-4779-ad76-25742227d154",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3bc11ff1-33c3-4d6f-a968-0911db43478d",
                                "id": "078a3660-c85b-447f-976b-ddbe63259017",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3677409-0e85-463e-a312-e7e09db2f17d",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "004291d0-92d5-43da-bc39-ebad1d0f6dad",
                                "id": "RealABUSDFix",
                                "name": "RealABUSDFix",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "60390283-acab-46bc-a79e-1c684259ddf7",
                                "id": "RealPnLUSDFix",
                                "name": "RealPnLUSDFix",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e2d194f1-6901-4c9e-b964-38dd80aaf888",
                                "id": "RealABUSDLifetime",
                                "name": "RealABUSDLifetime",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dee65c89-bcfa-4b1b-845d-4b99bb3fd163",
                                "id": "RealPnlCurrDuplicate",
                                "name": "RealPnlCurrDuplicate",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71d78469-56b9-4f62-82fe-b508dc528472",
                                "id": "RealPnlUSDDuplicate",
                                "name": "RealPnlUSDDuplicate",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ffd7ed44-e85a-4551-9a14-9830c0e62438",
                                "id": "rate_fixed",
                                "name": "rate_fixed",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "e3f25d16-fe51-4544-941e-e3c2dbf984d4",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "5c36238b-2d11-4348-a9c4-a107a54f7783",
            "fullname": "MySql:d0c03a8e-7b77-428b-a381-fe8d6ab86c80",
            "type": "extract",
            "name": "d0c03a8e-7b77-428b-a381-fe8d6ab86c80",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ae2bf708-811d-4cc2-a2bf-97dc49e8034b",
                        "id": "tq_ycPL77K8U",
                        "name": "Arrow_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "51773487-d4d4-4b67-b5ce-0d4c0bec2f19",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a5ae489f-48ec-4cc3-9587-906c7cc843ea",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "017858cc-6a39-45c0-a989-c3215778df7e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e98f473-b966-46f0-867c-09ebe9be40a6",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c9f489e-ac0d-4dd2-b5c5-aa04b0236584",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bd03da6-a2a2-4f08-94ce-d757ecd1a86e",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b630739-403c-47a6-9896-643e406aacde",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "819f2fc0-f2c9-4b5f-a9e3-7d2a92d5a5e4",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4cfc5fd2-2e53-452f-9e37-11394715d085",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cff34a87-1ae4-43f9-b514-e58c7470d356",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "901eef84-a2da-40c7-970d-0b5bda30ed47",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6865b0e2-cb88-408e-b087-305faad7f0b0",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "68b4875a-36e0-42b1-a07c-657c568b50ac",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b7b8fccb-5a96-4f0d-9524-9e74fdc4340b",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "33e15d66-1923-475b-8baf-8796ed6c8a6c",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e25eee61-4151-4053-85d7-982460414f7a",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "abf32346-86de-4c0c-898e-816114c4fe83",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e280b56-8499-4688-86c3-ff3509dcec92",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5816d1fc-c5d0-4554-b834-34f953f25fb7",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b83699c4-8a21-4a25-bda6-f690af9dc5dd",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8212ecc3-3611-41ce-a437-6e405cd3958f",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5707ecda-088e-497e-b26e-5350d30b8256",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee577f07-d22e-4231-bacc-bedcfe5c8e84",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "599bc72f-32cb-4b11-9f12-5ed7bd440ed0",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c8fbe976-da94-4fb5-97d1-bf2e00cb8693",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3407764-5f46-470b-a13c-05c11faa8892",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3227aed1-9278-44e1-b43a-8b757e32a9d0",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7cb3b200-5d0d-4464-82bf-89a636658665",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a0f860b9-72bb-41d9-ad0b-d5dba845c022",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5ca6d09a-3a92-489b-952e-65a8c60c60ec",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8698efdd-f92f-43f0-8949-5efd3645ea1d",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "452b410f-6dc7-4bd0-8ebd-ff37a084ca4c",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "59beffbb-ff3c-45e6-82c9-54a7d1838b2b",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b6e3981f-d8f0-451b-8297-5971b840bbc2",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "406158f2-fecd-4176-a796-38c472c57c73",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "501c83f3-da0f-46fa-9bc4-3191037dc7a1",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0351c71f-2fa8-4c80-86a6-67876b054984",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "00c51e5f-e4f4-43ef-8eb2-ae57bf3f1b90",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6c5ad23e-5687-4f9a-ba8d-c1d0ee4475b2",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "97495762-b803-4b58-98c1-4097c76a6fe4",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7aff837d-eaaa-4e09-a764-eed9270c829f",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ab01d051-d46f-4e64-afa5-e7b13f27d535",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b10604d4-1ffb-4dc2-8808-f8647aa1179a",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e258a720-7cc3-4365-8696-c9fb0c12a0a6",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "40302fe9-930b-4fcc-b889-6a22879124fd",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "983c5246-7d12-4899-ac44-29b274ffe641",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "343d75e8-05ee-415b-b609-42a1e0bd6253",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b298a2cd-6f06-4097-804e-bcd37c8486e3",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "74096fb5-e0cb-494e-955e-d2eef7e96381",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "183f696b-2353-4cfc-b616-5599cc170890",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1d886176-abbe-4025-ac08-2d03ca02ccec",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75c51364-88e1-41e8-9ae9-9840beda7a18",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83d43965-7dd8-4cf3-bbde-0a42cd472423",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "78eee27b-6bbe-4dd0-9c60-a0e347001286",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5ecc3acc-6e1f-497b-93e7-0b1655fee9e7",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d9d001c-0941-4795-a9e7-51f19285ad09",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a63540df-ddd3-453a-bd08-6a9b5a2bcd35",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d306ab34-b2e0-447c-bea3-765e83b202a6",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da78d620-bf56-414c-a559-f26249e3c565",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1549086e-71fe-4b1c-af97-affd659fea78",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "166e9703-6ded-4699-af1b-833efbd7bbc6",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5d806665-1992-428b-9f14-8ecc01dfa1b3",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d6016e60-5efe-4163-b069-fa7ea1a2f579",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "16f4c195-6869-4c4a-98b8-273ad8cfa4bc",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e876a061-f78b-4d3b-83dc-abbcbc5d10b2",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c0f9936d-ca42-4a9e-95bc-0e6e7e49f07f",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4d615040-11a9-41da-bca2-5d90e93605d2",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e388ab7b-63d5-4304-8661-e7bb04636429",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a45df07d-d69e-49ea-a585-bf2a0b6891d6",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ffdf00c7-1516-4fe0-891d-337615e15d59",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aede00ca-f13a-4066-ab27-9ae27d3e9c95",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4c75027a-9790-441b-8b6c-66490fd6b830",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "46a0c1b2-4507-4e1c-b745-e322ca81124e",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9806a768-9ef2-42e1-a250-2b921de61ad7",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "403b1775-ad54-4b0c-85e1-c54c77a73d09",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1a3dff2-1432-4340-a86e-475847bbf8f4",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ad7fd350-209a-4775-96b4-92aa7c9e7cd9",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5111bc2c-a1f1-42d3-acd6-8332f2bec28e",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b258b36-bb3f-4c13-9717-2574cf4ce842",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "68a9279a-d85d-4e31-b2c8-24800a5cf8b6",
                        "configOptions": {
                            "importQuery": "SELECT\n\taggCustomer.id,\n\taggCustomer.site_name as site_name,\n\taggCustomer.site_id as site_id,\n\tconcat(aggCustomer.site_id, '10010', aggCustomer.id) as customer_key,\n\taggCustomer.customer_fullname,\n\tco.name,\n\taggCustomer.currency,\n\taggCustomer.created_at,\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\n\taggCustomer.date,\n\taggCustomer.YearMonth,\n\tcase\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'GBP' then 1.3\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'EUR' then 1.1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'USD' then 1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\n\tend as rate,\n\tMaxDep.LastDepDate,\n\tMaxInv.LastTimeInvestment,\n\taggCustomer.tr_id,\n\taggCustomer.origin_type,\n\tMinDep.FTDDate,\n\tcase\n\t\twhen FTD.FTDind is null then 0\n\t\telse 1\n\tend as FTDInd,\n\taggCustomer.user_id,\n\tconcat(aggCustomer.site_id, '10010', COALESCE(aggCustomer.user_id, 0)) as employee_key,\n\taggCustomer.deposit_curr,\n\taggCustomer.deposit_usd,\n\taggCustomer.cashback_curr,\n\taggCustomer.cashback_usd,\n\taggCustomer.withdrawal_curr,\n\taggCustomer.withdrawal_usd,\n\taggCustomer.withdrawal_curr_new,\n\taggCustomer.withdrawal_usd_new,\n\taggCustomer.cashback_withdrawal_curr,\n\taggCustomer.cashback_withdrawal_usd,\n\taggCustomer.withdrawal_fee_curr,\n\taggCustomer.withdrawal_fee_usd,\n\taggCustomer.chb_curr,\n\taggCustomer.chb_usd,\n\taggCustomer.inactivity_fee_curr,\n\taggCustomer.inactivity_fee_usd,\n\taggCustomer.overnight_fee_curr,\n\taggCustomer.overnight_fee_usd,\n\taggCustomer.fees_curr,\n\taggCustomer.fees_usd,\n\taggCustomer.pnl_curr,\n\taggCustomer.pnl_usd,\n\taggCustomer.duplicated_pnl_curr,\n\taggCustomer.duplicated_pnl_usd,\n\taggCustomer.swap_curr,\n\taggCustomer.swap_usd,\n\taggCustomer.contract_usd,\n\taggCustomer.rbonus_curr,\n\taggCustomer.rbonus_usd,\n\taggCustomer.cancelled_bonus_curr,\n\taggCustomer.cancelled_bonus_usd,\n\taggCustomer.pending_bonus_curr,\n\taggCustomer.pending_bonus_usd,\n\taggCustomer.fixed_balance,\n\taggCustomer.fixed_balance_usd,\n\taggCustomer.negative_balance_fix_curr,\n\taggCustomer.negative_balance_fix_usd,\n\taggCustomer.refund_curr,\n\taggCustomer.refund_usd,\n\taggCustomer.education_deposit_curr,\n\taggCustomer.education_deposit_usd,\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\n\taggCustomer.balance_after_curr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\n\tb.balance as CurrencyBalance\nfrom\n\t(\n\tselect\n\t\tt.*,\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\n\t\t\telse @netdepositcurracc := @netdepositcurr\n\t\tend as NetDepCurrAcc,\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\n\t\t\telse @netdepositusdacc := @netdepositusd\n\t\tend as NetDepUsdAcc,\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastab < 0\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\t\telse @RealABAccHelp := @RealAB\n\t\tend as RealABAccHelp,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastabusd < 0\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\n\t\tend as RealABAccHelpUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\t\telse @realreal := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\n\t\t\telse @realrealneg := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\telse @realrealusd := @RealABUsd\n\t\tend as RealAccountBalanceAccumulatedUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\t\telse @RealABUsd\n\t\tend as RealABDiffUsd,\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\n\t\t\telse @realpnlcurr := @realpnlcurracc\n\t\tend as RealPnLCurr,\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\n\t\t\telse @realpnlusd := @realpnlusdacc\n\t\tend as RealPnLUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\n\t\t\tend as education_deposit_total,\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\n\t\t\telse @eligible end as EligibleDiffCurrency,\n\t\t@lastreal := @realreal,\n\t\t@lastrealusd := @realrealusd,\n\t\t@lastrealneg := @realrealneg,\n\t\t@lastab := @RealABAccHelp,\n\t\t@lastabusd := @RealABAccHelpUsd,\n\t\t@lastId := t.id,\n\t\t@lastrealpnlcurr := @realpnlcurracc,\n\t\t@lastrealpnlusd := @realpnlusdacc,\n\t\t@lasteligible:= @eligible\n\tfrom\n\t\t(\n\t\tselect\n\t\t\tbrand.name as site_name,\n\t\t\tcast(brand.id + 1000 as char) as site_id,\n\t\t\tb.id,\n\t\t\ta.id as tr_id,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\n\t\t\t\telse a.created_at\n\t\t\tend as created_at,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\n\t\t\t\telse date(a.created_at)\n\t\t\tend as 'date',\n\t\t\tb.user_id,\n\t\t\td.code as currency,\n\t\t\ta.origin_type,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend as YearMonth,\n\t\t\tcase\n\t\t\t\twhen d.code = 'USD' then rates.USD\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\n\t\t\tend as rate,\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\n\t\t\ta.balance_after as balance_after_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\n\t\t\t0) as deposit_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\n\t\t\t0) as deposit_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\n\t\t\t0) as cashback_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\n\t\t\t0) as cashback_usd,\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\n\t\t\t0) as withdrawal_curr_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\n\t\t\t0) as withdrawal_usd_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_usd,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) as fees_curr,\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) as fees_usd,\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\n\t\tfrom\n\t\t\ttransaction_record a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount,\n\t\t\t\ta.realized_at\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 1) rbonus on\n\t\t\trbonus.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 0\n\t\t\t\tand a.status = 'approved') pbonus on\n\t\t\tpbonus.id = a.id\n\t\tinner join trader b on\n\t\t\ta.trader_account_id = b.default_account_id\n\t\tinner join brand on\n\t\t\tb.brand_id = brand.id\n\t\tinner join trader_account c on\n\t\t\tb.id = c.trader_id\n\t\tinner join currency d on\n\t\t\tc.currency_id = d.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,32,65,73,107,115)\n\t\t\t\tand coalesce(d.name,\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\n\t\t\twithdrawals.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,32,65,73,107,115)\n\t\t\t\tor coalesce(d.name,\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\n\t\t\twithdrawals_cashback.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,32,65,73,107,115)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tand COALESCE(b.psp_reference_id,\n\t\t\t\t'') <> 'CH SR Cashback'\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\n\t\t\tdeposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tb.status = 'completed'\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\n\t\t\teducation_deposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,32,65,73,107,115)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tor COALESCE(b.psp_reference_id,\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\n\t\t\tcashbacks.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\n\t\t\twithdrawal_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 8\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\n\t\t\tovernight_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\n\t\t\tinactivity_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tswap as swaps_curr,\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\n\t\t\tfrom\n\t\t\t\ttrader_account_position a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id) swaps on\n\t\t\ta.id = swaps.ftr_id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t1.1448 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3108 as GBP,\n\t\t\t\t'2019-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1376 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3263 as GBP,\n\t\t\t\t'2019-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1224 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3021 as GBP,\n\t\t\t\t'2019-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1214 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3038 as GBP,\n\t\t\t\t'2019-04' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1197 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2637 as GBP,\n\t\t\t\t'2019-05' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.136 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2691 as GBP,\n\t\t\t\t'2019-06' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1071 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2152 as GBP,\n\t\t\t\t'2019-07' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1009 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2157 as GBP,\n\t\t\t\t'2019-08' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0899 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2287 as GBP,\n\t\t\t\t'2019-09' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1157 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2937 as GBP,\n\t\t\t\t'2019-10' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1019 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2928 as GBP,\n\t\t\t\t'2019-11' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1124 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3351 as GBP,\n\t\t\t\t'2019-12' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1095 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3205 as GBP,\n\t\t\t\t'2020-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1089 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3181 as GBP,\n\t\t\t\t'2020-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.13513 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.30362 as GBP,\n\t\t\t\t'2020-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0945 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2582 as GBP,\n\t\t\t\t'2020-04 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1115 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2349 as GBP,\n\t\t\t\t'2020-05 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1234 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2389 as GBP,\n\t\t\t\t'2020-06 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1772 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3087 as GBP,\n\t\t\t\t'2020-07 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1938 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3364 as GBP,\n\t\t\t\t'2020-08 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1819 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3163 as GBP,\n\t\t\t\t'2020-09 ' as ym ) rates on\n\t\t\trates.ym =\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tsystem_currency_vol\n\t\t\tfrom\n\t\t\t\ttrader_account_position) contract on\n\t\t\tcontract.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t113 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t178 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t431 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t444 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t667 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t669 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t719 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t722 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t725 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t728 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t730 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t739 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t3 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t742 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t4 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14017 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14185 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t15286 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t17222 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18557 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18633 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t51094 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t53021 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t55189 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56011 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56598 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t58533 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59217 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59564 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59921 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59936 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59940 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59976 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t60973 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62255 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62602 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64700 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64903 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66341 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66653 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t67606 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68025 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68732 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69281 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69501 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t70036 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t71348 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t73585 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t74087 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76808 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76830 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77591 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77992 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t78569 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79158 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79751 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79776 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79861 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80148 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80149 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t81789 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t82187 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83126 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84647 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84882 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84994 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t85474 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86488 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86959 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t87442 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88286 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88547 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88580 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88608 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88934 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88957 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88960 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89028 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89048 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89527 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t90983 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91231 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91599 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92083 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92119 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92272 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92436 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92529 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t93156 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t94765 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95003 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95417 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95533 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95552 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95696 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96039 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96082 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96442 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96444 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96903 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97559 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97715 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98608 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98799 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98801 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98939 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98941 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99276 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99382 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99383 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99943 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101045 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101071 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101252 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t141562 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142017 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142046 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142054 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142060 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142077 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142082 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142264 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142430 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142628 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143897 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143985 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144173 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144779 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t146491 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147091 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147685 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148023 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148087 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149446 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149654 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t150882 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151089 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151363 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151386 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152005 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152069 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152804 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153023 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153576 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153588 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153631 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154646 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154692 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155297 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155382 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155827 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156184 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156235 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156868 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t157794 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158445 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158887 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159205 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159555 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159821 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160010 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160727 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160963 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t161450 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162530 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162532 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163044 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163285 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163535 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163689 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164246 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164829 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164864 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164909 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165119 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165178 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165335 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166717 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t7 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166741 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168116 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168721 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168736 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t169843 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\n\t\t\tduplicated_transactions.origin_id = a.origin_id\n\t\t\tand duplicated_transactions.brand_id = 6\n\t\twhere\n\t\t\tb.is_test = 0\n\t\tgroup by\n\t\t\t1,\n\t\t\t3,\n\t\t\t2,\n\t\t\t4,\n\t\t\t5,\n\t\t\t6,\n\t\t\t7,\n\t\t\t8,\n\t\t\t9,\n\t\t\t10,\n\t\t\t11,\n\t\t\t12,\n\t\t\t13\n\t\torder by\n\t\t\t3,\n\t\t\t4,\n\t\t\t5 asc) t\n\tinner join (\n\t\tselect\n\t\t\t@lastab := 0,\n\t\t\t@RealABAccHelp := 0,\n\t\t\t@lastRealABAaccHelp := 0,\n\t\t\t@lastId := 0,\n\t\t\t@realreal := 0,\n\t\t\t@lastreal := 0,\n\t\t\t@RealABUsd := 0,\n\t\t\t@lastabusd := 0,\n\t\t\t@RealABAccHelpUsd := 0,\n\t\t\t@realrealusd := 0,\n\t\t\t@lastrealusd := 0,\n\t\t\t@netdepositcurr := 0,\n\t\t\t@netdepositcurracc := 0,\n\t\t\t@netdepositusd := 0,\n\t\t\t@netdepositusdacc := 0,\n\t\t\t@realpnlcurr := 0,\n\t\t\t@realpnlcurracc := 0,\n\t\t\t@lastrealpnlcurr := 0,\n\t\t\t@realpnlusd := 0,\n\t\t\t@realpnlusdacc := 0,\n\t\t\t@lastrealpnlusd := 0,\n\t\t\t@currentrate := 0,\n\t\t\t@realrealneg := 0,\n\t\t\t@lastrealneg := 0,\n\t\t\t@education_deposit_total:= 0,\n\t\t\t@eligible:= 0,\n\t\t\t@lasteligible:= 0) v) aggCustomer\ninner join (\n\tselect\n\t\ta.id,\n\t\tb.name\n\tfrom\n\t\ttrader a\n\tinner join country b on\n\t\ta.country_id = b.id) co on\n\tco.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.id) as FTDInd\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) FTD on\n\tFTD.id = aggCustomer.id\n\tand FTD.FTDInd = aggCustomer.tr_id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.created_at) as LastDepDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MaxDep on\n\tMaxDep.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.open_at) as LastTimeInvestment\n\tfrom\n\t\ttrader_account_position a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1) MaxInv on\n\tMaxInv.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.created_at) as FTDDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MinDep on\n\tMinDep.id = aggCustomer.id\nleft join trader_account b on\n\taggCustomer.id = b.trader_id\norder by\n\t1,\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368e16",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5c4e2b58-e697-499b-a614-02a2285c61f5",
            "fullname": "MySql:87455a64-577f-4dea-b3d1-74d1640130a1",
            "type": "extract",
            "name": "87455a64-577f-4dea-b3d1-74d1640130a1",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "69c1bb3a-c501-43d7-8032-a0f1ff41afee",
                        "id": "tq_fv8chj5YJ",
                        "name": "Ashford_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "fa53face-88c5-4745-af87-700a85de39f1",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5fc5c7f7-0a8b-4ccc-a717-2f18cdaf6318",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d647f5d-a2ea-43c9-a36f-c43bc22e8269",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9679401d-bf33-4a44-97db-30d53152fc5f",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe67eb00-fb05-4bf6-b8de-98b9e44f9453",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4e2fe5d-d1a5-490d-9174-2c911e1b57d8",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e6a6a9f-b096-4889-b66d-589db461e3b9",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6753c65e-1845-45b9-802a-5fec0cc44a8f",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "59144fd8-0851-40bd-820d-6e0feb76d532",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2fce9f55-b35e-4597-907e-79cfaac09609",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "a94e70a2-e6e5-4f22-805f-c4deb01629e5",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d5076780f2002c37e9ed",
                "provider": "MySql",
                "parameters": "Oz2AfvRo3srlztUw24mN8xjULQgCsDxE8xdGvyNUDfDIDVlPEvzGPi9X1pOk7WkJorypT3vAhcaensqPr3DxJWq4DMDr4Ntq8hg/ST/QG/Ry+Mc5Itvb7ssjapRdR/f5pJGa1CgTA4+V9S7ZAeHlkIJ8fCivOQ1bPR1RbzXK2+kyaVjENBts5VNtP4yYjGtpqTycZGcbTdSdI98JCq+mp2IzDRzS7cexXuu83rKl7MG3hlCMfvhn4khms5onk7u7",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5c53eacb-b4e5-4087-b9c7-02398f182bad",
            "fullname": "MySql:MySql-5c53eacb-b4e5-4087-b9c7-02398f182bad",
            "type": "extract",
            "name": "MySql-5c53eacb-b4e5-4087-b9c7-02398f182bad",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "61190cd38a56da002c368e1c",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFL6czB0CGbzkCaBUw+ZXoqcNee235Svk4bYIKmOxmfPKPzdRZewbzKtJzxokICVy5ebOk7xFaCRHr9R5aA4S0RE=",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5c5bacb9-a300-47d8-9546-2fc6bc674ce8",
            "fullname": "MySql:MySql-5c5bacb9-a300-47d8-9546-2fc6bc674ce8",
            "type": "extract",
            "name": "MySql-5c5bacb9-a300-47d8-9546-2fc6bc674ce8",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8dabb3f0-f903-4ef2-b147-172c555c1767",
                        "id": "tq_pyo8xaLUw",
                        "name": "Prime_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ecd59725-2685-42e9-80f8-cb6bae2561dd",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a29217f-4c23-4463-932e-5e877cb1cebb",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab95801f-f9da-4ddd-8a99-b8cde5f8ad82",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "24859c79-7be5-4ede-aa0f-1f2c509ec6ea",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "13cb87e9-eb89-4a50-9c3a-17c09ae05790",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "79e34f17-1cab-4f70-a7a6-81f0184916fe",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ddf5644a-aa50-48ae-80cf-c62b6565f3f2",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d820ef9b-bd0e-4bad-a768-a5e41238f1eb",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "ecd59725-2685-42e9-80f8-cb6bae2561dd",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "8088254e-d34d-4101-91cc-c5395ae5f042",
                        "configOptions": {
                            "importQuery": "select\n\t1000 + brand.id as site_name,\n\tconcat(1000 + brand.id, '10002', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl\n\t\tend as open_pnl_diff,\n\t\t@last_id := a.trader_id,\n\t\t@last_open_pnl := a.open_pnl\n\tfrom\n\t\t(\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\topen_pnl_daily\n\t\torder by\n\t\t\t2,\n\t\t\t3 asc) a\n\tleft join (\n\t\tselect\n\t\t\t@last_open_pnl := 0,\n\t\t\t@last_id := 0) b on\n\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join trader on trader_account.id = trader.default_account_id\ninner join brand on trader.brand_id = brand.id\ninner join currency on\n\ttrader_account.currency_id = currency.id"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd38a56da002c368e1e",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFIX7z4hDzOA5YXgCX1CnxcziCZXnKajrGEM0j8uqIlTwXnpKxRmvJQ/vEoycz24MzdQtO85lTUxeO8n2QreZhfY=",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5d8a402d-83c5-4ccf-af2d-1bb37e9a9a23",
            "fullname": "MySql:7fdca08d-a4d2-4790-933f-75a50e8e0700",
            "type": "extract",
            "name": "7fdca08d-a4d2-4790-933f-75a50e8e0700",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "515af0fe-c28c-4d87-9516-f4be81d152e5",
                        "id": "tq_r114NiUq8",
                        "name": "TradeTheBit_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c3997f0b-709c-4763-b7ca-aa751a30c74a",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd5ce944-7b67-48d7-9aaf-5622607cc39f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf45040b-d290-4442-b66b-a5c56121cac5",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a3eaf78-3b2a-413c-9fc1-2f4c53595509",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fb48ff5-1191-47ec-b5cd-6a6b47ea3d6b",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a00a1e3e-324c-466e-84c8-10420c46ae30",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96b4b9a4-7ffb-40de-890f-60f378cc1d39",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4205f26f-27dc-4761-919c-8ac6a0e69bbf",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c217374f-9da4-4d6d-9fbc-93bd29e2da8c",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "253ac808-8688-4690-9f1c-ee8e09e2c7a1",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "d0d1ddd4-7d45-4326-b825-a9b1836eabed",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6416780f2002c37e9f5",
                "provider": "MySql",
                "parameters": "F954Cqx2+xpp7cv613X4To3KDLtYkIILY9DKa7o2J6iwT7Hhp/LuVGR7WVoXuAJR6pANxIXoQ9aWeJiI7OcJP72ZHBxG9xyN42erULpN5ZuqvWQ4Ab7IRfQ6FHGxrmIec/RVbJ5P1EBneN6L0WOHnZFugjR8UPuM7oh3rwSSnzvjLJFOJ0c2gxjMsXRaCgVGAB0Pjz5j/uHDcFPg85fyrANVftdnJomPKg7Rk6G5kbKEybu1E9znVlAXap1CpXX6",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5e6be4ac-f581-455b-978f-31b2d3bd702d",
            "fullname": "MySql:4182f2d3-2681-4ad0-b72c-12ef53a1a406",
            "type": "extract",
            "name": "4182f2d3-2681-4ad0-b72c-12ef53a1a406",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f2f62cb9-ba5e-4943-95e9-f6e6f6d096a3",
                        "id": "tq_u8MCKhS5B",
                        "name": "MarketCG RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "12999165-f7d6-4c84-aac3-204badda6e78",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c6e5a6f7-88c8-4331-8d35-9430ea9560d8",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "759d9886-826b-4a85-9acf-5092f43a2dc1",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed477cb8-3a51-4312-bd65-760d077e12d9",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "468cb19a-66f4-4a6d-88c5-5a71b653ca2d",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd837b6f-1c45-4af6-a3d9-a111355b96a6",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0aea4840-8b73-44c2-8924-8fa8e6e037a5",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13e0b95c-d264-44bf-ac03-82536753a4fa",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71ffbb6d-535e-4646-a82d-9835b3c03bc6",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "19b69c3b-9379-494c-bc20-362e36f61c18",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "966fe3c4-8506-422b-8453-1c0b99ef22f2",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "36192fbe-c901-446a-a75a-fcebb0a89928",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 24,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "19acbdb2-9999-4e13-b43f-f097008775ca",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e869e880-4e94-419c-9e71-7503108e4481",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "76ed2e99-695f-41a7-be02-6d6be041e1de",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c354a417-1e54-41f7-a1d3-382a99a90626",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b8b7e55-cdc1-4163-98ab-37884f46df63",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e33a9b27-704c-4579-9fb3-8c2d90c7ef86",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4174aadc-c4e3-4184-a0d2-66bc9fdf194d",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "951049e8-45e1-4461-9e04-c327282753ee",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08a6631e-8d8c-437d-9ca4-197ef4145eb4",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dfd94076-dc43-45d2-8253-0be4872ad1d5",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6d38a7c4-a6bc-4955-b1b0-ffee352bd1d5",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14d94f2a-959a-4a0e-8712-0e275d32697f",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8fe13062-c976-4306-b388-73dd89c90fe0",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb895727-a862-4027-8aa8-b8364b598a79",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "33906fcd-1817-46bb-a989-60d45d882e43",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0c815928-15ef-40f1-b085-d49b38b0805e",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "07c2fe6f-df01-44f9-80fe-cacd1fd7cb82",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6c4e562c-ed79-4ff2-b95d-fb8c682ab80b",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c546639-a897-4707-9843-fc004e767d6c",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0c72ccca-553a-4ca0-a338-61039e8423b1",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "26c215e7-e8b0-4823-b473-1965201787cd",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c08d8c74-0465-4609-99f0-c626da1644fe",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b0b30eaa-fb5d-400b-b99c-c1e39f1bb2e0",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8958709f-0af7-40ba-b3c0-4665f58bbfc3",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "826fa671-ccfb-4278-ace7-e378111ca038",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d0669ec7-996e-4ba3-973c-ff1ef58071a5",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "80dc3576-f0ae-412d-b648-534098e675e5",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ad540d23-3e1e-4ead-8edc-cec71af2ba88",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "221691f6-790a-4a0f-a731-aee3cf7e78da",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c68aab5f-11ff-4576-8c4d-c8a3e4be59a2",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4c6015b1-d65f-42fb-a665-631a5d9fca24",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "69ca6628-749f-44ca-a521-b7fe8bfa781e",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c11e24b8-23f7-4414-8e0b-9bd8489c854a",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e4424b62-8f77-48e4-8986-583e0746edc7",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "049d2afd-9957-4431-bd66-646a8228829e",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a1c8638e-9930-46c9-a6aa-6daa1c206317",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b4259ac-b6e8-4b7f-9fe0-f78ee0acaa91",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "82057ef4-f565-4a59-9206-a901b786c57e",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f88870c8-d65e-449a-963e-866b0274624e",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b8ea0c4-2474-43d0-b08d-d40f2cf08f30",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b317bc6e-9431-4d51-a456-9bee8789ca9e",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "884da0cb-1d96-46c8-88e5-48ecdace1f7a",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f42236ee-efd9-4c7d-b8ba-68ffd812993b",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c22ae83-1b5c-4632-9d7a-e7fa258769f2",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "82169c67-cb35-4d76-bc2d-33de0ca455b7",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7e0d3d63-7707-4cbb-ac13-49013c4cbc9e",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9dd24946-b6f0-4eda-b14f-abe01a63d7c0",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b8cfe286-95ad-4b67-9efe-3cb51ec857c3",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "93e2181e-63fe-449a-89d3-fe1919a3f26d",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "341379d7-4732-4cad-b8ef-202d3e99b11a",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f475dc26-2913-4584-b3a7-4c1472129610",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "37fa9c62-5ce1-41d3-984e-2feada4b72ba",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "15b249fb-7847-4677-8c51-534fda3c5cf2",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8019b46e-bbd3-4bb2-ae5c-7c7828b71764",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "994ccdfa-7a69-49e7-a29f-c3f509b16517",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a8648aa7-354a-414f-9ee8-58f01356fff3",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a8a7b55a-be59-41cc-bc5e-fcd2f5cfaf46",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d04cad7d-38a2-4043-8129-6bc5669a27d0",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6614b45f-9b90-4120-97ea-e0f44e7f7f43",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "27089201-0b83-44d0-8e71-a376ad6bccc4",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "896e77f1-bc04-42be-9150-3dce3576dc5c",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b973bda-6f78-4986-a84e-855e15494a82",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "df2c2d0a-df3a-43a0-8fb4-079ef94ac1dd",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3fa5d39-ec4e-4323-805b-852f494cbd33",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "775a0593-4bb1-4135-9de6-588e55077437",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4cea66c2-5f33-41a9-bdf2-70bda4ee3ec4",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8051b20e-e1e4-4acf-8483-98bbef6c1e87",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "91721db0-0885-4dbb-8a1b-ddcefc3747bc",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\t\tselect t.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect b.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,55)\r\n\t\t\t\tand coalesce(d.name,'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,55)\r\n\t\t\t\tor coalesce(d.name,'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,55)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\t\tselect 1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym \r\nunion\r\nselect\r\n1.0945 as EUR,\r\n1 as USD,\r\n1.2582 as GBP,\r\n'2020-04 ' as ym\r\nunion\r\nselect\r\n1.1115 as EUR,\r\n1 as USD,\r\n1.2349 as GBP,\r\n'2020-05 ' as ym\r\nunion\r\nselect\r\n1.1234 as EUR,\r\n1 as USD,\r\n1.2389 as GBP,\r\n'2020-06 ' as ym\r\nunion\r\nselect\r\n1.1772 as EUR,\r\n1 as USD,\r\n1.3087 as GBP,\r\n'2020-07 ' as ym\r\nunion\r\nselect\r\n1.1938 as EUR,\r\n1 as USD,\r\n1.3364 as GBP,\r\n'2020-08 ' as ym\r\nunion\r\nselect\r\n1.1819 as EUR,\r\n1 as USD,\r\n1.3163 as GBP,\r\n'2020-09 ' as ym) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\t\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\t\tselect 113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 7\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand a.id not in (751,758,764,798,808,949)\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\t\tselect a.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619f870a74cfc4002dc01b93",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NAc1gMa0VBzZ9QDyN4mgrYY4RdbmC5kaicIuBKtyLx50isgKI42gk0NUhwNAOs/C//rfCcf26YrMKFuhFjde0RcvkzPGcYE8h+sUnaaT/8VA==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "61bcbad7-0444-4fd6-8534-ef9032cc5f52",
            "fullname": "MySql:0f2cc429-aa74-431a-adff-099dea7f1be8",
            "type": "extract",
            "name": "0f2cc429-aa74-431a-adff-099dea7f1be8",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "43983927-2b72-46c3-931f-6541c851d13c",
                        "id": "tq_WQU4Sabhc",
                        "name": "IvyTrusts RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "18160b12-d2be-4abc-9d2b-1c594dddb80a",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d289de9-94dd-44ca-8468-d14516108ea8",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d725f7af-c123-475d-8624-5550d86be0e6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9948ed43-7f06-4123-82dc-26bd7707ca06",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "837be8b4-9716-4914-bf9f-e25dab5bd9a5",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 306,
                                "precision": 306,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "403237da-db95-468c-ac52-8499f92dfdbe",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d6ed3db-3208-4c59-afbb-4af07cbf235f",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "43f00132-0e79-4e93-8ccb-e75796acea26",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9da9a8c5-b0a5-4f01-a570-ce513de9f75a",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9d6c544e-85a4-49aa-86c4-21f11eaa3220",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fdc0dae9-2ed5-4897-ac0b-30d76a613c63",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d60fff7-5a91-4133-8b97-cef2a5874986",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 24,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3440010c-22f6-4c7b-b2ac-11361885c94b",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9583289d-6632-431f-ab47-1a92d3addd12",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a561dcdf-0208-4c6f-a8f9-0240aabc6e0e",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "24d47ade-ba18-4034-a81b-966713405386",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "62b9ec27-2b7e-4936-8d0c-f4810d4fbade",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75c82c20-2cc8-4127-8de4-8ffa53106ecd",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "183d14f5-68a1-4c8b-a857-f446597c652a",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "94cd8d29-7f9d-433a-975f-ac51cd077418",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92445a3b-35ed-44ff-b637-d9f0b3634c5f",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd1303df-6b15-4913-8b55-d028f2b8b619",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "33aba788-96b3-43a1-9e61-2a4b96b0bb23",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "504ddea1-6874-44f7-b2c3-9e952579531c",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3826a5df-b6a9-4e0b-ad4f-9c585b75123d",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ad7322ad-6236-4510-a2d1-73220ada6306",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "200f2575-338c-4a43-a85f-d7155e14cb3f",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "adc3ad8a-51d7-47ab-9aa7-1d3210c9b5d9",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f637953-d987-41f3-84d2-5bfb4620b462",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "37eb709a-90bb-4c25-9e2c-6b3c27531b69",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3ccfccdd-18ea-4f26-b35b-bed8314afa20",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "78333f7d-a0bd-4200-b13a-c4c24e8d4ef5",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c242418b-9dd0-4c93-913c-6ab9bbcd41bd",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "536622b0-1088-4e2f-aed6-41602e27770e",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "32a44987-4f6a-479e-b480-9b0add6d51d2",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dcc8ef28-5556-4fea-99d1-e6e2950efa9f",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e8f0c686-a5c8-4235-a2bc-a01332742d00",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c5f4576b-06af-4045-861e-4e545979969e",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1844ca7-f8c2-4a1d-8856-df074d684217",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c7dbf9ae-5fa2-4192-8445-0ddffff6a192",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "36814fd6-ae33-47b3-9a87-705b38744fbe",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3d81ffc1-5c19-4c68-805e-9b6a5439b876",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8574b41c-aafe-447f-b4e2-2cbb57b311d1",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "046ba2a1-64e7-4af3-8a5f-231dc5a1feda",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db5b5f18-b3bd-4557-befd-8c3bed7643d3",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0fbb23ea-33e3-4993-a158-a90cd6d370a4",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5be28ab-b463-452a-81ca-7e4aef44b10c",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1d845188-8ada-471d-a4e6-6590a09b41b5",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "07855bd0-25b5-4070-a803-d32307650db0",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3f92da36-d156-4bbf-beb2-2c657b8c1f5b",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6fb1631e-0742-43a5-a68e-4dfa6de30a13",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e4ec3b73-73e2-4d04-8212-52a47f4a9f41",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "90ab5cd8-ae88-4fb1-a5d3-2afb045883b8",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a7d7ed93-7bea-4051-accf-7822c806c3e4",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1092cd85-a2ba-4866-96e3-2e317fbafa1a",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "922225ca-5d06-4900-a628-c8b7182833f0",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6dce5508-2e98-4e8e-b79e-3c1c1f455ce0",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be29bd01-6cd8-4cf8-ab71-b8a6cb0b4739",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "737bb690-6af3-4073-81ce-45c3d69ab747",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fc0deb02-deff-47c0-8452-dc90d06348cf",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "174dedfc-d6a0-4506-885d-90732baffa39",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "909f0326-142c-475a-af22-c33064e29ae3",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1df0a2d2-b9bc-401c-b913-7b169d7c472d",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "284c01af-b141-4f8e-a095-4e94c14abdd6",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ec278bf3-b457-4bbe-bb57-7116a2cef45e",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5c9d01e1-e270-477f-9acf-8b8d08ba29fb",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c873f7f6-1ac0-4e21-a218-6635a8e4f8c1",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "41c573af-a104-4a7e-8109-cda91a60320a",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "39707796-40a0-4de0-8eb7-50248b251104",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3a7de0d6-05f2-477f-91ec-154dd9d7909e",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b55d46c-36fa-492a-91f1-b423fbefbd1d",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "af8569d1-aec1-45f5-9563-b39017fbbe2c",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b4a973fa-4d5a-4caa-afbf-05d16bc4db80",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "99926bcb-6ce6-4f36-a6b8-3c335f56edeb",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4b0cf196-7558-4bc3-bef3-4b6cc09d9a24",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f42874b-b653-4e7b-bd4a-d106f0e8ef43",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bba46c8b-8cc4-4118-af14-6a91931a6d30",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bd01588f-70b5-4f35-b4ea-4c4ad78b4cbc",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e0a21820-5495-4d9a-88b0-d31c936d302c",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "034cbbe0-c9b3-4343-99ab-9d1eda826f9f",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10003', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10003', COALESCE(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\t\tselect t.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect b.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join brand on b.brand_id = brand.id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,208,325,478,511,664)\r\n\t\t\t\tand coalesce(d.name,'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,208,325,478,511,664)\r\n\t\t\t\tor coalesce(d.name,'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,208,325,478,511,664)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,208,325,478,511,664)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\t\tselect 1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\nunion\r\nselect\r\n1.0945 as EUR,\r\n1 as USD,\r\n1.2582 as GBP,\r\n'2020-04 ' as ym\r\nunion\r\nselect\r\n1.1115 as EUR,\r\n1 as USD,\r\n1.2349 as GBP,\r\n'2020-05 ' as ym\r\nunion\r\nselect\r\n1.1234 as EUR,\r\n1 as USD,\r\n1.2389 as GBP,\r\n'2020-06 ' as ym\r\nunion\r\nselect\r\n1.1772 as EUR,\r\n1 as USD,\r\n1.3087 as GBP,\r\n'2020-07 ' as ym\r\nunion\r\nselect\r\n1.1938 as EUR,\r\n1 as USD,\r\n1.3364 as GBP,\r\n'2020-08 ' as ym\r\nunion\r\nselect\r\n1.1819 as EUR,\r\n1 as USD,\r\n1.3163 as GBP,\r\n'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect 113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 6\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t5,\r\n\t\t\t4 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\t\tselect a.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4,\r\n\t8\r\n\tasc"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61bb0d33575187002c94dca0",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiNCcMibb1+BB8XVxNqk1WzyO+TFmKpoM2bSX/Ivm7/xq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "67e9a837-a8aa-4768-b78b-5a49bd7bdb14",
            "fullname": "MySql:85173226-adc2-4288-b126-6e5a4d7c6dce",
            "type": "extract",
            "name": "85173226-adc2-4288-b126-6e5a4d7c6dce",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "3b102b1d-61bb-44c0-852d-0a504a990c36",
                        "id": "tq_K2vXJy9Hj",
                        "name": "Arrow_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f156c676-6db2-4f71-a807-c51930436b28",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a4dbad94-c383-4ca8-9318-ddf5dd26405e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "412f5e70-e650-46b7-a8da-a169fd48f07e",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf1da620-4586-4047-8f58-517de78a70ab",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3399f897-9c1e-4d34-8d46-ecc34d228876",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21b40550-1467-4a70-b9cf-b5f11fa797a9",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4b98f2f-31cd-4c43-a233-e1d203b153fb",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc549825-7d03-4cd9-ae3f-d91ffc88b99a",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b763d031-5b61-44e5-a3b3-640d275e4af5",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63f8fde6-356e-4029-8ce9-f126058c0f82",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "90db3c2e-f979-47ee-a3ba-3385e1b18d4d",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6c76780f2002c37ec36",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "68c7b63d-d9c9-4806-99e2-ba348a7a9c21",
            "fullname": "MySql:4b187a5b-3262-45ac-b34e-c4158bb276cf",
            "type": "extract",
            "name": "4b187a5b-3262-45ac-b34e-c4158bb276cf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "2b15935c-a802-43bb-917e-8526ae963b7c",
                        "id": "tq_wyvWb9UFz",
                        "name": "TradeTheBit_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2e432cd6-5d65-40d0-9bd9-5df0dad4aa3a",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2bc4227d-9dec-45fe-9aa1-ab110fb82a72",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf42118e-d539-4cec-8501-b28e4bce56f1",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1d88588-6d89-4fb4-a6a2-2117269f8aa2",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcb1ec7e-99f6-4e45-9aa1-4c4db1406e31",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3bad1444-c1dd-41d1-93ad-300aa29bcf38",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f547c070-d68b-4331-a2c7-3724a0b8320e",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8344163c-b219-4ecd-b59b-5a7faf54f950",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "930d1b85-de28-49f8-afe6-cd7332f02045",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec8b419a-2698-4cb1-832a-35370a714547",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a4679be-882f-4fdf-a6c5-d9a0c6b74352",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99df7cf8-b10a-4454-bcd0-c0278c26f2ef",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccbaec60-49e8-4a65-911d-4446c6354362",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a24a3864-ccb0-4af0-b4cb-8b56f751f6a0",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0d917b5-a536-4c8e-b94b-e706b74d27aa",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "365b3d4a-4c22-4b7a-8eeb-f6065ab2d5e9",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "119c89d9-b35e-47a6-8b4b-70ad5fa38bb0",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a1162744-d873-4dbd-bbed-6d0443582c15",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da8a53ae-1494-452f-ac81-cca8361dbcc4",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0d1a741-4b6d-44f5-bb9c-cd9499f00698",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ae25c61-fa0c-44ac-a7b5-9cd131b310af",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e454b959-2bd8-4b3d-8398-f9f6297fec18",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0866753-ab63-4b11-afdc-28b70920ff49",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a191307e-3e26-4606-814a-bbf6efe71331",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4592fa48-bfd3-4fef-ae9a-a00f1630cff3",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a367aed-7fa1-474f-bd03-dc51fd442aa9",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d88647df-e9b4-4fb3-9d9c-1adc6a5b46f9",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "809aa64b-2cc2-4034-9557-a53eef54bd08",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2c943bf-07b3-4c70-bef1-8a5fa7a90ca0",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7faccbd6-7f3c-42d7-9a99-7ce038ba9c5a",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23468516-7d37-48f7-af34-cd42e0c615d9",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "43123c7a-f00b-442e-9fc7-71b2840ebef2",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25c80532-79a4-4880-99ab-d03d79259b02",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c81d176-83d5-4239-adbb-e5a81d1d53cd",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d60e020-7417-401c-bafd-5f5d437a19d1",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1592d054-83ca-4934-9086-f997ba9d8cc2",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e5a897d7-b2de-4dfa-8e02-00af558d21ad",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad2630a9-d760-4e37-98fa-be92bb1b841f",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ee1f3ee-3ae3-40fd-82ec-7896283774af",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bad1c53b-3c03-44a8-9abf-a1ef9594e297",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "489d4bb8-e7cf-4301-84c3-a2c78ac1bb95",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "716c9663-c16e-497c-bf69-a53bfc6e3d8b",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67a3c48c-009b-4f04-bc8b-298d8de5d23e",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cecc81f5-d8a9-4f67-91a5-3c8933936283",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46997410-ed58-4431-98eb-c1011c87fa20",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7375ebf0-5bae-429e-9790-4628403e7734",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a80260b7-4fb8-47ef-bb2a-d22beaac80ad",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cd1ba67-f80b-43ac-bc85-c6baabd57f5a",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c13bb92-a3dd-4313-9f82-64389bb850f8",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7673de04-002e-4b71-bc10-fca274ca700a",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d71a2b3-74c1-4645-80f9-d92a8600f87d",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b73c4be-4959-4998-b0c0-600845ee03d7",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0916320c-59b1-4bae-8daf-09d0bdb6a848",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8034e7ee-8966-4323-a592-fbd62c3f561c",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8cd7e1d-7f43-4cf9-9eba-d22edd77f389",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "a191307e-3e26-4606-814a-bbf6efe71331",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "68a095c8-6fa7-42a3-866d-4bbadfeef3c4",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32,70,78)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,70,78)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,70,78)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6226780f2002c37e9f4",
                "provider": "MySql",
                "parameters": "F954Cqx2+xpp7cv613X4To3KDLtYkIILY9DKa7o2J6iwT7Hhp/LuVGR7WVoXuAJR6pANxIXoQ9aWeJiI7OcJP72ZHBxG9xyN42erULpN5ZuqvWQ4Ab7IRfQ6FHGxrmIec/RVbJ5P1EBneN6L0WOHnZFugjR8UPuM7oh3rwSSnzvjLJFOJ0c2gxjMsXRaCgVGAB0Pjz5j/uHDcFPg85fyrANVftdnJomPKg7Rk6G5kbKEybu1E9znVlAXap1CpXX6",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6a2bc46f-8a9d-48f5-9881-c078a845fb51",
            "fullname": "MySql:1360ae72-9e3a-4115-bea3-a0776c01e301",
            "type": "extract",
            "name": "1360ae72-9e3a-4115-bea3-a0776c01e301",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "35b5ddba-2281-4687-a701-de784ba1913f",
                        "id": "tq_a2Dd3OBud",
                        "name": "Arrow_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "7ed3dd74-c394-4a93-a422-a515869f6af4",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb28cc63-8fae-4de2-94b7-efb0a304c2ef",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14f051aa-0e40-4a4b-a89d-7436e91e8716",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e0b2bfb-0af9-4d1d-8ac2-53077ab02f44",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1f09db5a-32a7-427b-9272-119ba9bcb01e",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ea78b623-3c18-4b44-a6a0-7136005be27c",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50208c9a-208e-4857-b384-5376b0789441",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b9aba24-4f16-4972-8b6e-73593b4ed382",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be33ef47-802a-4f92-b890-ff9d91460caf",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "026cdbec-55b8-4c4f-b628-da04585e2eb1",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cdefa054-3233-48f7-a896-fce92534bc58",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "294d8fb2-61c8-4f16-b14f-e2f988df3374",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d94fff3b-fef3-48cc-9784-bd6db7a7bdd0",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "252cb26e-74b1-43f0-8b4a-8ba95d97e210",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9790218d-ab99-44d8-bad9-2230a6f6979f",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ebee6c4-60ee-41fb-84bb-5099dd592b0a",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "67fc9667-8ec9-42a3-a222-40bca204def8",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "985594d8-bff8-46ad-8a58-227d850347c5",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57f32126-f92e-4d4b-85a9-da01e95ea396",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2153a961-422f-4e9b-afcc-1a42807bb29a",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "915d2b66-51ae-439d-a7d4-9775c7b339b9",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b448c646-b0ea-41c4-a5f5-f8bb0aba7b14",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc12f937-7c50-4b00-a984-cc32ace3a37e",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a251ea0b-0242-4dc3-bcd9-8e057a3e9b8a",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d66a8f07-2d52-462a-9d24-0498837f4796",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63820a2e-d864-4a32-93e5-e5c0d016a10c",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba530d15-10bb-48fb-96a1-7de52f0cae81",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83dca13b-b6ba-4ca8-b302-4b8339502b45",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9066d2af-09d7-4a0b-ae72-bf39c0d665c0",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "80acc6dd-ad75-4ee6-a4c9-a43aad855693",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "58378796-8ba0-474d-8341-7ec20cfcc072",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2025442-fdc6-4ebd-8d8a-3bdd7184bce4",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "24b6bcc2-d132-4751-a6af-27ed1ad65854",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2edf0059-699b-4fe2-bf0f-fa6e7b6fc7e5",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "31dc62c1-712d-4e19-8e82-e5dc9a005c9c",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f4c89a6-26b9-4c93-ae7f-3e3c654acbe1",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2e2338f2-8894-41eb-9e1c-0e36a912617f",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2c76a78c-ebe2-438d-aa5d-0e86cb8f24b5",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02af46e0-cadc-41e3-b537-0e7358982325",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "52df6fa4-06af-4478-8b4a-f3d792533ee0",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "090b57b8-3fac-4f0e-9d41-2137cec7466b",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39133654-6c03-49bc-b386-58121de3010c",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "500c10e0-c1f5-4638-b369-47fd080ff668",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f8ac4cd-86d3-48ab-a968-725c355364aa",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bb1cdcb-4a9d-42e2-989b-9e59b824439c",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eddbaa8f-af97-4b5c-a380-49acb333df75",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cdaf8bae-823a-4a32-9073-dcc989fe2a24",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd1b5da5-7e86-403f-8734-7f007adc78e7",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0982fedf-9a66-400b-a91d-9d5522de9557",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3de9049-0772-408c-b954-0acb48b243ab",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7fe0d0b-cc9f-4931-b547-b94f20ce74b4",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "569d8386-9369-429c-8ccc-918fe2dbc85b",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b484c68b-1816-4dd9-8e79-db6eefd374a0",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3d98a487-0889-41cd-b51e-268aa0eb4d3e",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "041d6412-e98f-4162-a716-006d5abe9a09",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "a251ea0b-0242-4dc3-bcd9-8e057a3e9b8a",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "c3d725cb-7d75-418d-857b-fc5b6daee3c6",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10010, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( brand.id + 1000, 10010, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tinner join brand on trader.brand_id = brand.id\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttransaction_deposit.payment_provider_id not in (24,32,65,73)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,65,73)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,65,73)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d8236780f2002c37ec40",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6aa470fa-d521-457f-9d51-98851eb19d8b",
            "fullname": "MySql:6898f2dd-de0d-4bb8-afef-e971b0c6ebc5",
            "type": "extract",
            "name": "6898f2dd-de0d-4bb8-afef-e971b0c6ebc5",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "741d04e4-141c-43da-96e6-cbfd20edd83c",
                        "id": "tq_s4lwMT7kX",
                        "name": "BigBitMarket_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2050239d-7faf-46e3-a4d8-73a0299e4398",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f8fbd99-1bb0-41b8-b770-bc7075750c45",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77a92c4b-181f-45bd-8569-33c0766b6223",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffd2f183-aa45-436c-be0f-8090eedf2497",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d95b6ceb-b7e8-4e5c-9fd2-9731f3077dbc",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a97fbce8-4462-462c-9fd5-9d31ede13715",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 40,
                                "size": 22,
                                "precision": 22,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "afa18793-bcc3-47df-96df-413ac21d5122",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "033afacd-f841-49e4-9125-bc5216c3ecdc",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "9aad1f60-d15a-41cd-bcd7-f712c101b97f",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0debbb43ad1002c7a7586",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6b782623-3ad2-4714-a528-a9e3eae9cc32",
            "fullname": "MySql:2f32dcd8-7a61-4ae9-8df6-1205e661b7ff",
            "type": "extract",
            "name": "2f32dcd8-7a61-4ae9-8df6-1205e661b7ff",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "87557274-bf71-4e4e-b3f8-aca924ac8f0d",
                        "id": "tq_Bk7syHSy9",
                        "name": "InfinityCapitalg_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c9b6dfec-5057-4626-b224-b846685d156a",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4c70590-ae57-4623-9291-e3639e059204",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2d3786e-65e2-4b2f-ac15-7d7fdeee2850",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e98df9ec-90bb-472c-969b-9fca351d5059",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19358eb0-7e4e-4ca2-99b4-e10d7209ce02",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8bb121d-caf6-4c65-bf6d-16b5451758f5",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b698aa7c-e7bb-418d-b1b0-51f85a59e351",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0be2c45-8cfb-4a80-960d-7918217d12e5",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2df10c90-e769-4053-b801-59881876629c",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "48d79107-f8e4-4f0a-8aba-c68b4f7ca699",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30c56372-92ac-4ba9-beea-ffdaddee91b9",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d7d024b-d386-4d44-9195-c0f525a1d38e",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2ca4e998-51cc-4622-8acb-4aa72a63f95d",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be18f422-97df-4868-9ac8-5ed5738593c9",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "105d7151-77f8-47f5-826d-091a43c5f575",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "175a3b55-fa4b-4504-b035-e5b29fc89ef0",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "756ba3f1-be58-4579-8451-13d238262fe8",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35833011-2338-40b2-90aa-fda66713aced",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f2210907-60e7-48de-85e8-d331747a9c7c",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c913c220-2f41-4758-82b9-e40a85933dba",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c90eff96-0ba7-4364-b3b8-8b5ceb1017ab",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "deaaa7fe-44ac-4532-aa18-c74f3eb1e496",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "af39889d-9049-4137-a1bf-19559204c2db",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9534d76d-ba79-4a8d-9c77-d0902c47dbf9",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1aab375a-da22-4c09-b8a9-2b60b7f0a1b7",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "555f74b6-8a1f-479a-9471-9c81d7c455f3",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c45b59c6-fbd8-4e18-bbe9-480248588cb6",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2782fde9-1000-4533-b3b7-0a421b49d692",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "39d3385d-0c85-43b3-ae95-b8dc8923e967",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e4d26a6-7495-4765-b4b4-7a3998729c22",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6c8fd137-16d7-4ed3-a69c-a820f19887ee",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e165f23f-3d27-4040-8e94-fd8d2ccee442",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0a7130a5-5d7f-4200-bcfa-03ded65ede81",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8a55400f-ba59-4655-80ef-7c493c0bdc41",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e6ab7ca-4ddb-4f56-abd8-197b2c2aa33a",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "509cff5f-bbf5-4d90-98d5-7227bfccfaf8",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bb76fa38-21bb-435f-b922-3be9b08513de",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fc4858c7-0609-45a9-b971-27e5760544f5",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cc4442fb-63e4-4cbd-998c-93b59f5fc223",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b34eefa-6e21-4b8d-aba7-7b3e6c9cea11",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e05ccba5-88dd-4cbb-b3c4-aeb484cd5f14",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3b2bdb9-3880-418b-9e62-bbdb6721cfd4",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4d06abf8-ca58-4767-8c52-d16ad224c535",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "249285a9-6375-44db-b1c3-a5acbbf18820",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9bbc0064-1f63-4694-ad64-dcda9afd54e2",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2cc5b9a9-bed6-4c3e-928c-fceba6a3841c",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d250571e-7d50-47a0-8019-3d15acefca7a",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1e6ca10-20b4-4e79-ada4-74d4a8c2007b",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f17581a-0097-4131-8c50-38dabf177fd8",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a5104929-5758-4dad-a949-182f980cb6e2",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "96dd746a-249c-4dc6-92a8-0b8b353ac1a3",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "edba0c8a-f5e4-4d14-9666-75734531a923",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "623d2ea8-6d70-4a28-b6ba-8c9e9fcfe205",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "728f162f-b24b-455b-aebc-3e0e009a73e6",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5744d4eb-70ea-463d-8444-2c7abd946e54",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb03f911-e2b9-4fca-8ba8-382237a630e6",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3e1bab0c-ceae-4016-9109-7a935abba5ed",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e4176d11-30c3-43d1-abb4-fccfd380c866",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2c264842-cff3-4441-8bdf-34f30d352a1e",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6daad2e1-775e-4097-8c87-2e1ea3ab654b",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ec01aee5-ead6-445a-bdaa-1907003fc06e",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ffa3c82-e35e-4592-8e8a-7493cfa3e508",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4428c9cd-77a9-425e-9b01-2f4154843c5a",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "13028d3a-29b9-47fc-86cb-15cd2392739b",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd50712e-fece-4041-980d-af5e37827d22",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89fb01aa-bfca-4a22-8dd5-d9dd42af9fb6",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "95b38293-e3a8-4262-ae86-e5f16dacc81b",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f0d14548-5a47-4ced-874b-66fcf3af4a42",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "37c21343-c1e1-4e98-8132-651897e9d55b",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db3fa7e6-1f8f-4b49-ab27-9bc1d3ec76c9",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7866e7f6-e7cb-4ab9-8fa6-5ce6c6857521",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "976a920d-52b0-45e9-a88f-3fc6c86d5205",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb049f36-ef20-4304-ac48-b2e5c0100b4d",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3800219-3aad-4d2e-bfc9-869509e77274",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75c7a660-2b33-481a-94c4-5e2b41f3ae54",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9152f59c-95e3-4345-b24b-325ecd4d72d0",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c26fc00f-77b5-486f-9086-3baaf9b93cad",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cdebe22d-8949-4cfa-805e-9b89c3e0a2bc",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0c1d66e8-ef73-4d04-aea9-6aadf1455cd6",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "17732ef8-6cc1-42fe-94cc-5c060011100d",
                        "configOptions": {
                            "importQuery": "SELECT\n\taggCustomer.id,\n\taggCustomer.site_name as site_name,\n\taggCustomer.site_id as site_id,\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\n\taggCustomer.customer_fullname,\n\tco.name,\n\taggCustomer.currency,\n\taggCustomer.created_at,\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\n\taggCustomer.date,\n\taggCustomer.YearMonth,\n\tcase\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'GBP' then 1.3\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'EUR' then 1.1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'USD' then 1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\n\tend as rate,\n\tMaxDep.LastDepDate,\n\tMaxInv.LastTimeInvestment,\n\taggCustomer.tr_id,\n\taggCustomer.origin_type,\n\tMinDep.FTDDate,\n\tcase\n\t\twhen FTD.FTDind is null then 0\n\t\telse 1\n\tend as FTDInd,\n\taggCustomer.user_id,\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\n\taggCustomer.deposit_curr,\n\taggCustomer.deposit_usd,\n\taggCustomer.cashback_curr,\n\taggCustomer.cashback_usd,\n\taggCustomer.withdrawal_curr,\n\taggCustomer.withdrawal_usd,\n\taggCustomer.withdrawal_curr_new,\n\taggCustomer.withdrawal_usd_new,\n\taggCustomer.cashback_withdrawal_curr,\n\taggCustomer.cashback_withdrawal_usd,\n\taggCustomer.withdrawal_fee_curr,\n\taggCustomer.withdrawal_fee_usd,\n\taggCustomer.chb_curr,\n\taggCustomer.chb_usd,\n\taggCustomer.inactivity_fee_curr,\n\taggCustomer.inactivity_fee_usd,\n\taggCustomer.overnight_fee_curr,\n\taggCustomer.overnight_fee_usd,\n\taggCustomer.fees_curr,\n\taggCustomer.fees_usd,\n\taggCustomer.pnl_curr,\n\taggCustomer.pnl_usd,\n\taggCustomer.duplicated_pnl_curr,\n\taggCustomer.duplicated_pnl_usd,\n\taggCustomer.swap_curr,\n\taggCustomer.swap_usd,\n\taggCustomer.contract_usd,\n\taggCustomer.rbonus_curr,\n\taggCustomer.rbonus_usd,\n\taggCustomer.cancelled_bonus_curr,\n\taggCustomer.cancelled_bonus_usd,\n\taggCustomer.pending_bonus_curr,\n\taggCustomer.pending_bonus_usd,\n\taggCustomer.fixed_balance,\n\taggCustomer.fixed_balance_usd,\n\taggCustomer.negative_balance_fix_curr,\n\taggCustomer.negative_balance_fix_usd,\n\taggCustomer.refund_curr,\n\taggCustomer.refund_usd,\n\taggCustomer.education_deposit_curr,\n\taggCustomer.education_deposit_usd,\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\n\taggCustomer.balance_after_curr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\n\tb.balance as CurrencyBalance\nfrom\n\t(\n\tselect\n\t\tt.*,\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\n\t\t\telse @netdepositcurracc := @netdepositcurr\n\t\tend as NetDepCurrAcc,\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\n\t\t\telse @netdepositusdacc := @netdepositusd\n\t\tend as NetDepUsdAcc,\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastab < 0\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\t\telse @RealABAccHelp := @RealAB\n\t\tend as RealABAccHelp,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastabusd < 0\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\n\t\tend as RealABAccHelpUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\t\telse @realreal := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\n\t\t\telse @realrealneg := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\telse @realrealusd := @RealABUsd\n\t\tend as RealAccountBalanceAccumulatedUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\t\telse @RealABUsd\n\t\tend as RealABDiffUsd,\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\n\t\t\telse @realpnlcurr := @realpnlcurracc\n\t\tend as RealPnLCurr,\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\n\t\t\telse @realpnlusd := @realpnlusdacc\n\t\tend as RealPnLUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\n\t\t\tend as education_deposit_total,\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\n\t\t\telse @eligible end as EligibleDiffCurrency,\n\t\t@lastreal := @realreal,\n\t\t@lastrealneg := @realrealneg,\n\t\t@lastrealusd := @realrealusd,\n\t\t@lastab := @RealABAccHelp,\n\t\t@lastabusd := @RealABAccHelpUsd,\n\t\t@lastId := t.id,\n\t\t@lastrealpnlcurr := @realpnlcurracc,\n\t\t@lastrealpnlusd := @realpnlusdacc,\n\t\t@lasteligible:= @eligible\n\tfrom\n\t\t(\n\t\tselect\n\t\t\tbrand.name as site_name,\n\t\t\tcast(brand.id + 1000 as char) as site_id,\n\t\t\tb.id,\n\t\t\ta.id as tr_id,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\n\t\t\t\telse a.created_at\n\t\t\tend as created_at,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\n\t\t\t\telse date(a.created_at)\n\t\t\tend as 'date',\n\t\t\tb.user_id,\n\t\t\td.code as currency,\n\t\t\ta.origin_type,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend as YearMonth,\n\t\t\tcase\n\t\t\t\twhen d.code = 'USD' then rates.USD\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\n\t\t\tend as rate,\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\n\t\t\ta.balance_after as balance_after_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\n\t\t\t0) as deposit_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\n\t\t\t0) as deposit_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\n\t\t\t0) as cashback_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\n\t\t\t0) as cashback_usd,\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\n\t\t\t0) as withdrawal_curr_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\n\t\t\t0) as withdrawal_usd_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_usd,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) as fees_curr,\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) as fees_usd,\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\n\t\tfrom\n\t\t\ttransaction_record a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount,\n\t\t\t\ta.realized_at\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 1) rbonus on\n\t\t\trbonus.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 0\n\t\t\t\tand a.status = 'approved') pbonus on\n\t\t\tpbonus.id = a.id\n\t\tinner join trader b on\n\t\t\ta.trader_account_id = b.default_account_id\n\t\tinner join trader_account c on\n\t\t\tb.id = c.trader_id\n\t\tinner join currency d on\n\t\t\tc.currency_id = d.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand coalesce(d.name,\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\n\t\t\twithdrawals.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tor coalesce(d.name,\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\n\t\t\twithdrawals_cashback.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tand COALESCE(b.psp_reference_id,\n\t\t\t\t'') <> 'CH SR Cashback'\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\n\t\t\tdeposits.id = a.id\n\t\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tb.status = 'completed'\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\n\t\t\teducation_deposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tor COALESCE(b.psp_reference_id,\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\n\t\t\tcashbacks.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\n\t\t\twithdrawal_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 8\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\n\t\t\tovernight_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\n\t\t\tinactivity_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tswap as swaps_curr,\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\n\t\t\tfrom\n\t\t\t\ttrader_account_position a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id) swaps on\n\t\t\ta.id = swaps.ftr_id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t1.1448 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3108 as GBP,\n\t\t\t\t'2019-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1376 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3263 as GBP,\n\t\t\t\t'2019-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1224 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3021 as GBP,\n\t\t\t\t'2019-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1214 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3038 as GBP,\n\t\t\t\t'2019-04' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1197 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2637 as GBP,\n\t\t\t\t'2019-05' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.136 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2691 as GBP,\n\t\t\t\t'2019-06' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1071 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2152 as GBP,\n\t\t\t\t'2019-07' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1009 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2157 as GBP,\n\t\t\t\t'2019-08' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0899 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2287 as GBP,\n\t\t\t\t'2019-09' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1157 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2937 as GBP,\n\t\t\t\t'2019-10' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1019 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2928 as GBP,\n\t\t\t\t'2019-11' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1124 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3351 as GBP,\n\t\t\t\t'2019-12' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1095 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3205 as GBP,\n\t\t\t\t'2020-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1089 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3181 as GBP,\n\t\t\t\t'2020-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.13513 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.30362 as GBP,\n\t\t\t\t'2020-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0945 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2582 as GBP,\n\t\t\t\t'2020-04 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1115 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2349 as GBP,\n\t\t\t\t'2020-05 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1234 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2389 as GBP,\n\t\t\t\t'2020-06 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1772 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3087 as GBP,\n\t\t\t\t'2020-07 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1938 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3364 as GBP,\n\t\t\t\t'2020-08 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1819 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3163 as GBP,\n\t\t\t\t'2020-09 ' as ym) rates on\n\t\t\trates.ym =\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tsystem_currency_vol\n\t\t\tfrom\n\t\t\t\ttrader_account_position) contract on\n\t\t\tcontract.ftr_id = a.id\n\t\tinner join brand on\n\t\t\tb.brand_id = brand.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t113 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t178 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t431 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t444 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t667 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t669 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t719 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t722 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t725 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t728 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t730 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t739 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t3 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t742 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t4 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14017 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14185 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t15286 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t17222 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18557 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18633 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t51094 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t53021 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t55189 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56011 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56598 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t58533 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59217 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59564 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59921 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59936 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59940 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59976 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t60973 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62255 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62602 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64700 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64903 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66341 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66653 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t67606 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68025 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68732 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69281 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69501 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t70036 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t71348 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t73585 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t74087 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76808 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76830 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77591 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77992 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t78569 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79158 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79751 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79776 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79861 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80148 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80149 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t81789 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t82187 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83126 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84647 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84882 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84994 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t85474 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86488 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86959 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t87442 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88286 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88547 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88580 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88608 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88934 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88957 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88960 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89028 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89048 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89527 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t90983 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91231 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91599 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92083 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92119 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92272 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92436 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92529 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t93156 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t94765 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95003 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95417 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95533 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95552 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95696 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96039 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96082 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96442 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96444 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96903 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97559 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97715 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98608 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98799 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98801 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98939 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98941 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99276 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99382 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99383 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99943 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101045 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101071 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101252 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t141562 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142017 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142046 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142054 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142060 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142077 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142082 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142264 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142430 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142628 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143897 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143985 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144173 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144779 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t146491 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147091 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147685 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148023 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148087 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149446 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149654 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t150882 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151089 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151363 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151386 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152005 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152069 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152804 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153023 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153576 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153588 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153631 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154646 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154692 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155297 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155382 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155827 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156184 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156235 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156868 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t157794 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158445 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158887 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159205 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159555 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159821 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160010 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160727 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160963 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t161450 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162530 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162532 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163044 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163285 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163535 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163689 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164246 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164829 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164864 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164909 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165119 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165178 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165335 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166717 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t7 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166741 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168116 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168721 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168736 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t169843 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\n\t\t\tduplicated_transactions.origin_id = a.origin_id\n\t\t\tand duplicated_transactions.brand_id = 7\n\t\twhere\n\t\t\tb.is_test = 0\n\t\tgroup by\n\t\t\t1,\n\t\t\t3,\n\t\t\t2,\n\t\t\t4,\n\t\t\t5,\n\t\t\t6,\n\t\t\t7,\n\t\t\t8,\n\t\t\t9,\n\t\t\t10,\n\t\t\t11,\n\t\t\t12,\n\t\t\t13\n\t\torder by\n\t\t\t3,\n\t\t\t4,\n\t\t\t5 asc) t\n\tinner join (\n\t\tselect\n\t\t\t@lastab := 0,\n\t\t\t@RealABAccHelp := 0,\n\t\t\t@lastRealABAaccHelp := 0,\n\t\t\t@lastId := 0,\n\t\t\t@realreal := 0,\n\t\t\t@realrealneg := 0,\n\t\t\t@lastreal := 0,\n\t\t\t@lastrealneg := 0,\n\t\t\t@RealABUsd := 0,\n\t\t\t@lastabusd := 0,\n\t\t\t@RealABAccHelpUsd := 0,\n\t\t\t@realrealusd := 0,\n\t\t\t@lastrealusd := 0,\n\t\t\t@netdepositcurr := 0,\n\t\t\t@netdepositcurracc := 0,\n\t\t\t@netdepositusd := 0,\n\t\t\t@netdepositusdacc := 0,\n\t\t\t@realpnlcurr := 0,\n\t\t\t@realpnlcurracc := 0,\n\t\t\t@lastrealpnlcurr := 0,\n\t\t\t@realpnlusd := 0,\n\t\t\t@realpnlusdacc := 0,\n\t\t\t@lastrealpnlusd := 0,\n\t\t\t@currentrate := 0,\n\t\t\t@education_deposit_total := 0,\n\t\t\t@eligible := 0,\n\t\t\t@lasteligible := 0) v) aggCustomer\ninner join (\n\tselect\n\t\ta.id,\n\t\tb.name\n\tfrom\n\t\ttrader a\n\tinner join country b on\n\t\ta.country_id = b.id) co on\n\tco.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.id) as FTDInd\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) FTD on\n\tFTD.id = aggCustomer.id\n\tand FTD.FTDInd = aggCustomer.tr_id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.created_at) as LastDepDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MaxDep on\n\tMaxDep.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.open_at) as LastTimeInvestment\n\tfrom\n\t\ttrader_account_position a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1) MaxInv on\n\tMaxInv.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.created_at) as FTDDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MinDep on\n\tMinDep.id = aggCustomer.id\nleft join trader_account b on\n\taggCustomer.id = b.trader_id\norder by\n\t1,\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e2a",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "719a9652-1f75-49df-af94-9ba354ac4499",
            "fullname": "MySql:9830f89e-c434-4b21-8b69-10a54596990b",
            "type": "extract",
            "name": "9830f89e-c434-4b21-8b69-10a54596990b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "abcc2754-f373-4c80-80a5-4145c6a946f8",
                        "id": "tq_D8ZCjcLt9",
                        "name": "TradeTheBit_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2504d6fa-fc8f-4241-9cbf-3e2b5084fb32",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "589e3d71-0486-4a68-9232-f4a3de76414e",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88c82b9c-0865-491c-bdfb-1aab83190747",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16835f50-0c48-4243-bd83-9be3b96709d2",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffbb87b6-b5c2-4eb1-a02b-b51250b9e24e",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c1f4f6a-c50a-498e-8b38-5a11e4af729a",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "87acd691-713a-4c7f-8d4c-0a5125931076",
                        "configOptions": {
                            "importQuery": "select\r\n\t`date`,\r\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\r\n\tcode,\r\n\tsite_id,\r\n\temployee_key,\r\n\topen_pnl\r\nfrom\r\n\t(\r\n\tselect\r\n\t\topen_pnl_per_day.*,\r\n\t\tcase\r\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\r\n\t\t\telse last_day(`date`) end as eom_date\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\t`date` - interval 1 day as 'date',\r\n\t\t\t\tc.code,\r\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\r\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\r\n\t\t\t\tsum(open_pnl) as open_pnl\r\n\t\t\tfrom\r\n\t\t\t\topen_pnl_daily a\r\n\t\t\tinner join trader_account b on\r\n\t\t\t\ta.trader_id = b.trader_id\r\n\t\t\tinner join currency c on\r\n\t\t\t\tb.currency_id = c.id\r\n\t\t\tinner join trader d on\r\n\t\t\t\ta.trader_id = d.id\r\n\t\t\tgroup by\r\n\t\t\t\t1,\r\n\t\t\t\t2,\r\n\t\t\t\t3,\r\n\t\t\t\t4) open_pnl_per_day) eom_pnl\r\nwhere\r\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e2c",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6tIYtFHDx4PVY74RHYbsI6IhvMp8sxqqBTdleDWDyt2e+Fyk3LcoEnGSq9Vlhg0xsd3y74BZLzC/tlv2s7a0hSsdYCs79vBVJyd5U3QQcpa+nUzjpMgHOGIHzjGpciIIMnNVFTvZoHUexzM9auLhAvlkGn+ldc2l33OfdgtL1+KR",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "72a9da29-6740-44de-91fd-48f0ee04e9fb",
            "fullname": "MySql:7cdc29f1-cda5-443f-b2f3-53ec359cdc42",
            "type": "extract",
            "name": "7cdc29f1-cda5-443f-b2f3-53ec359cdc42",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4d6e055f-e4cf-4023-845b-e6bc410c104c",
                        "id": "tq_qbl6PpBD3",
                        "name": "Chelsea_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "41aa1f78-46c1-4046-8513-4d950a9d68a6",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3017641e-6905-4892-9157-dbede1e286b9",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "266cfd2e-e59a-47f9-b5bd-495bb4a5acbf",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d2d9b99-810b-4bce-8037-eae0a6dee0e7",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee0adf2d-7987-4563-af40-34aee6368329",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98e95a9a-5c7d-4c2e-9a25-793f3639bfff",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "cf0e5efe-7fc6-42b2-980a-e364f9c37145",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e2e",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lmoVQsTevINebgL5jFjt37tZHVE1yfCNBl6wIlYq6wI7NUggy3EK86zDSbM4Fw27FcQ7WJjO+t052mJVx7AZ+Z6gWRvGvZ4n1PPPLo5KaSvMstq72ErNzPegcuzwKce1NBllSBZUAXHjSilY0GlglY61i6z48l5MvN5HzcxxLj8",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "73aba339-f8d5-4a20-8971-e82a69c4ff31",
            "fullname": "MySql:27f66076-3f24-457f-b01b-5be4fdb66600",
            "type": "extract",
            "name": "27f66076-3f24-457f-b01b-5be4fdb66600",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "95a03c85-5268-4697-8a09-b050d0f5053f",
                        "id": "tq_VmCzfHFtY",
                        "name": "BitfinityFX_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "98bf6bff-a395-41bd-9435-cc77828a4fa0",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8cc2a8d-2162-4097-8941-69a9078f3984",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "229fb7bb-5bbb-45be-99d4-752213b96606",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c7633d0-f34e-49eb-8025-f4dea5e53dca",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4561a3e5-feb8-4bae-b769-5ede33550d4b",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7143ecbc-c621-4845-8cca-d0437e96e5b5",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cbd25c3e-af26-4c3d-97fa-5accb8a950c3",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b31bcfb2-f31c-407f-892b-47b33982bcf6",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "edcae89a-e820-4764-8611-6d9b03103aa1",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4fc4eab1-1e85-4bfa-91a8-b84d6fe3232b",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cf0561f-2753-43c0-bcd4-9781754b5634",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9578da1a-f802-4ae7-b331-88133b995587",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 24,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a71dd427-c9b7-4d12-9e21-87b853289412",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a70a16c-36dd-4de2-969f-86c19f864ccf",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b47c1cb-31c4-48d2-827b-5506cda7417b",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c714fa59-a65a-4b68-bd78-6622df273a38",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d2e5d07-d3bc-4cbe-b022-f9a4355d20f1",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81f84db2-fdab-4dde-9e3b-5c603932d5ca",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c65ffa35-be6f-4cd5-a1ef-dd5dbbb2ae7d",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e724abe-adeb-4d09-8df8-84cc16fca01b",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f6b2281-70a1-49dc-8064-91f01ad70337",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72b02455-29e0-4227-9531-c6bf6470f865",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2d5f9ba-2dde-4280-afb5-142810368e1f",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6a7d22a-d3a7-41ad-8da0-2b8418efa483",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc0019de-e659-46da-86d1-cbdb1f93a229",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f7f20e1-e1e9-40a0-a982-abb13bcdcbd4",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3eabfb26-9661-4b47-82e8-250f3080232d",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d57d6326-f212-49ea-9f1b-e7fd83df07b2",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "89ccff98-df06-457b-a30d-19824bd92fa7",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79de663c-c1f9-48c3-a161-cd8fd4c4cf56",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0170a2f-9bc9-47ff-8db1-ffb6f1e6757b",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a37c736-9a61-49e4-86b0-bd4687e48a7c",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f2bb4ef-4a74-4926-b8c8-6bae4ff7d496",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9040a186-8e2e-4a9b-a366-e33e3fd50bdb",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9512ee6b-2ba2-4804-9c64-edff60c1277c",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7792b51c-df1a-4c21-a5c2-31c2b139710e",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c256daf7-fb1d-4cd0-89be-08a20d2c1a5a",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0d159d2-422c-4793-863f-e30f0262d3d7",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bc242b8-f94c-4fbd-8a03-f03caee1bbd9",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96d42f77-570d-4508-ba09-de2608991cc9",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ad0b256-9db5-405a-900a-09a1a0869422",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d533838-c784-471e-ab54-7df82a74be80",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23a37f67-5572-4b39-b33b-dce6dd72e1bb",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1fcf3bb-94f2-4b1e-b27c-3b615d652f71",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccb7ebea-89a0-4fee-a197-68d7acba830d",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "04bdcf8e-7395-4bfa-9af8-9c3b72b9c1ae",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "464af0c4-6255-4972-ace6-a3b6eecc6097",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f754af99-c012-477c-9a0b-baa6664de8c1",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2dbb205-02c2-4207-8237-6b39a91bcf8e",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05e7ab4f-b9d7-4c35-9f5b-cdcabb6c31d1",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a403d500-08dd-41ae-80e5-be2a7a90cd38",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab196ec6-dcf4-4dac-906b-634e7e9167e9",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa8b4efd-6db1-422d-ac93-3a11312e319f",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be5636cc-e0ed-41a7-856a-caebbfd54314",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b54058dd-bb90-4612-af48-392b8e22602b",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dcdd354d-623a-4a44-8446-e4775067bf62",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4cd8e41f-b387-40ed-99cc-4cfff1e9faf8",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4e9b899-8731-4548-89f0-420580804614",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b683c265-12cd-4c8c-bf13-862cc0a59e05",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abdd86e1-211e-42cb-aa7e-bb41fe374289",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e778032f-bf65-4ccb-a17b-3aeee1589872",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d53091c-627a-481a-aed7-bf05d55c1ae6",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31ac8145-5f22-4713-8fce-384cfa9708a5",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c693acfd-cbe1-43a3-8b27-85b2257c0992",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ab41771-8bf2-49bb-a3a6-6ed60af05adb",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91b603c7-33ed-4dca-96f2-fbc8a3114683",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c53b73b-e62c-4fba-bb57-794e634cf4bc",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "974ebaec-cf52-4a1e-af2d-2ac3c938dd49",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "291e2f63-901a-477d-92e0-864658043ce5",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4351595f-8182-4c52-93e3-9ff9155f060d",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0bb48ad-609b-447a-8bb8-40963636971e",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9540cee-c98e-4707-8ffb-018c1713209d",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27eb89c9-fdf3-47a0-8677-af7394c6ccc6",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0b89ea5-6978-442c-be5c-e7fdaea89bfb",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5e3519e-b1f1-465c-bec1-c9e5c798c452",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76ac6048-daf7-4999-8192-efab6928833d",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ca1f576-8c1f-463c-a62f-fd99437e9760",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40da5795-b8bf-47e1-9913-6fd81096ffcf",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8f0273c-bc0e-4a88-a23b-82f8f6d03c39",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "0e35c7aa-78c0-4e8b-943b-52b2e55c636d",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\tselect\r\n\t\tt.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand coalesce(d.name,\r\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tor coalesce(d.name,\r\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0945 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2582 as GBP,\r\n\t\t\t\t'2020-04 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1115 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2349 as GBP,\r\n\t\t\t\t'2020-05 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1234 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2389 as GBP,\r\n\t\t\t\t'2020-06 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1772 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3087 as GBP,\r\n\t\t\t\t'2020-07 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1938 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3364 as GBP,\r\n\t\t\t\t'2020-08 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1819 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3163 as GBP,\r\n\t\t\t\t'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 6\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\tselect\r\n\t\ta.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619517f6fd9249002de3c53a",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8C2q0mVY+o2WF4+UVAyIhGiWhSY3+Y93kyI+zrKj2Bg5HiBiNB45Ta2GGPAsEoYp8/7dK0B1NeCzhErO6Xxg3c338i0MevnkC9Yi9QGlRnh1xn5Kjp5TuCxX28iusyU+paJ5wPXzkAPGHPDNhGasnoxvMsxipUWeTclTSatITjv9eQNNH4tFpXr1gskkcrIfglENUveS4Og+oLFLIuz1xQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "79d04022-b895-4c30-b795-22b2c77a41d9",
            "fullname": "MySql:53c50e31-61f2-4a2b-a1af-34c598dbe60a",
            "type": "extract",
            "name": "53c50e31-61f2-4a2b-a1af-34c598dbe60a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1b378cd5-ea25-418d-a33a-36ce50c7e888",
                        "id": "tq_91la0mtim",
                        "name": "MarketCG Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2b55aeef-d069-4b01-a48f-1889e745dc6e",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "20aa2fcf-5ba3-47bb-add3-458b37683074",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d35c6ba8-0a76-4a9f-a173-51391af6b004",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b360e523-2509-495c-8c71-c1f2d52ea9d1",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc0dce1e-25ee-47ed-9ca8-904a3d5281f8",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b6bf4d1-e61f-4aac-986d-390cde748ae9",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c95b2fd-042c-4e6b-86cb-4d250cee79bd",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5dbc5158-fc27-4a14-aef5-75d09531897d",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c4ca536-45f5-4df0-80db-ef21f85d2f4e",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e90a5ee8-072f-4aa5-82da-4089f92ec28c",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c4594b73-c74b-4286-bb6c-0cbbd6f7c1c3",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat(1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d3896780f2002c37e9e2",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NAc1gMa0VBzZ9QDyN4mgrYY4RdbmC5kaicIuBKtyLx50isgKI42gk0NUhwNAOs/C//rfCcf26YrMKFuhFjde0RcvkzPGcYE8h+sUnaaT/8VA==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "7a38b09a-8648-4462-b1a9-f113081b0d66",
            "fullname": "MySql:dd9112b0-e90b-4aa3-9e00-7e3eaccfcd74",
            "type": "extract",
            "name": "dd9112b0-e90b-4aa3-9e00-7e3eaccfcd74",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "31d29b47-6787-4847-8196-8ecde0a06a2c",
                        "id": "tq_YcULFDAMC",
                        "name": "YorkEmployees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f3cb3e4b-7459-4463-9fab-ab6b5a9223b8",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88e9ff5e-c527-4937-9cc6-6076288cf6b6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1615b888-c16a-43ec-bf86-2d831cc78e2b",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "795e5162-f43b-41af-9ee6-d00ee895e6ef",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "274770b9-c3f1-4527-919f-30884830052e",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc884cb2-60dd-478f-a55d-886e60ef59a8",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce0ac9e5-62bd-4a42-86ba-a2e57c57938b",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "971bdfab-998b-45b9-a84f-658f12607447",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9095239b-e6b0-4ed6-8764-3ed0cf6fc6f8",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a668b751-324c-49e6-a4be-8190e4bc082b",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "23ee8cce-48a7-40cd-afce-48969304ae5e",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tCOALESCE(1000 + brand.id,\r\n\t1001) as site_id,\r\n\tconcat( COALESCE(1000 + brand.id, 1001), 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\tuser_groups.id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d1ba6780f2002c37e9d8",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiUuE2nWqYtNik98wCcYKjHVFDivbJrt4nOjZsBy+hIwTw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "7aafe128-5884-41e3-bb2e-492e4d1058e6",
            "fullname": "MySql:a0dc7c66-1548-41a3-804f-3be6d6a6507e",
            "type": "extract",
            "name": "a0dc7c66-1548-41a3-804f-3be6d6a6507e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "02d9491f-4362-4d3a-8729-1f8c1e3b08f3",
                        "id": "tq_2Kiw61txL",
                        "name": "365TradingFX_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8aba3a17-78b0-4c79-a5ec-24e57c8b1c06",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f8dc07d-ee14-4ffb-834e-47c234a919f8",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb1fa47e-817c-4ba4-a512-381a0e8c9cd5",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24440c55-2ce2-45dc-887a-18074a4c22e6",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1427e4f9-37db-4524-bf40-567b013e9d05",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41002732-5522-44ee-83a8-0f0893b876e1",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c634abf1-1043-44e1-9f8d-ce5e18fc3db9",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3743a8b5-5b18-49b8-9817-fdec9bbfa8e0",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9151a1d1-84dc-4489-bf37-f2a377383318",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73ca6124-d7a8-4de3-9307-93094f8662d8",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abb0557e-9cc5-4c89-946e-711d851a732c",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "176df441-739c-4352-b502-032b217f348b",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56a57b84-8da5-40d8-84fe-abd4ad8c75bb",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b9bb052-b11a-48e9-9706-1dbc4263234a",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b02537a-55c7-4187-bdd0-7be44d8763cc",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ab6a027-8b78-4c6f-b3bb-0b9713f1a17c",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "effb575c-e24f-40a4-8335-b80b6ddb2818",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0052c0b9-e63e-4c51-b42b-0b5738a881f3",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0301fd0-16f0-4e53-8013-db6fa3c0c291",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ee921e6-2a3c-4c9c-b00c-9c75551cea41",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f040d70-39b4-4b94-a262-223c1460ec4d",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54e14c9c-4209-4480-a5c7-61497418e1f5",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac7b1fc5-51db-4c3d-bc07-8257be391c09",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0de07484-f8c1-440c-b121-08985181de4d",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3c96d68-8691-4200-90d4-a9e29dc30d33",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d475587-8677-4264-b8f3-d2ef1b0d16ca",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29f620a8-4cae-4ff8-a687-edad6eeecfa7",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa516526-0d70-460d-80db-63269d8d7af5",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6521c484-7a31-4ae0-adf8-b9c397b2490d",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "507a9bf6-5418-41de-bcdb-a0e14d2c8f1e",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4e5141b-e199-402e-aa43-9e15c7b65dc9",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab6a46cb-82ba-43fe-971b-eac3b4667778",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d37e3ac4-03ad-491e-8b88-d7f6519f5f50",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "508ed606-b9f8-406c-b036-c3d07673400f",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5881b665-3281-4a2c-960a-1498c5e2a798",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8454743-e223-4203-9f9d-72690c8c47b5",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2b00749-80e7-4e0a-a1fd-d3dbc026a382",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ef0f213-baff-45c6-a388-5bc54407792b",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3591491-9e0e-415c-9584-500a1f7d6306",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62eebc81-7ae1-4c01-9d96-4041ba7c329e",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cdcb2039-a26e-43de-80a5-3e3a9ce56875",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58f15e3c-98af-4b87-bf67-77e98e5a7a94",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "126d6203-ce34-452a-a569-e10494a77538",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f0947f0-c123-40f0-9fb7-bd8358ba62c8",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f252dff3-e5f9-4611-8348-4e00f714b87e",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6623a974-0c28-4776-9dc3-afa262305810",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21d0aae4-9cbf-4a4b-98da-a9d175004598",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e34e5d2a-8caa-48b4-8919-de1910c4f948",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f7d0e103-6644-428b-b7bb-4926ad5fbae8",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1a15ed9-e0aa-42b0-b6ec-ebf73ad37240",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45caee90-4fea-43af-bfe0-2219a66274b4",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93b2389a-a0f1-42f3-952d-129a85ef70f8",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82ce1194-505a-4de8-b250-12fdebd9d185",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e70a64f-fdb9-4c14-9bd4-2d5f0dce7efe",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3219b6e0-ff54-45d5-af2e-9c6d461e82ad",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3259b1b-c67f-4df8-8e83-0aa1f581b733",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f0d3ea3-f7f3-46a7-af4d-f06227baac15",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "102f38b7-0932-4b08-b2fa-8dae868c2695",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01b8a539-1166-48f7-a175-538d4a0bf985",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b1b8912-5f1b-4b5f-afd8-93738a69b710",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45576112-f539-4a56-863d-a965c4341a3d",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c10214d-a7d5-41ce-af40-375c697c771e",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff54e447-3662-4147-b1bd-d7af7ea47ba3",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3221b703-502a-481e-8fb2-11e89c8951ed",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f80deaa4-aa3f-4101-bcea-c20e60b9e38b",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60bacbfb-39b5-4316-8377-f1544cc65c23",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed531969-2769-480c-b933-848982f268ca",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebe6a4d9-dc16-4982-8588-d24b47c1a28d",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79bee08e-9eaf-41f0-b115-09e9e612239d",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c15b0f4-1a1e-4840-a676-efcb80c19574",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cae7f242-e678-4d91-8a18-230f8b485c67",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2127221b-e1d6-446f-a919-f78e5e77b063",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba1c7788-46e9-41c3-9900-8a0d9113a0c7",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7041fa20-d586-4f0d-837e-d251a5367ff9",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "107f6361-e69e-4610-93dc-226b734f39b9",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01e63053-fb0d-4f6f-9f65-03293f2aab4a",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5bef5bdf-dcc0-4fa2-80f2-4b192f71c4dd",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72b71818-edaf-45dc-b95a-747e002db75d",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2962c585-6d9b-42ee-948e-ba3eeb1f2a32",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "72b71818-edaf-45dc-b95a-747e002db75d",
                                    "type": 6
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "ef5cce85-1a4d-4dae-a912-b2edc917d6d6",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\tselect\r\n\t\tt.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,68,76)\r\n\t\t\t\tand coalesce(d.name,\r\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,68,76)\r\n\t\t\t\tor coalesce(d.name,\r\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,68,76)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,68,76)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0945 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2582 as GBP,\r\n\t\t\t\t'2020-04 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1115 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2349 as GBP,\r\n\t\t\t\t'2020-05 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1234 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2389 as GBP,\r\n\t\t\t\t'2020-06 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1772 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3087 as GBP,\r\n\t\t\t\t'2020-07 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1938 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3364 as GBP,\r\n\t\t\t\t'2020-08 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1819 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3163 as GBP,\r\n\t\t\t\t'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 6\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\tselect\r\n\t\ta.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e34",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6h2kEQfj06tSGpyh+xEzmk6Iq8paTu3ip6/rB+N1MFIYN59/xJKyq6s2pJ06bUpzhAANrOSGSl8zpPlUO8IwiG8A7d+Vz+KCoZhjqP9L+KHT5GfaypnOnu+badv06TGAXIJlaegbboPbyBtw46kZTRfJ2bJyakx/q48snRhZp8Cm",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "8077eb62-a7cf-4ff8-aec3-d792082e0ff3",
            "fullname": "MySql:8f027247-8920-4571-986c-30bb4a398f4b",
            "type": "extract",
            "name": "8f027247-8920-4571-986c-30bb4a398f4b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "177dee83-f774-452c-9386-46d43351591e",
                        "id": "tq_OBnMafPt0",
                        "name": "BitfinityFX_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "54f0b4b0-e94e-43c3-8338-7bc25701c1ee",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1fb49e5-7b09-4521-b426-3bf7d19e1bdd",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffa9614d-8457-4947-9d2e-3f7c1adb53d2",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47dcab8d-6fda-432a-84ea-7fbe70c20e25",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "75f5d1a1-59f5-4f40-942e-b98780855b26",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2df3d9a7-f416-40ef-bb62-332483032dc8",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "93f500bb-77ce-4319-823c-6346761a038b",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619516f2fd9249002de3c52d",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8C2q0mVY+o2WF4+UVAyIhGiWhSY3+Y93kyI+zrKj2Bg5HiBiNB45Ta2GGPAsEoYp8/7dK0B1NeCzhErO6Xxg3c338i0MevnkC9Yi9QGlRnh1xn5Kjp5TuCxX28iusyU+paJ5wPXzkAPGHPDNhGasnoxvMsxipUWeTclTSatITjv9eQNNH4tFpXr1gskkcrIfglENUveS4Og+oLFLIuz1xQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "8233df57-5ab7-449f-8640-2e5fb94e56e4",
            "fullname": "MySql:3d071e61-2765-4deb-9a18-579c66fe58bb",
            "type": "extract",
            "name": "3d071e61-2765-4deb-9a18-579c66fe58bb",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d84aa505-edf7-4981-99f8-2fe8f8ae1c4f",
                        "id": "tq_Yx7E9i9V1",
                        "name": "WinGroup_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "237ca246-bca0-4f6e-81c1-80db4a2469cc",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38395083-3773-4ba3-ad82-7bbbd1d2386c",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f6a5927-dd13-4ed6-896e-d0d2293fb262",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "adf5b783-2ca6-41e3-99b6-2fb49cf2d69e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0172aa3-5d72-44d0-a0c0-168ce9b27dc1",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13e3448e-4dce-4b98-b634-8660019023a7",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "080bf4a5-fe87-434e-ac75-178b14108539",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e36",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oISZYo/jnBBiedN+eL7iEVmicVz5zdJvnkTnDpGXX+jM3jkWwQH1GDq4EovBiX29q5VS6x+Z07G9BXJJzwZT+nGfZWcVbeOv81/ipF/iAkEydLA1qCoilSMT7qJlQub6SW5eExTvv+75JqKLkCs/jkkYjDgSKl1b0MSB6ZMr8WT",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "830d4746-9c3a-4cdf-b6e5-fae353e8f18d",
            "fullname": "custom-830d4746-9c3a-4cdf-b6e5-fae353e8f18d",
            "type": "custom",
            "name": "custom-830d4746-9c3a-4cdf-b6e5-fae353e8f18d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9e74eddc-4972-46b0-a406-c87a30391a10",
                        "id": "OpenPnl",
                        "name": "OpenPnl",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "d0fd18b9-7988-4324-acfe-7767802002bb",
                            "expression": "select eom.*,\r\n'-100' as employee_key,\r\ncase when eom.code = 'USD' then open_pnl\r\nwhen eom.code in ('EUR','GBP') and isnull(Rates.[rate]) then eom.open_pnl * Ratesa.rate \r\nelse eom.open_pnl * Rates.[rate] end as open_pnl_usd,\r\neom.[date] as date_2\r\nfrom\r\n(select Prime_open_pnl.*\r\nfrom [Prime_open_pnl] \r\nunion all\r\nselect York_open_pnl.*\r\nfrom [York_open_pnl]\r\nunion all\r\nselect Market_open_pnl.*\r\nfrom [Market_open_pnl] \r\nunion all\r\nselect Ivy_open_pnl.*\r\nfrom [Ivy_open_pnl] \r\nunion all\r\nselect FXVC_PnL.*\r\nfrom [FXVC_PnL]\r\nunion all\r\nselect [Wealth_open_pnl].*\r\nfrom [Wealth_open_pnl]\r\nunion all\r\nselect [Arrow_open_pnl].*\r\nfrom [Arrow_open_pnl]\r\nunion all\r\nselect [AussieTrust_open_pnl].*\r\nfrom [AussieTrust_open_pnl]\r\nunion all\r\nselect InfinityCapitalg_Open_PnL.*\r\nfrom InfinityCapitalg_Open_PnL\r\nunion all\r\nselect [365TradingFX_open_pnl].*\r\nfrom [365TradingFX_open_pnl]\r\nunion all\r\nselect TradeTheBit_open_pnl.*\r\nfrom TradeTheBit_open_pnl\r\nunion all\r\nselect NostraCapital_open_pnl.*\r\nfrom NostraCapital_open_pnl\r\nunion all\r\nselect TheBPCA_open_pnl.*\r\nfrom TheBPCA_open_pnl\r\nunion all\r\nselect GeniusIG_open_pnl.*\r\nfrom GeniusIG_open_pnl\r\nunion all\r\nselect Chelsea_open_pnl.*\r\nfrom Chelsea_open_pnl\r\nunion all\r\nselect ashford_open_pnl.*\r\nfrom ashford_open_pnl\r\nunion all\r\nselect wingroup_open_pnl.*\r\nfrom wingroup_open_pnl\r\nunion all\r\nselect BendigoCoins_open_pnl.*\r\nfrom BendigoCoins_open_pnl\r\nunion all\r\nselect BitfinityFX_open_pnl.*\r\nfrom BitfinityFX_open_pnl\r\nunion all\r\nselect BigBitMarket_open_pnl.*\r\nfrom BigBitMarket_open_pnl\r\n) eom\r\nleft join [Rates] on [eom].[date_key] = Rates.[date_key] and eom.[code] = Rates.[symbol]\r\nleft join Rates as Ratesa on getyear(adddays([eom].[date],-1)) * 10000 + getmonth(adddays([eom].[date],-1)) * 100 + getday(adddays([eom].[date],-1)) = Ratesa.[date_key] and [eom].[code] = Ratesa.[symbol]\r\n"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5929559f-3e6f-4e1f-8467-617a02ff9c41",
                                "id": "7a240541-f291-40e9-a03a-63f4ea9b0459",
                                "name": "site_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20913230-a57d-44e7-ad70-59fc2ac08224",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8786a449-6601-4522-a7ce-511930205292",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "27cdbc1d-a3f5-48ff-8b70-bf38e199aa01",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "12d91cb5-d863-489d-a0d0-586b0d778335",
                                "id": "date",
                                "name": "date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2eaf4f2e-c4f9-41eb-9c66-be74ff64bdca",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2354dc92-2360-4659-9d24-6784b88a7538",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b682509-96fc-4e85-8b82-29496abf64c0",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33ec7f8f-d879-469d-801c-eedb5a42c35b",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "750ef26a-37a8-4e7b-8e90-53cae585d3d5",
                                "id": "open_pnl_usd",
                                "name": "open_pnl_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ebf28ac1-d923-44e6-94d5-545628deb1be",
                                "id": "date_2",
                                "name": "date_2",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "5b4d4542-dcc6-47ec-a831-6a1d5e6011ab",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "8578729d-f5a9-4cc9-926d-4e970a085979",
            "fullname": "MySql:07c52a6d-419d-4895-ab57-6cb193c9aadf",
            "type": "extract",
            "name": "07c52a6d-419d-4895-ab57-6cb193c9aadf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "66028741-1ffb-4bc3-bef8-39306f2eff17",
                        "id": "tq_AypyPJIGb",
                        "name": "Ashford_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a836250a-53cd-4fc3-b02f-a3f44e2a36d0",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05d52ea7-0b27-49f0-b78e-d3f1293d4a35",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58a64994-5221-438a-9a9d-c4011c571536",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08370561-fe1e-4213-8ab0-81d7d26931d7",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4bc4382c-eeee-4f3c-9b50-4460b468edac",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb177195-bc5c-46bb-b978-b3412440bec0",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30730bbc-fbda-43ea-aae6-35d5a58ee0d5",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44ace81c-918d-4fc0-bb61-fece47e61543",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93188df7-b733-4c65-a692-d1d19c5990f6",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31bd8a41-4cc9-4fbf-a59c-d29daf7cd275",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "388e06cc-1ac5-459a-8a2c-faec8f42ca14",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "107abf84-dd25-4a94-af50-170750f8356f",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "340e8194-3488-4407-a8dc-f74fe452715d",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "264d8eea-49e5-4079-8774-97bddca096e4",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2aefefab-136d-4eae-9147-8b1ae3e1a0fe",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29aed520-cdcf-4d25-9444-a90a1349f885",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f90d34d-684a-44fd-8c19-d1d3a4bc12bb",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "574f1175-8b59-4bbb-bc4d-cf167b1f419a",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f25bfdf-0281-4bd6-b10d-f34d68c63e4c",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a1f08ec-1b83-44b2-be6b-5c41752d6dcf",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc91ae1b-0ca1-4212-b90e-b4128355d9a0",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d58c333d-d8d9-4001-9459-68a08de3b747",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "596632b6-8132-4896-b181-c29d184d66a5",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "552d9dac-97b7-405a-a3cc-eb3a745b5ff3",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d85d5401-b048-4eef-b92a-e3e12572a7b9",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99324a6d-0fb4-4642-9641-b17cd62f093c",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bcf5d645-0a4f-4578-a3b3-278dd639ca33",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88a9a630-1d70-452e-8c1f-f3dbe0eedca6",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da13f9a3-c453-464c-8001-d460de463615",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e066b800-b9cb-45e5-9d30-06ebea52c307",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbd32a7e-2dcd-4555-995f-7f465942026b",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cd1153e-6db3-432b-8737-f04147cc3414",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d12c0cc-8adb-4490-978b-00645488bc53",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c000e3b-c296-4872-8bfc-cf74691c3856",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b6c5a9c-3c8e-4790-9d96-295cb66fdb2a",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb0db851-67dc-45f4-9a93-01f02a52035d",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "adea7980-ac0c-45c5-b7dd-f88e903f1a27",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84569531-2151-470f-ab54-1d3c2827ab35",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24419ea3-3651-44d4-a8cf-4896e5a5b597",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f797e69f-6804-4bcc-932a-ec4ea0b48797",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d3a3938-b974-47cf-9d07-0610f288cd3b",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62562322-2fd6-472f-af4c-3c5731a9ca1b",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a7d82d2-3359-4c9d-9692-18276fe9f411",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56473c29-263a-44f2-9774-900778653932",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c85d868-c502-4a58-99ae-587f6217008d",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce4105e3-c774-49cb-b801-daa02b53eca4",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ece1d1ba-577b-4f33-a42f-cd214d26acb8",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bae29a40-ed03-4d56-b212-2c59c036cb48",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b8a3d15-ca06-4d22-b41b-cc0ac91cd524",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b70b832-0ff8-42d8-98ae-fa70527da031",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15415858-c4e6-4560-9cfc-7aa8367efda9",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ff2383c-5d56-4b7c-a286-33fcfdfaf442",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2dfb0291-74a0-4935-a227-b53a46481442",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c37e45b2-e166-4519-ac3f-50247cf48440",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84fdc095-b667-4bbc-a033-8bbf715ac959",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "766b49ba-2fbf-4cc6-a7e5-ce063f690e8b",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4dc9867d-9afa-4163-aee2-6bb440100bc1",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "770b089c-bbb2-42d6-8e9b-cc8d66951fe5",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98678f07-c926-4480-9cbf-866d11434862",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2daabcac-f3a0-47a8-a1c1-85f7e9c125a5",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "801d8806-4513-4c43-b904-6cee27b72792",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "880dc1ff-da98-40e9-bde8-cb2639729ec9",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1c9d2e9-1537-4040-8691-797c9b347bdc",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79fe08e5-f241-43a6-8acd-fe5a4624ccc0",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "85f24cfe-cc4b-476c-864a-470a0688101a",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e855adf7-bc97-4a4f-88ba-26ef23444efa",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54d3d8fb-e7e1-404a-9c57-fb0f3f2613d1",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bbc3f5e-da05-4794-be9d-514e1fa2eb24",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea0b7704-c236-49e1-b5d5-67290af9293a",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3720a5db-285e-46a3-8287-70ca1db44942",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1627dd50-df20-40d1-aa7c-a5624f23fa0f",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee2b149f-e90a-4a6f-a70e-54abfaad3edc",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5d4dee6-8c42-4ef4-bf80-fd08c45d5e9f",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c492529c-7a83-4c1e-9fa7-13151455958e",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66fb8667-4fd4-4c7c-9968-38004c2c4b16",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aedf00c3-33f2-4e29-b907-7955827f691d",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a693ca7-292c-4691-8d7e-c7fdfc787e92",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8e8643f-d960-4c01-a6ab-8e64f433fea3",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e446bee1-247d-45d2-b6e5-c30629f1198f",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "f1e8bc7f-9d78-49d7-9bd3-2cf26debfd33",
                        "configOptions": {
                            "importQuery": "SELECT\n\taggCustomer.id,\n\taggCustomer.site_name as site_name,\n\taggCustomer.site_id as site_id,\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\n\taggCustomer.customer_fullname,\n\tco.name,\n\taggCustomer.currency,\n\taggCustomer.created_at,\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\n\taggCustomer.date,\n\taggCustomer.YearMonth,\n\tcase\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'GBP' then 1.3\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'EUR' then 1.1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'USD' then 1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\n\tend as rate,\n\tMaxDep.LastDepDate,\n\tMaxInv.LastTimeInvestment,\n\taggCustomer.tr_id,\n\taggCustomer.origin_type,\n\tMinDep.FTDDate,\n\tcase\n\t\twhen FTD.FTDind is null then 0\n\t\telse 1\n\tend as FTDInd,\n\taggCustomer.user_id,\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\n\taggCustomer.deposit_curr,\n\taggCustomer.deposit_usd,\n\taggCustomer.cashback_curr,\n\taggCustomer.cashback_usd,\n\taggCustomer.withdrawal_curr,\n\taggCustomer.withdrawal_usd,\n\taggCustomer.withdrawal_curr_new,\n\taggCustomer.withdrawal_usd_new,\n\taggCustomer.cashback_withdrawal_curr,\n\taggCustomer.cashback_withdrawal_usd,\n\taggCustomer.withdrawal_fee_curr,\n\taggCustomer.withdrawal_fee_usd,\n\taggCustomer.chb_curr,\n\taggCustomer.chb_usd,\n\taggCustomer.inactivity_fee_curr,\n\taggCustomer.inactivity_fee_usd,\n\taggCustomer.overnight_fee_curr,\n\taggCustomer.overnight_fee_usd,\n\taggCustomer.fees_curr,\n\taggCustomer.fees_usd,\n\taggCustomer.pnl_curr,\n\taggCustomer.pnl_usd,\n\taggCustomer.duplicated_pnl_curr,\n\taggCustomer.duplicated_pnl_usd,\n\taggCustomer.swap_curr,\n\taggCustomer.swap_usd,\n\taggCustomer.contract_usd,\n\taggCustomer.rbonus_curr,\n\taggCustomer.rbonus_usd,\n\taggCustomer.cancelled_bonus_curr,\n\taggCustomer.cancelled_bonus_usd,\n\taggCustomer.pending_bonus_curr,\n\taggCustomer.pending_bonus_usd,\n\taggCustomer.fixed_balance,\n\taggCustomer.fixed_balance_usd,\n\taggCustomer.negative_balance_fix_curr,\n\taggCustomer.negative_balance_fix_usd,\n\taggCustomer.refund_curr,\n\taggCustomer.refund_usd,\n\taggCustomer.education_deposit_curr,\n\taggCustomer.education_deposit_usd,\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\n\taggCustomer.balance_after_curr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\n\tb.balance as CurrencyBalance\nfrom\n\t(\n\tselect\n\t\tt.*,\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\n\t\t\telse @netdepositcurracc := @netdepositcurr\n\t\tend as NetDepCurrAcc,\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\n\t\t\telse @netdepositusdacc := @netdepositusd\n\t\tend as NetDepUsdAcc,\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastab < 0\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\t\telse @RealABAccHelp := @RealAB\n\t\tend as RealABAccHelp,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastabusd < 0\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\n\t\tend as RealABAccHelpUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\t\telse @realreal := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\n\t\t\telse @realrealneg := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\telse @realrealusd := @RealABUsd\n\t\tend as RealAccountBalanceAccumulatedUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\t\telse @RealABUsd\n\t\tend as RealABDiffUsd,\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\n\t\t\telse @realpnlcurr := @realpnlcurracc\n\t\tend as RealPnLCurr,\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\n\t\t\telse @realpnlusd := @realpnlusdacc\n\t\tend as RealPnLUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\n\t\t\tend as education_deposit_total,\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\n\t\t\telse @eligible end as EligibleDiffCurrency,\n\t\t@lastreal := @realreal,\n\t\t@lastrealusd := @realrealusd,\n\t\t@lastrealneg := @realrealneg,\n\t\t@lastab := @RealABAccHelp,\n\t\t@lastabusd := @RealABAccHelpUsd,\n\t\t@lastId := t.id,\n\t\t@lastrealpnlcurr := @realpnlcurracc,\n\t\t@lastrealpnlusd := @realpnlusdacc,\n\t\t@lasteligible:= @eligible\n\tfrom\n\t\t(\n\t\tselect\n\t\t\tbrand.name as site_name,\n\t\t\tcast(brand.id + 1000 as char) as site_id,\n\t\t\tb.id,\n\t\t\ta.id as tr_id,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\n\t\t\t\telse a.created_at\n\t\t\tend as created_at,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\n\t\t\t\telse date(a.created_at)\n\t\t\tend as 'date',\n\t\t\tb.user_id,\n\t\t\td.code as currency,\n\t\t\ta.origin_type,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend as YearMonth,\n\t\t\tcase\n\t\t\t\twhen d.code = 'USD' then rates.USD\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\n\t\t\tend as rate,\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\n\t\t\ta.balance_after as balance_after_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\n\t\t\t0) as deposit_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\n\t\t\t0) as deposit_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\n\t\t\t0) as cashback_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\n\t\t\t0) as cashback_usd,\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\n\t\t\t0) as withdrawal_curr_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\n\t\t\t0) as withdrawal_usd_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_usd,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) as fees_curr,\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) as fees_usd,\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\n\t\tfrom\n\t\t\ttransaction_record a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount,\n\t\t\t\ta.realized_at\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 1) rbonus on\n\t\t\trbonus.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 0\n\t\t\t\tand a.status = 'approved') pbonus on\n\t\t\tpbonus.id = a.id\n\t\tinner join trader b on\n\t\t\ta.trader_account_id = b.default_account_id\n\t\tinner join trader_account c on\n\t\t\tb.id = c.trader_id\n\t\tinner join currency d on\n\t\t\tc.currency_id = d.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand coalesce(d.name,\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\n\t\t\twithdrawals.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tor coalesce(d.name,\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\n\t\t\twithdrawals_cashback.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tand COALESCE(b.psp_reference_id,\n\t\t\t\t'') <> 'CH SR Cashback'\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\n\t\t\tdeposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tb.status = 'completed'\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\n\t\t\teducation_deposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tor COALESCE(b.psp_reference_id,\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\n\t\t\tcashbacks.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\n\t\t\twithdrawal_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 8\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\n\t\t\tovernight_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\n\t\t\tinactivity_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tswap as swaps_curr,\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\n\t\t\tfrom\n\t\t\t\ttrader_account_position a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id) swaps on\n\t\t\ta.id = swaps.ftr_id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t1.1448 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3108 as GBP,\n\t\t\t\t'2019-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1376 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3263 as GBP,\n\t\t\t\t'2019-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1224 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3021 as GBP,\n\t\t\t\t'2019-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1214 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3038 as GBP,\n\t\t\t\t'2019-04' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1197 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2637 as GBP,\n\t\t\t\t'2019-05' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.136 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2691 as GBP,\n\t\t\t\t'2019-06' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1071 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2152 as GBP,\n\t\t\t\t'2019-07' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1009 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2157 as GBP,\n\t\t\t\t'2019-08' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0899 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2287 as GBP,\n\t\t\t\t'2019-09' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1157 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2937 as GBP,\n\t\t\t\t'2019-10' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1019 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2928 as GBP,\n\t\t\t\t'2019-11' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1124 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3351 as GBP,\n\t\t\t\t'2019-12' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1095 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3205 as GBP,\n\t\t\t\t'2020-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1089 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3181 as GBP,\n\t\t\t\t'2020-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.13513 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.30362 as GBP,\n\t\t\t\t'2020-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0945 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2582 as GBP,\n\t\t\t\t'2020-04 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1115 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2349 as GBP,\n\t\t\t\t'2020-05 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1234 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2389 as GBP,\n\t\t\t\t'2020-06 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1772 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3087 as GBP,\n\t\t\t\t'2020-07 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1938 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3364 as GBP,\n\t\t\t\t'2020-08 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1819 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3163 as GBP,\n\t\t\t\t'2020-09 ' as ym ) rates on\n\t\t\trates.ym =\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tsystem_currency_vol\n\t\t\tfrom\n\t\t\t\ttrader_account_position) contract on\n\t\t\tcontract.ftr_id = a.id\n\t\tinner join brand on\n\t\t\tb.brand_id = brand.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t113 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t178 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t431 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t444 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t667 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t669 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t719 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t722 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t725 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t728 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t730 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t739 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t3 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t742 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t4 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14017 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14185 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t15286 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t17222 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18557 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18633 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t51094 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t53021 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t55189 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56011 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56598 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t58533 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59217 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59564 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59921 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59936 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59940 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59976 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t60973 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62255 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62602 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64700 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64903 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66341 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66653 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t67606 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68025 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68732 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69281 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69501 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t70036 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t71348 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t73585 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t74087 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76808 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76830 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77591 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77992 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t78569 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79158 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79751 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79776 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79861 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80148 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80149 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t81789 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t82187 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83126 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84647 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84882 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84994 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t85474 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86488 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86959 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t87442 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88286 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88547 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88580 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88608 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88934 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88957 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88960 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89028 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89048 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89527 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t90983 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91231 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91599 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92083 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92119 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92272 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92436 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92529 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t93156 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t94765 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95003 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95417 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95533 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95552 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95696 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96039 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96082 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96442 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96444 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96903 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97559 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97715 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98608 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98799 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98801 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98939 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98941 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99276 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99382 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99383 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99943 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101045 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101071 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101252 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t141562 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142017 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142046 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142054 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142060 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142077 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142082 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142264 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142430 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142628 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143897 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143985 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144173 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144779 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t146491 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147091 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147685 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148023 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148087 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149446 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149654 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t150882 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151089 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151363 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151386 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152005 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152069 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152804 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153023 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153576 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153588 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153631 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154646 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154692 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155297 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155382 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155827 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156184 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156235 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156868 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t157794 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158445 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158887 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159205 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159555 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159821 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160010 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160727 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160963 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t161450 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162530 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162532 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163044 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163285 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163535 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163689 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164246 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164829 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164864 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164909 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165119 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165178 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165335 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166717 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t7 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166741 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168116 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168721 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168736 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t169843 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\n\t\t\tduplicated_transactions.origin_id = a.origin_id\n\t\t\tand duplicated_transactions.brand_id = 6\n\t\twhere\n\t\t\tb.is_test = 0\n\t\tgroup by\n\t\t\t1,\n\t\t\t3,\n\t\t\t2,\n\t\t\t4,\n\t\t\t5,\n\t\t\t6,\n\t\t\t7,\n\t\t\t8,\n\t\t\t9,\n\t\t\t10,\n\t\t\t11,\n\t\t\t12,\n\t\t\t13\n\t\torder by\n\t\t\t3,\n\t\t\t4,\n\t\t\t5 asc) t\n\tinner join (\n\t\tselect\n\t\t\t@lastab := 0,\n\t\t\t@RealABAccHelp := 0,\n\t\t\t@lastRealABAaccHelp := 0,\n\t\t\t@lastId := 0,\n\t\t\t@realreal := 0,\n\t\t\t@lastreal := 0,\n\t\t\t@RealABUsd := 0,\n\t\t\t@lastabusd := 0,\n\t\t\t@RealABAccHelpUsd := 0,\n\t\t\t@realrealusd := 0,\n\t\t\t@lastrealusd := 0,\n\t\t\t@netdepositcurr := 0,\n\t\t\t@netdepositcurracc := 0,\n\t\t\t@netdepositusd := 0,\n\t\t\t@netdepositusdacc := 0,\n\t\t\t@realpnlcurr := 0,\n\t\t\t@realpnlcurracc := 0,\n\t\t\t@lastrealpnlcurr := 0,\n\t\t\t@realpnlusd := 0,\n\t\t\t@realpnlusdacc := 0,\n\t\t\t@lastrealpnlusd := 0,\n\t\t\t@currentrate := 0,\n\t\t\t@realrealneg := 0,\n\t\t\t@lastrealneg := 0,\n\t\t\t@education_deposit_total:= 0,\n\t\t\t@eligible:= 0,\n\t\t\t@lasteligible:= 0) v) aggCustomer\ninner join (\n\tselect\n\t\ta.id,\n\t\tb.name\n\tfrom\n\t\ttrader a\n\tinner join country b on\n\t\ta.country_id = b.id) co on\n\tco.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.id) as FTDInd\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) FTD on\n\tFTD.id = aggCustomer.id\n\tand FTD.FTDInd = aggCustomer.tr_id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.created_at) as LastDepDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MaxDep on\n\tMaxDep.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.open_at) as LastTimeInvestment\n\tfrom\n\t\ttrader_account_position a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1) MaxInv on\n\tMaxInv.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.created_at) as FTDDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MinDep on\n\tMinDep.id = aggCustomer.id\nleft join trader_account b on\n\taggCustomer.id = b.trader_id\norder by\n\t1,\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e39",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6qAqQ4wTrAjQNYhfY7egrcPCKm7Rh9+irvJBmxkN4y5OWK0b1ABUI6cX4BynT/Bb57V8dXjpQ/i465b9A+cO9KF/5WSBj4Act8xbVcAg/2E4DCkuyCXF+OKugn3wI+gXAF02li6ZiOESl71+QZkncPGh5q9fZWYJlgnkJvoKDP2C",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "922fe2a9-d7cd-4896-8956-26bc8754f922",
            "fullname": "MySql:MySql-922fe2a9-d7cd-4896-8956-26bc8754f922",
            "type": "extract",
            "name": "MySql-922fe2a9-d7cd-4896-8956-26bc8754f922",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "5dbff676-440f-4c9a-b6fa-167e649a121d",
                        "id": "tq_s20ULKhkd",
                        "name": "InfinityCapitalg_Open_PnL",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6412058c-e74f-45ee-8c6a-e3325f116f29",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "556ae55d-7636-474f-9800-6b55a6d15a72",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "353a3672-20d8-4865-9731-dd552ae89033",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a17d916f-4fd1-4d50-90fa-b70f803e3815",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f6509896-3bb3-452b-8c14-9a227843a186",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4690af29-4455-418d-b0eb-ff967bc533c4",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b480e6e0-6ed5-4788-94ef-53984f5477d8",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "16d66e20-5662-4397-92cc-ca7fca4953c7",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "66338443-d448-47eb-8d8f-55345263447f",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "755a0a4e-028f-4f77-9811-242043cf3044",
                        "id": "tq_uoZSEdc2M",
                        "name": "InfinityCapitalg_eom_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6c74a753-54b9-4f98-8b75-9bfd39b9f332",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "51c73f1c-a08f-497c-bbd2-9a8f3f8b1797",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "91ac0807-c543-4bc1-8db5-7b0376820ec2",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbcb8683-c27e-4c0e-a053-7791eae577b3",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84451d85-dd9e-4846-846c-9a5cfd34e35d",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ed701bb-48b2-4d41-bae6-a87b1b841f39",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "2f76dffa-d255-4317-a6e3-7eada44b7fd7",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e3b",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFDK3HBxmko3prablFaI1b6kvdaONocO4mGDvrM54DgP9W1oPEw8BC6mp/SYk7RA8xkUrf2IEbn348Yqf2PLVTaEl7QfiGiMXpcXf2f98OxAHYjeCJn2Lc3dDX6g/P/KuFQ==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "93cccb46-3a83-4bab-997f-057c4e2b3b37",
            "fullname": "MySql:1bc4ddea-afe4-40db-85a5-8779cdbe1ed9",
            "type": "extract",
            "name": "1bc4ddea-afe4-40db-85a5-8779cdbe1ed9",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b5950df8-d70e-4f41-b088-89a16498ba86",
                        "id": "tq_hWJVfijHl",
                        "name": "MarketCG Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8be2beb2-aa82-47d1-a426-a6ddfc5f7a34",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53c647fc-bdd8-435e-aa24-a8051578b7cc",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f3a9824-8b16-4cdf-95fe-1a6ba0c2ef06",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49c9f9ed-40c3-4654-a22f-1af6654ed2e7",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ed442da-64c1-42de-a397-742968ed23f3",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "09272ed5-124f-41f8-87fe-f525a7cfb235",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91a64b85-afd6-4110-ac30-513f1418335e",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8618f372-663c-49f4-a70d-2c7939c0612a",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63026547-c88c-4be2-98e1-3c24e983c574",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbca23f7-00df-434f-8006-3bba55e26946",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a1ea19b-23ee-4b11-9eb7-dc1f98bdffd6",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e0dfcafa-6e2b-465a-a87c-b42d3a374fdd",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "40c0a40c-bc4e-47e1-b8d0-0a692190ecac",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3dbadc9b-31d0-448e-a124-6438cd019e97",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aedc261b-d046-460c-bf52-ccc5f3e2256e",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea4c5357-886c-415a-8b1b-81c891f0f503",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "87dfb694-5876-4a04-9ca0-54329b074ec1",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77c705bc-af25-4e51-af5d-d038e820ef07",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "340d6c44-2a6f-4ac9-b864-1a367241fcbf",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "626693f8-fde8-4180-aa6e-cae72b98a04e",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b9d403f-245f-415d-8209-b6318bbadb37",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed4d118f-c3e1-4552-ae04-7d5c375f8d37",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0eee80ea-bef2-4e60-9d7e-7361a40bb335",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5d7d312-cae8-40c6-8958-efb7acfbbffb",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "53a78f37-429c-49bd-b293-abe58bcb9ebc",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b3662d4-8920-4fe0-a727-9ea84c3b2a59",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0ee4e2d8-a027-4c8c-852e-6b59251bcb03",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a30af763-157f-4eaa-885f-e42ca0d16ffd",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b8371c69-b7ec-4297-b6c9-659df9720b2b",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "419caa65-7f20-4e15-b680-85e3071d6a17",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c6c36ea0-2b44-43f7-b66a-1572dc00d6b2",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5dccd12-d229-412d-a081-b6ff7e37a68d",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "54b5ceaa-3211-4cc9-857d-d30b21bf8ba8",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "67b91aba-b597-413a-a8ad-db42bfb7b479",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8e05ceb9-4493-4aac-9980-bf827b120f22",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1af30ebc-3094-4b2e-afad-605eae2847f5",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b6bf1d07-3c96-438a-95fd-d8d63d1bade8",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7e5a6525-419c-4e9f-ba2f-d7a208489ab2",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9d5b985e-bd9d-4eaa-aca0-a4449d00b339",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a12171f9-6c81-42d1-95cb-58485d516124",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "586346fc-9bde-4763-a737-868ac25a508e",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e82a7f1-727a-43e5-867a-69939eefc26a",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4921b57c-8874-4328-aa04-a63380ad9b30",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b27a622d-19e1-4d6f-b360-21ff29d20f9a",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8ef8039-3e7e-4070-b3fd-d5383dc10dfb",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "74297d58-8bcc-41e6-b9c0-92f71ea2d792",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b4f7be06-c7c6-4867-891a-f9347f592120",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d8dba405-0ef9-4657-a7e7-e1864539e702",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c27521c-d055-4ff1-bba8-77464e603c03",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "864b44b8-1757-4ec3-809e-d30e63e3b00e",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc7d03c7-b9a8-436a-95f5-e798e78aeda9",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "60f22d91-fa14-403a-869d-9d981f191f84",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a23066e0-cfba-40fd-8450-c7a89d932fdc",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5e9e671e-c635-4d80-9737-767cc9497197",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e5db4c63-216e-49ab-bf71-2e169b52cec6",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "d5d7d312-cae8-40c6-8958-efb7acfbbffb",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "a09f180b-e20a-496b-ad7b-16ded5be727b",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tCOALESCE(transaction_deposit.payment_provider_id,0) not in (24,32,55)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,55)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,55)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0\r\n"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d3536780f2002c37e9e1",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NAc1gMa0VBzZ9QDyN4mgrYY4RdbmC5kaicIuBKtyLx50isgKI42gk0NUhwNAOs/C//rfCcf26YrMKFuhFjde0RcvkzPGcYE8h+sUnaaT/8VA==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "957a89a8-101b-4d5a-ad71-47efd3a9d107",
            "fullname": "MySql:5b09f8a0-21b4-487c-93b9-fdec3d7e54ca",
            "type": "extract",
            "name": "5b09f8a0-21b4-487c-93b9-fdec3d7e54ca",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "11bef385-4c75-4eb3-a502-c2c8f332022a",
                        "id": "tq_AYygxXJIb",
                        "name": "365TradingFX_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0ba9c1d7-dae6-4ae9-b30a-cee44050b621",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a2ab4ec-ef6c-4f5a-92e1-2c57f7214049",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6b6d6fc-872c-4141-a950-87d5b8725ad9",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a52cb76-ea37-43be-a3ad-8399dc896804",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1fb28265-6dc2-422d-92a6-74deff8ea25e",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ccd6da1-b8b6-4929-8917-52f7ad67e8dd",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b2c9725-8730-48cd-adae-45bb40452915",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87ac9d3c-bb31-453e-9147-41525e7411b8",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e3996b22-740b-4c9d-840a-45e9bb149dc7",
                        "configOptions": {
                            "importQuery": "select\r\n\tcast(1000 + brand.id as char) as site_id,\r\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\r\n\tb.trader_id as customer_id,\r\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\r\n\tb.date - interval 1 day as date,\r\n\tb.open_pnl,\r\n\tb.open_pnl_diff,\r\n\tcurrency.code\r\nfrom\r\n\t(\r\n\tselect\r\n\t\ta.*,\r\n\t\tcase\r\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\r\n\t\t\telse a.open_pnl end as open_pnl_diff,\r\n\t\t\t@last_id := a.trader_id,\r\n\t\t\t@last_open_pnl := a.open_pnl\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\t*\r\n\t\t\tfrom\r\n\t\t\t\topen_pnl_daily\r\n\t\t\torder by\r\n\t\t\t\t2,\r\n\t\t\t\t3 asc) a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t@last_open_pnl := 0,\r\n\t\t\t\t@last_id := 0) b on\r\n\t\t\t1 = 1) b\r\ninner join trader_account on\r\n\tb.trader_id = trader_account.trader_id\r\ninner join currency on\r\n\ttrader_account.currency_id = currency.id\r\ninner join trader on\r\n\ttrader_account.id = trader.default_account_id\r\ninner join brand on\r\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e3d",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6h2kEQfj06tSGpyh+xEzmk6Iq8paTu3ip6/rB+N1MFIYN59/xJKyq6s2pJ06bUpzhAANrOSGSl8zpPlUO8IwiG8A7d+Vz+KCoZhjqP9L+KHT5GfaypnOnu+badv06TGAXIJlaegbboPbyBtw46kZTRfJ2bJyakx/q48snRhZp8Cm",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "95e25971-6ca3-4f43-9319-16bd41b21101",
            "fullname": "MySql:0fa33079-ccc0-48ca-aa63-504d8f495c74",
            "type": "extract",
            "name": "0fa33079-ccc0-48ca-aa63-504d8f495c74",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "5fd78a27-5a95-490d-8bd6-273a729500fa",
                        "id": "tq_Dq53j6WAa",
                        "name": "BigBitMarket_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ece17f7e-ba1b-43f2-a19e-3100940c0fdb",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e946eff-1bdc-4ff3-b557-c8235e58f14a",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74cde964-8cb5-414d-b237-82c573584d49",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7122281-b7a1-4528-82cd-bd79cc5a44e4",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86b47d87-dac1-4535-9e6d-2edd7acca976",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "674f656a-311c-4946-9a4a-8d4a2f9688ed",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "6078b96a-89a8-4c10-bef4-6ef528346de0",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0de98b43ad1002c7a7584",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9644fd0c-0bd3-4989-90bc-1e1ccbb5a2da",
            "fullname": "MySql:d492b2cd-faa6-4cd1-ae6f-4294f32424e2",
            "type": "extract",
            "name": "d492b2cd-faa6-4cd1-ae6f-4294f32424e2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7daf4135-a4a7-4a34-b4e0-a755401f0357",
                        "id": "tq_6SWKuFDbK",
                        "name": "TradeTheBit_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0812c3ec-c311-4450-adb6-a6324ff8cbc4",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8cdb43a-e891-4f9f-b82e-eb01a083338d",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ea4461b-3d44-41a0-8892-af85dc9a6759",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2495b86-293c-4a74-8221-8ea85c51756c",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50120948-a8e0-46db-b7d8-f844d1faeec9",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fedede4a-1d1d-45a7-8c64-f7ae9b60badf",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7def0bf-f569-477d-804d-7ca3a2d47f32",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5dc4098-aa59-4880-83fb-2f6cad52fdb5",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "b969ecb1-4742-4b19-bc7a-fa6acb5657f2",
                        "configOptions": {
                            "importQuery": "select\r\n\tcast(1000 + brand.id as char) as site_id,\r\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\r\n\tb.trader_id as customer_id,\r\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\r\n\tb.date - interval 1 day as date,\r\n\tb.open_pnl,\r\n\tb.open_pnl_diff,\r\n\tcurrency.code\r\nfrom\r\n\t(\r\n\tselect\r\n\t\ta.*,\r\n\t\tcase\r\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\r\n\t\t\telse a.open_pnl end as open_pnl_diff,\r\n\t\t\t@last_id := a.trader_id,\r\n\t\t\t@last_open_pnl := a.open_pnl\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\t*\r\n\t\t\tfrom\r\n\t\t\t\topen_pnl_daily\r\n\t\t\torder by\r\n\t\t\t\t2,\r\n\t\t\t\t3 asc) a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t@last_open_pnl := 0,\r\n\t\t\t\t@last_id := 0) b on\r\n\t\t\t1 = 1) b\r\ninner join trader_account on\r\n\tb.trader_id = trader_account.trader_id\r\ninner join currency on\r\n\ttrader_account.currency_id = currency.id\r\ninner join trader on\r\n\ttrader_account.id = trader.default_account_id\r\ninner join brand on\r\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e3f",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6tIYtFHDx4PVY74RHYbsI6IhvMp8sxqqBTdleDWDyt2e+Fyk3LcoEnGSq9Vlhg0xsd3y74BZLzC/tlv2s7a0hSsdYCs79vBVJyd5U3QQcpa+nUzjpMgHOGIHzjGpciIIMnNVFTvZoHUexzM9auLhAvlkGn+ldc2l33OfdgtL1+KR",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9a1a8cac-9625-450f-b779-5b1fe1f7d2c5",
            "fullname": "MySql:b55dc615-2f9c-45f9-b869-f670576105ff",
            "type": "extract",
            "name": "b55dc615-2f9c-45f9-b869-f670576105ff",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4cd0534b-8388-49b2-aefe-1451e628e74a",
                        "id": "tq_iybwOoneg",
                        "name": "Ashford_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f7928513-27e7-446f-a42e-9ca6b000ebfa",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f41f9e2f-3ecf-494c-81e8-67133e24c8b5",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e05c6aa-5c48-4ee4-a133-d658837ee680",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2fb68d0-621f-4cff-a6c3-91ff35fc828e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae8f36db-5dfe-4bfc-a8dd-a2e56648c0f9",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80ab09be-92e5-45ee-a24a-851ae895ab20",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "413b0557-3633-4de0-8f20-e03b1c197393",
                        "configOptions": {
                            "importQuery": "select\r\n\t`date`,\r\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\r\n\tcode,\r\n\tsite_id,\r\n\temployee_key,\r\n\topen_pnl\r\nfrom\r\n\t(\r\n\tselect\r\n\t\topen_pnl_per_day.*,\r\n\t\tcase\r\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\r\n\t\t\telse last_day(`date`) end as eom_date\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\t`date` - interval 1 day as 'date',\r\n\t\t\t\tc.code,\r\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\r\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\r\n\t\t\t\tsum(open_pnl) as open_pnl\r\n\t\t\tfrom\r\n\t\t\t\topen_pnl_daily a\r\n\t\t\tinner join trader_account b on\r\n\t\t\t\ta.trader_id = b.trader_id\r\n\t\t\tinner join currency c on\r\n\t\t\t\tb.currency_id = c.id\r\n\t\t\tinner join trader d on\r\n\t\t\t\ta.trader_id = d.id\r\n\t\t\tgroup by\r\n\t\t\t\t1,\r\n\t\t\t\t2,\r\n\t\t\t\t3,\r\n\t\t\t\t4) open_pnl_per_day) eom_pnl\r\nwhere\r\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e43",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6qAqQ4wTrAjQNYhfY7egrcPCKm7Rh9+irvJBmxkN4y5OWK0b1ABUI6cX4BynT/Bb57V8dXjpQ/i465b9A+cO9KF/5WSBj4Act8xbVcAg/2E4DCkuyCXF+OKugn3wI+gXAF02li6ZiOESl71+QZkncPGh5q9fZWYJlgnkJvoKDP2C",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9b6f0c8d-1c22-41e0-b494-89ce4b268a54",
            "fullname": "MySql:MySql-9b6f0c8d-1c22-41e0-b494-89ce4b268a54",
            "type": "extract",
            "name": "MySql-9b6f0c8d-1c22-41e0-b494-89ce4b268a54",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "131b0268-e8c4-4397-9512-49da30a9d1a9",
                        "id": "tq_mW6tRiCNY",
                        "name": "AussieTrust_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "37e4d46c-2f6f-4f9b-8742-49e727efa4b4",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcf91da4-5b82-4e01-8b23-2a7d4754719e",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd0a89b4-9d87-4b65-b4d3-d7caeeaab89e",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "869c4352-5789-4127-9da0-ee7278f094a2",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e8357c7-8ce6-4c68-bee3-27fa28b063db",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7715f427-2087-4050-9466-bc1acb6d5380",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e4b66db-fb16-4441-863c-d7abb5c15528",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ce7e7511-617d-4588-88a5-493f4ccd3835",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "cef180ff-c95b-4d99-94c1-00f6a59e1bf9",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "f20a6f66-8fd5-4f51-b92f-f185610ae29a",
                        "id": "tq_ZOrlEHoUU",
                        "name": "AussieTrust_eom_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "335850c7-8181-4362-b776-b4db3389ed31",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "34690aee-a320-47bb-8b57-20d2acaa03f3",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da7fa417-9848-45d0-b265-3108d0822bfa",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c37e1035-f831-4d4e-8635-a1714d344f5d",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57b3c8bb-b938-4d13-9a1f-1cf5ede5a90c",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19c33351-4dc3-4c69-911c-af428168307f",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "23744614-acc3-4423-9ff0-e682fc2e4879",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(COALESCE(1000 + d.brand_id, 1001), 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e45",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFBOE7XbLtDfztzmP6eQ4KBt3tRGIH63X48U4CzSaVa+dUfhCGFpJQKmhkBC+dQUu/RMoasJpviGoRBZntP2bvD4A7ukgYI+LVnDPvsQbPi90",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9bc47795-eefc-4c6d-9b43-efc6d7f11f98",
            "fullname": "MySql:MySql-9bc47795-eefc-4c6d-9b43-efc6d7f11f98",
            "type": "extract",
            "name": "MySql-9bc47795-eefc-4c6d-9b43-efc6d7f11f98",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7a80a0ce-5bfa-4e58-a640-3081cd196303",
                        "id": "tq_Gz1B63dKe",
                        "name": "MarketsCG_eom_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8076f816-6174-48a2-a1f8-e4e7d580b89e",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db71b2ab-0452-4033-8058-49967e9f305e",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "439254f3-a42c-49d9-9151-50fa65b2dca3",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87e95144-cdab-420e-a57c-8d23590eb181",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98091c48-d249-4fa6-8b3c-423fed996c57",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fef2a01f-c0b7-4248-8a08-949ead3fa32b",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "0276ccaf-33ab-4093-8f26-7ae16f52174d",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e47",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFDtCLG4kXh87E24rRoJBo9V7meNmblVPjKFzTtoOKlxwWW705mQdR/VhIwhrot1AlXYWrzPLtpHhN1OQObCAqi5AUP8VagIsMxwNSNGDv+Ei8pA48VxaaW0TttN+LBzv2g==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9cd860af-0264-4588-a251-86051561c57d",
            "fullname": "MySql:8fc0b001-033a-4966-888a-537249ed9bed",
            "type": "extract",
            "name": "8fc0b001-033a-4966-888a-537249ed9bed",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0aa7712e-3178-4f0f-8f24-1b102403bc08",
                        "id": "tq_07bqzsLf0",
                        "name": "Chelsea_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "58011b05-21ee-434e-b109-4505ae2c33de",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df9f1647-bd6b-42d3-a3a6-6af3e08372bb",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d40f186f-b21d-401d-be15-991da3e9c2f5",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b686023-f091-4cf0-b263-95402e813099",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de41152b-7756-4e19-b19c-bc60f5e17d4f",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7fc851a1-0bc4-40cb-8769-32709e20426a",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e277023b-c445-4ff6-8da8-25cf14b2dff5",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57601778-e9ee-4939-b586-2e27ea4faf4c",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "14172d20-db21-45f9-a678-73896bfe2c4d",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e49",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lmoVQsTevINebgL5jFjt37tZHVE1yfCNBl6wIlYq6wI7NUggy3EK86zDSbM4Fw27FcQ7WJjO+t052mJVx7AZ+Z6gWRvGvZ4n1PPPLo5KaSvMstq72ErNzPegcuzwKce1NBllSBZUAXHjSilY0GlglY61i6z48l5MvN5HzcxxLj8",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9f172bf9-b65a-4d76-84b7-4f58be1c6e5a",
            "fullname": "MySql:MySql-9f172bf9-b65a-4d76-84b7-4f58be1c6e5a",
            "type": "extract",
            "name": "MySql-9f172bf9-b65a-4d76-84b7-4f58be1c6e5a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c0977ba2-879c-4318-821b-9253a4d475ce",
                        "id": "tq_i1PjzsmNV",
                        "name": "PrimeOT_eom_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "dcf54f9a-f03f-4140-93f8-c750fcfd51f1",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f581b4e9-a91a-4b9d-9416-ba2304a172d7",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e61c1b8d-d20b-4f6a-9ab9-3e21f6d65518",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77c1fad4-bc77-4d26-9820-34012edaf57d",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17fcd78a-569f-4744-9765-d521538b377a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e13ca34b-6052-4ef7-9f0a-7efc10d0beef",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "8798eba2-23d3-416d-9f72-b826a46292ac",
                        "configOptions": {
                            "importQuery": "select `date`, YEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key, code, employee_key, site_id, open_pnl\nfrom\n(select open_pnl_per_day.*, case when `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date` else last_day(`date`) end as eom_date \nfrom\n(select  `date` - interval 1 day as 'date',c.code, cast(1000 + brand_id as char) as site_id, concat(1000 + brand_id, 10002,d.user_id) as employee_key, sum(open_pnl) as open_pnl\nfrom open_pnl_daily a \ninner join trader_account b on a.trader_id = b.trader_id \ninner join currency c on b.currency_id = c.id\ninner join trader d on a.trader_id = d.id\ngroup by 1,2,3,4) open_pnl_per_day) eom_pnl\nwhere `date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e4b",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFIX7z4hDzOA5YXgCX1CnxcziCZXnKajrGEM0j8uqIlTwHa61Byqi5RonV2GOAnegaxLOz1W84BlI+GKkc5E1HAsQGhILBGse+2uap0fm3wskdjYn5ChwEw1OciM6LjeUZA==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a1eb811d-d487-4985-8212-77ee9e8daa3e",
            "fullname": "MySql:e3787fc4-1a28-4e45-a8a1-e5340c2510ae",
            "type": "extract",
            "name": "e3787fc4-1a28-4e45-a8a1-e5340c2510ae",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "43abb5c2-73c8-44ef-bb75-f8e5e2b0eb01",
                        "id": "tq_b6mv2akh4",
                        "name": "BigBitMarket_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "443e86d9-a825-400a-af28-68c675e6ad68",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d44cf75-f720-465d-bfc8-8ae7a94e00e3",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f32143e-52ca-4c5a-8023-ce60a22b5bbc",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4d2503c-c45f-46ac-b49f-598cf661f6f9",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54b3d0ce-d777-4fae-b840-58b1bc37338f",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1779224a-fd90-45f9-af6f-07a86547a60a",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b4e2ad0-76c3-41c2-99d3-15eac5583c31",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9083b2c-d00d-4fad-b582-a07b39688bee",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3466906-2ee5-414f-8e57-aa281d068cfc",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef053223-f136-4e7a-a336-455c6a880b4c",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88df7341-b1dc-4439-bc78-2a7360e04802",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17162cc1-e94a-4b12-91f8-f5d06a16e98e",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 24,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f2fe1c0b-75ad-4bc5-9e90-40cc1746031d",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a4aa21e-c5bd-4bfc-9860-2871cb2b22d0",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3738187a-7704-4265-a1f5-4ab1cdf33865",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc33240c-5e3e-4537-8b38-5ed8e527b0c7",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45545702-2e60-4e0b-9c8e-34e131be854a",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42da9e51-36b6-41a6-b37b-f05299819ae6",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb97ccc5-723b-402c-ae59-e70a7ca1c570",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66262761-2d05-4273-9e05-b12698df8b8d",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "507c8302-7e91-427b-bec8-b40b5b86cdaa",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b3967d7-bded-45f2-a4de-aa48dab7bc01",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7855940b-7d4c-4c4f-b38e-4f571bd5e6c0",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7116f61-fe6e-4406-926d-95fc8ebd4db6",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6c3392c-741e-4438-801d-90273c9d5df5",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df76284a-dabf-4334-86e1-d76d5638a933",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2ca5dba-6894-4811-96d5-d215de858149",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2186dd7a-b5b7-447c-9c37-d33e6dbfad1d",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0da5b5e8-db3b-4538-b1af-53d90eff0138",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ab37396-6eaa-4e18-8400-3136d8cd438f",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4bffc92-9529-40d2-9edc-6e3953da827d",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba01acf7-a932-470f-a9d9-b47dcf8cf0cd",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b5ac0be-44b0-40ed-ada9-f18ef0650620",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c661ecc-deab-4ce0-948f-4e84e6f302da",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3742babd-2f5d-4ba6-9bc9-75db5c81541d",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da95e4d8-1244-4e3e-aa62-34309b353203",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40e24b9b-e44d-4b3a-9817-0b67fc0096e5",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7875d3d-22f0-4cbe-845b-9acd80e7017a",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8a7dcc2-ede2-4cb5-8083-7d1a3c5765cf",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4a8ae87-ee5b-4ee1-8e4e-9e84d130498d",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "482f7301-04a7-476c-9ea0-c0f75d08ea4d",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d08b437-afdb-4f22-9b7d-97e9ac70c651",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "820f8029-229a-4f75-8e48-4feadc829b27",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6152c00c-51be-4bb9-b4c0-adb2a62c0918",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6737970-89bb-4731-9a8a-d683d79887a9",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86fbd9c1-b992-414b-a622-99908d1bb46c",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e173b65-afa7-415c-8f0b-8ea521542802",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dee02b75-cabc-4bd7-af48-0b13fa38d1b3",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4229f6a-da8e-40bc-a256-8c917ef400ec",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d886b7f-df77-4c3f-bc76-a115034fda23",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b95bc35f-46be-4661-a0e2-f790e5a42878",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82dd00a9-8b38-4841-b5b0-1e120627d6a3",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3b42168-3c5f-4d7c-a2fc-cc342f3d4b9f",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a73ec82-651b-4fa8-8506-40e28011d43e",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9ac49a6-1d4c-4117-9bf7-839b7a8f6ee6",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "039f5ec8-148b-411d-acda-1a0a5f2ff3ab",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7cbeeb33-8524-4131-8654-9fed23ba0f3e",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e879493f-336f-4c4f-bb67-48aca01f192c",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a482a579-bcfd-4f9a-995f-f0c54e363f00",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9db23c80-9bdf-4637-a2b3-d0f95b561f1c",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08280c95-8e51-4c6f-9686-6cdcb440482d",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e78330f5-89b8-4895-92ec-a2ce7152dfda",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf41784c-2077-4b0a-a2b8-2e87736d1546",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "523a495b-3c0c-431c-ac39-d731daa9d75b",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6801f7e5-1329-46c1-87e2-06112a043f2e",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6abaf13a-2ea2-4af1-bd3e-a9505fb07750",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fc87115-d2b9-4fbd-8f89-fe2308f5d58b",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3719e90b-9ccf-4f98-b41a-b1237096633f",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07125ade-4c3f-48b6-b8df-693d14f134a2",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46c734af-a127-429b-9d7e-ff7a43f4d5a5",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c418d29b-cbc3-4a04-9fac-4ae78704da77",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11aaafe4-46ec-46f0-897a-4fce64314595",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f619a254-b2ce-49fe-8abb-afdacaa08136",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f062559-209f-488e-8d2e-0aadd1779542",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b4b698b-ce45-4f4e-a00d-d43d4fab011d",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f736d94a-462f-48ac-9b76-e9fb503e2006",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d3c9898-204d-4b25-b373-06e9b3125155",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e857348-1690-4a73-bfce-1e3515b2262f",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18be4bb0-0143-4856-92ff-a16812a4d31f",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "14f9e07a-a992-4507-a0f6-6ec4154e277c",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\tselect\r\n\t\tt.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand coalesce(d.name,\r\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tor coalesce(d.name,\r\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0945 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2582 as GBP,\r\n\t\t\t\t'2020-04 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1115 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2349 as GBP,\r\n\t\t\t\t'2020-05 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1234 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2389 as GBP,\r\n\t\t\t\t'2020-06 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1772 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3087 as GBP,\r\n\t\t\t\t'2020-07 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1938 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3364 as GBP,\r\n\t\t\t\t'2020-08 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1819 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3163 as GBP,\r\n\t\t\t\t'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 6\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\tselect\r\n\t\ta.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0df05b43ad1002c7a7588",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a3301185-c993-4ce7-b386-8d8bec110b48",
            "fullname": "MySql:a14d807c-a850-4d7e-a531-a44e79b4648d",
            "type": "extract",
            "name": "a14d807c-a850-4d7e-a531-a44e79b4648d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "80a77c58-512a-441c-a672-3c4875fcd92a",
                        "id": "tq_GkLrUQT9a",
                        "name": "WinGroup_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d634d5a7-d348-4f44-a61d-6a279d4ecd58",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5999eb08-3f44-4e14-9d24-2b222e9cd75a",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80934322-d7f0-4057-ac10-be4e07e1a5c1",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2268526d-b135-47ad-9879-01655b6516d0",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5771b002-de07-499b-884b-a4d9ab633e6c",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5504e9a-dffc-4e7d-b06a-48f6f504fcb5",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ba51302-28bb-466e-8674-b323d373cb75",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d8bf072-a3c9-4d90-93f2-381184a20a1a",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e22bc915-d4cf-4779-946b-282510c44054",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "36cb52ae-c3d9-4164-a363-1ef4acad4445",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1045cd81-6a9f-4d79-b7d9-c23faa9d6c7a",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c710ef2f-1543-47c3-938e-802ce1634754",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc939967-5814-43a4-8ccb-f578e0f57138",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7913aa4c-c395-418f-b16f-6c628a81a579",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6906278-75d5-44e6-a95e-e3848f8054bd",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b30b847b-8132-472d-aca6-95e728b7440e",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f32e80d-64c8-4fce-92f7-737ab663b206",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5de6d660-93cb-443a-b987-02fae2ebb404",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e2f090c-8702-4c3f-8f49-b01d9c1a9a6f",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98144a29-4900-4920-bb7f-9562b664276b",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed6783fa-842f-4138-b946-4116b88394ad",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aaa77610-ccab-4da2-a375-83b98a58df30",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13024d44-ded9-45d7-9282-935fdf1f847e",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93c8dd54-318e-41f8-975d-75276efd26fb",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16f819e9-c335-4592-b556-3e7783d10eba",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5435405f-659a-46af-868d-641762dfa726",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0af6c040-1a90-459e-bee5-e70852f1e8fa",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f380db52-5292-401e-b1d7-181b6a000a14",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b01d01f7-8d0d-4551-8d57-9961e1db0ba7",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0047ddaa-9722-4e9f-a4b8-a330bbf55d8a",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23ee78b9-13de-4816-8b67-063b179c0ee3",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cd6dcb1-0d13-4481-819a-2a92520bac2e",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa984be9-dae3-4763-ac1c-4d6116fd497b",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d132a453-d29c-4c6c-bc17-dd637b489d37",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c625ee1f-3b8a-4bce-be21-83cd2ff09a00",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a99b2577-5fea-4c2f-8272-0cde2f48f4b4",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93e45be6-aa90-4440-89fa-11c3f56d2323",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "438074ff-9b8c-46f1-aaf1-e456e84d1138",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5354cd58-b8a8-4771-ad0e-feb80b246f23",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "083ad0f6-4604-4732-9668-25820878184f",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebec39c8-5216-4ea6-b6d2-65cb03dc1d5b",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7413cf59-5128-42f3-afb1-514be8e0563e",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1c82f18-5ac3-4ea7-86c7-2bfd2406b04f",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37a44251-fa3a-4d41-942e-ff4cdeaf91c2",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "592c844d-7685-41d9-bb36-a8bf4b593542",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cfccd4ae-4aa2-4786-bcd9-0ffea1775d14",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a5aef78-daea-446f-a9ab-4b4a84237e07",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c5f94af-3d88-48e5-90a2-480b2674436e",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "834258e0-8c9c-4c02-b294-7b6c4ff32158",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb35754c-0aff-4e92-9238-2181b66641c7",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "447f2962-7543-4596-afdc-929c47d6f246",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52952146-e9b7-46b9-894d-f94037c16617",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2b3ab51-dbe8-4805-88a5-828088f17d82",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2754a223-5590-482b-84f2-6dc3d3b07fe8",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b7f7fb9-fed8-46d5-b2c5-293caa149961",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19f92e0d-b7e6-40b3-b3e8-4d8f59ce1286",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b5c8dd7-61c2-4d9b-a1ca-241adc65909e",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb605fea-6b32-4606-9411-f94efa73a50b",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a718dde-79c1-443f-ba90-7775fbf4c0a2",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd3c759d-1547-40c0-82a9-62ad5a76f170",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "170aab1b-7f09-4d08-bdc6-f0ac836336c4",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cffd80f4-0bc0-4fb5-8dd2-851b0976d091",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "36dcaab2-2548-4566-a997-dd687c3aff9a",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44977659-dc2b-4fca-ac81-d5b2704c314e",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a3568db-d6c5-4f81-b77c-e60b1b2a8bb2",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c08a1458-68cc-4e3c-b551-3d7c21b54786",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b947502f-30be-4db7-bfdc-3e9824ed1e02",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a7d6f6b-3f4a-4d73-a71b-39cb61806829",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f678afb-43b1-49e7-a3cb-97456c937b15",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b83d6e4-cd2a-450d-b347-6dffde132d18",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3158276-58c3-4736-8062-3a7b6439a22e",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7fb49e8e-92e3-4e85-b722-cc90d8682e8b",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9590b60-15fe-4ca6-9cec-8b0508c1f815",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5226e107-fd62-4b6d-b5bb-69055e043ac9",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "efc82320-5d07-42aa-b326-f1648db5d83a",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0344407d-087a-4638-9276-ec2e2d7b487c",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6fe03e37-9047-416d-b087-8c3b8bdbc153",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5cffff8-11ba-4076-8e1d-516774e508d4",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ca9fa7e-38a9-43ab-906f-887bff0c9d6f",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c9c2fbb2-fd85-4da8-9137-a7a80eb68753",
                        "configOptions": {
                            "importQuery": "SELECT\n\taggCustomer.id,\n\taggCustomer.site_name as site_name,\n\taggCustomer.site_id as site_id,\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\n\taggCustomer.customer_fullname,\n\tco.name,\n\taggCustomer.currency,\n\taggCustomer.created_at,\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\n\taggCustomer.date,\n\taggCustomer.YearMonth,\n\tcase\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'GBP' then 1.3\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'EUR' then 1.1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'USD' then 1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\n\tend as rate,\n\tMaxDep.LastDepDate,\n\tMaxInv.LastTimeInvestment,\n\taggCustomer.tr_id,\n\taggCustomer.origin_type,\n\tMinDep.FTDDate,\n\tcase\n\t\twhen FTD.FTDind is null then 0\n\t\telse 1\n\tend as FTDInd,\n\taggCustomer.user_id,\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\n\taggCustomer.deposit_curr,\n\taggCustomer.deposit_usd,\n\taggCustomer.cashback_curr,\n\taggCustomer.cashback_usd,\n\taggCustomer.withdrawal_curr,\n\taggCustomer.withdrawal_usd,\n\taggCustomer.withdrawal_curr_new,\n\taggCustomer.withdrawal_usd_new,\n\taggCustomer.cashback_withdrawal_curr,\n\taggCustomer.cashback_withdrawal_usd,\n\taggCustomer.withdrawal_fee_curr,\n\taggCustomer.withdrawal_fee_usd,\n\taggCustomer.chb_curr,\n\taggCustomer.chb_usd,\n\taggCustomer.inactivity_fee_curr,\n\taggCustomer.inactivity_fee_usd,\n\taggCustomer.overnight_fee_curr,\n\taggCustomer.overnight_fee_usd,\n\taggCustomer.fees_curr,\n\taggCustomer.fees_usd,\n\taggCustomer.pnl_curr,\n\taggCustomer.pnl_usd,\n\taggCustomer.duplicated_pnl_curr,\n\taggCustomer.duplicated_pnl_usd,\n\taggCustomer.swap_curr,\n\taggCustomer.swap_usd,\n\taggCustomer.contract_usd,\n\taggCustomer.rbonus_curr,\n\taggCustomer.rbonus_usd,\n\taggCustomer.cancelled_bonus_curr,\n\taggCustomer.cancelled_bonus_usd,\n\taggCustomer.pending_bonus_curr,\n\taggCustomer.pending_bonus_usd,\n\taggCustomer.fixed_balance,\n\taggCustomer.fixed_balance_usd,\n\taggCustomer.negative_balance_fix_curr,\n\taggCustomer.negative_balance_fix_usd,\n\taggCustomer.refund_curr,\n\taggCustomer.refund_usd,\n\taggCustomer.education_deposit_curr,\n\taggCustomer.education_deposit_usd,\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\n\taggCustomer.balance_after_curr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\n\tb.balance as CurrencyBalance\nfrom\n\t(\n\tselect\n\t\tt.*,\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\n\t\t\telse @netdepositcurracc := @netdepositcurr\n\t\tend as NetDepCurrAcc,\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\n\t\t\telse @netdepositusdacc := @netdepositusd\n\t\tend as NetDepUsdAcc,\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastab < 0\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\t\telse @RealABAccHelp := @RealAB\n\t\tend as RealABAccHelp,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastabusd < 0\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\n\t\tend as RealABAccHelpUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\t\telse @realreal := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\n\t\t\telse @realrealneg := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\telse @realrealusd := @RealABUsd\n\t\tend as RealAccountBalanceAccumulatedUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\t\telse @RealABUsd\n\t\tend as RealABDiffUsd,\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\n\t\t\telse @realpnlcurr := @realpnlcurracc\n\t\tend as RealPnLCurr,\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\n\t\t\telse @realpnlusd := @realpnlusdacc\n\t\tend as RealPnLUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\n\t\t\tend as education_deposit_total,\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\n\t\t\telse @eligible end as EligibleDiffCurrency,\n\t\t@lastreal := @realreal,\n\t\t@lastrealusd := @realrealusd,\n\t\t@lastrealneg := @realrealneg,\n\t\t@lastab := @RealABAccHelp,\n\t\t@lastabusd := @RealABAccHelpUsd,\n\t\t@lastId := t.id,\n\t\t@lastrealpnlcurr := @realpnlcurracc,\n\t\t@lastrealpnlusd := @realpnlusdacc,\n\t\t@lasteligible:= @eligible\n\tfrom\n\t\t(\n\t\tselect\n\t\t\tbrand.name as site_name,\n\t\t\tcast(brand.id + 1000 as char) as site_id,\n\t\t\tb.id,\n\t\t\ta.id as tr_id,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\n\t\t\t\telse a.created_at\n\t\t\tend as created_at,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\n\t\t\t\telse date(a.created_at)\n\t\t\tend as 'date',\n\t\t\tb.user_id,\n\t\t\td.code as currency,\n\t\t\ta.origin_type,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend as YearMonth,\n\t\t\tcase\n\t\t\t\twhen d.code = 'USD' then rates.USD\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\n\t\t\tend as rate,\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\n\t\t\ta.balance_after as balance_after_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\n\t\t\t0) as deposit_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\n\t\t\t0) as deposit_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\n\t\t\t0) as cashback_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\n\t\t\t0) as cashback_usd,\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\n\t\t\t0) as withdrawal_curr_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\n\t\t\t0) as withdrawal_usd_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_usd,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) as fees_curr,\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) as fees_usd,\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\n\t\tfrom\n\t\t\ttransaction_record a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount,\n\t\t\t\ta.realized_at\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 1) rbonus on\n\t\t\trbonus.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 0\n\t\t\t\tand a.status = 'approved') pbonus on\n\t\t\tpbonus.id = a.id\n\t\tinner join trader b on\n\t\t\ta.trader_account_id = b.default_account_id\n\t\tinner join trader_account c on\n\t\t\tb.id = c.trader_id\n\t\tinner join currency d on\n\t\t\tc.currency_id = d.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand coalesce(d.name,\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\n\t\t\twithdrawals.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tor coalesce(d.name,\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\n\t\t\twithdrawals_cashback.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tand COALESCE(b.psp_reference_id,\n\t\t\t\t'') <> 'CH SR Cashback'\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\n\t\t\tdeposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tb.status = 'completed'\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\n\t\t\teducation_deposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tor COALESCE(b.psp_reference_id,\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\n\t\t\tcashbacks.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\n\t\t\twithdrawal_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 8\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\n\t\t\tovernight_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\n\t\t\tinactivity_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tswap as swaps_curr,\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\n\t\t\tfrom\n\t\t\t\ttrader_account_position a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id) swaps on\n\t\t\ta.id = swaps.ftr_id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t1.1448 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3108 as GBP,\n\t\t\t\t'2019-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1376 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3263 as GBP,\n\t\t\t\t'2019-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1224 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3021 as GBP,\n\t\t\t\t'2019-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1214 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3038 as GBP,\n\t\t\t\t'2019-04' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1197 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2637 as GBP,\n\t\t\t\t'2019-05' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.136 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2691 as GBP,\n\t\t\t\t'2019-06' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1071 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2152 as GBP,\n\t\t\t\t'2019-07' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1009 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2157 as GBP,\n\t\t\t\t'2019-08' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0899 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2287 as GBP,\n\t\t\t\t'2019-09' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1157 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2937 as GBP,\n\t\t\t\t'2019-10' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1019 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2928 as GBP,\n\t\t\t\t'2019-11' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1124 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3351 as GBP,\n\t\t\t\t'2019-12' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1095 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3205 as GBP,\n\t\t\t\t'2020-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1089 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3181 as GBP,\n\t\t\t\t'2020-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.13513 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.30362 as GBP,\n\t\t\t\t'2020-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0945 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2582 as GBP,\n\t\t\t\t'2020-04 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1115 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2349 as GBP,\n\t\t\t\t'2020-05 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1234 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2389 as GBP,\n\t\t\t\t'2020-06 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1772 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3087 as GBP,\n\t\t\t\t'2020-07 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1938 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3364 as GBP,\n\t\t\t\t'2020-08 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1819 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3163 as GBP,\n\t\t\t\t'2020-09 ' as ym ) rates on\n\t\t\trates.ym =\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tsystem_currency_vol\n\t\t\tfrom\n\t\t\t\ttrader_account_position) contract on\n\t\t\tcontract.ftr_id = a.id\n\t\tinner join brand on\n\t\t\tb.brand_id = brand.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t113 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t178 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t431 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t444 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t667 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t669 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t719 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t722 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t725 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t728 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t730 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t739 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t3 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t742 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t4 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14017 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14185 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t15286 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t17222 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18557 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18633 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t51094 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t53021 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t55189 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56011 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56598 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t58533 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59217 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59564 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59921 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59936 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59940 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59976 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t60973 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62255 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62602 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64700 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64903 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66341 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66653 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t67606 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68025 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68732 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69281 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69501 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t70036 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t71348 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t73585 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t74087 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76808 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76830 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77591 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77992 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t78569 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79158 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79751 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79776 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79861 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80148 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80149 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t81789 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t82187 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83126 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84647 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84882 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84994 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t85474 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86488 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86959 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t87442 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88286 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88547 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88580 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88608 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88934 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88957 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88960 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89028 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89048 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89527 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t90983 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91231 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91599 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92083 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92119 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92272 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92436 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92529 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t93156 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t94765 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95003 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95417 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95533 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95552 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95696 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96039 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96082 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96442 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96444 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96903 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97559 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97715 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98608 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98799 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98801 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98939 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98941 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99276 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99382 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99383 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99943 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101045 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101071 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101252 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t141562 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142017 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142046 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142054 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142060 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142077 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142082 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142264 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142430 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142628 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143897 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143985 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144173 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144779 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t146491 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147091 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147685 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148023 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148087 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149446 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149654 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t150882 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151089 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151363 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151386 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152005 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152069 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152804 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153023 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153576 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153588 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153631 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154646 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154692 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155297 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155382 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155827 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156184 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156235 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156868 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t157794 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158445 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158887 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159205 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159555 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159821 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160010 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160727 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160963 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t161450 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162530 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162532 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163044 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163285 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163535 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163689 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164246 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164829 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164864 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164909 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165119 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165178 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165335 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166717 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t7 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166741 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168116 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168721 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168736 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t169843 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\n\t\t\tduplicated_transactions.origin_id = a.origin_id\n\t\t\tand duplicated_transactions.brand_id = 6\n\t\twhere\n\t\t\tb.is_test = 0\n\t\tgroup by\n\t\t\t1,\n\t\t\t3,\n\t\t\t2,\n\t\t\t4,\n\t\t\t5,\n\t\t\t6,\n\t\t\t7,\n\t\t\t8,\n\t\t\t9,\n\t\t\t10,\n\t\t\t11,\n\t\t\t12,\n\t\t\t13\n\t\torder by\n\t\t\t3,\n\t\t\t4,\n\t\t\t5 asc) t\n\tinner join (\n\t\tselect\n\t\t\t@lastab := 0,\n\t\t\t@RealABAccHelp := 0,\n\t\t\t@lastRealABAaccHelp := 0,\n\t\t\t@lastId := 0,\n\t\t\t@realreal := 0,\n\t\t\t@lastreal := 0,\n\t\t\t@RealABUsd := 0,\n\t\t\t@lastabusd := 0,\n\t\t\t@RealABAccHelpUsd := 0,\n\t\t\t@realrealusd := 0,\n\t\t\t@lastrealusd := 0,\n\t\t\t@netdepositcurr := 0,\n\t\t\t@netdepositcurracc := 0,\n\t\t\t@netdepositusd := 0,\n\t\t\t@netdepositusdacc := 0,\n\t\t\t@realpnlcurr := 0,\n\t\t\t@realpnlcurracc := 0,\n\t\t\t@lastrealpnlcurr := 0,\n\t\t\t@realpnlusd := 0,\n\t\t\t@realpnlusdacc := 0,\n\t\t\t@lastrealpnlusd := 0,\n\t\t\t@currentrate := 0,\n\t\t\t@realrealneg := 0,\n\t\t\t@lastrealneg := 0,\n\t\t\t@education_deposit_total:= 0,\n\t\t\t@eligible:= 0,\n\t\t\t@lasteligible:= 0) v) aggCustomer\ninner join (\n\tselect\n\t\ta.id,\n\t\tb.name\n\tfrom\n\t\ttrader a\n\tinner join country b on\n\t\ta.country_id = b.id) co on\n\tco.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.id) as FTDInd\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) FTD on\n\tFTD.id = aggCustomer.id\n\tand FTD.FTDInd = aggCustomer.tr_id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.created_at) as LastDepDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MaxDep on\n\tMaxDep.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.open_at) as LastTimeInvestment\n\tfrom\n\t\ttrader_account_position a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1) MaxInv on\n\tMaxInv.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.created_at) as FTDDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MinDep on\n\tMinDep.id = aggCustomer.id\nleft join trader_account b on\n\taggCustomer.id = b.trader_id\norder by\n\t1,\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e4f",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oISZYo/jnBBiedN+eL7iEVmicVz5zdJvnkTnDpGXX+jM3jkWwQH1GDq4EovBiX29q5VS6x+Z07G9BXJJzwZT+nGfZWcVbeOv81/ipF/iAkEydLA1qCoilSMT7qJlQub6SW5eExTvv+75JqKLkCs/jkkYjDgSKl1b0MSB6ZMr8WT",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a9e48b4d-4b18-404c-b8bb-d70e93423968",
            "fullname": "MySql:35371633-7e0e-4859-b831-f54b552569b0",
            "type": "extract",
            "name": "35371633-7e0e-4859-b831-f54b552569b0",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4f4532d7-9c34-407d-9b07-6dcfaf2a979c",
                        "id": "tq_UFOICOYfl",
                        "name": "PrimeOTCustomers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "18cf5b8f-bed9-47fa-8428-89f2b1425069",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e1f1a42-b6b3-40da-8466-2fdb3c698570",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "030dfcde-2e31-4259-ab3f-cec9e1845461",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2c645e9-709a-4a7c-9cf4-523e48c685cc",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a89af1df-abb4-464e-9673-4ef34c068a26",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "40d97076-eb30-442d-8715-3d3f41e232fe",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9da5d3b4-6e76-4ff4-8bcf-ff55fe1b1f4b",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32d557b1-5189-427c-a03e-c8b8f86d0b29",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ead332a-7014-4dc0-9324-d5a9b4338bc0",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd3353fe-8d96-4180-b4fe-23a0e9789a5c",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "086a8325-3ef5-4bc1-96cc-e00e058ab514",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ed02d1c-b945-4424-945f-658f7f2cae3c",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "edf73077-4204-4c45-a7af-ae6af06ec208",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d2ea74f0-7e47-4a9e-9d31-8213b31da1f6",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d603bf70-b518-4f59-bf1b-5713b46de252",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b63664b-f7e0-4ce9-952c-182f924108bf",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d20894ab-9b15-4ee5-bcc8-b857ae9c8977",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf75a684-dfc4-4d64-a185-8800e77058d0",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4481b947-c2b4-41a3-aa21-4cb60c31ecdb",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b07172b-0d16-460e-85c9-cbd494d8ecbf",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "294e1ab8-c36f-48ca-805f-7100bb7bc323",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4af81e2f-7b91-4bb6-b30f-34c32e57aaee",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ebc5378-0b1b-4f0d-87ab-e629a09e264a",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e9cd25bd-bb16-4c3d-8dfd-1bdf526bbcbd",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3719a4c4-599e-424f-8c57-f4ba64de5b80",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d491221-3b66-42fb-beaf-02908165b57d",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "10eb4d66-8312-4fd4-8396-7128d4532609",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "154cb04f-85f1-4478-b284-ea4f345372ed",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2628c06b-54a6-46fe-8b12-b32850d228f4",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b9b807f7-4fdd-422f-a042-36e9672bb4db",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "185fdf3c-215b-420b-8af1-17e14d148005",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cad3a44e-de2e-46ae-b9b5-102a324ab8e8",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d85ccd60-4f27-4bfb-8466-9467c36d7262",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b3718f92-2fb7-407e-8dfc-09c71d9e149c",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "882aa507-e6c0-4440-b67f-355a1af9a363",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6aac8a11-1000-4008-bfa1-ca80422ecb97",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b499d49-3f7d-4e30-b903-b6152bce148d",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e9b43093-812c-4c86-bc2a-dcc142b139fb",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "450111ff-b543-4264-9b17-f793b96ddc69",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83a1ebfb-a18d-4840-8e9a-ec49ccede533",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2af13be8-d632-4b10-a61b-62f7cbee0423",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d2bfbe5-5e0a-4c86-8dcf-f1c083482681",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83f8e092-62ee-483e-9cec-655275f01596",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "404387ab-73bc-482b-baf1-cf3b908fab5a",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b02b7330-f3de-4255-a8a1-733dbda203eb",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d8f8eac5-f23e-4a34-af42-c0e08922b754",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8ec43967-6bc5-4901-b4d7-5b6a85e1f6fd",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3f29ecf4-faad-44d7-a267-d43e0711cf2a",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb19549d-7a28-424c-bff4-4ed708544f5a",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e1a4c2d-6123-4b0e-b0d6-ba8967736ed4",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d50c7aac-817f-46c7-bff2-4e7ae15b57e7",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7a51350d-bb05-4e7e-a0ba-218a53e67bd5",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3666d752-8b75-4ec0-a6a1-b1ec4f2066cb",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "972eafa4-5100-47f1-ad4d-bddd467ef650",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0eb9ca3-41c1-4371-9a01-1c4c8b66dfab",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "e9cd25bd-bb16-4c3d-8dfd-1bdf526bbcbd",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "cd547a84-99b8-43a2-9379-a77a576071f9",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10002, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10002, COALESCE( trader.user_id, 0 )) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce( trader_account.wallet_number,\r\n\t'N/A' ) as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\tCOALESCE( trader_marketing_data.utm_sub_aff_id,\r\n\t'Null' ) as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE( kyc_status.name,\r\n\t'null' ) as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\ttrader_status.name as trader_status,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\tdates.days_from_last_deposit,\r\n\tcase\r\n\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\telse dates.days_from_last_deposit\r\n\tend as min_active_day,\r\n\tcase\r\n\t\twhen (\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit\r\n\t\tend ) <= 30 then 1\r\n\t\telse 0\r\n\tend as is_active,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF( transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate ) AS days_from_first_request,\r\n\tDATEDIFF( CURRENT_DATE(),\r\n\tdates.last_call_date ) as days_from_last_call_date,\r\n\tDATEDIFF( CURRENT_DATE(),\r\n\tdates.last_effective_call_date ) as days_from_last_effective_call_date,\r\n\tdatediff( current_date(),\r\n\tFTD.FirstDepositDate ) as days_from_ftd,\r\n\tdatediff( current_date(),\r\n\ttransaction_withdrawals.first_request_date ) as days_from_first_request_till_today,\r\n\tCOALESCE( employees.full_name,\r\n\t'null' ) as employee_incharge,\r\n\tCOALESCE( employees.team_name,\r\n\t'null' ) as team_incharge,\r\n\tCOALESCE( employees.department,\r\n\t'null' ) as department_incharge,\r\n\tCOALESCE( employees.group_name,\r\n\t'null' ) as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF( CURRENT_DATE(),\r\n\tassignments.assignment_date ) as days_from_first_assignment,\r\n\tDATEDIFF( assignments.assignment_date,\r\n\tFTD.FirstDepositDate ) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE( assignments.full_name_assign,\r\n\t'null' ) as full_name_assign,\r\n\tCOALESCE( assignments.team_name_assign,\r\n\t'null' ) as team_name_assign,\r\n\tCOALESCE( assignments.group_name_assign,\r\n\t'null' ) as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE( redepositor.is_redeposit_1k,\r\n\t0 ) as is_redeposit_1k,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen country.name in ( 'Switzerland',\r\n\t\t'Germany',\r\n\t\t'Austria' ) then 'Germany'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen country.id in ( 14,\r\n\t\t86,\r\n\t\t225 ) then 2\r\n\t\telse 1\r\n\tend as locale_group_id\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\ninner join brand on trader.brand_id = brand.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join trader_status on\r\n\ttrader_status.id = trader.trader_status_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,29,45,62,107)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax( case when transaction_record.origin_type = 1 then transaction_record.created_at end ) as last_deposit_date,\r\n\t\tmax( case when transaction_record.origin_type = 2 then transaction_record.created_at end ) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF( CURRENT_DATE(),\r\n\t\tmax( case when transaction_record.origin_type = 1 then transaction_record.created_at end ) ) as days_from_last_deposit,\r\n\t\tDATEDIFF( CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date) ) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin( `call`.created_at ) as first_call_date,\r\n\t\t\tmin( case when duration >= 180 then `call`.created_at end ) as first_effective_call_date,\r\n\t\t\tmin( case when duration >= 1800 then `call`.created_at end ) as first_effective_30_min,\r\n\t\t\tmax( `call`.created_at ) as last_call_date,\r\n\t\t\tmax( case when duration >= 180 then `call`.created_at end ) as last_effective_call_date,\r\n\t\t\tmax( case when duration >= 1800 then `call`.created_at end ) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tcase\r\n\t\t\twhen group_type.name = 'Branch'\r\n\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\telse group_type.name\r\n\t\tend as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\tuser_groups.id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\telse f.name\r\n\t\t\tend = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id =\r\n\t\t(case\r\n\t\t\twhen e.parent_id is null then e.id\r\n\t\t\telse e.parent_id\r\n\t\tend)\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,29,45,62,107)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tmin(c.id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id\r\n\t\t\twhere\r\n\t\t\t\tc.parent_id is not null\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\temp.id,\r\n\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect proba.id,\r\n\t\t\t\t\tsum(ch)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tselect a.id,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\telse 0\r\n\t\t\t\t\t\tend as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1\r\n\t\t\t\thaving\r\n\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\tinner join user_group on\r\n\t\t\t\temp.id = user_group.user_id\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand\r\n\t\t\tcase\r\n\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\telse `group`.type_id\r\n\t\t\tend = 6\r\n\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,29,45,62,107)\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` ) redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\tselect\r\n\t\ttrader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1 ) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d28d6780f2002c37e9de",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CAgo/mhzsyh0uxU+gptUMPWJyvCkVdqgrWNxqHTIoQ0w",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "af4f1348-a546-4180-a9c3-a586cd43faf5",
            "fullname": "MySql:a70a88ad-0fbd-41b6-ab51-49e2b63fd3e3",
            "type": "extract",
            "name": "a70a88ad-0fbd-41b6-ab51-49e2b63fd3e3",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8e542fd5-72b5-4929-aa53-5b836966a124",
                        "id": "tq_JYx4m40gt",
                        "name": "BigBitMarket_Employees",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "39d83c4b-bdbf-40c9-a674-c962a1cb9ccd",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f94e4c6a-fddc-4402-a7ec-10a6348a24ed",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "deeb84d2-2ce4-4f7f-b567-afe16bb88a1f",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6da2ff1-b6b5-4c00-a8fb-5a52a7458245",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be27d118-cd71-4943-ad35-bcfec879fc90",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62704f1d-122c-4cc1-a847-cfae31917289",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e64bab7c-0212-457f-a514-6b29d8c999b9",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58c20e9c-7cad-4293-a6d1-602873fb1349",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d16d1d41-123b-463d-811b-90a0bac3bff2",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bff08fef-03b1-4604-aa6b-e6a4b67f1ca9",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "0ee05fbd-67cb-4cbf-92bf-91d9c32e629d",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0de52b43ad1002c7a7582",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b434551b-27cb-4e23-8ab2-9b90b4ca4c06",
            "fullname": "MySql:5a96c164-eddc-4769-998d-16d719c8d1b9",
            "type": "extract",
            "name": "5a96c164-eddc-4769-998d-16d719c8d1b9",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "dc6390f4-04d5-4e0e-92a7-ec86edb2d641",
                        "id": "tq_eC1MJpXoJ",
                        "name": "BitfinityFX_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "fb51f6c0-c12e-4fa0-8355-e174988ca28e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22bdd567-fc80-4752-9673-39502cfa33fc",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d41d4a2-4d0a-4d53-bb79-09ec283766e5",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fef56099-dd7f-441a-866c-4d3dbe703a74",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2288b31e-24aa-44c8-8f8c-3b32e077c9f6",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1e68b3d-b36f-4c32-bcf2-b982f68408a3",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 40,
                                "size": 22,
                                "precision": 22,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c198177a-41e5-4466-a8f0-08d0502d54bf",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "895da2a2-09c1-4c38-a7e2-dbc9b7f29e7a",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c11548e3-e2a8-4547-9440-0cf800fef7c9",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61951742fd9249002de3c532",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8C2q0mVY+o2WF4+UVAyIhGiWhSY3+Y93kyI+zrKj2Bg5HiBiNB45Ta2GGPAsEoYp8/7dK0B1NeCzhErO6Xxg3c338i0MevnkC9Yi9QGlRnh1xn5Kjp5TuCxX28iusyU+paJ5wPXzkAPGHPDNhGasnoxvMsxipUWeTclTSatITjv9eQNNH4tFpXr1gskkcrIfglENUveS4Og+oLFLIuz1xQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b7b181cb-0515-40dd-9296-8d8e41bcd565",
            "fullname": "MySql:b84fb335-b589-4101-b2c8-c65b969c518d",
            "type": "extract",
            "name": "b84fb335-b589-4101-b2c8-c65b969c518d",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "61190cd48a56da002c368e59",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8OSfPYhJH5R3HPnPvPUq9ufFEejHbQ5noMM+s2I3j9hfV4ghZOttugRuXVbNWlMq51sPWEQ79B4SIfJgGwbgIEwugkCtRlhGLq4p5Jfb15dVDFMoI69c+dcUuN1SDyQ57I=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "bc61e7ce-90ab-4d31-911b-2a91dbc154d6",
            "fullname": "MySql:ce5ed8c6-f9ef-46dc-838f-1d03e970aea5",
            "type": "extract",
            "name": "ce5ed8c6-f9ef-46dc-838f-1d03e970aea5",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "08a047ff-5dde-4b2c-8849-ade8fbf58ffb",
                        "id": "tq_qaNRA66RW",
                        "name": "BendigoCoins_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ef5723dc-14dd-49cc-8d7f-55c37f9b02e1",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8ef633d-a457-420e-aa4f-60df57d0a12b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd3927c4-9520-4a16-a691-de1674da7d36",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d9e184b-c4eb-4f6d-a1ab-9ccc2fae55c6",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5c9306a-678c-4b59-b210-389fec948609",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f66f3fa-ca44-47eb-bd6e-f5a4a913b386",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "024ac2b6-7bb2-4352-b523-507933cc51dc",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80992697-3422-4be2-943b-59e4b715eef5",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "689627b4-6c35-4882-9d5a-e929312b0782",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0101caff-f0d8-4fa0-aa8a-da5ccb844551",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13e49720-798b-4430-95ce-c2b3c41624e3",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94838172-226b-4c1f-820a-d9ab60b4f890",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "955d1866-c561-4eaf-80ca-5c06971ba3d6",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "acad41e6-aa0e-4819-a74d-742912bc3066",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6c08fdf-14ca-4f4c-9fd8-3541a33d9774",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa821a36-d8fc-415b-87d7-63fb7b5d69f2",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ecefa256-8334-4f43-b50a-6c4d9804d37b",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bab4a4f8-eae3-4f07-acda-c0b09f03bd67",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0beb0062-1e6a-4ef9-900c-04c9e9d7850b",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8d7a81f-b71b-449d-89b1-42304c2fce9c",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea14ce80-71f8-4575-a718-22422c9d055a",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1f8d45b-56e8-46ef-8ece-8eea606fd8aa",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "edc71dc7-6d19-4f11-89bf-b1617a465e35",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f8da5b2-a915-4f68-892f-14848bf90adb",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c156efa-612b-4b7e-8c40-608f361292ae",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dadb9252-ca21-481e-9641-3e4e311004cf",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "906d3cf6-9409-4bc8-9868-22ac864a437d",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e747657a-cbe5-4ab2-945d-d62b4f06a570",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d4560ab-6924-4a54-a20a-54f32ff43e21",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4bcad22c-4d82-45ac-9154-039832d6f76a",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2df1e8c-51b5-4e97-b97c-11580356f2f5",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7d4f017-ff4d-43ed-84f2-40e337ad9a46",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa1ebb37-153c-4728-ac23-60ea4a9f65db",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b07021c-c52e-4016-a86c-8126725624c9",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "43062288-d768-44ad-94b8-4a62c167f182",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e56098ae-7a6b-4be7-9a58-0ff45cc9dfff",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbc7fcaa-27cd-4fb2-97e5-adae1b61d062",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50ce0bd4-463e-41b3-80b6-59ce118d394a",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60178948-dcf8-4d64-bf73-77ca5fef7cdb",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c53eb94-f153-40bb-accb-8123b52d52f5",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6751ef05-977d-404a-88ca-1632767579fa",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26a1eb5b-9d65-480d-b487-f5b16f8fb9d1",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02bb1be3-c890-4cca-989c-114c63dbce36",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c323b3a-5f7b-4c6d-9850-94ac27f07839",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b629593d-3b68-46c6-9904-dac73e828221",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ba7b04a-0276-4bf4-9481-b336ed07ae9a",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e9506de-72aa-4fc0-9db5-981c9f432a22",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "201d31aa-7991-4794-a4f1-2aaf31bd0b87",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23e71a0a-a800-4fd1-a0bd-55c30de1df56",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "317e672e-2a37-40e5-9144-064e22433fa3",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a51d83be-29d3-4190-9a26-e6b440a320d8",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37581fdd-169e-41be-a06d-79abeceba3e0",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "265be8c7-97c0-4db6-b0a0-9a871e8d350c",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48b910e0-f7da-4542-8679-1acac45fd134",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22f8c2a7-3e38-46a8-a28a-5fb78ecedb3f",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "6f8da5b2-a915-4f68-892f-14848bf90adb",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "d997f632-3f64-4680-9da3-35a131e7f6e3",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d7136780f2002c37ec39",
                "provider": "MySql",
                "parameters": "FhwKndxsEm4karcTRhcRhQ31JuodaLCOkLCPAL5UDyKQmplY4PGQirEicte+5XlO7CmeguqIciMcA3dWSPlLRdyZQQBa8rSl7481iBoEVleEKNnY0oZY59Uua0u3yiz/U5itDzyqwT3hV27JP+osZrKYLMelBUn+F7vnCn46CtacVjNzMfL/BmkfA2U0DhrLnI0aG8HaWhblMUs9PMPHSLPgZ1yWRCKlfMFEAtsVU51Jg4PyWiAT5+nvRZJBKlUf",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "bc6dc566-7bc0-4f97-939a-af0661d5c512",
            "fullname": "MySql:MySql-bc6dc566-7bc0-4f97-939a-af0661d5c512",
            "type": "extract",
            "name": "MySql-bc6dc566-7bc0-4f97-939a-af0661d5c512",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "277fc53c-8ca6-419a-acfb-9bda2f9d96e5",
                        "id": "tq_xw3jE7bg6",
                        "name": "York_eom_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "30fe97c5-3649-48e7-9828-98ed40419278",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b971af29-2c14-4481-901c-6c451698064f",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eb49ffc1-5266-4e8f-81fa-eee27d1aebc5",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2086a094-4552-4e94-81ea-6faeffbe0c7a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90adfac5-2478-4e14-815e-4753100730d0",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0dc85b8f-0e32-4c31-88e1-68b42e080cb4",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "15859f1b-f00e-4ce1-ae7a-56504e69d9d9",
                        "configOptions": {
                            "importQuery": "select `date`, YEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key, code, site_id, employee_key,open_pnl\nfrom\n(select open_pnl_per_day.*, case when `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date` else last_day(`date`) end as eom_date \nfrom\n(select  `date` - interval 1 day as 'date',c.code, cast(1000 + d.brand_id as char) as site_id, concat(COALESCE(1000 + d.brand_id,1001),10000,d.user_id) as employee_key, sum(open_pnl) as open_pnl\nfrom open_pnl_daily a \ninner join trader_account b on a.trader_id = b.trader_id \ninner join currency c on b.currency_id = c.id\ninner join trader d on a.trader_id = d.id\ngroup by 1,2,3,4) open_pnl_per_day) eom_pnl\nwhere `date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd48a56da002c368e5d",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFEmT/bcq/EycnRME8TGHq9ZgxIX6mgDymM7dLWqZsj+nMrkwVMLpfpzNPsDmI7cOke5W9nu6oGC9BKbiu7eT2hNVfAmhq11RY4q2NhjueqpLaC0+9I1P9SE8Goy/101MFw==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "bfac4aaa-b7b0-4f16-ac31-50a7ea1bcebd",
            "fullname": "MySql:793186cf-2102-4a5b-857c-cffaa8a9648d",
            "type": "extract",
            "name": "793186cf-2102-4a5b-857c-cffaa8a9648d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "5ea36115-2db2-4dea-b1d5-ad90a2807450",
                        "id": "tq_D2xG9wEbz",
                        "name": "BendigoCoins_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5fe6ea5b-1264-4ed8-9269-2aa8c3ed5985",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb33855f-6609-4e71-8f58-e28de375eda6",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f47a474-8f78-47aa-88c2-6e87d68add44",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef906422-462f-4644-bcd7-c4bc3baa2c73",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "984667c5-e341-415e-92e7-dcf19b209ccc",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "598fa1c1-480f-4350-88b0-bffc77476592",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4f2dffd-0d55-4fad-b65b-940a11a3e628",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f87ac7fc-2972-45db-aac2-c7917df5ec5b",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b959fefe-9612-4fbb-acf5-14be828f2bb3",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9dfae571-c212-44d2-9f9a-dc3f0c9a6019",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51da1779-5be8-4724-94c4-506f61a7a8dd",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b969dfe-aa01-4556-a9dc-73ec59150c15",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 24,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07207680-159a-488b-8bbd-a278a420a6b2",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "373d50a6-dea4-4a79-9015-35b27f092a94",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "875d7bfb-998d-4fc9-9e10-e17e8f5b261b",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a1d692f-2760-4f11-a45c-121d9e9cb3f2",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "421cc624-6451-49c5-8e0a-c2f7189b6143",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94c0c994-691d-4c23-9f79-01632eda4dd1",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02faa10b-6ee0-4784-9594-f2b00dcffcce",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09f2f5e1-51cf-408a-973d-229ebd607792",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe928f37-2fd6-48e0-91bd-418c6ebb8c0b",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4543381-e6ed-417e-bcb3-c231a1607452",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6d5e76d-33d6-45c5-ad80-12d83bce7ef9",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "701e7954-0217-4a2b-91ab-3f5e475a23b3",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd764ae3-493b-4b53-8035-1649e14cd7fe",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e471310-bee1-4dca-ad20-4feb3aa36b2f",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d42e393e-118d-461d-9d00-30f5f5362b13",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ae8840b-9bdc-4686-a9c3-cf9c693e8ec1",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80020f8d-1156-4e7a-a5bf-ef1c4ff64bd2",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "669d08e7-4555-4d18-bb88-3dec779ec8d9",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f4237b4-8896-40f6-90b9-93403929b476",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1bffaf4-d3ef-4935-942d-8d5577fc8df6",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a59e765-b3b3-44fa-b738-37faf72cb6ff",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ae8a6f1-f229-4a01-a568-3a3569fd57a2",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54720954-8fe4-47d4-b797-89f33325107d",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1523a1da-4c12-4ec8-a758-a88d68df1fca",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "437493d1-97a2-499c-8276-bb3fe2436c81",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be4f72e7-6be0-43eb-a78f-8ba2cf11be7c",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5dd7e35-e34f-43a1-b2cf-e0e14d9f0dad",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73417ce1-5393-4b10-ad35-56f420768db8",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b5bec61-8a8d-4fee-9048-9e41cadf923f",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae512621-23c0-44ff-adfc-6b577ae9a695",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "310a50f1-587e-47ab-9bf2-40e39ada8d16",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "035fdb5d-bc19-483e-ba26-a9a271c1848b",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11b51f0b-c80e-46c0-a6ab-1f1c71177688",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "838a0b21-2877-452c-b3b2-ff833e8532a0",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ca9aa8d-88e5-4571-b554-3747abef6454",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe1d4285-149c-4fee-84ab-6f6621db628a",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da313763-7439-4859-bf89-f23ae65f4d75",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df4503a5-8d1d-44f7-86b6-625f275ec737",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6cc05a77-313f-4a5c-9eba-dbe33028126b",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f5345c2-a967-47d9-adea-3b3b4173bc25",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67e2a17f-a00b-4ecd-8e62-fb6d84da68a0",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca1649d2-e6b6-4650-a969-42f99e551aae",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a50ce3b-d004-4c76-8c33-bd1535ede531",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "631d2f7d-9739-4be1-a0ba-6823f2c49d43",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37d682a4-a3be-4fc8-ad89-0f20fe8df5fd",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f351590-6b27-4d8b-a6b9-b89b53d62974",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1a77561-7cd1-4add-8247-5be158af704e",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fd0244c-7ee6-441a-8b94-dbd38267b1db",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d7c6eef-29ef-41eb-a0d4-a409894ebe02",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c0bf3df-0fe9-4794-a693-7421287cc79d",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e215adf-1cb7-4cb9-9ed0-26c7e1e9a1fa",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da254f07-04ca-476a-842b-fc2acb5495d6",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e679897c-26c7-4c55-bc8b-a6c2bcf7d506",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e065c58f-f5fb-4e32-b487-4f85078c4c66",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35e1057d-b72d-4eb6-8def-aec43c8915b8",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f26a02e-98e6-4141-a1c2-d2cb6aa2bcd3",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dddbb42-39fc-408b-907f-a072fc4aa77f",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4df8b7c5-e8d3-443d-85a8-88a92572e53d",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60ca00b1-4047-4b4e-bbde-80bab4b9e265",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d9a4eaf-83f2-4531-84c4-6aff462b9b2a",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fa6247a-3548-4e7a-9524-a127e2bb1be1",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b2fc6d6-7a56-458a-88f8-4d249b045fef",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d17ff4c-0419-41c4-836a-1b25cc528942",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4c61174-f186-467f-b0a8-d83b09003b1e",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b5b44c1-e7ba-4545-8170-338cea6f4730",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "214e7cf2-8ec9-416b-a776-64a8e336a4c4",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ece9677-1b58-413c-bf97-5b92a9108f49",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "63a98aeb-83e6-46d8-ad43-b7781dcb29b9",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\tselect\r\n\t\tt.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand coalesce(d.name,\r\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tor coalesce(d.name,\r\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,\r\n\t\t\t\t32)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0945 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2582 as GBP,\r\n\t\t\t\t'2020-04 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1115 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2349 as GBP,\r\n\t\t\t\t'2020-05 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1234 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2389 as GBP,\r\n\t\t\t\t'2020-06 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1772 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3087 as GBP,\r\n\t\t\t\t'2020-07 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1938 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3364 as GBP,\r\n\t\t\t\t'2020-08 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1819 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3163 as GBP,\r\n\t\t\t\t'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 6\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand a.id not in (1491,1477)\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\tselect\r\n\t\ta.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619f86b074cfc4002dc01b92",
                "provider": "MySql",
                "parameters": "FhwKndxsEm4karcTRhcRhQ31JuodaLCOkLCPAL5UDyKQmplY4PGQirEicte+5XlO7CmeguqIciMcA3dWSPlLRdyZQQBa8rSl7481iBoEVleEKNnY0oZY59Uua0u3yiz/U5itDzyqwT3hV27JP+osZrKYLMelBUn+F7vnCn46CtacVjNzMfL/BmkfA2U0DhrLnI0aG8HaWhblMUs9PMPHSLPgZ1yWRCKlfMFEAtsVU51Jg4PyWiAT5+nvRZJBKlUf",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c3338877-b11f-4595-9e41-d7fd0ee9e397",
            "fullname": "MySql:MySql-c3338877-b11f-4595-9e41-d7fd0ee9e397",
            "type": "extract",
            "name": "MySql-c3338877-b11f-4595-9e41-d7fd0ee9e397",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1031bf94-7196-4a2b-8d08-7739efbcd3d4",
                        "id": "tq_S0qqhzqWf",
                        "name": "FXVC_eom_open_pnl",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "52c3954c-a662-489d-878d-0a53052106d9",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "796f4cd2-8f0b-42fd-9b14-348a3f3dc419",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "98cb518d-1a73-4e1e-a27d-0869a8ea7eca",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2527ba6b-4abb-442a-9e72-ae0e00a55115",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1d6dba2-7519-43b8-9b2b-a075ffaeaf45",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14339a9b-ab5b-4bca-96d3-b3bb8b022fed",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "74d3536d-dac0-43a6-a514-07d47b5e797d",
                        "configOptions": {
                            "importQuery": "select `date`, YEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key, code, site_id,employee_key, open_pnl\r\nfrom\r\n(select open_pnl_per_day.*, case when `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date` else last_day(`date`) end as eom_date \r\nfrom\r\n(select  case when a.id < 540973 then a.date - interval 1 day else a.date end as date,c.code, cast(e.id + 1000 as char) as site_id, concat(cast(e.id + 1000 as char),10006,d.user_id) as employee_key, sum(open_pnl) as open_pnl\r\nfrom open_pnl_daily a \r\ninner join trader_account b on a.trader_id = b.trader_id \r\ninner join currency c on b.currency_id = c.id\r\ninner join trader d on a.trader_id = d.id\r\ninner join brand e on d.brand_id = e.id\r\nwhere d.id not in (1235547,1235546)\r\ngroup by 1,2,3,4) open_pnl_per_day) eom_pnl\r\nwhere `date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e5f",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6p52/3KRwedCFhQ3cLF+etepdHCOpmr/cGgfydyq/glgqLHvt/Jb2zo8+neaSyzj+bn5Y7jXBnJaM4QGCcr8n5laPqCxB33XB2QRHH2NxGw2DoB0FBqiVbF8tQYJAjFrHPq7cjvQFZG2GPbxX1SXvjxkXvVM9ukUhf7Y9PaGKs0L",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c5e06b10-caf8-4bcd-b1b0-9cf285fcedf7",
            "fullname": "MySql:b08f9672-c5ae-468d-a5bf-307aea6fbf75",
            "type": "extract",
            "name": "b08f9672-c5ae-468d-a5bf-307aea6fbf75",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "5fe24d2b-3970-4b10-ae7f-43c1fb7d1bee",
                        "id": "tq_HXcdhwAVm",
                        "name": "365TradingFX_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "dc254411-28ad-4434-be86-1e705ff86ba9",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd85615f-4d5f-4c02-856c-5560b64aa142",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2f79eeb-4bbd-4ff8-8270-11d86246e5f5",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16cba2fd-218f-4f31-8ec8-93803af88366",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eded5d1a-dbeb-4966-9e4a-b5c800671bb3",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6ecf2e2-5658-459e-9d32-f0770d00f82e",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8c12958-2c29-4f76-aaa8-69bc2b109060",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce76f60e-c74e-492c-ae96-3b12b08134f6",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f311cd97-e92d-46d4-aa3e-d1025d13e110",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db98a544-c576-4a7d-9de0-51311180bc9f",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "f27fca3d-b9ba-40e1-8bc3-9bcdfe2ee4a9",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6bd6780f2002c37ec35",
                "provider": "MySql",
                "parameters": "WpjwuHhqzfDIdAFVxxbzsI0YjwvC+DbfC5SOQEIG9Hv/ov90B4e996K5jgUO+RnMIymf8vUv4ZkKAz3a9ZjFWfFx0Vo47BjpHtnTXLtkifQRqyaZfd4D6O1eqmErosIKNYe9BaLz/Dcd/UP9mDlqVceymGdLGHoVvU8f/jie8mwEQUF6aAirIkBFxSa+GAc1y/33qpuBkVC0lkCPxLhwxjFEew4CVf7nWq1YJkAA++dxReSWYPaOBwUZ1W5/aDZr",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "cb32af07-5750-4e4a-b824-f20b2f6812ec",
            "fullname": "MySql:66c4f315-99f3-49fb-923a-2964a41a0ad6",
            "type": "extract",
            "name": "66c4f315-99f3-49fb-923a-2964a41a0ad6",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "31fdb087-7cea-4a9b-aac3-e4d9ce28826c",
                        "id": "tq_Svy1x4aOu",
                        "name": "NostraCapital_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2b1f1c4b-e279-48bb-9ec7-e50048147e2e",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "018631ff-0e8b-4256-8d7d-7239fd7f8013",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a806a65-6539-4544-a9f5-b15e65d4a9cc",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40b77421-8085-4104-b448-727b9ea58445",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2b097d8-730c-4520-9c91-1a30ea0a3e47",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8d13008-0cd5-4908-b6c3-ea08693036ef",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "b5912dcb-3cd7-453b-83e7-e443759938a9",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e65",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6mkpXbI+4cVPcW9QmdR/OpFY0NV6lOS+yIHmY9aWUhUzSj1KLvCfMgcIqWzFtH2wB4wDE6J0O3kIYCeCTy2Vm2FnBTBcZ0ejYO8nr2tUHC3cyjEC9VpB/CP/XWAQHRXQ8biCOO3g3QegnOXaTTb/9ErFOuEJ8WFWhUXRuCVMOFyl",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "cd749c4e-b84d-47fc-b5e4-2e4f67948f82",
            "fullname": "MySql:4cf37126-85c6-4b2b-8572-4e81d3a1cc39",
            "type": "extract",
            "name": "4cf37126-85c6-4b2b-8572-4e81d3a1cc39",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7979ba3a-80f1-4d35-b162-dc4b52b18a1a",
                        "id": "tq_ThKn9wLxC",
                        "name": "IvyTrusts Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "bc7d1c1c-1389-47f7-a97a-b1ffd6840fa3",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "915f0521-2794-4102-972f-71c7e2954e89",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "10f320ea-5280-4296-b223-41546ef140a6",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7d5d493-6507-47ea-ae0d-dab6add1184f",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e6429bf-cb7a-49ea-a747-f23faed843f8",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77d90309-c79a-43de-8d74-8b9c70f66b6a",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57803c57-07c8-49ef-99b7-37b83e136588",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27204b53-d1e0-4c4e-9b7f-54b723b248b7",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cfcf80be-7b3b-44bc-89d2-835a524bcef1",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbab3880-43fa-4a51-a86e-c6f410ed109b",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c4689faa-e5b5-4cab-bd29-b37d0c36fe90",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id  + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10003, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name\r\n\tend as department,\r\n\tgroup_name.name as group_name\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect a.id,\r\n\t\tmin(c.id) as group_id\r\n\tfrom\r\n\t\t`user` a\r\n\tinner join user_group b on\r\n\t\ta.id = b.user_id\r\n\tinner join `group` c on\r\n\t\tb.group_id = c.id\r\n\twhere\r\n\t\tc.parent_id is not null\r\n\tgroup by\r\n\t\t1\r\nunion\r\n\tselect\r\n\t\temp.id,\r\n\t\tmin(user_group.group_id) as group_id\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect proba.id,\r\n\t\t\tsum(ch)\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\telse 0\r\n\t\t\t\tend as ch\r\n\t\t\tfrom\r\n\t\t\t\t`user` a\r\n\t\t\tinner join user_group b on\r\n\t\t\t\ta.id = b.user_id\r\n\t\t\tinner join `group` c on\r\n\t\t\t\tb.group_id = c.id)proba\r\n\t\tgroup by\r\n\t\t\t1\r\n\t\thaving\r\n\t\t\tsum(ch) = 0) emp\r\n\tinner join user_group on\r\n\t\temp.id = user_group.user_id\r\n\tgroup by\r\n\t\t1) user_groups on\r\n\t`user`.id = user_groups.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id =\r\n\t(case\r\n\t\twhen `group`.parent_id is null then `group`.id\r\n\t\telse `group`.parent_id\r\n\tend)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d43b6780f2002c37e9e7",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiNCcMibb1+BB8XVxNqk1WzyO+TFmKpoM2bSX/Ivm7/xq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ce250e57-e4d3-4029-a680-517ced070633",
            "fullname": "MySql:3901d979-d90f-43e9-a881-e18ca85d6974",
            "type": "extract",
            "name": "3901d979-d90f-43e9-a881-e18ca85d6974",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ea287fea-25c9-4e12-99d7-45207c5d3c0c",
                        "id": "tq_oL1E2foiA",
                        "name": "BendigoCoins_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c0d2b4e2-42c4-49d9-b992-ae968c3e007f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbdf68b0-82d3-43eb-9480-6cadf01ce4ed",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8970b597-034b-4765-8204-67f8d52fbb87",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea1e7525-58ea-4ebd-b251-666bfc3f34e7",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "018cf650-5c43-4765-b25b-a77640724518",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c475a08-bd13-4af5-bfbb-5ebb88c973db",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9086708e-67c1-4b3b-94ef-d6ce020d23ef",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e2bf65c-db98-4f75-8f6a-b9e5ebc650ce",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "2c427d47-7086-4c96-9cf5-6fd71588e90d",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "616021c39d5c67002c6f196d",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLYe2SGfT8Lds+akycpW5+K9YO+8fTekLNVbA78DM/OCWbxUblK2Id8YJvnNXUQ+eTIAHMN/W71sURfgBeS0WwQxNOqj84HBxwBZ6il+EKFmHJ9FWKQZm+UDy5OxqZbFAkXbpIyiPYxJBez63/L55hNPwBFOT2h2PzJQNrmoEZCdMcWAZeNnU55kjKL1mdEhkXeRVJc9RJItZ3XYlFNc1pmocYfl2UZpPJAOkcdJcbO/5",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d12dd7f6-e589-4be7-8282-843065896d6a",
            "fullname": "MySql:MySql-d12dd7f6-e589-4be7-8282-843065896d6a",
            "type": "extract",
            "name": "MySql-d12dd7f6-e589-4be7-8282-843065896d6a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "944e679d-dcee-45eb-9acc-bccf64a0c102",
                        "id": "tq_JNs6C5YUK",
                        "name": "dw_params",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9823c6d3-757a-4728-9bc6-d9697537b987",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "756180eb-eaba-4353-872b-f881bac00e90",
                                "id": "param_id",
                                "name": "param_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "36f4fe41-c204-4472-a488-d828c3f026c5",
                                "id": "param_name",
                                "name": "param_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31cf7ec4-5098-46c6-87b6-d5d332f1e25b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e783db38-d4b3-46bc-8429-9787ffde6c57",
                                "id": "subject_int",
                                "name": "subject_int",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b4e54926-d129-4eff-99b3-c4e60c864e18",
                                "id": "subject_string",
                                "name": "subject_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ca01a58-412e-49ed-9146-cf2ea8764538",
                                "id": "value_int",
                                "name": "value_int",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "021232c0-44a5-4c4a-b263-9aabd9a3b5ff",
                                "id": "value_string",
                                "name": "value_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68515b57-bcb0-4c13-af3e-5e9bc90461a0",
                                "id": "additional_value_string",
                                "name": "additional_value_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "277e777a-c3c7-42ea-8a23-3038c42e9aff",
                                "id": "last_update",
                                "name": "last_update",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "2aefa932-281c-452e-8e79-d32b3893228f",
                        "configOptions": {
                            "importQuery": "select * from dw_parameters where param_id = 2"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e6d",
                "provider": "MySql",
                "parameters": "vbzYfS4H8zKaaa63Q8eVyx36cxK7oYg+4Q5WunfT3zgdww2iSGhTLrUnq7V9U0erIOY0jNYmKt9GMi/AOy4uJor53Wy5pKADZZQU4IywmnjHaGH4fezFLpM4Qgb/nP5Qo2z3T75JjWg0asinZRH4nPIpWIWzjBZUhPLin/PXCjhJiUvrOtcx64Deeph0+EQDy1nQEeRpJE9+RWm+KH4ERg==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d19ee410-5143-407c-9ec7-bfcb51a5c7bb",
            "fullname": "MySql:67fb4612-010e-48a1-99e2-d959fc42b019",
            "type": "extract",
            "name": "67fb4612-010e-48a1-99e2-d959fc42b019",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "740c287c-2747-4365-83e5-909fed936deb",
                        "id": "tq_78SOzbcMD",
                        "name": "BitfinityFX_Customers",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e910b650-d4a0-41f7-9682-a75c4b5abe33",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a99c2129-d422-4c7e-89be-99b373cb5724",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c292b5e6-fd3d-4bc9-8ff6-df7a7ee63c7e",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac35f733-0923-4964-b6da-975d1af2491b",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d998524-2bae-4e2e-974e-624ebfcc63d9",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bb9f418-d335-4c05-a0f5-b5ad96ba50ba",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66a5e075-2cde-402a-a212-f61e031508a7",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "359fc02d-e54e-470e-aa51-7c6a0a020dc7",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d99d0772-7d04-4148-a3d5-b95151287848",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f49c6f42-19fc-4693-801e-b90edbe152d1",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba361090-49bb-467b-b25d-4f6628c17cb8",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0143ea3-e89b-4ed7-8e2b-8b68ca1ed915",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83813d04-4fbd-466f-9aed-a23608a8a6e0",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4994b04f-8d33-498f-b0db-adf5565e7112",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f2d16de-96c7-4fcf-aef8-8e9a73b5b692",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9affebac-4920-49ed-b8bc-b3dfa77d2da1",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "144201b3-c991-4614-a767-f2600543f0ad",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d554d429-6955-4270-98c6-1d43ec0b086c",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a6089377-03bf-49f6-b8a2-46e4bd006079",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c5e9236-346b-4b84-83a2-316842b0ce62",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "559d3180-760c-4a11-803b-9b53721cca04",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15a15576-e13a-4e48-b515-f0af5a6729a1",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6ecd09b-4bfe-4764-beec-455068854775",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74b8e5c4-f804-45c5-a53e-d45d3aa88f0b",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de8d8c57-fb8a-4f27-b065-7f6c0cc93c1e",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e048b641-17b7-4ece-9752-4eca57102128",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77805d17-e1f2-41c8-9558-5e7dbcb07ae4",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ed1079f-e97d-4078-ba7b-233db9ce16be",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87f57f83-91a3-4b88-847d-77a4f4ccfc1e",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30a63e81-6e21-43ff-b5ac-c6647e0ae806",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ea60008-2788-4d44-85e1-9f74376576be",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d4df151-5884-4ea8-b0c0-f060e0ac25f0",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff1cfba5-ead2-4698-ad65-f927fb75e4a8",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92359a32-27fd-4062-aedb-bd49b8263853",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e900b39b-e91c-4149-81db-ce63edb1f893",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "faede360-8c86-4265-8102-b73f3fff2cee",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b39c4d56-71ac-457b-b4dd-bf106436566d",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ed7c3dc-ac10-4409-9ca0-fd6355e9ed0b",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62f11336-3ba5-46cd-844b-54a0f524c08a",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2044213-0cc5-48c2-9097-d34f3f349636",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf378399-258b-4d4b-a2dd-ec78d4814485",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5311cd6f-8a62-4306-976d-3726058cdfff",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c32943f5-f78c-4e9d-b3e0-aec8070f4aa5",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9fe9882-39fb-408d-a2af-e15b70bce282",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "897dc683-b060-4bad-af92-f4548d363777",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88f47a4a-6600-4acf-995a-bf6687ba032b",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd4dd8d9-65e5-4394-a5e5-0d3a1ef0430c",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac1a3951-2fd8-4fe3-9580-79feba1c0313",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8170ee6-322a-4e3d-a0d1-c09b4f1862b7",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5319a7fd-3c46-4fb3-b98f-e01f6a4f443b",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f09d702a-eaba-4115-8675-19767cd87704",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fae2a786-24b6-46f5-b53a-f71804d500cc",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48aff3a1-0797-41ac-9487-9850714eb4ac",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "910ef10c-9afb-41bf-9263-1df4d1824afe",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ac6cb9e-5477-43d4-ac45-450cf871ee51",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "74b8e5c4-f804-45c5-a53e-d45d3aa88f0b",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "a5f0a3be-8e28-4215-abf1-1e2da08a0017",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61951684fd9249002de3c525",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8C2q0mVY+o2WF4+UVAyIhGiWhSY3+Y93kyI+zrKj2Bg5HiBiNB45Ta2GGPAsEoYp8/7dK0B1NeCzhErO6Xxg3c338i0MevnkC9Yi9QGlRnh1xn5Kjp5TuCxX28iusyU+paJ5wPXzkAPGHPDNhGasnoxvMsxipUWeTclTSatITjv9eQNNH4tFpXr1gskkcrIfglENUveS4Og+oLFLIuz1xQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d68350be-43c6-4b0c-8b97-60b9d022a3c2",
            "fullname": "MySql:MySql-d68350be-43c6-4b0c-8b97-60b9d022a3c2",
            "type": "extract",
            "name": "MySql-d68350be-43c6-4b0c-8b97-60b9d022a3c2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8ed3c877-237f-43bd-92e8-69241db5677e",
                        "id": "tq_3GQiQgakM",
                        "name": "Market_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9e1d1cc1-1e2a-4c32-ad4e-275af5c43e01",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05a466b4-5ad5-4dc6-9b9b-cfa4ed1088da",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81652ffa-9140-4073-a512-3bdbdfe4f069",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb45c172-a41d-4f08-ba99-eeb0cd6ee259",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "13f4dbec-65f0-4cd0-befb-2d1b928d2858",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d0da3906-d5f4-40f3-9b00-7377c49ce082",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "706fafab-6d1c-43d1-907e-b6e8e3d77400",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02c93715-204c-4be5-a0c3-b3dd707d0e48",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "7098ffee-ced3-4702-b39d-6e1f48f79e4d",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e71",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFDtCLG4kXh87E24rRoJBo9V7meNmblVPjKFzTtoOKlxwWW705mQdR/VhIwhrot1AlfqgXFLiU0ps0e+38Xpvf04=",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d6b4d94a-6a51-4b40-b9b9-f2e8f7136f7e",
            "fullname": "MySql:88c84346-7974-455d-8256-85b64f806aa7",
            "type": "extract",
            "name": "88c84346-7974-455d-8256-85b64f806aa7",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "10ca41d0-8952-49f5-b0f5-1d94eae3fae9",
                        "id": "tq_xjrlEEPD2",
                        "name": "GeniusIG_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2b5f8a5f-94eb-45a2-9ded-597dedd37011",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91590eda-e0ab-4af4-8941-03b6c79fb3bb",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a422a9c-20fe-4120-ae4d-89c86b85e8d4",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "315a2171-6271-4185-9b9d-92293fdfbc8a",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64e62305-8b42-49b4-93a6-9a9fabc6ee11",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7887e3c5-9fba-4866-b4c5-5d71ac2e1273",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e76f8de0-b603-44f6-a9f0-c43ad5f2ca53",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20a45fcd-043e-4216-beac-e6ce12cadad3",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5481d7e8-3c0c-49e2-8b7a-e937b05cc58e",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9acb91d-e8a6-42f6-836a-c8343b35721e",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "a1a8209b-1832-4d57-ab89-66a168e7fef5",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6626780f2002c37ec2c",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCkM37LkFbGnRhmt2tYLFqO1gr0leFAbxvqr45h97aRL2uFXV6bnmXjrx+upQdOgFiG2n1XzowSr7ML18mjmQhnzqjq1V2FUQMfFFcLg11wwiXozn0iLcNZcjGmBoyCW6IdyK2k1UjDiKqlSqoJZSuzAb/GTm3+JvHrvJTMCSB28",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d6c4d661-fbbf-4ac7-93fa-81523d14c1e6",
            "fullname": "MySql:204d6303-e514-459c-b9b4-6161b3074502",
            "type": "extract",
            "name": "204d6303-e514-459c-b9b4-6161b3074502",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "617a437f-9769-4648-9e4a-e04fe752a523",
                        "id": "tq_cUwWqdGrB",
                        "name": "Chelsea_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "06ed7692-6db0-492e-85b1-aa2bb30e5026",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c50bb1c7-5d42-4808-accb-71316249b963",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67a4ee45-6569-4374-8681-221e22cfb6b2",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e8f6bef-26cc-4b1d-a9fa-0251f30586c1",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30f9a12a-9b9d-4da2-9535-730833ab1e1f",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3086b189-6e2f-40ff-b350-76315cd37c56",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f29c5a43-a69e-4c7e-a19f-ac320b8397f5",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2be8c562-5d66-452a-a895-4b174be83743",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17046f51-f7e5-4d7f-b8f9-54e54f0e4aa8",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27b062de-b396-4406-9972-a984b57630bd",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc2d2089-0702-4874-9385-0503dfe08d56",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "986da5a6-4d72-4b7b-b1de-88c3ca9776fb",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5dfcb0f5-a92e-4bfc-9083-b38a80a7e591",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4bfb9d5-0f78-4102-8e7e-127e20798185",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1e146cb-fcd7-47c5-bc74-61994c9d9975",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f63dc5c-fb4b-4cc1-878a-dd7ac4e52a50",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a8063b1f-a9d8-47bc-8050-765d25bfdda9",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "78acd13b-bcc1-4180-aa3c-1e7cead3d7bd",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "74ed9054-847b-4fbe-8285-52fd5501625c",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff4eee83-43c2-40e7-9f4e-894b270eedb1",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22c1a4e5-2e33-4fc4-9e3f-89f632a0b038",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a416c87-b237-4cb0-8137-3708b0774e53",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "903a5648-a3b0-44a1-b05c-f9c99271ceb0",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c3e3aa8-b7cd-45c2-9303-93d40244aaf6",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "401e4679-2c80-4144-b8a9-902391fab4c3",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c85de13-9fab-4f41-8320-6d102afcf14f",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "403dc309-cd8d-4f17-8b47-84452b21fa2c",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aac1ee49-6f90-44b4-95ba-2d00c4dc79ac",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24c03bc7-7787-4886-9770-1c569f03e0f4",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff0f9c4b-28d8-464a-a41e-1f9571ca9ec7",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5a6cb2e0-6700-47a1-829d-e6a06297b110",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0888a2f-0a24-451b-a697-0901fc7a058a",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f5930f7-fed7-4118-88eb-20eee2b562a8",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "240778b4-7898-47de-9305-eecf1efe9d1c",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61e392dd-4e74-49d4-aa1a-1029b943cb6d",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5231c261-3924-4bf2-b04a-2624eaddf9f1",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37f2557e-b444-44da-8c42-7b68f8d1e4aa",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "115a91e0-fa85-4432-80c4-1ab156d06d41",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31c499e2-cc74-4b9c-9329-68baedc973a7",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1839810c-68d3-462d-9573-f26e3034ab89",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b451f19d-5eb6-4fa9-9e3c-27af42eece14",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "090f84d6-fff8-426e-adbc-94bfe5c91096",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46212a34-d267-47a5-8206-f935ef9ea7dd",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d33acf8d-633b-4967-88da-8c98ab171ccf",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c28cea0a-45d8-4b67-835d-a20d145ac342",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a98e07a-3031-41ef-9735-da8f6a5db67a",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2cff7743-5231-460e-b93d-89d02abb688f",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9115a1c-a4fa-4cf0-8310-feb902f707cc",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0e9b259-ab17-4a0c-90fc-48723e69ab83",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d041714f-ae1e-49b5-adde-3e3b53af80c1",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0cbcd651-e27d-4e19-8a8b-7e8d7bc89fd1",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee14b1cd-155e-4219-a243-22e05986e1f0",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e21ecd40-02c2-431f-8354-5b9a4694519e",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f07ca07-a4d2-4276-acf8-d97f4d2c16ea",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5aee3e32-87b8-43a1-8b66-83b8da966cad",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "4c3e3aa8-b7cd-45c2-9303-93d40244aaf6",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "00c36ad5-5567-4b29-9c9e-1cdb55b802db",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d7396780f2002c37ec3a",
                "provider": "MySql",
                "parameters": "BE4OxiDqsaVb+1ukLM/AG3kiM0mBmEnf5+RF0FNWdMvVMRLKEGHP7i8Jb4OVv7CAoJrH7a/nkykrGiit3FSG/m85DPOX2IUqB6qOs2clw5riXmxFSMuiF3F8MgrP3MH12R4ofvsfF/fYNHAGVdVhOGjYUgjhzKoG+h+ur0i61f2xq5hHO9UjwqjzFmrYrN8ntau9AUUkD/MC6QOashL2AjWRcvpvZbZikoelSn8/Tb4Qv8PiC23gjgUiJBr0/QAq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d756e884-59fe-43ce-81fd-522630bb501c",
            "fullname": "MySql:cbce93e5-5407-47d5-b070-93ba489a8889",
            "type": "extract",
            "name": "cbce93e5-5407-47d5-b070-93ba489a8889",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "230dfb63-1836-4141-af45-41de246f26a5",
                        "id": "tq_vdx7AE6PA",
                        "name": "GeniusIG_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "32529e68-ab31-475b-b8fd-ebcefa0c60f9",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1571eff7-f906-476a-b115-20bf94703588",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7faf1fc5-1e84-422a-951d-a7dd99898442",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e64182c7-714c-43d1-af3a-969d40a3d7bb",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c88211c1-c27e-47db-a7b2-dd35d2bab922",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a00814a3-2567-418b-a4c9-9d189d0014d4",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e585f890-fd48-4820-b828-0a16e009488e",
                        "configOptions": {
                            "importQuery": "select\n\t`date`,\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\n\tcode,\n\tsite_id,\n\temployee_key,\n\topen_pnl\nfrom\n\t(\n\tselect\n\t\topen_pnl_per_day.*,\n\t\tcase\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\n\t\t\telse last_day(`date`) end as eom_date\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t`date` - interval 1 day as 'date',\n\t\t\t\tc.code,\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\n\t\t\t\tsum(open_pnl) as open_pnl\n\t\t\tfrom\n\t\t\t\topen_pnl_daily a\n\t\t\tinner join trader_account b on\n\t\t\t\ta.trader_id = b.trader_id\n\t\t\tinner join currency c on\n\t\t\t\tb.currency_id = c.id\n\t\t\tinner join trader d on\n\t\t\t\ta.trader_id = d.id\n\t\t\tgroup by\n\t\t\t\t1,\n\t\t\t\t2,\n\t\t\t\t3,\n\t\t\t\t4) open_pnl_per_day) eom_pnl\nwhere\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e77",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lNqu9YjU4aq2UrD1B4elNg9lVKQFHRdfOjSDmdho2O0BcE4ZGSnDY66nmV13xmTftBiPAwAPjQRY3WaG8+JajVjq0bDUxyyXSBahftWfD+BqWv3e7qI4k/hTBGAZLgcMyNOeLODquQbmqREECx1kSDm5qX7TJaisk1mvdLWSNPK",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d7a22a51-ee8b-47d1-8300-1ed5d9edcfc5",
            "fullname": "MySql:434db7b9-b47b-4a64-b713-debf28543d93",
            "type": "extract",
            "name": "434db7b9-b47b-4a64-b713-debf28543d93",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "e594e3e4-f161-402b-bf9f-8cf8e3cdc31c",
                        "id": "tq_1j74vmdcD",
                        "name": "AussieTrust_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "4c206738-a0d0-477d-9d91-1fe396d31b09",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7844f6de-4d54-470d-99a3-4c144bf372cd",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d804682-ae10-4056-b75c-d3c55569d3de",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "011db082-8f76-45ce-b4b3-20ebe3888691",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64830a00-df05-4457-996a-c276871499cc",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be16f8cd-6eeb-4731-a992-9fd46bff3d34",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "252c6200-9d4c-4110-885c-661a9da0cfe0",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45b5eda6-821b-497d-868f-06fdcba64b9d",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d054224d-7990-414e-b76b-1fa42457795d",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6b151f9-dbee-4167-8a06-4ff6f7c4c8ad",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "2cc256c6-6b4f-4f48-bbc7-dc0302de1b12",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id  as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d5bd6780f2002c37e9f2",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "db73e480-b5e5-47fc-8e52-205c2666fd85",
            "fullname": "MySql:MySql-db73e480-b5e5-47fc-8e52-205c2666fd85",
            "type": "extract",
            "name": "MySql-db73e480-b5e5-47fc-8e52-205c2666fd85",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b963fd5a-00d0-4b33-a8dd-c111148e36a1",
                        "id": "tq_R779HIeDF",
                        "name": "Ivy_open_pnl",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ba044bac-f146-4bf6-9783-c5e2c3d96140",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7a08726-408c-4c07-99c9-6de185578878",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f46e0d2c-4aa4-41a8-a6d7-6586d7b32961",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "46847eb8-df7e-430d-874d-1a75ebeb0b53",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd60ad3e-d451-488f-a6d3-18d429a3ef5f",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "37d3fbe1-fad4-4a5f-9db4-1cc59b6538a5",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "39a7e25a-0422-479b-a922-60b0472f50ea",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "442aa278-2b05-4ab1-bf78-4a63cae9c222",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "a06bbe2c-8e63-4e10-bc06-32dadb60eca5",
                        "configOptions": {
                            "importQuery": "select\n\tcast(brand.id + 1000 as char) as site_name,\n\tconcat(cast(brand.id + 1000 as char), '10003', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl\n\t\tend as open_pnl_diff,\n\t\t@last_id := a.trader_id,\n\t\t@last_open_pnl := a.open_pnl\n\tfrom\n\t\t(\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\topen_pnl_daily\n\t\torder by\n\t\t\t2,\n\t\t\t3 asc) a\n\tleft join (\n\t\tselect\n\t\t\t@last_open_pnl := 0,\n\t\t\t@last_id := 0) b on\n\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on trader_account.trader_id = trader.id\ninner join brand on trader.brand_id = brand.id"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e79",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFA9JlqyFqZAeoogKne8sIUpkNMpEfeosVFHWt/W5yFiTbz403VSj8P6QpKG7YhSJTL2Lz+jvz3+sojz3OJE6pKc=",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "e7863c49-cf26-4420-ae3c-aad31ae5e1a8",
            "fullname": "MySql:ce09cb46-40f2-4041-a092-4b72f3fcfce4",
            "type": "extract",
            "name": "ce09cb46-40f2-4041-a092-4b72f3fcfce4",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7e206126-0012-40c6-a2e1-6c5795b45ac9",
                        "id": "tq_fstEfxbGA",
                        "name": "BigBitMarket_Customers",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "4c9a2b1d-2c7e-4834-8793-197dead07e4f",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3fea58b-5cdb-46fa-9221-890279768673",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d91d7fdd-52c6-493a-ba40-86f7a0358d7c",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27a98427-62e4-4c07-b55d-295005ca8afe",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f80a165d-7a9d-4877-a127-680ae474b4ee",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0df16951-db3b-4888-854f-37e34d43b11e",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81de6018-0a6c-4678-9862-f34c9a818fba",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19c6a6fc-dacb-4df5-85a9-f68640e1e5fd",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e84b8962-a2f6-4880-9bc0-bb6862bd4e9e",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8974f484-aa70-4176-ad4a-ea1e0ad18537",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45a4feab-aaad-4fd8-a095-d89636032d75",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c090acaf-1256-41ee-9914-60a8f3a6df8d",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0cb520c9-8a60-48fe-ae9c-0ea1077c1336",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64b626f9-e0a1-4bff-8aaf-d9b8e9481afd",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f903470b-5b28-485c-adbe-6f07deada30c",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd2fd9b7-882d-4a9b-98c0-9f5a43704aea",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e867227-c8f6-4aae-b5ec-44cf1afe6b4e",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "86ddd225-f9b0-4a23-9c8b-375202abfadb",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bb16b8af-4fc0-4816-b582-f2cbc1641fe9",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64a100e9-021b-4887-ad37-8ef061c88deb",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "629c6b43-f7ca-4850-91d7-99eaada0387b",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "028bf384-946e-4d97-bd48-1d5d6fc17dfc",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b81ed784-1c0f-43f8-841d-9f264664d49c",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25f4488f-84be-4bae-b05d-af61f67fca3d",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "085b1948-80cf-43f0-a170-06e748337b4f",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47428d6d-c3ce-4442-8bff-04963a8023e3",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96ba3f57-61d6-4a95-891b-46e7f3d6e988",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a40d4910-291f-4fa5-b2a2-4160ebe19a8d",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f9d6107-0f89-4c01-9790-3fc1e5638be7",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e59ebf3-7ab9-4e36-ac58-528fc1cfd0c0",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3df3aaab-b699-4774-83ce-405adc04c6d8",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "027ce518-b665-4f46-8706-39bd05c3cef7",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e2d8f3d-16d4-488d-ac0f-8b8aeb2dc84d",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ca224bf-0636-45af-94a0-f251fc7308f9",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c2ed3037-a6d1-4f8c-98c9-01b0d032a400",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d29ca14c-d5cf-493c-a509-2f27355126b3",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6854d7e8-9b35-4026-86b0-f976c564f8d4",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d096d2e2-ab91-45c6-8ecc-262602e6f535",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f92d5774-5d6b-4ecd-bb88-0bfc8aeaece4",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d89b3f9a-7c16-4ead-a6ba-4cb94e0cdf8e",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c1bb762-63d0-4419-9d20-2a07c793c275",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5295cfa-a18b-4c81-bca8-5f45d1698852",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce7d8f49-230e-48ae-8e0d-a8978df39046",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77fa5752-6744-4852-9ce9-53e7883d90d1",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "071ff7c7-ef3d-411f-8a34-cc919f0a1a7a",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27c4e47b-353a-44e2-b695-767bee8c15da",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7a0a78a-87f0-4f79-8e58-5bf7f212cd49",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c2b6f8f-e1c9-49d1-a9a9-bcacab48e7fe",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "176f8608-7aa8-47d1-a9a3-bf2317ab5a17",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca91e071-b373-4671-a6bf-2ca1093b550b",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56552291-05a3-4cf5-aa2c-33383858f4a2",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1b51de6-5da2-4253-83d0-8523ef7f0b4b",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3962159f-a821-4dee-af20-dfc62d43d77a",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b67e9e66-b1d5-45cd-8774-775c0eb9e057",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f33df2cc-965d-40d3-a1d4-d6173c56a15c",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "25f4488f-84be-4bae-b05d-af61f67fca3d",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "66cfdc9a-4314-4444-ab7b-9e9093ea461f",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0de23b43ad1002c7a7580",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "e9505c7e-2e6b-4388-a62b-ef6a3107c14a",
            "fullname": "MySql:f5f4bcf5-31df-4821-876e-6202350857bf",
            "type": "extract",
            "name": "f5f4bcf5-31df-4821-876e-6202350857bf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f3d959fa-0371-4804-847e-df714bc3cc6d",
                        "id": "tq_rdRg6le5C",
                        "name": "GeniusIG_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "cc74f727-acbb-4419-98cf-9a3da25e0289",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c512eb21-542a-4913-8096-ee879d9d5748",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1137c2ab-5a48-47a0-8a90-5bf6fe5f44eb",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce2fc755-d124-40ea-a595-08fe3e36a253",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c34c397e-699c-4a99-b6f0-92af011f0e69",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73c35d6e-64e9-4a4e-b10b-aeaad0810017",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08b60884-4184-48bf-b9b4-ec0b3f6259ba",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc35bacf-ca5c-4a0a-8ce3-024a9656e787",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8063c07-d4d0-4f53-a614-4eaa2edc9370",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3bcec47-a599-4a6e-811f-fa0f2010ab5f",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7fccf6c1-46e2-44ba-be1a-09c0b17003ca",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbdb2b37-a1d1-45b4-b9be-5db175806feb",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "207aabf0-4882-4376-aecd-08f97a2bbc94",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f6a8ea4-af9a-4659-9fe7-a2a5ab6a3f7a",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3c47df0-f242-46c9-9edc-b1fb275213a5",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c2a60d5-4773-4681-beb0-be8b51c70cb2",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "60e46cf3-468d-4664-ad30-17f365f582a6",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "494eddc4-d89e-4151-97b1-aa0934caf93f",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "775e5f73-59ed-4846-9fdc-1c917671cdec",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "256ba73c-1efd-4cb5-81b4-b83f0f4fe892",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a1985e9-428d-4c9a-ac24-4103f0d0ab13",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6daec31-bd32-46d4-aabb-cb6321753d39",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a59e22dc-4a94-4125-91d5-98333d6488d1",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "369a0aa1-46dc-4434-9066-194f84ba11ad",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ea42dfc-0736-4cb1-be09-dd759eb967f0",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70a5e351-f3a2-47bf-86e5-d5ccbcf77843",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d9b6dbd-9a24-4254-b33a-c26f1cf9ed22",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d532ac0-02b0-474e-857e-cdef60131722",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5163b6b0-464f-464b-9d6a-f17aacdf2691",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3efee05f-b48d-483a-a766-b2767791b3d8",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "012d91d1-2b21-48e0-970a-d5b979e86b91",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e265a083-3ccc-45c6-80cc-76f73f3c1832",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e3d82c3-445b-43f8-92c6-df2cb0e79759",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5cb7c9e5-e350-4d81-9270-b19db82148bc",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68210197-a6c1-480e-a03c-cf43061364ef",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fb8ee87-a5cb-42e7-946f-ec771d4191bc",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2417bc2-c6ba-4ddc-9040-b7ab14febabc",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aab98d08-0494-4735-9c1f-e72aa729bfc8",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "59948773-b4b3-4a02-b1ba-ae0819971980",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cfd2800e-c0d9-4f43-a817-fc608ea38471",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e12e1a19-a366-4550-bb70-f7be6bd1e7bc",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b976a38-5669-4dc1-9c45-e36115234b1f",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2ff5e08-9e0c-43b6-a022-75e8a0d40dd0",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "372099da-9ce2-4970-90ba-f042195d7ba4",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80f34287-b5f5-4f9f-8ede-ac647f68a49b",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea0826b0-abb9-4cf0-95e3-06e75c27be9c",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4fce8925-60f3-4881-961e-6aeac4facd4d",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f75197bd-c3f0-4333-b0f7-a84b413bbbfe",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6a98937-4af8-4ed0-bd98-f14c5d09c39b",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5f2e7ea-93b0-45a7-8883-4b158e09967f",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0cf31aeb-9496-417b-ae57-b5279ec06653",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5fbfb28e-eaa7-472d-8a87-bfaa761dc67e",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51f3055c-3ee6-478e-8fc3-801f8c1f106f",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13319b2b-222b-489d-bac7-c8f3fe7a2497",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "633ee926-c918-4e6b-803e-c7786f4f4816",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "369a0aa1-46dc-4434-9066-194f84ba11ad",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "da11a5fa-da54-4a03-b1e2-964ad1601497",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\t\t\t\t\t\t\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32,70,78)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,70,78)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32,70,78)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6f06780f2002c37ec38",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCkM37LkFbGnRhmt2tYLFqO1gr0leFAbxvqr45h97aRL2uFXV6bnmXjrx+upQdOgFiG2n1XzowSr7ML18mjmQhnzqjq1V2FUQMfFFcLg11wwiXozn0iLcNZcjGmBoyCW6IdyK2k1UjDiKqlSqoJZSuzAb/GTm3+JvHrvJTMCSB28",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "eaa8ec43-5a66-4fbf-b4d6-b9354def09eb",
            "fullname": "MySql:fd5afdbb-6c36-41fc-9527-fe019d59fd4e",
            "type": "extract",
            "name": "fd5afdbb-6c36-41fc-9527-fe019d59fd4e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "cd40fcd4-dbbd-42ab-bbd6-4b63c699e448",
                        "id": "tq_MT0hT0ZLM",
                        "name": "TheBPCA_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d11e7026-9fe2-4d62-b615-dca8d710830d",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01a4983a-baf6-4e5d-9cd5-2c9c5db72bee",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2776a286-8008-4f41-a787-fa849efa49a5",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ad6bc6a-b327-4b58-be39-ab2e643ba32d",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30a01d1e-aec8-4c41-9221-91755b4a7cee",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb456d2d-2eb5-4beb-9adf-1c01e319ce62",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb17706a-7886-410c-bc23-70d23a15bd60",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3efe16f-6f33-4087-a481-b433dbc05fc8",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0775dd21-0351-4294-9e9c-6b9916704de1",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21f08870-dbfe-4b5f-b50a-72c978ac7b54",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "daaf0aeb-d5f5-43c8-b97d-d2b7db7896d5",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fded0858-0416-4b80-be2d-bea5ce284729",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7fb986f3-cd15-4a72-bbfa-8465be8dd058",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f24d6774-3f6b-4ea6-b233-6fa8f96364db",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a392d4f-d9cf-4c25-b00a-0b2fbaa49d6b",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fae7be18-8907-4e77-a7b4-1b5d4c8f7912",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25c04042-64cc-4aaa-a80f-9382a4d5fcd4",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9654d918-e17f-44c1-bd8a-9d396d8f34b8",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3bfdf3fe-5146-4b80-9027-9d1247a9c29a",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0ffdcf5-9ab9-4ebe-a004-69d8aeb4b0c8",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f89370dd-9179-4820-9077-42a0e30b8d56",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b04d05e9-6463-44af-bd10-1fb20e497dce",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f070de0b-a537-4c98-b680-84318891074d",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f20f014-17b9-411b-8646-a64a2e3a1d51",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad4ae238-c0f4-44e8-809d-66e7083a05f4",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc55dc5b-92cc-4c1b-9204-559b79e24920",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "581db413-bee3-4f74-ae56-f807a07508c6",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6f48826-11e9-44de-a1c2-0e15fb5f1326",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b7ac390-03bd-44cf-a86c-5db0775751f2",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "778e50be-273c-486c-9162-bcb45828f4dc",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "224031d8-15e8-4ff9-b9ba-65a3addbb50b",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92515a8c-0aba-4cf9-bf9f-89eb9846f1b8",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b0c8453-818c-4887-8a60-2cb64e92a470",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0abe2724-a299-4099-ad29-47c5aee1cfb1",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f25cc538-ad47-4e54-8e84-b7f3febba4b3",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd16b10d-8538-4ccd-b7ad-ff4bcc9cc5f0",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "acb616f2-af35-457d-8544-c04bacdc9930",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c274bc6e-785b-417e-ab35-4fd28a4f8667",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00eaef19-b8c7-468d-bb50-e98f0bcd6e78",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2455276a-8a48-4f6a-a4b8-7ef67f7a525e",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a5ec8f2-4d12-4af5-b4c5-5652a49d9972",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96ab9abf-c2e9-4fe1-875a-33378f4f3b63",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9277ddad-7b3d-4ea0-9bc0-a9506e46ac87",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce449771-e977-4df4-9bde-e87430973059",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a535555-26e7-43af-ba0c-08c6f5f728f3",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c255ac07-ca39-497d-ade8-98a3e691c3ab",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7bc382b-be8c-4ea9-aebd-b240fa05d2c0",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9de89c90-314d-4b3c-9de8-008e5e73282f",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c6b06cb-d9f7-43e5-b5f9-d39236917626",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c35937b-a10c-4455-baeb-aa7de9325ddc",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6dad999-5844-4909-9a86-6a3b503ad38b",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "273f75a3-37e2-4ebc-bc25-59b4474f18a7",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2ddb541-79b4-4a23-a563-e9b313af605c",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c59fda51-d5ab-4e4d-ba7e-92e4d48dfa96",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ab9a540-0a6e-40ff-aafe-24caa223809c",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45b70865-33b4-44e8-819e-0f0cafdc2137",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20a5f46e-da34-4142-8a6e-b7f81613989d",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "703613c6-fe3f-42fd-9987-5caa01786684",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21509a53-d06c-4767-9b3e-0636fc26dfea",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a14dde53-f55d-415a-8a57-3ca9ec2fd02f",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56991d4a-3492-48e3-b0dc-648e8be26d2b",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc642ca9-9402-4030-9d96-46a6e3a78832",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b281b37c-85b2-4954-80f3-e6f9b8013a0b",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "75743bcb-6a59-4347-90ad-e579337949fe",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b34bc142-1865-40e0-bdc5-ee42ac74d9b7",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "584d3c4e-79d6-42d8-be7b-64f716402676",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1230abd5-2a95-4184-a5bf-d594fc7573a1",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2858bbb1-a308-435b-9675-5ed95d912f14",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "568d459c-17ee-4ae7-9cad-5c0effdacc52",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7eca702-bcc3-48ae-a798-912bc3273dad",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41070376-98ab-49a7-abfc-1952f01aba78",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cd2a3d8-d57f-4068-9aba-6bfceaff15ef",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b55be74e-ba27-4713-bc18-9eb4505df8de",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34dc14ad-5621-4e21-9909-ae25f80563fa",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76a871cb-a735-4661-bd3e-8711c5e711b7",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec2a18b1-72fd-491e-8575-da1ac426d590",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3349e12d-d1eb-40a9-90e7-745afd985046",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3d9cfa5-aff8-4959-b33a-a55f5016685f",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6b3eabf-5935-4304-a35d-6607f95b3de1",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "329875e0-6994-48cf-a55c-8e41e7356936",
                        "configOptions": {
                            "importQuery": "SELECT\n\taggCustomer.id,\n\taggCustomer.site_name as site_name,\n\taggCustomer.site_id as site_id,\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\n\taggCustomer.customer_fullname,\n\tco.name,\n\taggCustomer.currency,\n\taggCustomer.created_at,\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\n\taggCustomer.date,\n\taggCustomer.YearMonth,\n\tcase\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'GBP' then 1.3\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'EUR' then 1.1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'USD' then 1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\n\tend as rate,\n\tMaxDep.LastDepDate,\n\tMaxInv.LastTimeInvestment,\n\taggCustomer.tr_id,\n\taggCustomer.origin_type,\n\tMinDep.FTDDate,\n\tcase\n\t\twhen FTD.FTDind is null then 0\n\t\telse 1\n\tend as FTDInd,\n\taggCustomer.user_id,\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\n\taggCustomer.deposit_curr,\n\taggCustomer.deposit_usd,\n\taggCustomer.cashback_curr,\n\taggCustomer.cashback_usd,\n\taggCustomer.withdrawal_curr,\n\taggCustomer.withdrawal_usd,\n\taggCustomer.withdrawal_curr_new,\n\taggCustomer.withdrawal_usd_new,\n\taggCustomer.cashback_withdrawal_curr,\n\taggCustomer.cashback_withdrawal_usd,\n\taggCustomer.withdrawal_fee_curr,\n\taggCustomer.withdrawal_fee_usd,\n\taggCustomer.chb_curr,\n\taggCustomer.chb_usd,\n\taggCustomer.inactivity_fee_curr,\n\taggCustomer.inactivity_fee_usd,\n\taggCustomer.overnight_fee_curr,\n\taggCustomer.overnight_fee_usd,\n\taggCustomer.fees_curr,\n\taggCustomer.fees_usd,\n\taggCustomer.pnl_curr,\n\taggCustomer.pnl_usd,\n\taggCustomer.duplicated_pnl_curr,\n\taggCustomer.duplicated_pnl_usd,\n\taggCustomer.swap_curr,\n\taggCustomer.swap_usd,\n\taggCustomer.contract_usd,\n\taggCustomer.rbonus_curr,\n\taggCustomer.rbonus_usd,\n\taggCustomer.cancelled_bonus_curr,\n\taggCustomer.cancelled_bonus_usd,\n\taggCustomer.pending_bonus_curr,\n\taggCustomer.pending_bonus_usd,\n\taggCustomer.fixed_balance,\n\taggCustomer.fixed_balance_usd,\n\taggCustomer.negative_balance_fix_curr,\n\taggCustomer.negative_balance_fix_usd,\n\taggCustomer.refund_curr,\n\taggCustomer.refund_usd,\n\taggCustomer.education_deposit_curr,\n\taggCustomer.education_deposit_usd,\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\n\taggCustomer.balance_after_curr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\n\tb.balance as CurrencyBalance\nfrom\n\t(\n\tselect\n\t\tt.*,\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\n\t\t\telse @netdepositcurracc := @netdepositcurr\n\t\tend as NetDepCurrAcc,\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\n\t\t\telse @netdepositusdacc := @netdepositusd\n\t\tend as NetDepUsdAcc,\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastab < 0\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\t\telse @RealABAccHelp := @RealAB\n\t\tend as RealABAccHelp,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastabusd < 0\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\n\t\tend as RealABAccHelpUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\t\telse @realreal := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\n\t\t\telse @realrealneg := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\telse @realrealusd := @RealABUsd\n\t\tend as RealAccountBalanceAccumulatedUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\t\telse @RealABUsd\n\t\tend as RealABDiffUsd,\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\n\t\t\telse @realpnlcurr := @realpnlcurracc\n\t\tend as RealPnLCurr,\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\n\t\t\telse @realpnlusd := @realpnlusdacc\n\t\tend as RealPnLUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\n\t\t\tend as education_deposit_total,\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\n\t\t\telse @eligible end as EligibleDiffCurrency,\n\t\t@lastreal := @realreal,\n\t\t@lastrealusd := @realrealusd,\n\t\t@lastrealneg := @realrealneg,\n\t\t@lastab := @RealABAccHelp,\n\t\t@lastabusd := @RealABAccHelpUsd,\n\t\t@lastId := t.id,\n\t\t@lastrealpnlcurr := @realpnlcurracc,\n\t\t@lastrealpnlusd := @realpnlusdacc,\n\t\t@lasteligible:= @eligible\n\tfrom\n\t\t(\n\t\tselect\n\t\t\tbrand.name as site_name,\n\t\t\tcast(brand.id + 1000 as char) as site_id,\n\t\t\tb.id,\n\t\t\ta.id as tr_id,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\n\t\t\t\telse a.created_at\n\t\t\tend as created_at,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\n\t\t\t\telse date(a.created_at)\n\t\t\tend as 'date',\n\t\t\tb.user_id,\n\t\t\td.code as currency,\n\t\t\ta.origin_type,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend as YearMonth,\n\t\t\tcase\n\t\t\t\twhen d.code = 'USD' then rates.USD\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\n\t\t\tend as rate,\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\n\t\t\ta.balance_after as balance_after_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\n\t\t\t0) as deposit_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\n\t\t\t0) as deposit_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\n\t\t\t0) as cashback_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\n\t\t\t0) as cashback_usd,\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\n\t\t\t0) as withdrawal_curr_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\n\t\t\t0) as withdrawal_usd_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_usd,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) as fees_curr,\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) as fees_usd,\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\n\t\tfrom\n\t\t\ttransaction_record a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount,\n\t\t\t\ta.realized_at\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 1) rbonus on\n\t\t\trbonus.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 0\n\t\t\t\tand a.status = 'approved') pbonus on\n\t\t\tpbonus.id = a.id\n\t\tinner join trader b on\n\t\t\ta.trader_account_id = b.default_account_id\n\t\tinner join trader_account c on\n\t\t\tb.id = c.trader_id\n\t\tinner join currency d on\n\t\t\tc.currency_id = d.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand coalesce(d.name,\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\n\t\t\twithdrawals.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tor coalesce(d.name,\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\n\t\t\twithdrawals_cashback.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tand COALESCE(b.psp_reference_id,\n\t\t\t\t'') <> 'CH SR Cashback'\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\n\t\t\tdeposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tb.status = 'completed'\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\n\t\t\teducation_deposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tor COALESCE(b.psp_reference_id,\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\n\t\t\tcashbacks.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\n\t\t\twithdrawal_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 8\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\n\t\t\tovernight_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\n\t\t\tinactivity_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tswap as swaps_curr,\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\n\t\t\tfrom\n\t\t\t\ttrader_account_position a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id) swaps on\n\t\t\ta.id = swaps.ftr_id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t1.1448 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3108 as GBP,\n\t\t\t\t'2019-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1376 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3263 as GBP,\n\t\t\t\t'2019-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1224 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3021 as GBP,\n\t\t\t\t'2019-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1214 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3038 as GBP,\n\t\t\t\t'2019-04' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1197 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2637 as GBP,\n\t\t\t\t'2019-05' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.136 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2691 as GBP,\n\t\t\t\t'2019-06' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1071 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2152 as GBP,\n\t\t\t\t'2019-07' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1009 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2157 as GBP,\n\t\t\t\t'2019-08' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0899 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2287 as GBP,\n\t\t\t\t'2019-09' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1157 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2937 as GBP,\n\t\t\t\t'2019-10' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1019 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2928 as GBP,\n\t\t\t\t'2019-11' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1124 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3351 as GBP,\n\t\t\t\t'2019-12' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1095 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3205 as GBP,\n\t\t\t\t'2020-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1089 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3181 as GBP,\n\t\t\t\t'2020-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.13513 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.30362 as GBP,\n\t\t\t\t'2020-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0945 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2582 as GBP,\n\t\t\t\t'2020-04 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1115 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2349 as GBP,\n\t\t\t\t'2020-05 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1234 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2389 as GBP,\n\t\t\t\t'2020-06 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1772 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3087 as GBP,\n\t\t\t\t'2020-07 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1938 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3364 as GBP,\n\t\t\t\t'2020-08 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1819 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3163 as GBP,\n\t\t\t\t'2020-09 ' as ym ) rates on\n\t\t\trates.ym =\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tsystem_currency_vol\n\t\t\tfrom\n\t\t\t\ttrader_account_position) contract on\n\t\t\tcontract.ftr_id = a.id\n\t\tinner join brand on\n\t\t\tb.brand_id = brand.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t113 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t178 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t431 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t444 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t667 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t669 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t719 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t722 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t725 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t728 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t730 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t739 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t3 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t742 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t4 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14017 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14185 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t15286 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t17222 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18557 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18633 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t51094 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t53021 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t55189 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56011 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56598 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t58533 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59217 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59564 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59921 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59936 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59940 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59976 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t60973 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62255 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62602 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64700 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64903 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66341 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66653 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t67606 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68025 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68732 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69281 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69501 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t70036 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t71348 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t73585 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t74087 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76808 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76830 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77591 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77992 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t78569 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79158 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79751 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79776 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79861 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80148 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80149 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t81789 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t82187 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83126 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84647 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84882 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84994 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t85474 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86488 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86959 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t87442 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88286 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88547 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88580 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88608 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88934 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88957 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88960 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89028 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89048 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89527 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t90983 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91231 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91599 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92083 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92119 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92272 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92436 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92529 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t93156 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t94765 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95003 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95417 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95533 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95552 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95696 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96039 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96082 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96442 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96444 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96903 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97559 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97715 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98608 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98799 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98801 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98939 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98941 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99276 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99382 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99383 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99943 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101045 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101071 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101252 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t141562 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142017 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142046 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142054 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142060 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142077 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142082 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142264 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142430 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142628 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143897 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143985 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144173 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144779 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t146491 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147091 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147685 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148023 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148087 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149446 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149654 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t150882 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151089 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151363 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151386 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152005 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152069 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152804 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153023 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153576 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153588 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153631 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154646 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154692 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155297 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155382 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155827 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156184 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156235 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156868 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t157794 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158445 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158887 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159205 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159555 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159821 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160010 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160727 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160963 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t161450 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162530 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162532 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163044 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163285 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163535 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163689 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164246 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164829 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164864 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164909 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165119 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165178 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165335 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166717 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t7 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166741 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168116 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168721 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168736 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t169843 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\n\t\t\tduplicated_transactions.origin_id = a.origin_id\n\t\t\tand duplicated_transactions.brand_id = 6\n\t\twhere\n\t\t\tb.is_test = 0\n\t\tgroup by\n\t\t\t1,\n\t\t\t3,\n\t\t\t2,\n\t\t\t4,\n\t\t\t5,\n\t\t\t6,\n\t\t\t7,\n\t\t\t8,\n\t\t\t9,\n\t\t\t10,\n\t\t\t11,\n\t\t\t12,\n\t\t\t13\n\t\torder by\n\t\t\t3,\n\t\t\t4,\n\t\t\t5 asc) t\n\tinner join (\n\t\tselect\n\t\t\t@lastab := 0,\n\t\t\t@RealABAccHelp := 0,\n\t\t\t@lastRealABAaccHelp := 0,\n\t\t\t@lastId := 0,\n\t\t\t@realreal := 0,\n\t\t\t@lastreal := 0,\n\t\t\t@RealABUsd := 0,\n\t\t\t@lastabusd := 0,\n\t\t\t@RealABAccHelpUsd := 0,\n\t\t\t@realrealusd := 0,\n\t\t\t@lastrealusd := 0,\n\t\t\t@netdepositcurr := 0,\n\t\t\t@netdepositcurracc := 0,\n\t\t\t@netdepositusd := 0,\n\t\t\t@netdepositusdacc := 0,\n\t\t\t@realpnlcurr := 0,\n\t\t\t@realpnlcurracc := 0,\n\t\t\t@lastrealpnlcurr := 0,\n\t\t\t@realpnlusd := 0,\n\t\t\t@realpnlusdacc := 0,\n\t\t\t@lastrealpnlusd := 0,\n\t\t\t@currentrate := 0,\n\t\t\t@realrealneg := 0,\n\t\t\t@lastrealneg := 0,\n\t\t\t@education_deposit_total:= 0,\n\t\t\t@eligible:= 0,\n\t\t\t@lasteligible:= 0) v) aggCustomer\ninner join (\n\tselect\n\t\ta.id,\n\t\tb.name\n\tfrom\n\t\ttrader a\n\tinner join country b on\n\t\ta.country_id = b.id) co on\n\tco.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.id) as FTDInd\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) FTD on\n\tFTD.id = aggCustomer.id\n\tand FTD.FTDInd = aggCustomer.tr_id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.created_at) as LastDepDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MaxDep on\n\tMaxDep.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.open_at) as LastTimeInvestment\n\tfrom\n\t\ttrader_account_position a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1) MaxInv on\n\tMaxInv.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.created_at) as FTDDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MinDep on\n\tMinDep.id = aggCustomer.id\nleft join trader_account b on\n\taggCustomer.id = b.trader_id\norder by\n\t1,\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e7d",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oSBHqROSJqfbavRql9qKiSLEmwl7IhJ9c6fsHLIM0OwCRHrJNGuAkZHFejMZg4JRw0O3fODsXnYpi2hUBhBsbmkJv6Fp6AFNzUCzYUMwbHmTHLlXM9s4v79bGMK/5v8OLM1d6GkztCEoQnoKHxxgdL5bqbfcU8jEEZ4JlNgR8Mv",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "eb025165-7155-47fc-af1d-0ac3cf586a8b",
            "fullname": "MySql:7a9c0e29-71a2-46d3-9576-3d4a1eb0fd87",
            "type": "extract",
            "name": "7a9c0e29-71a2-46d3-9576-3d4a1eb0fd87",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "750ddf46-0f25-43be-a782-6a727b891ae2",
                        "id": "tq_0P5c6h0YN",
                        "name": "WinGroup_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "13ce530b-d19d-4a81-b80c-c47b4eb66aba",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78376fdb-8c17-4404-9102-e0c2f02d5c69",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72854c45-5692-4a1b-abb8-3c2d9da5e1f5",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90af7fa8-1f8e-45b8-b8a7-b354578ca96c",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9aa05227-4c67-453d-9ed7-fb40aebf6f1a",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78fb8fb6-4774-42f4-a53c-7fa4cc58d58d",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d5037d7-4225-4110-bac8-3934275b7127",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d993a5e6-eac5-462c-ab10-cc80b6f225ee",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "17108086-45a4-4a7b-a9a5-6d7e2546512f",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e7f",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oISZYo/jnBBiedN+eL7iEVmicVz5zdJvnkTnDpGXX+jM3jkWwQH1GDq4EovBiX29q5VS6x+Z07G9BXJJzwZT+nGfZWcVbeOv81/ipF/iAkEydLA1qCoilSMT7qJlQub6SW5eExTvv+75JqKLkCs/jkkYjDgSKl1b0MSB6ZMr8WT",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ec976477-b332-434d-a09f-6e920878424a",
            "fullname": "MySql:30884ab1-2215-49d9-8e15-46fc64ddab47",
            "type": "extract",
            "name": "30884ab1-2215-49d9-8e15-46fc64ddab47",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f16d6b14-97f4-4dce-a2c3-0754cfa3f2fe",
                        "id": "tq_hQD3mZNrq",
                        "name": "Wealth_employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d0c81982-8654-4936-b111-3ad0a08dba1e",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "27df67ce-4e7c-4b28-867d-423669d8b74a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "415713f3-faec-4ae5-9be1-4ea7208d4452",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fae762cc-88d8-49b7-9bc3-28faf3ce6bbf",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "deae667c-2248-4a45-9615-28ce62929e77",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9151d206-5594-4749-8625-c0f5e49cf047",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5ec3cda-97fd-4236-b173-46a8dc061669",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c02792d4-9e1e-4049-ae54-69f98120d94b",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76f96188-7e3a-4022-89d3-56357c4f105b",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90860608-423c-481a-97af-00eb69db338a",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e2d2dae8-4a62-43bd-b232-84ac54c534e9",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6856780f2002c37ec2f",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ed214258-9769-4a08-85ec-0bb31888515a",
            "fullname": "MySql:4727add1-3024-4fa0-aa36-bf83ae58ab80",
            "type": "extract",
            "name": "4727add1-3024-4fa0-aa36-bf83ae58ab80",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "72f40a7d-07e1-44aa-ac6a-71639a336c87",
                        "id": "tq_Oxv5ABOl4",
                        "name": "FXVC_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "05402e08-e4e0-4e8c-9505-26b0c3102ee7",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eae0907d-5721-46ea-8497-d269bf31ca6b",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f489c256-2011-43cf-af0c-9a005f195e5a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0fd9c19c-720b-4162-8908-05346e634a47",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "631ad81e-7bad-4c91-9a36-44807b650e3a",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 306,
                                "precision": 306,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11942c34-2b8c-4e77-b55f-0f5917ccf11c",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c70ed96-a167-48f0-afca-acc703742b0c",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7a8b887-ecd6-4117-be6a-3aa0016c03c1",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e55fbc05-ac47-407c-8a6c-b061a9e35d8f",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7aa79701-10d6-44fd-a2f8-a980e512b735",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6beb84ee-38fc-42b5-bacf-5f5e145352e5",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee677158-83d9-445f-adee-1419388a6a9e",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 24,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "527dcdb9-6dc3-483e-98f9-e3ac848874fb",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "544c5b8d-ee1c-4cdf-8806-19d16871371d",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9d8a472-f2fe-494b-b6dd-fb7dcb3283a0",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd931f92-b61b-4e54-b7c8-b75e3d2d1a33",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2881ace4-cd61-4a4b-8d45-f2d29be9c588",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c60595cd-f4b9-43f8-b32f-3713fa1ddd82",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "763aedc5-d251-4c4e-ab97-1d2a4a066255",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "924f1ad7-38d6-414e-8435-96e31edb6a6f",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d76288ba-33e1-4f09-9631-967b3bca97ec",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bdd487a-748c-4d1d-ac16-f809e1fbe6e6",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c3f41c0-ce4a-4f8f-9f50-3dd34db08fff",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "574898ff-cd2c-49b2-98e4-375b3b5229d7",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1168712-f4e2-4fd7-98a4-3893d6a874d3",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b8ccd0a-32f8-4c21-a86c-ec3c340065a8",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3fbe2b6-318b-4dca-9b4a-64084e410d40",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54647b89-fe48-4f06-b84e-feead1d79d52",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "831de9d7-6891-4ae2-b9e1-b2aef8c00adf",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6773c1b-5d52-4457-81f5-f6031b08eac7",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f86bdfa-fdec-49d2-b60e-8e2f47362814",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e5c1bdc-1d7f-4bb7-999e-61dedef9f577",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "042e9b53-e0c6-44ff-8720-09c4ffde9438",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99f0c4ec-df20-49c3-9887-10e396e1caf4",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28e20d9d-b76c-4df0-bcc9-64c3a6ba3ff7",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46b7565c-634b-419d-80b1-2090d3b8282e",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ca97779-d417-4f3f-aa9b-42e5f9ff158a",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72c8e428-6688-4c20-a220-a074c0d33dbf",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b35716d-7db0-4cc0-9485-6164b835c932",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee8c1b42-4430-4823-9f92-b243b86000d3",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e018890d-943d-45f1-9ccf-4ef222acb4b2",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82442d46-204e-402e-a307-fca77ab333b1",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31e299d7-fed0-4020-8117-12d3857db9d9",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d5bebd3-d480-4520-9b47-33d7a9a85c40",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86610b6a-c3de-4563-9a24-d49f601b052e",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "050e1445-ccf6-4165-be08-e02f4ea9363f",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84cb3529-a696-4f52-9c26-50ca1c61d53e",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b238734-97eb-4fbd-ba1d-eeeac718a403",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "186932e2-7802-4c5f-9f02-537ce2ab97b8",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01e294a2-dcb8-4df9-b806-c24a7f22ef94",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d893096-3c5a-496e-a92e-7a87f2d4b33a",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b3fe4f1-c91d-408c-a5fe-d3c90dee00b4",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9b877ec-ebef-44a6-9bda-8bbaab846373",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d18850a6-19c6-4a9c-9c0f-44cdaeb917c3",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8e9b585-dcc1-4da3-a125-d167b041f0ec",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ae2bf10-edd1-42fb-88b3-62862d17a48e",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b60dac69-6ed8-41a9-91a2-24aa79d4c6e0",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d1b381d-3226-475f-822a-eb3caf2e0613",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "986d5b81-671a-4fa4-b427-ef94ba97c687",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f582ea3b-4f4b-4334-9b52-d96a08616954",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b62e5554-8d27-40f3-bdac-6878df2374cf",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0065556-bbc8-4074-ad64-5de027beafd5",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "687084d6-7f54-4e44-a7e1-2405d098f21e",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4916b25e-80ad-4d59-ade7-579e2fc2a420",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "722ca3e9-176f-4e7c-b312-dc2b8a5b4c0c",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb62cd6f-848f-42a5-a01f-bf72cf86643e",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5e8cddf3-ed87-4568-9a22-ffaf2ced69fd",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "22ef992e-eae5-44ad-9e89-41ed4c2289ba",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dc2e2b78-15ac-4698-842f-9fb83d309568",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b91a795-835f-4304-8279-5b236beadd17",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5c99a01-56a7-410d-8643-e08311e1fa99",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68f32964-7d7c-4622-9b31-7e71bc620379",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8ac48c7a-3a3c-4162-946a-9ecd45e5653a",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2fa5a3ce-dff8-4c38-9539-e0bfe9bd2f69",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8083fcb-d31e-43a1-a906-582a78fc10a6",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7e02bb5-afa2-42e6-80aa-8b95eac210e3",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7544cb74-9624-494c-b28e-761ab0e625c8",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e007973-3b98-4865-810c-90928441968b",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f611038-b42d-45bb-a31f-dcfc0a37b41e",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "68f32964-7d7c-4622-9b31-7e71bc620379",
                                    "type": 6
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "8ac48c7a-3a3c-4162-946a-9ecd45e5653a",
                                    "type": 6
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "3c375aec-a022-418c-8a09-6b3268250c88",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10006', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10006', COALESCE(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr as pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\t\tselect t.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcast(case when t.site_id = 1036 then \r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend \r\n\t\telse case\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend end as decimal(20,10)) as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal := greatest(@RealABAccHelp,\r\n\t\t\t0)\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\tcase\r\n\t\t\twhen t.id = @lastId\r\n\t\t\tand @RealABAccHelp < 0 then @realpnlcurracc := @netdepositcurracc\r\n\t\t\telse @realpnlcurracc := @netdepositcurracc - @realreal\r\n\t\tend as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tcase when brand.id = 5 then 'FXVC' else brand.name end as site_name,\r\n\t\t\tcast(1000 + brand.id as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and a.id not in (676575,676577) then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and a.id not in (676575,676577) then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 and a.id not in (676578,695311,695325) then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 and a.id not in (676578,695311,695325) then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect b.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join brand on b.brand_id = brand.id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (9,10,11,24,61,208,318,335,336,337,344,379,497,517,547,582,700,720)\r\n\t\t\t\tand coalesce(d.name,'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (9,10,11,24,61,208,318,335,336,337,344,379,497,517,547,582,700,720)\r\n\t\t\t\tor coalesce(d.name,'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (9,10,11,24,61,208,318,335,336,337,344,379,497,517,547,582,700,720)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start (KYC)')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start (KYC)')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (9,10,11,24,61,208,318,335,336,337,344,379,497,517,547,582,700,720)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\t\tselect 1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym \r\n                          union\r\nselect\r\n1.0945 as EUR,\r\n1 as USD,\r\n1.2582 as GBP,\r\n'2020-04 ' as ym\r\nunion\r\nselect\r\n1.1115 as EUR,\r\n1 as USD,\r\n1.2349 as GBP,\r\n'2020-05 ' as ym\r\nunion\r\nselect\r\n1.1234 as EUR,\r\n1 as USD,\r\n1.2389 as GBP,\r\n'2020-06 ' as ym\r\nunion\r\nselect\r\n1.1772 as EUR,\r\n1 as USD,\r\n1.3087 as GBP,\r\n'2020-07 ' as ym\r\nunion\r\nselect\r\n1.1938 as EUR,\r\n1 as USD,\r\n1.3364 as GBP,\r\n'2020-08 ' as ym\r\nunion\r\nselect\r\n1.1819 as EUR,\r\n1 as USD,\r\n1.3163 as GBP,\r\n'2020-09 ' as ym) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect 113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 5\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc\r\n\t\t\t) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@realreacneg := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@lastrealneg := 0, \r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0) v) aggCustomer\r\ninner join (\r\n\t\tselect a.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\nwhere aggCustomer.id not in (1235547,1235546,1241054)\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a73e62e0e927002ca65858",
                "provider": "MySql",
                "parameters": "WsI2hGSf+dwqwSmh3TwuaO5Wqyut2TolmY92AeMWG08Xb/qjvMSuJGDm7JgDb9ySN0Xzjcz6PcqDViRiguXgcyUcf67U5gmIeajObfUj6tad7qKg1ZyeZwUIoxukmQND00I4zC3BmvjqPn25FTUhgHP3RYM8ArHf/0HcoZWv1DmBWB+C7ubJWy8Uvvn0dZZ2wfbKHoMxLVw5QXqUnoA4Rcv4hPfy04GTGD4JjZKhQpG3q2QKft9MDNcPxMaq0dSx",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "eeb8593c-096d-4488-aad6-e1d2cec8516c",
            "fullname": "MySql:818896f9-6f98-489a-89df-5a80918557cd",
            "type": "extract",
            "name": "818896f9-6f98-489a-89df-5a80918557cd",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c8e9d7bd-ea9a-4be9-b064-f125597b8786",
                        "id": "tq_VDJlxhdAy",
                        "name": "NostraCapital_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "96d9d19d-3b42-4d76-8697-f14cba0c83d7",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3074734-60bd-47fa-908c-e9623999908a",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1e0c29c-56d3-4ae3-978a-68e4c35721e6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a6dde5e-3ce0-46f7-a95a-729b18a44be4",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4940bde-1a3f-4579-b9c8-78636cb29eef",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19890adb-5861-4d17-b0dd-27867ae06195",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "819cbac3-988f-4aee-8bae-2e765f24d8e3",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63b0d6e0-4c7b-4c8b-881c-1ebd868827cc",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56fb079f-2357-4c04-96a8-b9ae9f18aa9a",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4bbe08fa-64f8-410f-848d-a5c2125032f5",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e5d82393-ee2a-4726-b88e-554c3d2bc4c2",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d6bb926-7067-43b6-b221-808e2d4bd0e1",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "011f85d2-5c85-4441-8b1a-08d8cd6b29d9",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "158caa2b-f18d-4420-a8d5-df04c1cbf814",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d8df143-b1a2-4972-8bb1-f08f9b78de6c",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b87d76ff-1dea-460c-b4f6-2c2639037d84",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e36208c-e6fd-44d8-9e15-f75dc02a7805",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0346dab-698e-4053-a0fe-cae4bd75091d",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6b9bae6-55f4-4936-ab2a-ec65598e5b93",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12e19b12-d5cf-467f-8539-4174dcc276bd",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "679414fa-177d-4275-a946-6b0b7bd37ad1",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebaf8933-7f7f-4c00-b09c-c6af906068dc",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb4bab7e-3a39-4946-a6f3-a5ecf9f6dee2",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0fa76ac-e0b6-45a0-9171-3d253d52e58c",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03a707be-293e-4e9c-94f4-73a23e1ca4d0",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a5f16ed-10fc-4900-854b-9c828615a1d2",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d747dca-3421-4d19-b7f1-e8886b89c4ec",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e61432ed-6d19-482d-96c1-6bbdadaf352d",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16885220-5711-4642-b5cf-1a8d5a0d3784",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3204293-f6b8-4d39-83bc-d315de4b7180",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45692f30-a5c3-4b30-bd49-8d7839689fbe",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f456e20f-2da7-47d5-b64f-90dd9e74d008",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c15c2010-3346-4a3c-a0b4-9f0574e0770a",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad1a47b5-980f-4adf-859b-97d3947c3a93",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "007bf518-eba5-4cb7-ad29-0e3985f0040b",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3c087f3-c73d-426f-bcfd-37fa5d2204c9",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "792e1fdf-2676-468a-afff-b324c2270f0a",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6f7ff55-f4f5-4295-9eca-a6643ad76336",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b21b85af-aa0d-43e3-824a-0bf744e5dfbb",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da0cf7da-a18c-4213-b9e3-79053a0f470a",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "107585b3-f5ee-434f-9055-4c8eb4e35654",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff53d556-230f-4618-bc9d-e2e392915e54",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9b59ec3-87c2-44d5-bd78-7f1aca030554",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2df5492-297b-416e-8e00-00ff65fa9920",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94e8333f-a505-4958-a9bf-36ecf0900079",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad41242a-f3e4-441f-a396-fdebc312d4ec",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b243ba8e-1567-4e8b-999f-de4c5368ee4b",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "929c8b68-322d-439c-bf59-f52694682e3c",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62cb9cad-a3ad-4673-8252-fec220871685",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b633457-d9ef-432d-ad33-f2a7ffedb859",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e24ab4bf-02ca-4d83-b313-df72e0881f56",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14dd4a40-6317-4489-9250-811e03a623af",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "445cf1ce-eddf-42e1-860f-9bf072ba1d7c",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e057f130-2f51-47b4-bbe4-eadad439a679",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "630d7f8b-478c-4abe-a0eb-a353b2ce0023",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17148791-d28d-4ce5-856a-f56e19a6adf2",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "043a764a-55f7-47f8-ba6c-8950ee161bda",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4cd45e24-091d-4df9-b427-153941c795ce",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "463ccfa7-6462-47c9-9c18-c2a8351dd5b0",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51a8147f-1701-4baa-9cd5-9c70cb8d0ad6",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce60d466-004e-4868-8f39-52520167a042",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94e27314-c983-4775-b1c1-78096b60adb2",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5d052b3-67ca-4cbc-ba68-7509ed4c9459",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d609268-f465-4b22-aad2-0142ef3f1864",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0b2dd3e-97cb-4817-bc0c-2466a34b63b9",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2640eeed-6dc2-42c2-aec3-f2a2e1e44435",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "256b5ade-7eec-477c-8f70-ca7aec0381dc",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea67e456-3061-45f6-bccd-c84e9447a61b",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c0cf984-3175-4ac1-8772-84edbf93faa1",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81ea6df6-da9a-4a44-a697-27c4db560513",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cb85141-4c61-47f9-a1dc-b17e3ca0fe6e",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27ec06f1-d35d-41ec-bea2-5be46c804a3a",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68e12e4d-c076-4244-9260-70d75ea6e22c",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "457b14c8-5385-4ebb-8b2c-5cf68f533fbd",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a46102f4-8585-4469-a000-b55df6960ddf",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93ccfe34-6c79-424b-9bd8-60ee9f22de9d",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4bb7893-f618-469c-954f-5846db002458",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4bb88924-1431-4dd5-bbf6-331074b6c7c1",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0541f049-ae9e-4f01-949c-988e0038b47a",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c49e3c8e-6c4c-46d3-858e-4df4aaa03afc",
                        "configOptions": {
                            "importQuery": "SELECT\n\taggCustomer.id,\n\taggCustomer.site_name as site_name,\n\taggCustomer.site_id as site_id,\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\n\taggCustomer.customer_fullname,\n\tco.name,\n\taggCustomer.currency,\n\taggCustomer.created_at,\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\n\taggCustomer.date,\n\taggCustomer.YearMonth,\n\tcase\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'GBP' then 1.3\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'EUR' then 1.1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\n\t\twhen aggCustomer.rate is null\n\t\tand aggCustomer.currency = 'USD' then 1\n\t\twhen aggCustomer.rate is not null\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\n\tend as rate,\n\tMaxDep.LastDepDate,\n\tMaxInv.LastTimeInvestment,\n\taggCustomer.tr_id,\n\taggCustomer.origin_type,\n\tMinDep.FTDDate,\n\tcase\n\t\twhen FTD.FTDind is null then 0\n\t\telse 1\n\tend as FTDInd,\n\taggCustomer.user_id,\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\n\taggCustomer.deposit_curr,\n\taggCustomer.deposit_usd,\n\taggCustomer.cashback_curr,\n\taggCustomer.cashback_usd,\n\taggCustomer.withdrawal_curr,\n\taggCustomer.withdrawal_usd,\n\taggCustomer.withdrawal_curr_new,\n\taggCustomer.withdrawal_usd_new,\n\taggCustomer.cashback_withdrawal_curr,\n\taggCustomer.cashback_withdrawal_usd,\n\taggCustomer.withdrawal_fee_curr,\n\taggCustomer.withdrawal_fee_usd,\n\taggCustomer.chb_curr,\n\taggCustomer.chb_usd,\n\taggCustomer.inactivity_fee_curr,\n\taggCustomer.inactivity_fee_usd,\n\taggCustomer.overnight_fee_curr,\n\taggCustomer.overnight_fee_usd,\n\taggCustomer.fees_curr,\n\taggCustomer.fees_usd,\n\taggCustomer.pnl_curr,\n\taggCustomer.pnl_usd,\n\taggCustomer.duplicated_pnl_curr,\n\taggCustomer.duplicated_pnl_usd,\n\taggCustomer.swap_curr,\n\taggCustomer.swap_usd,\n\taggCustomer.contract_usd,\n\taggCustomer.rbonus_curr,\n\taggCustomer.rbonus_usd,\n\taggCustomer.cancelled_bonus_curr,\n\taggCustomer.cancelled_bonus_usd,\n\taggCustomer.pending_bonus_curr,\n\taggCustomer.pending_bonus_usd,\n\taggCustomer.fixed_balance,\n\taggCustomer.fixed_balance_usd,\n\taggCustomer.negative_balance_fix_curr,\n\taggCustomer.negative_balance_fix_usd,\n\taggCustomer.refund_curr,\n\taggCustomer.refund_usd,\n\taggCustomer.education_deposit_curr,\n\taggCustomer.education_deposit_usd,\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\n\taggCustomer.balance_after_curr,\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\n\tb.balance as CurrencyBalance\nfrom\n\t(\n\tselect\n\t\tt.*,\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\n\t\t\telse @netdepositcurracc := @netdepositcurr\n\t\tend as NetDepCurrAcc,\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\n\t\t\telse @netdepositusdacc := @netdepositusd\n\t\tend as NetDepUsdAcc,\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastab < 0\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\t\telse @RealABAccHelp := @RealAB\n\t\tend as RealABAccHelp,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @lastabusd < 0\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\n\t\tend as RealABAccHelpUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\t\telse @realreal := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\n\t\t\telse @realrealneg := @RealAB\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\n\t\t\twhen @lastId = t.id\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\t\telse @realrealusd := @RealABUsd\n\t\tend as RealAccountBalanceAccumulatedUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrency,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\n\t\t\telse @RealAB\n\t\tend as RealABDiffCurrencyIncNegative,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\t\telse @RealABUsd\n\t\tend as RealABDiffUsd,\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\n\t\t\telse @realpnlcurr := @realpnlcurracc\n\t\tend as RealPnLCurr,\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\t\tcase\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\n\t\t\telse @realpnlusd := @realpnlusdacc\n\t\tend as RealPnLUsd,\n\t\tcase\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\n\t\t\tend as education_deposit_total,\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\n\t\tcase\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\n\t\t\telse @eligible end as EligibleDiffCurrency,\n\t\t@lastreal := @realreal,\n\t\t@lastrealusd := @realrealusd,\n\t\t@lastrealneg := @realrealneg,\n\t\t@lastab := @RealABAccHelp,\n\t\t@lastabusd := @RealABAccHelpUsd,\n\t\t@lastId := t.id,\n\t\t@lastrealpnlcurr := @realpnlcurracc,\n\t\t@lastrealpnlusd := @realpnlusdacc,\n\t\t@lasteligible:= @eligible\n\tfrom\n\t\t(\n\t\tselect\n\t\t\tbrand.name as site_name,\n\t\t\tcast(brand.id + 1000 as char) as site_id,\n\t\t\tb.id,\n\t\t\ta.id as tr_id,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\n\t\t\t\telse a.created_at\n\t\t\tend as created_at,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\n\t\t\t\telse date(a.created_at)\n\t\t\tend as 'date',\n\t\t\tb.user_id,\n\t\t\td.code as currency,\n\t\t\ta.origin_type,\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend as YearMonth,\n\t\t\tcase\n\t\t\t\twhen d.code = 'USD' then rates.USD\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\n\t\t\tend as rate,\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\n\t\t\ta.balance_after as balance_after_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\n\t\t\t0) as deposit_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\n\t\t\t0) as deposit_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\n\t\t\t0) as cashback_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\n\t\t\t0) as cashback_usd,\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\n\t\t\t0) as withdrawal_curr_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\n\t\t\t0) as withdrawal_usd_new,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\n\t\t\t0) as cashback_withdrawal_usd,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\n\t\t\t0) as fees_curr,\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\n\t\t\t0) as fees_usd,\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\n\t\tfrom\n\t\t\ttransaction_record a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount,\n\t\t\t\ta.realized_at\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 1) rbonus on\n\t\t\trbonus.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tb.id,\n\t\t\t\tb.amount,\n\t\t\t\tb.wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_bonus a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.is_realized = 0\n\t\t\t\tand a.status = 'approved') pbonus on\n\t\t\tpbonus.id = a.id\n\t\tinner join trader b on\n\t\t\ta.trader_account_id = b.default_account_id\n\t\tinner join trader_account c on\n\t\t\tb.id = c.trader_id\n\t\tinner join currency d on\n\t\t\tc.currency_id = d.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand coalesce(d.name,\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\n\t\t\twithdrawals.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\n\t\t\t\t0) as amount_curr,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) fee_amount_curr,\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_withdraw b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_processor c on\n\t\t\t\tb.id = c.transaction_id\n\t\t\t\tand c.origin_id = 2\n\t\t\tleft join payment_sub_processor d on\n\t\t\t\tc.payment_sub_processor_id = d.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tor coalesce(d.name,\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\n\t\t\twithdrawals_cashback.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) not in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tand COALESCE(b.psp_reference_id,\n\t\t\t\t'') <> 'CH SR Cashback'\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\n\t\t\tdeposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\tleft join transaction_sub_type c on b.type = c.id\n\t\t\twhere\n\t\t\t\tb.status = 'completed'\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\n\t\t\teducation_deposits.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.id,\n\t\t\t\ta.wide_currency_amount,\n\t\t\t\ta.amount\n\t\t\tfrom\n\t\t\t\ttransaction_record a\n\t\t\tinner join transaction_deposit b on\n\t\t\t\ta.id = b.ftr_id\n\t\t\twhere\n\t\t\t\tCOALESCE(b.payment_provider_id,\n\t\t\t\t0) in (24,\n\t\t\t\t32)\n\t\t\t\tand b.status = 'completed'\n\t\t\t\tor COALESCE(b.psp_reference_id,\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\n\t\t\tcashbacks.id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\n\t\t\twithdrawal_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 8\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\n\t\t\tovernight_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\ta.ftr_id,\n\t\t\t\tb.amount * -1 as amount,\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\n\t\t\tfrom\n\t\t\t\ttransaction_commission a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id\n\t\t\twhere\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\n\t\t\tinactivity_fees.ftr_id = a.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tswap as swaps_curr,\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\n\t\t\tfrom\n\t\t\t\ttrader_account_position a\n\t\t\tinner join transaction_record b on\n\t\t\t\ta.ftr_id = b.id) swaps on\n\t\t\ta.id = swaps.ftr_id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t1.1448 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3108 as GBP,\n\t\t\t\t'2019-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1376 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3263 as GBP,\n\t\t\t\t'2019-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1224 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3021 as GBP,\n\t\t\t\t'2019-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1214 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3038 as GBP,\n\t\t\t\t'2019-04' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1197 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2637 as GBP,\n\t\t\t\t'2019-05' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.136 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2691 as GBP,\n\t\t\t\t'2019-06' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1071 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2152 as GBP,\n\t\t\t\t'2019-07' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1009 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2157 as GBP,\n\t\t\t\t'2019-08' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0899 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2287 as GBP,\n\t\t\t\t'2019-09' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1157 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2937 as GBP,\n\t\t\t\t'2019-10' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1019 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2928 as GBP,\n\t\t\t\t'2019-11' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1124 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3351 as GBP,\n\t\t\t\t'2019-12' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1095 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3205 as GBP,\n\t\t\t\t'2020-01' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1089 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3181 as GBP,\n\t\t\t\t'2020-02' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.13513 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.30362 as GBP,\n\t\t\t\t'2020-03' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.0945 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2582 as GBP,\n\t\t\t\t'2020-04 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1115 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2349 as GBP,\n\t\t\t\t'2020-05 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1234 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.2389 as GBP,\n\t\t\t\t'2020-06 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1772 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3087 as GBP,\n\t\t\t\t'2020-07 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1938 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3364 as GBP,\n\t\t\t\t'2020-08 ' as ym\n\t\tunion\n\t\t\tselect\n\t\t\t\t1.1819 as EUR,\n\t\t\t\t1 as USD,\n\t\t\t\t1.3163 as GBP,\n\t\t\t\t'2020-09 ' as ym ) rates on\n\t\t\trates.ym =\n\t\t\tcase\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\n\t\t\tend\n\t\tleft join (\n\t\t\tselect\n\t\t\t\tftr_id,\n\t\t\t\tsystem_currency_vol\n\t\t\tfrom\n\t\t\t\ttrader_account_position) contract on\n\t\t\tcontract.ftr_id = a.id\n\t\tinner join brand on\n\t\t\tb.brand_id = brand.id\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t113 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t178 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t431 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t444 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t667 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t669 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t719 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t722 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t725 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t728 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t730 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t739 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t3 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t742 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t4 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14017 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t14185 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t15286 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t17222 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18557 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t18633 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t51094 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t53021 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t55189 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56011 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t56598 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t58533 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59217 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59564 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59921 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59936 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59940 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t59976 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t60973 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62255 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t62602 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64700 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t64903 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66341 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t66653 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t67606 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68025 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t68732 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69281 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t69501 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t70036 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t71348 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t73585 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t74087 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76808 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t76830 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77591 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t77992 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t78569 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79158 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79751 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79776 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t79861 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80148 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80149 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t80961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t81789 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t82187 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83126 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t83852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84647 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84882 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t84994 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t85474 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86488 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t86959 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t87442 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88286 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88547 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88580 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88608 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88934 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88957 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88960 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t88961 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89028 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89048 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t89527 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t90983 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91231 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t91599 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92083 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92119 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92272 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92436 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t92529 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t93156 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t94765 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95003 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95290 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95417 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95533 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95552 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t95696 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96039 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96082 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96442 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96444 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t96903 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97559 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t97715 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98608 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98799 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98801 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98939 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t98941 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99276 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99382 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99383 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t99943 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101045 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101071 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t101252 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t141562 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142017 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142046 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142054 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142060 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142077 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142082 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142264 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142430 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t142628 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143897 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t143985 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144173 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t144779 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t146491 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147091 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t147685 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148023 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t148087 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149446 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t149654 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t150882 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151089 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151363 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151386 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t151852 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152005 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152069 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t152804 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153023 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153576 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153588 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t153631 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154646 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t154692 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155297 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155382 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t155827 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156184 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156235 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t156868 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t157794 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158445 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t158887 as origin_id,\n\t\t\t\t7 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159205 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159555 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t159821 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160010 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160727 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t160963 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t161450 as origin_id,\n\t\t\t\t6 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162530 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t162532 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163044 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163055 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163285 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163535 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t163689 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164246 as origin_id,\n\t\t\t\t3 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164829 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164864 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t164909 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165119 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165178 as origin_id,\n\t\t\t\t4 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t165335 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166717 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t7 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t166741 as origin_id,\n\t\t\t\t1 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168116 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168721 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t168736 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated\n\t\tunion\n\t\t\tselect\n\t\t\t\t169843 as origin_id,\n\t\t\t\t5 as brand_id,\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\n\t\t\tduplicated_transactions.origin_id = a.origin_id\n\t\t\tand duplicated_transactions.brand_id = 6\n\t\twhere\n\t\t\tb.is_test = 0\n\t\tgroup by\n\t\t\t1,\n\t\t\t3,\n\t\t\t2,\n\t\t\t4,\n\t\t\t5,\n\t\t\t6,\n\t\t\t7,\n\t\t\t8,\n\t\t\t9,\n\t\t\t10,\n\t\t\t11,\n\t\t\t12,\n\t\t\t13\n\t\torder by\n\t\t\t3,\n\t\t\t4,\n\t\t\t5 asc) t\n\tinner join (\n\t\tselect\n\t\t\t@lastab := 0,\n\t\t\t@RealABAccHelp := 0,\n\t\t\t@lastRealABAaccHelp := 0,\n\t\t\t@lastId := 0,\n\t\t\t@realreal := 0,\n\t\t\t@lastreal := 0,\n\t\t\t@RealABUsd := 0,\n\t\t\t@lastabusd := 0,\n\t\t\t@RealABAccHelpUsd := 0,\n\t\t\t@realrealusd := 0,\n\t\t\t@lastrealusd := 0,\n\t\t\t@netdepositcurr := 0,\n\t\t\t@netdepositcurracc := 0,\n\t\t\t@netdepositusd := 0,\n\t\t\t@netdepositusdacc := 0,\n\t\t\t@realpnlcurr := 0,\n\t\t\t@realpnlcurracc := 0,\n\t\t\t@lastrealpnlcurr := 0,\n\t\t\t@realpnlusd := 0,\n\t\t\t@realpnlusdacc := 0,\n\t\t\t@lastrealpnlusd := 0,\n\t\t\t@currentrate := 0,\n\t\t\t@realrealneg := 0,\n\t\t\t@lastrealneg := 0,\n\t\t\t@education_deposit_total:= 0,\n\t\t\t@eligible:= 0,\n\t\t\t@lasteligible:= 0) v) aggCustomer\ninner join (\n\tselect\n\t\ta.id,\n\t\tb.name\n\tfrom\n\t\ttrader a\n\tinner join country b on\n\t\ta.country_id = b.id) co on\n\tco.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.id) as FTDInd\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) FTD on\n\tFTD.id = aggCustomer.id\n\tand FTD.FTDInd = aggCustomer.tr_id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.created_at) as LastDepDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MaxDep on\n\tMaxDep.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmax(a.open_at) as LastTimeInvestment\n\tfrom\n\t\ttrader_account_position a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1) MaxInv on\n\tMaxInv.id = aggCustomer.id\nleft join (\n\tselect\n\t\tb.id,\n\t\tmin(a.created_at) as FTDDate\n\tfrom\n\t\ttransaction_record a\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\twhere\n\t\ta.origin_type = 1\n\t\tand b.is_test = 0\n\tgroup by\n\t\t1) MinDep on\n\tMinDep.id = aggCustomer.id\nleft join trader_account b on\n\taggCustomer.id = b.trader_id\norder by\n\t1,\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e83",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6mkpXbI+4cVPcW9QmdR/OpFY0NV6lOS+yIHmY9aWUhUzSj1KLvCfMgcIqWzFtH2wB4wDE6J0O3kIYCeCTy2Vm2FnBTBcZ0ejYO8nr2tUHC3cyjEC9VpB/CP/XWAQHRXQ8biCOO3g3QegnOXaTTb/9ErFOuEJ8WFWhUXRuCVMOFyl",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f107b083-d6c3-45f8-920c-a6ea4d585940",
            "fullname": "MySql:94cc6543-ea46-4c6d-8091-eb8ce73494ea",
            "type": "extract",
            "name": "94cc6543-ea46-4c6d-8091-eb8ce73494ea",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c69f6df3-05b2-48f8-98d3-9e36b49805fa",
                        "id": "tq_bK4fPL10q",
                        "name": "BendigoCoins_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8026609d-7b55-4114-986d-51a82b164cd3",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa7c9446-062d-466e-a3db-2faf1dc30a1c",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b7e5915-5863-4073-8b56-724c530be7d9",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d48d97c1-efbc-4189-b9c3-3e1e207ce5be",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5996b280-29e4-42a7-bee1-8a48281331f7",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df147247-776b-4a5b-a2f9-4a5827dd6820",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a87e4544-e868-4ed8-a51b-ea624cf7ddea",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a387363d-1018-44d4-8d9a-a11d6e9fd1af",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8dff487-49c9-4375-90dd-92a2b9c51b9d",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abb6a037-9307-44a0-a45a-b8c76f4b8d27",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "a8cd660e-5629-4df0-b211-32f04a3e758a",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch'\r\n\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tproba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\tselect\r\n\t\t\t\t\ta.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\t`user` a\r\n\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\t`user`.id = user_groups.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d6716780f2002c37ec2d",
                "provider": "MySql",
                "parameters": "FhwKndxsEm4karcTRhcRhQ31JuodaLCOkLCPAL5UDyKQmplY4PGQirEicte+5XlO7CmeguqIciMcA3dWSPlLRdyZQQBa8rSl7481iBoEVleEKNnY0oZY59Uua0u3yiz/U5itDzyqwT3hV27JP+osZrKYLMelBUn+F7vnCn46CtacVjNzMfL/BmkfA2U0DhrLnI0aG8HaWhblMUs9PMPHSLPgZ1yWRCKlfMFEAtsVU51Jg4PyWiAT5+nvRZJBKlUf",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f3923cbe-0f3e-4546-a32e-10d9122abec8",
            "fullname": "MySql:42e0abf9-1cd3-4560-b67b-9db49196b2c2",
            "type": "extract",
            "name": "42e0abf9-1cd3-4560-b67b-9db49196b2c2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "25d773ac-73b4-42ce-b251-c2244569b4c1",
                        "id": "tq_aThgROV2k",
                        "name": "Wealth_Real_Ab",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2e6a46f8-ea4e-46e1-b0a5-5a6e3ff8d7a1",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3a8838c5-f7bd-4343-a172-f3a4e4604580",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61b28a5e-8628-43ae-b096-bc9a8d43bace",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8f0db4e-4e2a-45e3-9a61-1bb0437e5870",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3635737-8a89-443b-bfc7-ebbc3309b04e",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22a29e73-0b29-465a-b20f-86faa198aa18",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1de8f6da-e595-4b6f-b391-d61eb703142e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b374a6e-f0ae-4a14-8f50-f1fa25157d8a",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9d629287-9e49-4b22-8829-21d810f086a9",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3382ad48-57bd-4986-bf3d-d97aaa77dd0d",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "07695ae7-8c9c-4537-8b1e-34c7a044b923",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ce4c6c0-a856-4176-bc6f-857c0bd248e8",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "afaecb8c-2a9b-4c4a-9c5e-0d99ad2ec0b6",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "126a5d94-f457-4290-9f3a-80a3349a72e7",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f15967a5-769b-451e-abec-173ea6a33e22",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5dbd5e7-88af-41ea-a143-debc669d2cd3",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "690abf47-5c2e-4fe6-bf8b-2b5a57b53c69",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a7ac9c0f-ad8f-42bd-9c33-f91d6b592ba1",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fa113670-e61a-4e6d-a141-ea7157f6d62f",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "349a990b-dfa7-48f1-a651-55a292f4b4d7",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa28e3a6-1e84-446a-a726-798ae0f30c28",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "07ce7cb9-bffd-450f-b82b-1104d603c32c",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3320edae-ef15-4b79-94af-506875c40035",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6d099516-1eaa-4aa3-8e9a-d551f567dee1",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f6a7f79-e85b-409a-b039-fb75cddb94bd",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "07b57a3e-1d9e-4933-87a1-9f71b499c558",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3da46364-7716-41af-9ebd-65ba92f32ab5",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "347cd8ef-6451-4b84-98bf-e5aaf3e90766",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "76afafa5-63f7-430c-a5c9-5be56f245948",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e54aebb-c3f4-4ce1-82b2-b8d327fd15d9",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3f634314-7367-42aa-ad5a-a2d852b60f39",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ca35efe3-c74f-4786-8776-2b06d26f5507",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "56ef0a55-65cb-4fa1-96ef-d74d119c937b",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89882a80-4088-43a3-b550-8e9641ea90ba",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1772b445-f433-4bc0-95e0-67c110a37683",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "056911ea-61e4-4be6-8283-9095a9ca3a27",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "46d35aea-28f8-4c2e-bd81-7dd24697e9dd",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5fa12bee-3147-4e06-84f5-d81c0ffbc63e",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1c0eaeaa-a914-47fc-b0ea-e73115df9578",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "59261b7c-e410-4c7f-8c9e-eda45dccbd8b",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ae9ce745-cbf7-48d1-babd-8ddbb9ccf913",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3ed27d15-5f83-4596-bcce-fad7fb5a7162",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "77b2352a-4a13-46d4-87d3-6bb7abe7db66",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a6717578-0e6d-4800-abb0-29fd41d0348d",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b4dd4fed-93e6-453d-8f24-35b8a81bf3b6",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "351243c5-ba60-4962-87d0-262b50b5dc62",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a3e40c80-59df-4a9f-9e77-9a2ff70fa818",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8f5a26fd-8317-4c66-89fc-dbbfbe5de350",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5e6daa94-9c63-4f7b-be85-cd905229be4a",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "00daf6d3-4033-4c58-9fae-00b741a42970",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8ddaa4f3-5308-4798-a594-d5fba817d74b",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4944583c-d174-42e5-84a4-cdc61fe879e7",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1885b83-d563-410e-8b32-82b130a42402",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9593319e-a5f3-457c-8f9a-bd45eeb09366",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "992525b0-9b5e-40a4-93e1-13fc7c786f9d",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ea1e10da-dea8-4426-947d-9cff171e45f6",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ec62b6f5-fdda-4ec6-b600-b4a0f0fb19ab",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "04a1a19c-6ea4-4183-b617-eaf7cadd676d",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b39ceeb3-4ab3-4a8a-b93e-d820cb9fadff",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "480f5aab-98eb-4c34-9daa-586e98987356",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "87b5dada-725e-4501-a01a-122fd69b833c",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1fbd57c9-d2f9-45c8-aed9-c1a2a5ed255c",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4f79899e-2538-4595-be74-61ae7d727ee7",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "647038b2-3dcb-4445-a7bd-b42867e4efee",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "105ef3a9-8665-4fe9-bfd4-da5c4189f67b",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e1a2c26-f073-48e4-b960-3a7cb4c5f4a5",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b4001d1-fb32-46e6-8d5a-fc87ef6ed533",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4d30ff7f-4a02-4aa3-97c9-199aa61bf281",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aadedae2-c6d5-4f36-a17e-d82709619d71",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7600306a-f583-4ad5-be33-21e29b180914",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "378c3bde-dd23-469b-af38-1af0638d33cf",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ce0889bd-a306-4f8e-ad57-d0a59531d711",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "77c04cde-70a3-403a-a85b-a7b568e2ce1f",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ff349df6-a5e9-4f0f-af2b-8395862342d3",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "280465df-2b3c-49b9-b47c-e51f3b205043",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02391699-cbc3-4e98-98ff-63428b61194b",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1a2072ac-efea-4487-b0de-1c2837bc2b8c",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8af2e649-1341-4620-91b3-60e7a70e46dd",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fd6bc7bc-f4d1-416b-907e-54e43e9c92d6",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "8af2e649-1341-4620-91b3-60e7a70e46dd",
                                    "type": 6
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "6e7d146a-aba8-439b-a9df-b7ff72a29ea8",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\t\tselect t.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect b.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,68,76)) withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0)  in (24,32,68,76)) withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,68,76)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,68,76)\r\n\t\t\t\tand b.status = 'completed') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5\r\n\t\t\t\tand a.created_at < 20190923) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\t\tselect 1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\nunion\r\nselect\r\n1.0945 as EUR,\r\n1 as USD,\r\n1.2582 as GBP,\r\n'2020-04 ' as ym\r\nunion\r\nselect\r\n1.1115 as EUR,\r\n1 as USD,\r\n1.2349 as GBP,\r\n'2020-05 ' as ym\r\nunion\r\nselect\r\n1.1234 as EUR,\r\n1 as USD,\r\n1.2389 as GBP,\r\n'2020-06 ' as ym\r\nunion\r\nselect\r\n1.1772 as EUR,\r\n1 as USD,\r\n1.3087 as GBP,\r\n'2020-07 ' as ym\r\nunion\r\nselect\r\n1.1938 as EUR,\r\n1 as USD,\r\n1.3364 as GBP,\r\n'2020-08 ' as ym\r\nunion\r\nselect\r\n1.1819 as EUR,\r\n1 as USD,\r\n1.3163 as GBP,\r\n'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tsystem_currency_vol,\r\n\t\t\t\tswap\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\t\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\t\tselect 113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 4\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand a.id not in (\r\n\t\t\t\tselect ftr_id\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus\r\n\t\t\twhere\r\n\t\t\t\tstatus = 'expired')\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\t\tselect a.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e85",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f65f435e-d927-4583-8b2d-5641c8bc9ed9",
            "fullname": "MySql:53ae5f97-9852-4164-bddc-c18bf1093b12",
            "type": "extract",
            "name": "53ae5f97-9852-4164-bddc-c18bf1093b12",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "85bf9204-63cf-44c9-b8e0-1cb2f6619102",
                        "id": "tq_f3DbPyWYN",
                        "name": "GeniusIG_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2cd62d1c-4a1b-430b-a3d0-9443c510a44a",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aec3688a-6700-4449-9aba-009a140fa505",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6bd510fc-efa8-401b-bdd2-19d33f4850e7",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c240326e-4ae0-4e63-acce-76da8d652c9a",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5faddc78-314e-4a59-9dde-c14f9cef128e",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5583b330-8c64-434b-9f57-881a047e046c",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45903957-6be8-4363-b23d-35cb3f92b214",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33fdcfc0-4628-4ddc-839b-23c019896f5a",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db58c67f-71a9-4d7b-9e21-a72b0d99f219",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90f9c802-66cb-4e5e-9326-ca9480d3a366",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce76eacd-4a32-40a8-8f35-38cc040ea0f0",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1b249ec-f6a7-448c-a4ce-5041fee7b7b2",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 24,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "574de2e2-2f22-45d3-ae49-4ee795ad0eea",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd4e7fbc-0ff7-4990-9966-028e223084cb",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1907c54-1a71-4c26-b9d4-b97456bff980",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a889ff5-3ed2-4b00-9ee5-e0e357edea6f",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd24073a-0142-4b4f-ac2e-f8343d841151",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dee529b6-7843-4f49-a705-83a10677499a",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "015a6111-dcdc-47be-8ed1-2f3af7a76deb",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90cae61e-3c0d-42c5-a9f7-8f2c0f20104d",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6bf9769f-f4f8-4b04-ae10-c8388f0f1f33",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4411fa1f-53bb-4862-839a-84021ca8cf9e",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ec017ad-6a1c-4fa5-8995-2070e0c5124d",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc6b7359-f5e7-4f0d-978f-34fab4c016ed",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "286cb200-966d-497d-9ddf-8cb63c42cd6b",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "adfb845f-a3e1-4999-8cc8-bfb4b64baf87",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2571b99e-7a8b-425b-ae8b-79a88ab76ff7",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71348d2d-2735-4f98-a780-7e89976da5d6",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0ad7f9e-276f-4ea5-9e9e-8361bcd08383",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e65258e2-6470-4c47-8845-831a13e8ef18",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2369a679-3117-42ba-8c3d-94b0c2139242",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d998b5e-b816-4b86-978f-1fb3b11457b4",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d74a0155-f418-45dd-abba-58def0d7020d",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29422f4e-533a-4af6-a8b7-1646350deb97",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa7e1937-e6a2-4958-8f26-7ce82b865eae",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "498ba5de-9732-42fa-b244-89ce2f0b9e99",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0a081b5-3bbf-4fe4-b0a5-0ee5d3e65ea2",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef59be93-cc1a-4a0d-8421-9059d3af9912",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0185c7a6-75b5-4093-8f8d-804188b1f7eb",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bdc0f30d-9335-41be-9fcf-c00b2fcf68e8",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fed47d06-6d02-4030-bdfc-6b8152b3e1a4",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03b4aec7-0c7e-4a8a-8c20-bb819793ff6b",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4faffbbf-0eeb-4019-af1a-a53844802313",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b51f3046-1603-4f5a-a1cf-ad27e09fa123",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 61,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "379f564b-4e12-4cf7-abfa-44616a574304",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70d683c2-82b2-4800-a47a-46b297e2286b",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1d4772a-b629-4c18-aef4-5470e9f5ead3",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2301225-a66d-4bca-870b-1cfbd1758e53",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f62d705b-47b6-4776-82f6-9130982f18df",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39d86778-9466-449b-8d55-fd693ea1d5d2",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d600aae7-5eb6-4961-a8ea-b264ed8c46e6",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6b312b1-3938-4298-be9c-3853d6f7b9ec",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70b2e7bf-e272-437c-b95f-fb426b075470",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ede3997a-99a0-4d7e-a295-5e1a4f6df097",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8eb96a18-2f67-44f5-88f3-004591b68df4",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eac7061f-10fc-42f3-9bba-544ca766d2c1",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5175eec-ce5f-44b6-8385-811ee05b94a7",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b9db3b3-de11-4481-bd44-369dec3246a9",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e3ab656-be28-487a-8a61-ac82053f0c6a",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c6a6526-02d1-4f97-9e5f-b86ee7d7f0e6",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca639603-951d-4e31-945d-57f3e0c70407",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f17fc4f-a05b-4644-8ace-a0408e8afbbe",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54860c70-4b31-4c31-95a1-f8d8380446bc",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "138a460d-7ec9-442d-ba2c-f764407a3810",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d8c29fc-00ed-4638-8ea3-f92f4ac2ba9f",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39dfd9f8-7d57-4b54-92a6-b3dd0236210f",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dfde18d4-39ef-4d1a-8a0a-db361aff5a4e",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "559f8af6-397a-45dc-adcd-66f01f5ec536",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69395c50-c294-4438-b686-b9594c2c171d",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99c988ad-10e8-45b5-aff1-0761a616a2ff",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffbcb237-f7ab-4cc3-ba9c-d77cf45fdbaf",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8203f86-1e50-4108-95dd-28129cc77718",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02dceaa6-2b39-4d7f-bd3c-8b56e54d283d",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f6762cb-485e-46f5-b639-429ade126742",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c71201f1-2a97-4e93-9731-08f59dcb80df",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e05db821-9974-41b3-b47e-c559b11a32f3",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d7dc2f0-1894-4aa6-8666-2849e8fb6c9a",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "290049ff-744b-4f36-bcb8-be33401a4b51",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1161d980-c370-4966-8ad0-8edcb9cb3d02",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "d673f388-b6e4-4827-83de-c14f207ca187",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\tselect\r\n\t\tt.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,70,78)\r\n\t\t\t\tand coalesce(d.name,\r\n\t\t\t\t'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on\r\n\t\t\t\tb.id = c.transaction_id\r\n\t\t\t\tand c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on\r\n\t\t\t\tc.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,70,78)\r\n\t\t\t\tor coalesce(d.name,\r\n\t\t\t\t'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,70,78)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,70,78)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,\r\n\t\t\t\t'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0945 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2582 as GBP,\r\n\t\t\t\t'2020-04 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1115 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2349 as GBP,\r\n\t\t\t\t'2020-05 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1234 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2389 as GBP,\r\n\t\t\t\t'2020-06 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1772 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3087 as GBP,\r\n\t\t\t\t'2020-07 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1938 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3364 as GBP,\r\n\t\t\t\t'2020-08 ' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1819 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3163 as GBP,\r\n\t\t\t\t'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 6\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\tselect\r\n\t\ta.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61810171be80d2002d15aff5",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCkM37LkFbGnRhmt2tYLFqO1gr0leFAbxvqr45h97aRL2uFXV6bnmXjrx+upQdOgFiG2n1XzowSr7ML18mjmQhnzqjq1V2FUQMfFFcLg11wwiXozn0iLcNZcjGmBoyCW6IdyK2k1UjDiKqlSqoJZSuzAb/GTm3+JvHrvJTMCSB28",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fb8023b8-7a06-4f05-8116-1befb3b1acc8",
            "fullname": "MySql:1241ec78-bbf9-440d-84e2-e510ee702d41",
            "type": "extract",
            "name": "1241ec78-bbf9-440d-84e2-e510ee702d41",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "bb76e22e-42a6-446d-a20e-f8a36d10a10a",
                        "id": "tq_kb0i5ByGq",
                        "name": "NostraCapital_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "06b12eac-a78a-4107-9db3-c7b4faa460cc",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49966273-efbf-49de-ab37-be5b208eb291",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 27,
                                "precision": 27,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12038f5c-2428-47b7-a4f4-f022dde603a5",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f251c626-064c-4f33-9b68-e8d2b8933a2c",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "205c1bc3-fd36-46f1-9b1c-b91e93b42c3d",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "355c1a18-64bd-4ac6-a954-acbbd30862a1",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5cf66314-5c53-4dfb-9068-633575188aba",
                                "id": "open_pnl_diff",
                                "name": "open_pnl_diff",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9f084ef-3462-42aa-8f87-fe568b130995",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "a19ddc15-0c69-48bb-a2f4-e159f604f6b1",
                        "configOptions": {
                            "importQuery": "select\n\tcast(1000 + brand.id as char) as site_id,\n\tconcat(1000 + brand.id, '10000', b.trader_id) as customer_key,\n\tb.trader_id as customer_id,\n\tyear(b.date - interval 1 day) * 10000 + month(b.date - interval 1 day) * 100 + day(b.date - interval 1 day) as date_key,\n\tb.date - interval 1 day as date,\n\tb.open_pnl,\n\tb.open_pnl_diff,\n\tcurrency.code\nfrom\n\t(\n\tselect\n\t\ta.*,\n\t\tcase\n\t\t\twhen @last_id = a.trader_id then (a.open_pnl - @last_open_pnl)\n\t\t\telse a.open_pnl end as open_pnl_diff,\n\t\t\t@last_id := a.trader_id,\n\t\t\t@last_open_pnl := a.open_pnl\n\t\tfrom\n\t\t\t(\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\topen_pnl_daily\n\t\t\torder by\n\t\t\t\t2,\n\t\t\t\t3 asc) a\n\t\tleft join (\n\t\t\tselect\n\t\t\t\t@last_open_pnl := 0,\n\t\t\t\t@last_id := 0) b on\n\t\t\t1 = 1) b\ninner join trader_account on\n\tb.trader_id = trader_account.trader_id\ninner join currency on\n\ttrader_account.currency_id = currency.id\ninner join trader on\n\ttrader_account.id = trader.default_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\t"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e89",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6mkpXbI+4cVPcW9QmdR/OpFY0NV6lOS+yIHmY9aWUhUzSj1KLvCfMgcIqWzFtH2wB4wDE6J0O3kIYCeCTy2Vm2FnBTBcZ0ejYO8nr2tUHC3cyjEC9VpB/CP/XWAQHRXQ8biCOO3g3QegnOXaTTb/9ErFOuEJ8WFWhUXRuCVMOFyl",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fba3657f-58f2-4608-8aa8-22e063bbd667",
            "fullname": "MySql:d3fd71f3-b182-4698-b8c6-0868787e8bdd",
            "type": "extract",
            "name": "d3fd71f3-b182-4698-b8c6-0868787e8bdd",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "61190cd58a56da002c368e8b",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoholBm9zTgPkWmVjr8ZqHeK",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fcec998c-9b7f-4475-b51a-a2beb5d66ce3",
            "fullname": "MySql:a129f5be-7784-405b-8a3b-b1c61c60cdbe",
            "type": "extract",
            "name": "a129f5be-7784-405b-8a3b-b1c61c60cdbe",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0cb5e36f-9e89-4a5a-8df4-c8091766ff04",
                        "id": "tq_iRnRen8y3",
                        "name": "YorkRealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1cde11c4-c65c-4196-842d-e454c9d269a5",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "024d5970-2047-427a-94ca-59a589e44c53",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df88623d-0b7c-4f1f-95af-f359223f1cd9",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98c04ce2-f5ae-4f9f-9809-1c3335988bee",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d31d22a-2bf4-40bc-960f-2375efb60c98",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3e91576-18bc-4c12-b104-c40418b8ec3d",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbeb8cc1-a0f9-49ac-87ba-69d0b85eb73a",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e82ab9de-2582-4b80-a553-63bba51c5801",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d36031a0-7920-45ea-82ac-76babdf586e9",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e5fd2c4-d6e6-459c-9f12-70cce396fd24",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05b3a065-d4e5-4efc-a37c-e4ed457a660e",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48802371-6217-410c-b63a-f987d224adad",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db0d46e3-3a88-4421-8b82-253c6ff5b7cd",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1dd50418-ce61-40cf-b60b-1e25f8179764",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9952b1f2-4b88-4d4a-af86-68bd86416532",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "836afd65-62a0-45dc-8806-1bbb55b1d857",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d871b441-6029-44b5-b082-263ff25dcd28",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e5ac3316-da6c-4e00-9d20-ce8d15027875",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cb03d07-5552-41d9-b03a-9d017d5c4ab9",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14ab6935-78cc-44a6-b829-2e3e67ecb4d8",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bb78447-718f-4d98-a525-30b400a5fdf5",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1202a4e-5fb1-4ec3-98fc-41a4cd59e781",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e23e8af3-418a-445a-9b77-8db66b03efbd",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0eb50507-ee87-469b-ac7c-80c942677e12",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14fc2c8f-6178-4c2a-a659-93a1906cc8a9",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "229ad8e5-f22f-4cc9-b013-8c6ae6cf4020",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e51e30de-f579-40c5-9c92-59ea66e76fdb",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6e1bfd9-1c55-4059-875e-ae0bb303170d",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71afca62-830e-43ed-9e59-a6339bac4c04",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53c06d1d-4a02-4bed-91cb-3641fd91dce0",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c65224a1-0f91-498e-ad21-b7ff2bb04f60",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd645b6c-1cf7-4553-89a0-57e9597e0c06",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3095171e-fe63-49e3-8d69-e60119a43adb",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64c0345c-487a-4de9-a79b-fe42e7145281",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67dfbae9-8102-4a9f-9c55-b350d24e82ef",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c05b9823-9582-4fac-a0c8-c32df5c3b882",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e075d10f-9697-4302-9ed2-a2e55f3cdf7a",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08987b36-52da-4a98-845a-9d77c63d91fd",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0da133b-d8aa-4a14-8e10-29c97b276ae8",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f21d6503-3917-4b3e-bc5c-6e26a69dbfc7",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b85eae17-ad5c-41fb-b394-9a0df30b790b",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3021148c-624f-4267-9eb2-e03004d28ec2",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "631a71fd-2d2f-46da-8fc6-6509abdcf585",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd27015b-8053-41d7-9632-5a0d35ed4bfa",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1213f5e8-2e2d-44ab-ae76-d68353397654",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84d6aa36-7ceb-413d-a49c-4fe9ed0c7c86",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "339959e1-7d42-4a3b-ad26-76837b49cbf1",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4d34973-7fea-49aa-bddf-fc18268c04ba",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f9d31eb-6934-426f-aac8-6961284b9509",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5f72673-404d-4ed6-b16b-ac9cad46fea2",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4277b328-00e2-4681-b310-7c54ddc4e811",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "915d2edd-2405-4314-aaa5-5c14d0d2f795",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2eeafa1f-1296-4e3d-8f8f-db1c383239e8",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31c5218f-329d-4fa4-abf1-331ea879c6bb",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0ebe62b-a0e7-4433-92d6-94254a34850b",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88d2ed22-981f-45c4-b042-3854516704ec",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a235a3c-df1d-456f-91ba-b57d724f540f",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0ddb021-84b3-4381-a182-b57f2edc861c",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "85452457-2182-403b-8120-be0bf6f77916",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7018ce6d-4946-4ad7-ade3-a2b91d1dae03",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1dde347-5719-4f3d-b2ad-7a10d8ea0b94",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c44d5c5-f804-4bda-9522-a0b5c10cb4ef",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8ecad59-5273-41a6-9491-0f24d4d79e67",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8dd580dc-f12b-4638-a25d-19af1493ff4e",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d12f3d4-5243-41c3-a7ec-a4b8c6b51060",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6379e483-5191-4113-85f5-54ddeb57308f",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6187358-01ee-4330-919f-9d2b2bf3ef79",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed2e0034-3330-4a45-8b15-bdc6ef5b4ffc",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a142f421-7c8c-445e-8caa-6da8ae73176d",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c2ec930-bda7-43e4-8224-01e9749baa7c",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b379c150-f5b2-4f09-a4a3-b5c4791957de",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d9ac9c7-5b18-4ce4-9fa5-e9faab521739",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6500c7a3-57bc-4945-b040-050829b31aae",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0498cfe-cb22-447d-9b7f-b30221420ce3",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcb99d4b-4c32-4c73-989a-3c400166b2a8",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8f045f6-4251-4779-9dc4-5e50a8facd56",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e794b520-1a0d-44df-be88-f496777d5f22",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e19e6d1-eedc-46b2-80e8-989b75d82c7f",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26805ec1-29c9-4e84-b250-5210076fa2e8",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "14db94df-e535-4aa9-a06d-935cbf545dc7",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10000', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10000', coalesce(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\t\tselect t.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdacc,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect b.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,54,68,96,128)\r\n\t\t\tand coalesce(d.name,'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,54,68,96,128)\r\n\t\t\tor coalesce(d.name,'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,32,54,68,96,128)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\r\n\t\t\tdeposits.id = a.id\r\n\t\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,32,54,68,96,128)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\t\tselect 1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym \r\nunion\r\nselect\r\n1.0945 as EUR,\r\n1 as USD,\r\n1.2582 as GBP,\r\n'2020-04 ' as ym\r\nunion\r\nselect\r\n1.1115 as EUR,\r\n1 as USD,\r\n1.2349 as GBP,\r\n'2020-05 ' as ym\r\nunion\r\nselect\r\n1.1234 as EUR,\r\n1 as USD,\r\n1.2389 as GBP,\r\n'2020-06 ' as ym\r\nunion\r\nselect\r\n1.1772 as EUR,\r\n1 as USD,\r\n1.3087 as GBP,\r\n'2020-07 ' as ym\r\nunion\r\nselect\r\n1.1938 as EUR,\r\n1 as USD,\r\n1.3364 as GBP,\r\n'2020-08 ' as ym\r\nunion\r\nselect\r\n1.1819 as EUR,\r\n1 as USD,\r\n1.3163 as GBP,\r\n'2020-09 ' as ym) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\t\tselect ftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tinner join brand on\r\n\t\t\tb.brand_id = brand.id\r\n\t\tleft join (\r\n\t\t\t\tselect 113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 1\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,\r\n\t\t\t11,\r\n\t\t\t12,\r\n\t\t\t13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5  asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\t\tselect a.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\t\tselect b.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e8f",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE9NO30CEtYeuiYUtaqTnnfAU2tZy1ts9m5PIlekjZKdki2gvPSjPn2u0iSrDXJC+xb3tha8XaaFiaeclzkPJjBXt6jfCN8NG9SVA4k89XBc5Q0PdEjDFciH1xbw+joD/gcFrgTfftJutcjD9GYaZJqUJxSYIR2pVegpaZ4Spin0SQzmTPKfs3EbT1RAQYYGZ/kmklN7+RgacxQIcAc7PIMBA==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fd162e3c-0e8b-4f6d-9bf5-6dad9459116d",
            "fullname": "MySql:4c8d932a-2ec7-48b8-b504-d1d783525e3b",
            "type": "extract",
            "name": "4c8d932a-2ec7-48b8-b504-d1d783525e3b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9c7d91aa-cfbf-435a-b04c-9678b6767724",
                        "id": "tq_2VVzaY4A9",
                        "name": "PrimeOTRealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b513f9d0-5590-4869-9bb6-a54f7dc245cb",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "380d954a-aa21-4112-bae7-b2659cf6e27b",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "329de9e0-b645-4feb-92e1-8fca91551e0b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "400510be-1e8e-4d05-a779-d2a021f216c6",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88c99c03-3b96-4932-a237-2c2303e177ca",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73ef38be-72e5-42cc-866d-2f2acf425d10",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd4a6359-081b-433c-8de9-5184deddd046",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df130a8d-4ef3-432a-b905-1f7a6f04b61b",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc7b5ff9-825e-4175-be03-ec7b747f4a2f",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4447395e-d832-410c-a6f5-e792685201bc",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00808230-6118-4a0f-9061-23d36c3c2531",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87f6a8a1-0efc-4bba-a633-fb3efe0d88e2",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 26,
                                "precision": 24,
                                "scale": 5,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d15abeed-0b82-4c42-8078-d69fcc85100d",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea3dd8bb-91d6-4205-9c71-afb5d16563a1",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c075e2c4-b88f-4212-ac26-6a02e8b243f3",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76a5c321-07fa-41c5-a04b-1e21130756ee",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f9d8b77-4298-408d-aa34-874ae1255fc0",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5ee925e-6be2-4a43-898a-c817b016ae12",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0973bcb-df04-479d-80e3-3dd7a108ace5",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "adc3d10d-cc44-47e3-a539-1955fe3ae6dc",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "003837c0-c3e1-4418-83dc-11eb680df716",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9642b1d-a881-43e8-ae2b-8156222d5cf5",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9931527f-5124-420a-b75f-c0b59d8d89b0",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c398fbf-a39f-418a-8254-3a6f1fb6d330",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e6c6a30-e3a6-4035-bf64-14cd29e7e609",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8031428e-ce1e-4314-9467-dec46d9a31de",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d77b1377-9207-4849-8d1f-b49e065375b2",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b8a4fbb-f70e-43ba-a5e0-640d93ab7c02",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b751b287-f460-4a09-a9b8-59b7c397d2ee",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7698df44-80ea-4fb1-bbe6-2a32e95f4d46",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76b0d6a3-fe17-48cc-9560-a710f9af8cbe",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1b72b0e-b74c-43c6-bfb3-8e5ea4af4f3d",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "424812b8-728d-4368-92b2-1b40c65f07b8",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3f7d31f-b5db-4dcd-a09c-ee4ccc46a774",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00d7fca4-005e-43d5-9336-292e28a9c009",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbb32e58-2922-49ae-b841-a4870a0499bf",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e079f183-e00c-4e3c-9a82-f342680c5d60",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2bd00ca0-9fb4-46d8-90f1-09c71bab5f61",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4eaf642-00ca-4afb-abfe-b0867b05535c",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "349b3edb-5443-4c27-8bd6-9625e099d731",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "070fc1d5-be0f-435a-b600-d98fcff84038",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cce750ca-fe5b-4e8d-8a19-b6022346db07",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a6f4166-6889-4ce5-99ed-af56e215dfa5",
                                "id": "duplicated_pnl_curr",
                                "name": "duplicated_pnl_curr",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07ebf60a-ca86-4d39-862c-d8a504d8d694",
                                "id": "duplicated_pnl_usd",
                                "name": "duplicated_pnl_usd",
                                "type": 5,
                                "size": 63,
                                "precision": 61,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8a271b3-c550-4398-a6b7-8f5573b522b3",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dae7f9b-59ab-4315-82b6-3bb2b7776b90",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "332c8e33-02cb-46f9-8b3f-0947d47c4f0c",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fdda7cbf-90c2-4ae2-add8-2dc78d8c9ea4",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4443fdf-6bbd-4ad5-b28d-52638b0e64fd",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b0bf059-5e9b-4b77-bb70-4296a0cd92f6",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8f66a47-ada9-4cbe-9f7d-5e39e74c50eb",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9bcc7cfa-94ce-4d7e-8a2a-049ce7734000",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60784afb-457f-47a4-8828-7bbe1c3353a9",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e92fe3d3-8b59-406c-8d3a-9b790e6a7380",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c704aff7-193f-419f-9f11-8bb3fd39f7a1",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ffa4240-6477-41b8-9c04-2ef874a0e55d",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71431971-d006-42dc-927e-dfb611062a3a",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3efbfca-b9ef-4a75-998e-f6182bb38ab6",
                                "id": "refund_curr",
                                "name": "refund_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55b0eb9f-28ac-48c9-9c4f-f034e4ce032b",
                                "id": "refund_usd",
                                "name": "refund_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af4997aa-7276-452d-ba23-18ff604b3a51",
                                "id": "education_deposit_curr",
                                "name": "education_deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf087cf2-3cde-4f2e-a4f0-86e51e528020",
                                "id": "education_deposit_usd",
                                "name": "education_deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "533c2035-5316-4a8c-964c-2a448bf6e854",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02c2001c-e76b-4d53-ae1c-2d830e8c0780",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4690eb64-4ee2-4593-b8de-293c3e7ef686",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d83fea84-c541-479d-a2f7-0a83e8174628",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24e6c163-a03f-4559-8737-d2d5b197201e",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c48a668d-c12b-450d-821f-022b512dd85c",
                                "id": "EligibleCurr",
                                "name": "EligibleCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6fdec75-02d9-4bb2-a2e9-db6a659cbce4",
                                "id": "EligibleDiffCurrency",
                                "name": "EligibleDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9df7435-c4d7-4279-8889-71ab1e790a6e",
                                "id": "RealABAccCurrIncNegative",
                                "name": "RealABAccCurrIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56e7eaab-fe59-40bc-b6a7-9c9777f4712f",
                                "id": "balance_after_curr",
                                "name": "balance_after_curr",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e9975549-d3a5-41d3-be5e-1a61ec00999d",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "588bae5a-8d94-48a1-a181-1a09688dcfd5",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "179afb15-d8bc-4651-8a3e-e7b7787ccdaa",
                                "id": "RealABDiffCurrencyIncNegative",
                                "name": "RealABDiffCurrencyIncNegative",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60c19cea-4e29-4c36-8fb8-7ab3b4ae8a63",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca6bad22-033f-4ac0-a8b9-e68edeea567a",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2cf64bcb-d960-4211-b7af-d91f1c0a735b",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb85eefa-ecea-40c3-a70d-f2ebb0183918",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a0298b7-01d1-439a-b5cb-e4b56e2744e1",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88e5657c-7f3d-4f14-b4bf-7c05fbe86a11",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "0bc1475c-7269-421b-86fe-2d1f46252c05",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id as site_id,\r\n\tconcat(aggCustomer.site_id, '10002', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate\r\n\tend as rate,\r\n\tMaxDep.LastDepDate,\r\n\tMaxInv.LastTimeInvestment,\r\n\taggCustomer.tr_id,\r\n\taggCustomer.origin_type,\r\n\tMinDep.FTDDate,\r\n\tcase\r\n\t\twhen FTD.FTDind is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\taggCustomer.user_id,\r\n\tconcat(aggCustomer.site_id, '10002', COALESCE(aggCustomer.user_id, 0)) as employee_key,\r\n\taggCustomer.deposit_curr,\r\n\taggCustomer.deposit_usd,\r\n\taggCustomer.cashback_curr,\r\n\taggCustomer.cashback_usd,\r\n\taggCustomer.withdrawal_curr,\r\n\taggCustomer.withdrawal_usd,\r\n\taggCustomer.withdrawal_curr_new,\r\n\taggCustomer.withdrawal_usd_new,\r\n\taggCustomer.cashback_withdrawal_curr,\r\n\taggCustomer.cashback_withdrawal_usd,\r\n\taggCustomer.withdrawal_fee_curr,\r\n\taggCustomer.withdrawal_fee_usd,\r\n\taggCustomer.chb_curr,\r\n\taggCustomer.chb_usd,\r\n\taggCustomer.inactivity_fee_curr,\r\n\taggCustomer.inactivity_fee_usd,\r\n\taggCustomer.overnight_fee_curr,\r\n\taggCustomer.overnight_fee_usd,\r\n\taggCustomer.fees_curr,\r\n\taggCustomer.fees_usd,\r\n\taggCustomer.pnl_curr,\r\n\taggCustomer.pnl_usd,\r\n\taggCustomer.duplicated_pnl_curr,\r\n\taggCustomer.duplicated_pnl_usd,\r\n\taggCustomer.swap_curr,\r\n\taggCustomer.swap_usd,\r\n\taggCustomer.contract_usd,\r\n\taggCustomer.rbonus_curr,\r\n\taggCustomer.rbonus_usd,\r\n\taggCustomer.cancelled_bonus_curr,\r\n\taggCustomer.cancelled_bonus_usd,\r\n\taggCustomer.pending_bonus_curr,\r\n\taggCustomer.pending_bonus_usd,\r\n\taggCustomer.fixed_balance,\r\n\taggCustomer.fixed_balance_usd,\r\n\taggCustomer.negative_balance_fix_curr,\r\n\taggCustomer.negative_balance_fix_usd,\r\n\taggCustomer.refund_curr,\r\n\taggCustomer.refund_usd,\r\n\taggCustomer.education_deposit_curr,\r\n\taggCustomer.education_deposit_usd,\r\n\tcast(aggCustomer.NetdepCurr as decimal(20,10)) as NetDepCurr,\r\n\tcast(aggCustomer.NetDepCurrAcc as decimal(20,10)) as NetDepCurrAcc,\r\n\tcast(aggCustomer.NetDepUsd as decimal(20,10)) as NetDepUsd,\r\n\tcast(aggCustomer.NetDepUsdAcc as decimal(20,10)) as NetDepUsdAcc,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as RealABAccCurr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrency as decimal(20,10)) as EligibleCurr,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as EligibleDiffCurrency,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedCurrencyIncNegative as decimal(20,10)) as RealABAccCurrIncNegative,\r\n\taggCustomer.balance_after_curr,\r\n\tcast(aggCustomer.RealAccountBalanceAccumulatedUsd as decimal(20,10)) as RealABAccUsd,\r\n\tcast(aggCustomer.RealABDiffCurrency as decimal(20,10)) as RealABDiffCurrency,\r\n\tcast(aggCustomer.RealABDiffCurrencyIncNegative as decimal(20,10)) as RealABDiffCurrencyIncNegative,\r\n\tcast(aggCustomer.RealABDiffUsd as decimal(20,10)) as RealABDiffUsd,\r\n\tcast(aggCustomer.RealPnLCurrAcc as decimal(20,10)) as RealPnLAccCurr,\r\n\tcast(aggCustomer.RealPnLCurr as decimal(20,10)) as RealPnLCurr,\r\n\tcast(aggCustomer.RealPnLUsdAcc as decimal(20,10)) as RealPnLAccUsd,\r\n\tcast(aggCustomer.RealPnLUsd as decimal(20,10)) as RealPnLUsd,\r\n\tb.balance as CurrencyBalance\r\nfrom\r\n\t(\r\n\tselect\r\n\t\tt.*,\r\n\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr + t.education_deposit_curr as NetdepCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\telse @netdepositcurracc := @netdepositcurr\r\n\t\tend as NetDepCurrAcc,\r\n\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd + t.education_deposit_usd as NetdepUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\telse @netdepositusdacc := @netdepositusd\r\n\t\tend as NetDepUsdAcc,\r\n\t\t@RealAB := t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.duplicated_pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr + t.refund_curr + t.education_deposit_curr as RealABCurr,\r\n\t\t@RealABUsd := t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.duplicated_pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd + t.refund_usd + t.education_deposit_usd as RealABUsd,\r\n\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastab < 0\r\n\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\telse @RealABAccHelp := @RealAB\r\n\t\tend as RealABAccHelp,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @lastabusd < 0\r\n\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\t\tend as RealABAccHelpUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0\r\n\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealAB + @lastab >= 0 then @realreal := @RealABAccHelp\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\telse @realreal := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg := @RealABAccHelp\r\n\t\t\telse @realrealneg := @RealAB\r\n\t\tend as RealAccountBalanceAccumulatedCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\twhen @lastId = t.id\r\n\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\telse @realrealusd := @RealABUsd\r\n\t\tend as RealAccountBalanceAccumulatedUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrency,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealneg - @lastrealneg\r\n\t\t\telse @RealAB\r\n\t\tend as RealABDiffCurrencyIncNegative,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\telse @RealABUsd\r\n\t\tend as RealABDiffUsd,\r\n\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\telse @realpnlcurr := @realpnlcurracc\r\n\t\tend as RealPnLCurr,\r\n\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\telse @realpnlusd := @realpnlusdacc\r\n\t\tend as RealPnLUsd,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @education_deposit_total:= @education_deposit_total + t.education_deposit_curr\r\n\t\t\telse @education_deposit_total:= t.education_deposit_curr\r\n\t\t\tend as education_deposit_total,\r\n\t\t@eligible:= greatest(@realreal - @education_deposit_total,0) as EligibleCurr,\r\n\t\tcase\r\n\t\t\twhen @lastId = t.id then @eligible - @lasteligible\r\n\t\t\telse @eligible end as EligibleDiffCurrency,\r\n\t\t@lastreal := @realreal,\r\n\t\t@lastrealusd := @realrealusd,\r\n\t\t@lastrealneg := @realrealneg,\r\n\t\t@lastab := @RealABAccHelp,\r\n\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t@lastId := t.id,\r\n\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t@lastrealpnlusd := @realpnlusdac,\r\n\t\t@lasteligible:= @eligible\r\n\tfrom\r\n\t\t(\r\n\t\tselect\r\n\t\t\tbrand.name as site_name,\r\n\t\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\t\tb.id,\r\n\t\t\ta.id as tr_id,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\telse a.created_at\r\n\t\t\tend as created_at,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\telse date(a.created_at)\r\n\t\t\tend as 'date',\r\n\t\t\tb.user_id,\r\n\t\t\td.code as currency,\r\n\t\t\ta.origin_type,\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend as YearMonth,\r\n\t\t\tcase\r\n\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\twhen d.code = 'GBP' then rates.GBP\r\n\t\t\tend as rate,\r\n\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\ta.balance_after as balance_after_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t0) as deposit_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t0) as deposit_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t0) as cashback_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t0) as cashback_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t0) as withdrawal_curr_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t0) as withdrawal_usd_new,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t0) as fees_curr,\r\n\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t0) as fees_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.amount * duplicated_transactions.times_duplicated - a.amount else 0 end) as duplicated_pnl_curr,\r\n\t\t\tsum(case when a.origin_type = 5 and duplicated_transactions.origin_id is not null then a.wide_currency_amount * duplicated_transactions.times_duplicated - a.wide_currency_amount else 0 end) as duplicated_pnl_usd,\r\n\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd,\r\n\t\t\tsum(case when a.origin_type = 7 then a.amount else 0 end) as refund_curr,\r\n\t\t\tsum(case when a.origin_type = 7 then a.wide_currency_amount else 0 end) as refund_usd,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.amount else 0 end),0) as education_deposit_curr,\r\n\t\t\tcoalesce(sum(case when a.origin_type = 1 and education_deposits.id is not null then education_deposits.wide_currency_amount else 0 end),0) as education_deposit_usd\r\n\t\tfrom\r\n\t\t\ttransaction_record a\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\ta.realized_at\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\trbonus.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tb.amount,\r\n\t\t\t\tb.wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_bonus a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.is_realized = 0\r\n\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\tpbonus.id = a.id\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_account_id = b.default_account_id\r\n\t\tinner join brand on b.brand_id = brand.id\r\n\t\tinner join trader_account c on\r\n\t\t\tb.id = c.trader_id\r\n\t\tinner join currency d on\r\n\t\t\tc.currency_id = d.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,29,45,62,107)\r\n\t\t\t\tand coalesce(d.name,'') <> 'CH SR Cashback') withdrawals on\r\n\t\t\twithdrawals.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0) as amount_curr,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_processor c on b.id = c.transaction_id and c.origin_id = 2\r\n\t\t\tleft join payment_sub_processor d on c.payment_sub_processor_id = d.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,29,45,62,107)\r\n\t\t\t\tor coalesce(d.name,'') = 'CH SR Cashback') withdrawals_cashback on\r\n\t\t\twithdrawals_cashback.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) not in (24,29,45,62,107)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tand COALESCE(b.psp_reference_id,'') <> 'CH SR Cashback'\r\n\t\t\t\tand coalesce(c.name,'') not in ('education kick-start')) deposits on\t\t\t\r\n\t\t\tdeposits.id = a.id\r\n\t\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\tleft join transaction_sub_type c on b.type = c.id\r\n\t\t\twhere\r\n\t\t\t\tb.status = 'completed'\r\n\t\t\t\tand coalesce(c.name,'') in ('education kick-start')) education_deposits on\t\t\t\t\r\n\t\t\teducation_deposits.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\ta.amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join transaction_deposit b on\r\n\t\t\t\ta.id = b.ftr_id\r\n\t\t\twhere\r\n\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t0) in (24,29,45,62,107)\r\n\t\t\t\tand b.status = 'completed'\r\n\t\t\t\tor COALESCE(b.psp_reference_id,'') = 'CH SR Cashback') cashbacks on\r\n\t\t\tcashbacks.id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\tovernight_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ta.ftr_id,\r\n\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_commission a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id\r\n\t\t\twhere\r\n\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tswap as swaps_curr,\r\n\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join transaction_record b on\r\n\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\ta.id = swaps.ftr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t'2019-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t'2019-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t'2019-03' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t'2019-04' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t'2019-05' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.136 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t'2019-06' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t'2019-07' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t'2019-08' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t'2019-09' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t'2019-10' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t'2019-11' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t'2019-12' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t'2020-01' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t'2020-02' as ym\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t1.13513 as EUR,\r\n\t\t\t\t1 as USD,\r\n\t\t\t\t1.30362 as GBP,\r\n\t\t\t\t'2020-03' as ym\r\nunion\r\nselect\r\n1.0945 as EUR,\r\n1 as USD,\r\n1.2582 as GBP,\r\n'2020-04 ' as ym\r\nunion\r\nselect\r\n1.1115 as EUR,\r\n1 as USD,\r\n1.2349 as GBP,\r\n'2020-05 ' as ym\r\nunion\r\nselect\r\n1.1234 as EUR,\r\n1 as USD,\r\n1.2389 as GBP,\r\n'2020-06 ' as ym\r\nunion\r\nselect\r\n1.1772 as EUR,\r\n1 as USD,\r\n1.3087 as GBP,\r\n'2020-07 ' as ym\r\nunion\r\nselect\r\n1.1938 as EUR,\r\n1 as USD,\r\n1.3364 as GBP,\r\n'2020-08 ' as ym\r\nunion\r\nselect\r\n1.1819 as EUR,\r\n1 as USD,\r\n1.3163 as GBP,\r\n'2020-09 ' as ym ) rates on\r\n\t\t\trates.ym =\r\n\t\t\tcase\r\n\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\telse date_format(a.created_at, '%Y-%m')\r\n\t\t\tend\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tftr_id,\r\n\t\t\t\tsystem_currency_vol\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position) contract on\r\n\t\t\tcontract.ftr_id = a.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t113 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t178 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t431 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t444 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t667 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t669 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t719 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t722 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t725 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t728 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t730 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t739 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t3 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t742 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t4 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14017 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t14185 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t15286 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t17222 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18557 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t18633 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t51094 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t53021 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t55189 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56011 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t56598 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t58533 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59217 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59564 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59921 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59936 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59940 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t59976 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t60973 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62255 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t62602 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64700 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t64903 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66341 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t66653 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t67606 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68025 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t68732 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69281 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t69501 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t70036 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t71348 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t73585 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t74087 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76808 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t76830 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77591 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t77992 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t78569 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79158 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79751 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79776 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t79861 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80148 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80149 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t80961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t81789 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t82187 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83126 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t83852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84647 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84882 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t84994 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t85474 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86488 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t86959 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t87442 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88286 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88547 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88580 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88608 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88934 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88957 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88960 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t88961 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89028 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89048 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t89527 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t90983 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91231 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t91599 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92083 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92119 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92272 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92436 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t92529 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t93156 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t94765 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95003 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95290 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95417 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95533 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95552 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t95696 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96039 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96082 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96442 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96444 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t96903 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97559 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t97715 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98608 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98799 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98801 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98939 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t98941 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99276 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99382 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99383 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t99943 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101045 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101071 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t101252 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t141562 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142017 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142046 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142054 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142060 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142077 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142082 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142264 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142430 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t142628 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143897 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t143985 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144173 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t144779 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t146491 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147091 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t147685 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148023 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t148087 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149446 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t149654 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t150882 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151089 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151363 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151386 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t151852 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152005 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152069 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t152804 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153023 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153576 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153588 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t153631 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154646 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t154692 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155297 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155382 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t155827 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156184 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156235 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t156868 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t157794 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158445 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t158887 as origin_id,\r\n\t\t\t\t7 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159205 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159555 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t159821 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160010 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160727 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t160963 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t161450 as origin_id,\r\n\t\t\t\t6 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162530 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t162532 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163044 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163055 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163285 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163535 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t163689 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164246 as origin_id,\r\n\t\t\t\t3 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164829 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164864 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t164909 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165119 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165178 as origin_id,\r\n\t\t\t\t4 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t165335 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166717 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t7 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t166741 as origin_id,\r\n\t\t\t\t1 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168116 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168721 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t168736 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated\r\n\t\tunion\r\n\t\t\tselect\r\n\t\t\t\t169843 as origin_id,\r\n\t\t\t\t5 as brand_id,\r\n\t\t\t\t2 as times_duplicated ) duplicated_transactions on\r\n\t\t\tduplicated_transactions.origin_id = a.origin_id\r\n\t\t\tand duplicated_transactions.brand_id = 3\r\n\t\twhere b.is_test = 0\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t3,\r\n\t\t\t2,\r\n\t\t\t4,\r\n\t\t\t5,\r\n\t\t\t6,\r\n\t\t\t7,\r\n\t\t\t8,\r\n\t\t\t9,\r\n\t\t\t10,11,12,13\r\n\t\torder by\r\n\t\t\t3,\r\n\t\t\t4,\r\n\t\t\t5 asc) t\r\n\tinner join (\r\n\t\tselect\r\n\t\t\t@lastab := 0,\r\n\t\t\t@RealABAccHelp := 0,\r\n\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t@lastId := 0,\r\n\t\t\t@realreal := 0,\r\n\t\t\t@lastreal := 0,\r\n\t\t\t@RealABUsd := 0,\r\n\t\t\t@lastabusd := 0,\r\n\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t@realrealusd := 0,\r\n\t\t\t@lastrealusd := 0,\r\n\t\t\t@netdepositcurr := 0,\r\n\t\t\t@netdepositcurracc := 0,\r\n\t\t\t@netdepositusd := 0,\r\n\t\t\t@netdepositusdacc := 0,\r\n\t\t\t@realpnlcurr := 0,\r\n\t\t\t@realpnlcurracc := 0,\r\n\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t@realpnlusd := 0,\r\n\t\t\t@realpnlusdacc := 0,\r\n\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t@currentrate := 0,\r\n\t\t\t@realrealneg := 0,\r\n\t\t\t@lastrealneg := 0,\r\n\t\t\t@education_deposit_total:= 0,\r\n\t\t\t@eligible:= 0,\r\n\t\t\t@lasteligible:= 0) v) aggCustomer\r\ninner join (\r\n\tselect\r\n\t\ta.id,\r\n\t\tb.name\r\n\tfrom\r\n\t\ttrader a\r\n\tinner join country b on\r\n\t\ta.country_id = b.id) co on\r\n\tco.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.id) as FTDInd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) FTD on\r\n\tFTD.id = aggCustomer.id\r\n\tand FTD.FTDInd = aggCustomer.tr_id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.created_at) as LastDepDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxDep on\r\n\tMaxDep.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmax(a.open_at) as LastTimeInvestment\r\n\tfrom\r\n\t\ttrader_account_position a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1) MaxInv on\r\n\tMaxInv.id = aggCustomer.id\r\nleft join (\r\n\tselect\r\n\t\tb.id,\r\n\t\tmin(a.created_at) as FTDDate\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\twhere\r\n\t\ta.origin_type = 1\r\n\t\tand b.is_test = 0\r\n\tgroup by\r\n\t\t1) MinDep on\r\n\tMinDep.id = aggCustomer.id\r\nleft join trader_account b on\r\n\taggCustomer.id = b.trader_id\r\norder by\r\n\t1,\r\n\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "613f0666387fbb002c4fdeb2",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLVxQJn/fIgB2jPq/USX+LqSfZ6vqXBKwmQNyHbwju2Iyv3UGEGTgWDgj/ba3r/gq1kqbATP5o/xWwrhv89KMi4jDy0HDA4R66Y4CsaPWHveQ9fFyypLzTFQnQL+jR08758EdW3LZQIrPbEB5g6hvowXFnB4betMw+dYIGHfBEahj7iZqGVhIJOkz05deSrziuPINlCmfHeG6IbsJnIZQ5tnQIrPsHa9TiwIhIYN+Bsb4",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fe988904-9f5c-4f16-ae4d-d4114b682262",
            "fullname": "MySql:043c2da7-6cdd-4998-98ff-005376a9bd55",
            "type": "extract",
            "name": "043c2da7-6cdd-4998-98ff-005376a9bd55",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "e8bf1bb8-8e65-4123-9650-ee0136b14435",
                        "id": "tq_wZt1iG7jc",
                        "name": "Infinitycapitalg_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "be748c59-0ca6-4c21-90e4-63a0b444315c",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6479edd-82fc-49e1-994d-fba0ab5cbca6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd11b235-e0e1-4450-8081-8d3dc7d5af64",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c381fce-0036-4dca-b49c-a9c08fed36d1",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ca7355a-72f5-4508-b43a-e58fb5004fdc",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e37358f4-4cb2-4747-a9f1-2791e0a5ca91",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f4c3b91-18bc-4333-82ac-9ad86ad7ebe4",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf9fb941-a236-4923-95e1-168d7ca4ba12",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6ab21b8-1090-4e8a-8d8e-37086e890b3e",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f19f5237-edae-46e0-a7e3-404105cb1db9",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76c3df23-83b0-4b13-90d5-95883a19539c",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c23b4c2d-d48c-4762-b1f1-2148dbe596ef",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c9285131-394e-4adb-9b86-0a5b9363184d",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "018b2d62-2387-46a3-9dcf-768e7141a908",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a1b3d851-f1e4-4320-8d12-ab2bbab95d78",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d60b07a-cc81-43e6-9660-3a4bf95fcd17",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "32b18878-505c-4aa3-bfa4-9b497831a515",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "354e9648-b2df-48d1-9399-609a67fa3da8",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "10a55479-9f91-4410-9fde-1e295f07cf53",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "473fed8d-0363-4e0c-a8e6-22f5d8fe0e22",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6135b860-ad43-4a0d-be1a-170a171edbb1",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a7f8259-0a17-4559-8cc8-98eb1e3f369e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abadf5a8-af41-40c2-9294-d5612424719e",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60acb33b-ae0c-46d0-931f-bbcf1985fe4d",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8dcd4f04-b546-4404-9af3-93fffd8bd7e3",
                                "id": "trader_status",
                                "name": "trader_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8f095c5-e51b-416c-b87b-84fc791d96c2",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c219aa99-a4b9-408a-874a-dfa812cf8c1a",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "96d9b060-0e90-4ebc-b2a6-4d0f6bdf2069",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89dc5d5e-964e-43d7-adc4-656b7e7f93ee",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3b524c5-b326-4e16-9230-f82c24d14441",
                                "id": "days_from_last_deposit",
                                "name": "days_from_last_deposit",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c18713ef-db44-435d-bbbc-44697a486992",
                                "id": "min_active_day",
                                "name": "min_active_day",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5056a661-45eb-41a5-883e-3bec77232eb0",
                                "id": "is_active",
                                "name": "is_active",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0aeeb9b6-9a00-4236-a9fb-be6d0910521b",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dcd8098b-c393-4dc8-8e4d-48d238c0de9c",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0f8f8742-6ec4-4bd2-a583-d89fbaef3ce4",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be1d8fdb-fc48-4cfb-975e-eda4b42c219a",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a31db406-e484-4703-9bdc-62edddc862dd",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d411e560-7837-4e7e-879a-964ecf02327b",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9930310-150e-4c73-81ef-c33314cf1046",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e4b1eeb6-9361-4dae-a9db-90cbaf7140b8",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d35fe164-ff46-41b5-bdf0-f7b1c061b41c",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b626e5cf-28bd-4f94-8241-63b04af3bb83",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cfea616-9a24-4517-a2bb-dcc196a2bbbc",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "730cbd64-5991-4853-95f7-6be6d6515d02",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37b346ad-952b-4618-bb60-6bdd226d3fa2",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1b0cf239-6043-4c07-8f86-c5076a18cc09",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4fee0c55-d9ff-4c1c-9215-e73f9ae02d66",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "21dadcef-2a74-4a71-ab6d-f507f3a203dd",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0792703f-6ca6-42f2-b907-a5f6cca6cb8f",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16ae8a46-5af2-429e-a3f9-c991e3691621",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f22d1e58-bef7-4124-a070-1214d0f5cc09",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db91c9b8-9c56-4cd3-a94e-8bdb68b1c56a",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "76ff0807-d9b3-4196-919e-54689e27e10e",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4b78adb9-7a0c-4058-b449-514ad8f54d49",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50f6372b-20dd-451c-9405-1e300f4adb01",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "60acb33b-ae0c-46d0-931f-bbcf1985fe4d",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "658532e9-c6b4-4950-b744-d9227d9a51c6",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\tCOALESCE(trader_marketing_data.utm_sub_aff_id,\r\n\t\t'Null') as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\ttrader_status.name as trader_status,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\tdates.days_from_last_deposit,\r\n\t\tcase\r\n\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\telse dates.days_from_last_deposit end as min_active_day,\r\n\t\t\tcase\r\n\t\t\t\twhen\r\n\t\t\t\t(case\r\n\t\t\t\t\twhen dates.days_from_last_deposit >= dates.days_from_last_position then dates.days_from_last_position\r\n\t\t\t\t\telse dates.days_from_last_deposit end) <= 30 then 1\r\n\t\t\t\telse 0 end as is_active,\r\n\t\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\t\tdates.last_call_date,\r\n\t\t\t\tdates.last_effective_call_date,\r\n\t\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\t\tdatediff(current_date(),\r\n\t\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t\t'null') as employee_incharge,\r\n\t\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t\t'null') as team_incharge,\r\n\t\t\t\tCOALESCE(employees.department,\r\n\t\t\t\t'null') as department_incharge,\r\n\t\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t\t'null') as group_incharge,\r\n\t\t\t\tassignments.assignment_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t\t'null') as full_name_assign,\r\n\t\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t\t'null') as team_name_assign,\r\n\t\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t\t'null') as group_name_assign,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\t\telse 0 end as is_split,\r\n\t\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen country.name in ('Switzerland',\r\n\t\t\t\t\t\t'Germany',\r\n\t\t\t\t\t\t'Austria') then 'Germany'\r\n\t\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen country.id in (14,\r\n\t\t\t\t\t\t\t86,\r\n\t\t\t\t\t\t\t225) then 2\r\n\t\t\t\t\t\t\telse 1 end as locale_group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\t\tleft join trader_status on\r\n\t\t\t\t\t\t\ttrader_status.id = trader.trader_status_id\r\n\t\t\t\t\t\tinner join brand on\r\n\tbrand.id = trader.brand_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_name.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_name on\r\n\t\t\t\t\t\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\t\tc.id = d.id\r\n\t\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tb.id = d.id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\t\tg.id =\r\n\t\t\t\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\t\t\t\twhen e.parent_id is null then e.id\r\n\t\t\t\t\t\t\t\t\t\telse e.parent_id end)\r\n\t\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t\t`user`.id = user_groups.id\r\n\t\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4\r\n\t\t\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 5\r\n\t\t\t\t\t\t\t\t\t\t\twhen `group`.type_id = 4 then 6\r\n\t\t\t\t\t\t\t\t\t\t\telse `group`.type_id end = 6\r\n\t\t\t\t\t\t\t\t\t\t\tand COALESCE(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t0) not in (24,32)\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6194d5416780f2002c37e9ee",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fed1ae1f-3d41-4298-bf60-cf9ea1b8afb6",
            "fullname": "MySql:16aa7660-f08d-49d0-a6f4-4b6b7669f7a2",
            "type": "extract",
            "name": "16aa7660-f08d-49d0-a6f4-4b6b7669f7a2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a347bc31-7982-4a98-a575-7a998a685149",
                        "id": "tq_2cl5gDLJh",
                        "name": "TheBPCA_eom_open_pnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b7e27c54-e68a-4673-ab8d-dc20e5eddd1c",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69a3d9c6-cc45-47cc-90a1-b138b87cf55f",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e79791d2-6258-40d4-be0e-d2d9694f6f5d",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "196c0db5-3c00-4947-84c1-1ab64f0b1bfb",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a92ac37-6dde-403b-82a5-7367244b7cd9",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17de669c-fc14-4df8-ad2d-1423e1fc2421",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e1a6165d-9880-4780-aff3-22fb5d8264fb",
                        "configOptions": {
                            "importQuery": "select\r\n\t`date`,\r\n\tYEAR(`date`) * 10000 + month(`date`) * 100 + day(`date`) as date_key,\r\n\tcode,\r\n\tsite_id,\r\n\temployee_key,\r\n\topen_pnl\r\nfrom\r\n\t(\r\n\tselect\r\n\t\topen_pnl_per_day.*,\r\n\t\tcase\r\n\t\t\twhen `date` = date_format(now() - interval 1 day, '%Y-%m-%d') then `date`\r\n\t\t\telse last_day(`date`) end as eom_date\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\t`date` - interval 1 day as 'date',\r\n\t\t\t\tc.code,\r\n\t\t\t\tcast(1000 + d.brand_id as char) as site_id,\r\n\t\t\t\tconcat(1000 + d.brand_id, 10000, d.user_id) as employee_key,\r\n\t\t\t\tsum(open_pnl) as open_pnl\r\n\t\t\tfrom\r\n\t\t\t\topen_pnl_daily a\r\n\t\t\tinner join trader_account b on\r\n\t\t\t\ta.trader_id = b.trader_id\r\n\t\t\tinner join currency c on\r\n\t\t\t\tb.currency_id = c.id\r\n\t\t\tinner join trader d on\r\n\t\t\t\ta.trader_id = d.id\r\n\t\t\tgroup by\r\n\t\t\t\t1,\r\n\t\t\t\t2,\r\n\t\t\t\t3,\r\n\t\t\t\t4) open_pnl_per_day) eom_pnl\r\nwhere\r\n\t`date` = eom_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61190cd58a56da002c368e93",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oSBHqROSJqfbavRql9qKiSLEmwl7IhJ9c6fsHLIM0OwCRHrJNGuAkZHFejMZg4JRw0O3fODsXnYpi2hUBhBsbmkJv6Fp6AFNzUCzYUMwbHmTHLlXM9s4v79bGMK/5v8OLM1d6GkztCEoQnoKHxxgdL5bqbfcU8jEEZ4JlNgR8Mv",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        }
    ]
}