{
    "title": "Voicespin",
    "type": "extract",
    "buildDestination": {
        "destination": "elasticube"
    },
    "fiscal": "system",
    "relations": [
        {
            "type": null,
            "columns": [
                {
                    "dataset": "178958f8-5fdd-4d41-a7d1-1a1b2bc5ccb8",
                    "table": "ea3e36bd-c86b-4e5b-81dc-2bf4192e0506",
                    "column": "0c241b6a-af15-4a6f-a844-e4d4346bae38"
                },
                {
                    "dataset": "c8b10810-8253-46f6-aad8-ceaacf7cc82c",
                    "table": "0435350e-1328-4a44-a3d4-5eb208434e12",
                    "column": "08cca90d-b317-4dfc-8dad-c5aaaaee2d73"
                },
                {
                    "dataset": "ff9604a9-1a62-42d3-8737-0a8f03954481",
                    "table": "59ab80eb-bdc3-460a-9649-8f9e3b87e790",
                    "column": "72c48509-cd73-4ec1-a612-0dad49eeff1c"
                },
                {
                    "dataset": "072d8253-3767-42cc-9ca5-f7e7aabaaeef",
                    "table": "10f1df33-4727-44cf-a123-94d68c680654",
                    "column": "1cf5347c-de69-4fbe-82a2-2f93606a0890"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "3e9e4f76-cb4d-4410-afd3-f81391b705c6",
                    "table": "1054ad6d-f5c6-4ec3-8a69-023d3db5b0c1",
                    "column": "1a293dbb-3e0b-435f-8ac2-31fb27c64dc1"
                },
                {
                    "dataset": "c8b10810-8253-46f6-aad8-ceaacf7cc82c",
                    "table": "0435350e-1328-4a44-a3d4-5eb208434e12",
                    "column": "051c6b8c-55a1-48c4-9184-1b7e51fe1180"
                },
                {
                    "dataset": "072d8253-3767-42cc-9ca5-f7e7aabaaeef",
                    "table": "10f1df33-4727-44cf-a123-94d68c680654",
                    "column": "241e847f-b1de-4d0b-a77e-7023eba6fe1d"
                },
                {
                    "dataset": "ff9604a9-1a62-42d3-8737-0a8f03954481",
                    "table": "59ab80eb-bdc3-460a-9649-8f9e3b87e790",
                    "column": "9503a5cd-0c78-4d0a-9daa-1f37be49044f"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "cfeef8d1-132e-405e-beba-9d5f43a5e9cc",
                    "table": "0c0d2e66-45a1-48e2-9deb-e15cd7005a56",
                    "column": "2a09dc8b-1c10-4976-a2a9-13d73f63e525"
                },
                {
                    "dataset": "c8b10810-8253-46f6-aad8-ceaacf7cc82c",
                    "table": "0435350e-1328-4a44-a3d4-5eb208434e12",
                    "column": "b51c02c0-c9e9-440e-9cf1-2757f4b653ac"
                },
                {
                    "dataset": "ff9604a9-1a62-42d3-8737-0a8f03954481",
                    "table": "59ab80eb-bdc3-460a-9649-8f9e3b87e790",
                    "column": "31d5332f-e268-4ba4-a02e-875862335843"
                },
                {
                    "dataset": "072d8253-3767-42cc-9ca5-f7e7aabaaeef",
                    "table": "10f1df33-4727-44cf-a123-94d68c680654",
                    "column": "e00408fa-b19c-42e8-836c-92211cecf30a"
                }
            ]
        }
    ],
    "datasets": [
        {
            "oid": "018508fe-da50-4f71-b613-b29ff43e2ef9",
            "fullname": "MySql:ef6cdd3a-6062-4851-a91d-6205e069799b",
            "type": "extract",
            "name": "ef6cdd3a-6062-4851-a91d-6205e069799b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "15fdfaa8-efec-41e4-972a-1ea0bc2a8d22",
                        "id": "tq_RJmZQtcIp",
                        "name": "PrimeOTCustomers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9733f38d-3fc7-4dcc-8b22-c58e1dcc09ec",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11eddfb4-4b14-412e-b2d7-1ada6709aadf",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f379945-e48d-4fa2-875d-29898f707581",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7573f123-049b-4df6-972a-267314f4617a",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "026ed9e0-f016-47fb-96db-52fbf1ca01ef",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a48a75df-ab12-45ac-bf9b-ca0f0a0da1eb",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 40,
                                "precision": 40,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "65a04b11-beba-4a27-b225-3c210dc64277",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "75e140c1-9c46-4cbd-935c-f6890b392e36",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc140e62-ef21-43b9-b30e-ab8b6dea202d",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fc84d75-9807-47db-9068-3c11abf424cb",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bac796a0-1573-45da-91b3-ff5817b9acf7",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "510e5f75-0d64-4cad-9fd2-cff678e289f5",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e9dfbc71-e900-4db7-8e5c-ef9d0e67ec86",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "368daacd-fb77-4b56-abb5-f5c14f69cda6",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "07bf2eaf-cb02-4903-9194-a85abe504797",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d4f39a7-e85e-478e-bdf4-435f054589e0",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d387036-86bf-4195-b754-8d5d092a8bd0",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b6cbc978-9efd-4b16-b814-3db7d3015294",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a10da94d-b418-4af3-a5a1-cff8febda505",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30ad514a-512d-4af5-8bf3-42abdb8b2742",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e9230fa-e610-417f-b08e-cddc21a13471",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5c09aaf-1611-48b0-841f-1ac3b37ef478",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16a6241d-9e2a-49e0-a5dd-258631d35152",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9e554b7-27b3-4d13-806b-66f79591dfa3",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc7a1c12-42d0-4d3f-a617-babe7ff6b6e1",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "532c3314-a943-44a3-beb4-fb9f128295cc",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "86ff523c-9a9c-49ca-99b3-49866f21310f",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c01b2fee-0a2b-47c4-ba06-baadcbc0c3c4",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a618debf-7cd7-4e38-9d34-b108d4449a7a",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c4633ab3-579e-489f-bfc6-e50345a32f01",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bba8bc07-d6ce-42d1-8ceb-0204b8cb1f01",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b4018cd-6575-42ce-8b7a-d37f6acc50a5",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "90682405-9c48-4ef8-82eb-02f373dc1724",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b60576c-f1b9-4f3e-9eab-9fa2f050cbc7",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5808f087-cb89-41a1-9108-0910219ebba9",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a6c857d-e111-4795-a4ab-33e4652e534f",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1db73e1d-f2ea-4085-8da6-701ea5489cc9",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e6212599-b2cb-4769-990f-5d1666a7bb16",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5d12204-8204-4be6-8704-7b41a169ede8",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e64ad84d-8ddd-4025-ae8c-53c9f4e49b05",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30b59b08-3af9-43c6-bf71-5cb5b0c70ef4",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb6cbbc4-8253-434f-b6c8-5b0dd21ceb8c",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aef517e5-bbba-4832-9668-ad28b68a944b",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5a445d8c-b11b-4f24-9345-bf4e5eb5769e",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "79da5d50-3ebf-43d5-818c-1ad38737a2cd",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54fed57d-0713-4a2c-914b-23483fafb4de",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b76cbbb5-1aac-47ee-9c82-fe8d28e220f3",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb936ffe-341a-4a02-b32a-457b754cd61b",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f80da51d-d052-4008-b7f5-9925f705a8a4",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0621a0dd-9ddf-4a33-8a78-cb97a3fc108b",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "7573f123-049b-4df6-972a-267314f4617a",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "fc7a1c12-42d0-4d3f-a617-babe7ff6b6e1",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "66c5442b-2ad5-48c6-a224-c970c5b10abe",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\tCOALESCE(1000 + brand_id,\r\n\t1002) as site_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1002), '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1002), '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\ttrader.email,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader.created_at < 20190923\r\n\t\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\t\twhen trader.created_at >= 20190923\r\n\t\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\t\telse trader_marketing_data.utm_campaign end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\ttransaction_withdrawals.first_request_date,\r\n\t\tdates.last_call_date,\r\n\t\tdates.last_effective_call_date,\r\n\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\tdatediff(current_date(),\r\n\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\tdatediff(current_date(),\r\n\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\tCOALESCE(employees.full_name,\r\n\t\t'null') as employee_incharge,\r\n\t\tCOALESCE(employees.team_name,\r\n\t\t'null') as team_incharge,\r\n\t\tCOALESCE(employees.department,\r\n\t\t'null') as department_incharge,\r\n\t\tCOALESCE(employees.group_name,\r\n\t\t'null') as group_incharge,\r\n\t\tassignments.assignment_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\tDATEDIFF(assignments.assignment_date,\r\n\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t'null') as full_name_assign,\r\n\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t'null') as team_name_assign,\r\n\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t'null') as group_name_assign,\r\n\t\tcase\r\n\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\telse 0 end as is_split,\r\n\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t0) as is_1k_redepositor,\r\n\t\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,219) then 1 else 0 end as is_selfie\t\r\n\t\tfrom\r\n\t\t\ttrader\r\n\t\tleft join country on\r\n\t\t\ttrader.country_id = country.id\r\n\t\tleft join trader_marketing_data on\r\n\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record\r\n\t\t\tinner join transaction_deposit on\r\n\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\twhere\r\n\t\t\t\ttransaction_deposit.payment_provider_id not in (24,29,45,62)\r\n\t\t\tgroup by\r\n\t\t\t\t1 ) FTD on\r\n\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\tleft join (\r\n\t\t\tSELECT\r\n\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\tfrom\r\n\t\t\t\ttrader\r\n\t\t\tinner join trader_account on\r\n\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\tinner join transaction_record on\r\n\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\ttrader_id,\r\n\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\tfrom\r\n\t\t\t\t\ttrader_account_position\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) positions on\r\n\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`call`\r\n\t\t\t\tinner join `user` on\r\n\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\tleft join user_group on\r\n\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\tleft join `group` on\r\n\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\twhere\r\n\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) calls on\r\n\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\twhere\r\n\t\t\t\ttrader.is_test = 0\r\n\t\t\tgroup by\r\n\t\t\t\t1 ) dates on\r\n\t\t\tdates.customer_id = trader.id\r\n\t\tleft join kyc_status on\r\n\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\tleft join sale_status on\r\n\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\tleft join trader_account on\r\n\t\t\ttrader_account.id = trader.default_account_id\r\n\t\tleft join currency on\r\n\t\t\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\n\t\tleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,29,45,62)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t`group`.name as team_name,\r\n\t\t\t\tgroup_type.name as department,\r\n\t\t\t\tgroup_name.name as group_name\r\n\t\t\tfrom\r\n\t\t\t\t`user`\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\tuser_id,\r\n\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\tfrom\r\n\t\t\t\t\tuser_group\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) user_groups on\r\n\t\t\t\tuser_groups.user_id = `user`.id\r\n\t\t\tleft join `group` on\r\n\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\tleft join group_type on\r\n\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\tleft join `group` group_name on\r\n\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\temployees.employee_id = trader.user_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tc.id as customer_id,\r\n\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\tfrom\r\n\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\tleft join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\tc.id = d.user_id\r\n\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\tleft join `user` b on\r\n\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\tleft join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\tuser_group\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1) d on\r\n\t\t\t\t\tb.id = d.user_id\r\n\t\t\t\tleft join `group` e on\r\n\t\t\t\t\td.group_id = e.id\r\n\t\t\t\tleft join group_type f on\r\n\t\t\t\t\te.type_id = f.id\r\n\t\t\t\tleft join `group` g on\r\n\t\t\t\t\tg.id = e.parent_id\r\n\t\t\t\tinner join trader c on\r\n\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\tinner join trader_account on\r\n\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\twhere\r\n\t\t\t\t\t1 = 1\r\n\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\tand\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\tassignments.customer_id = trader.id\r\n\t\tleft join (\r\n\t\t\tSELECT\r\n\t\t\t\tredeposit.id,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\tinner join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t`user`.id = user_groups.user_id\r\n\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t0) not in (24,29,45,62)\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1) redeposit\r\n\t\t\t\tinner join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\tinner join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t`user`.id = user_groups.user_id\r\n\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\tredepositor.id = trader.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ttrader_id,\r\n\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_withdraw\r\n\t\t\tgroup by\r\n\t\t\t\t1) transaction_withdrawals on\r\n\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619512796780f2002c37ece0",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CLQO1pn40szcYNg2rZoiX1Vg29Vp5lwLqTDoBiPX74Z7tq4A1c99blLl+UTfHxXxv3fHMdNaD6ZQ0AYwLSELF3A=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "059ff120-d4b4-4c0e-b3e5-a7719b207194",
            "fullname": "MySql:9456081a-e248-43f4-a521-aec8dcea78ab",
            "type": "extract",
            "name": "9456081a-e248-43f4-a521-aec8dcea78ab",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "eeaed017-3bb9-49ee-9e25-9493a81d368b",
                        "id": "tq_8q6bb29Hg",
                        "name": "TheWealthCore_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "81899567-7432-476a-8a32-d973b0f7c5a7",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "629c58d3-2dfc-4e1d-bbd2-e3ebdb39ae4f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "94739423-3df1-4fc2-8f55-90ced580a4be",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbc6b7a9-ee03-4153-b242-c247b0df6caf",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e1fff6b-3619-4435-8797-cecde211f8bf",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27129d48-fab0-4cc8-b177-7b00f7bafa04",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20a384c6-49e8-405b-bf9c-78a439ed7611",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b053c58-fb35-486d-a191-0000db454ef5",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93d528c8-d036-4b7c-8d41-c364fbeb8fd6",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c6cc25b-133a-4b67-88e4-741ef91eadac",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e34a6450-94f2-4a07-b248-d7a2e0ceb1e1",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e4d825d-7e01-4dfd-966e-209ec28378e3",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c091dda7-a2ba-4f03-ad7d-2418e5462ca6",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1eb1ea2-bb88-4941-8219-f7fb8fcce7ea",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "87603570-e680-4047-ae50-aff3a2a8f158",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "aab72107-d231-4631-83e5-bb10b55f9a95",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195176ffd9249002de3c535",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "072d8253-3767-42cc-9ca5-f7e7aabaaeef",
            "fullname": "182c809d-5f24-4cbe-ad98-db384b0d5496",
            "type": "custom",
            "name": "182c809d-5f24-4cbe-ad98-db384b0d5496",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "10f1df33-4727-44cf-a123-94d68c680654",
                        "id": "Calls",
                        "name": "Calls",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "3a3c296c-6aac-4839-bc02-471a2f5af30d",
                            "expression": "select \r\ncalls.*, \r\ntobigint(getyear(calls.calldatetime) * 10000 + getmonth(calls.calldatetime) * 100 + getday(calls.calldatetime)) as calldatetime_key,\r\ntostring(employees.site_id) +'_'+ tostring(calls.agent_num) +'_'+ tostring(employees.employee_id) as ext_employee_key,\r\ncalls.site_name + '_10000_' + calls.accountcode as customer_key\r\nfrom\r\n(\r\nselect * from [Genius_Voicespin]\r\nunion all\r\nselect * from [FXVC_Calls]\r\nunion all\r\nselect * from [Arrow_BPCA_Bitfinity_Calls]\r\nunion all\r\nselect * from [InfinityCapitalg_Voicespin]\r\nunion all\r\nselect * from [Aussie_Calls]\r\nunion all\r\nselect * from [York_Calls]\r\nunion all\r\nselect * from [Prime_Calls]\r\nunion all\r\nselect * from [IvyTrust_Calls]\r\nunion all\r\nselect * from [WinGroup_Voicespin]\r\nunion all\r\nselect * from [Wealth_Voicespin]\r\nunion all\r\nselect * from [Ashford_Voicespin]\r\n) calls\r\nleft join employees on calls.agent_num = employees.extension_number and employees.site_name = calls.site_name"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "da12416d-dc6f-479e-a515-3bb895ed3c6e",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96579190-b0e0-48fc-802b-3040c7ca333c",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "31cc669f-642c-49f4-b959-7067cffb2a75",
                                "id": "9586a15d-1be3-4ae8-b3ad-a74a79c4a4e2",
                                "name": "waittime",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de291b9c-9753-47a7-b027-8b3c413dbc0f",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "338b81ca-ac1a-48cd-b905-d477383a8b46",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e649871a-d9b4-4baf-b451-19282b18c966",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9239f108-aea7-4f7b-a535-18840551101b",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1ac163a-2605-4113-958a-af6792b1013e",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93312c15-6f13-45a2-a767-4e05dc84a92b",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01822531-d1fd-45f6-8288-04f99ac20e66",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "085009e1-22de-4c1e-80e7-a20d07e6e028",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3184f008-0f5f-4d77-9278-dffc0c429ed7",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa61ef9b-6b14-4bd1-bb56-b1429e780278",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cf5347c-de69-4fbe-82a2-2f93606a0890",
                                "id": "calldatetime_key",
                                "name": "calldatetime_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e00408fa-b19c-42e8-836c-92211cecf30a",
                                "id": "9e0789af-7e47-4f18-bcec-a697bfe0f597",
                                "name": "ext_employee_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "241e847f-b1de-4d0b-a77e-7023eba6fe1d",
                                "id": "30df585a-e5cd-4215-890f-43a4c9580267",
                                "name": "customer_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "2a57e210-f78c-4465-a286-882e4b558481",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "0765b1f5-4098-4c53-9811-1a185d8f4758",
            "fullname": "MySql:ddc7b459-679f-4c93-b0aa-c15d0ed18740",
            "type": "extract",
            "name": "ddc7b459-679f-4c93-b0aa-c15d0ed18740",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b1a3741e-55d9-4409-b3c9-172f7f8c068a",
                        "id": "tq_5dMprOzR4",
                        "name": "BitfinityFX_Employees",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "aca18077-5aea-4e83-9d77-e82622463155",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7441eda9-9261-4401-b08d-b03ed5d46f48",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b20f8430-4ab5-48f9-8666-4cf648ccb95b",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6434161c-3c32-4607-bac1-0d5c1a747e61",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7f070f3-abfb-4825-8c3f-b96935415be0",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce1aaf5c-a714-48c8-bc57-80ee051b6506",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16460833-d20b-4d9a-b899-59ce0adbec28",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3359e369-b8f3-432a-8840-57aa638b00a7",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c453d44-8bc9-4026-8d31-7a8046a1e432",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08a776c0-32d6-4581-b54e-53e52e5d694d",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca92f9a2-f419-4ab1-b172-3b484c210645",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76b24bf5-7052-4a23-b4e8-9089cf83780a",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e3a98e4-28d9-4125-b68e-685889283cef",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb2ad29b-abe9-4f2b-ac2a-174849946e97",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ac291bc-47e3-4928-b4d2-db8200eec3ed",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "f97f6086-7918-4e60-b71c-b0dffe6b2ea6",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a4de3b356021002c50aac7",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8C2q0mVY+o2WF4+UVAyIhGiWhSY3+Y93kyI+zrKj2Bg5HiBiNB45Ta2GGPAsEoYp8/7dK0B1NeCzhErO6Xxg3c338i0MevnkC9Yi9QGlRnh1xn5Kjp5TuCxX28iusyU+paJ5wPXzkAPGHPDNhGasnoxvMsxipUWeTclTSatITjv9eQNNH4tFpXr1gskkcrIfglENUveS4Og+oLFLIuz1xQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "089b2a11-393b-4a68-8222-1bd4da59c166",
            "fullname": "MySql:4ec4c1e7-f5e6-4288-9fb3-89b2b7096e5c",
            "type": "extract",
            "name": "4ec4c1e7-f5e6-4288-9fb3-89b2b7096e5c",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1cac8d2f-3ef3-4366-9cbd-3f06a1cec07a",
                        "id": "tq_NElGsXLos",
                        "name": "TheBPCA_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "eafe9e3a-f4af-4832-a74f-7a627fc8eef0",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6586c1f2-cc21-41f6-a196-e64d960985ad",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac597674-eb4c-4fbf-9c07-9b8d6a271895",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "256cdfb8-c699-48f2-8bb0-db58816fde6c",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "025b2858-3d26-4c4b-817c-ee8ab34291e3",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78897d91-ccb7-49d1-b062-04ada864e1a9",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c71332ff-6631-40ec-aa10-f25e531c3695",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d505282f-8e52-471d-9cc7-78d4b3387ae3",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12a4cd86-c48e-4e5d-8e56-a2f373718fcc",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f901bc4-8ccc-4556-bd33-21dcff3f7ce8",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f860c7f-a26a-45cc-af7b-9318367405eb",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06e66d8b-fadf-4da6-8464-96156157c083",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47f13eb4-741f-49c5-9e9f-8a3ab543ff3d",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a26c7198-490d-46ac-935b-6a513a5b999a",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b6f2b57-69e6-4c12-a537-d479dd47f906",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "016aa31e-f8ed-40c2-872f-ed99825ec015",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195178bfd9249002de3c536",
                "provider": "MySql",
                "parameters": "Li2FpOBZkuQVFHmglvVO3unF3cyE7uQhXYenrn6ytNP08dPSNopcrZhCPhIEZbJq3GHeZmZNPZrQfHZy7Mo7S3QwZl+lJvy8mcXjoPWADHn7fHD/TXsGlpkaRPNOQnFO1tEd5xDHMHRh7i0mnvMheVsy39u8/PLd+UW23hnoTWzeGuy1jl1t9vmXt8xw1uh0Lw271DKaGVhOc5Lst9nqXnRu5pPfVPjIho4oBLMYdZDsXAdGAFkgsULvW5O9Ut8l",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "08c03916-f988-4f26-9ddf-c49e2ee1f307",
            "fullname": "e3a545e0-443e-47ab-95bd-c21fc98ba638",
            "type": "custom",
            "name": "e3a545e0-443e-47ab-95bd-c21fc98ba638",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "480867a6-e783-46c5-b7f3-de5cf60a48cb",
                        "id": "First_presale_call",
                        "name": "First_presale_call",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "589c51a5-353b-400d-a87c-e9c786b12562",
                            "expression": "select \ncustomer_key, min(calldatetime) as first_call\nfrom Calls\nwhere 1=1\nand site_name in ('FXVC')\nand agent_num in ('728','4014','886','894','4030')\ngroup by customer_key"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "7fd004b4-51a5-4963-8b23-3f9f7d143899",
                                "id": "e9f21d82-0af9-4fb3-810e-39d08fb40c9c",
                                "name": "customer_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6971a5f6-95a4-48e6-a46f-da01b5f1750c",
                                "id": "700ee526-0c07-4fe0-bc25-523912f2bdfe",
                                "name": "first_call",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "2657a029-0c23-465e-85ee-293322ef9a87",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "0bf56ca0-86b5-47d4-bf9b-aef4dad63595",
            "fullname": "MySql:30636b11-c1a4-4787-8425-70d685b9cf04",
            "type": "extract",
            "name": "30636b11-c1a4-4787-8425-70d685b9cf04",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a36252f3-832d-46d5-9644-2e18b06fd1f9",
                        "id": "tq_z1k140BFb",
                        "name": "FXVC_Calls_voicespin",
                        "type": "base",
                        "schemaName": "callcenter_11",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "16acd7ca-d74b-4aae-bb92-ae9bbbb1bf24",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d787994-2345-40cb-a462-172fdfcf790c",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3ba9c09f-9921-4adc-95d1-d149012e93e0",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d904edc-733f-4adc-805d-f28afe4a0994",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "26e05d65-deee-495b-b8c6-9a1f752b42b8",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53692c5f-d739-46d5-bb11-653d9fbed77f",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1dce851f-fb8c-4875-ae16-fc000b26e017",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d7bd3b2f-5d3c-421c-9879-eda602086ff7",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a378adde-9729-497e-ac90-4ee0901b6e93",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "03755e6a-062f-4135-b03f-1b2cb8d2c508",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc533cb0-9f35-4c4a-bd26-b0c640cb5cb6",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d322a985-a480-4ebf-a5a4-6e46143ba416",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-14T09:09:40.239Z",
                                        "oid": "6e477bf3-008c-443a-a58d-9f08c478ffff",
                                        "expression": "lookup([FXVC_Customers],[SiteName],[accountcode],[customer_id])"
                                    },
                                    "indexed": true,
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 65536,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "32f31a66-fd73-4757-9dc4-78252cf72077",
                                    "hidden": false
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "1c968126-2b30-4c1c-a160-45deebcd428a",
                        "configOptions": {
                            "importQuery": "select\r\n\tcall_id,\r\n\tcalldatetime,\r\n\twaittime,\r\n\tconv_duration,\r\n\tin_out,\r\n\tagent_num,\r\n\twork_sec,\r\n\taccountcode,\r\n\tcalldate,\r\n\tuniqueid,\r\n\tdst,\r\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\r\nfrom\r\n\tprisa\r\nwhere\r\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "ad1ce163-47db-4d05-94d7-6b2fca1683d5",
                        "id": "tq_sjfPTGji4",
                        "name": "FXVC_Agent_Stats_voicespin",
                        "type": "base",
                        "schemaName": "callcenter_11",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d9c97338-b31d-403f-a65f-2843b90627f9",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "973ed914-8774-4b9a-b7a0-96e9337e49d6",
                                "id": "calldatetime_key",
                                "name": "calldatetime_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a9d8cade-a18c-401e-a003-9a4ca2f613fe",
                                "id": "First_CallTime",
                                "name": "First_CallTime",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "637b68e0-a214-42df-b199-569a143d0631",
                                "id": "Last_CallEnd",
                                "name": "Last_CallEnd",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21364a1a-0da7-47fa-b3f6-893f6b8b3341",
                                "id": "Log_Time",
                                "name": "Log_Time",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95177056-ad15-4944-ab83-2f4adacd0b0b",
                                "id": "GrossPhoneTime",
                                "name": "GrossPhoneTime",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96e6dc37-4dfe-401f-bd42-792bcd630aad",
                                "id": "NetPhoneTime",
                                "name": "NetPhoneTime",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a55828b6-dc5f-4bc2-b617-1dd596595e97",
                                "id": "Idle_Time",
                                "name": "Idle_Time",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9e340af-aa85-43f3-a1f6-13c849f309ac",
                                "id": "Time_Active(Gross)",
                                "name": "Time_Active(Gross)",
                                "type": 18,
                                "size": 16,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6991a950-fdbe-43d4-99b3-6b8369fc8fa2",
                                "id": "Outgoing_Calls",
                                "name": "Outgoing_Calls",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fbaaedf7-dbb4-4e13-9ba2-63f743456bf9",
                                "id": "Successful_Calls_30s",
                                "name": "Successful_Calls_30s",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9fa1133-725d-4cea-b3e1-34a6a8951d02",
                                "id": "Successful_Calls_90s",
                                "name": "Successful_Calls_90s",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c4860652-7a09-4a4b-b732-d2e194402b79",
                                "id": "Success30s%",
                                "name": "Success30s%",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d766ff3-ae35-4aad-b429-59654a767d09",
                                "id": "Success90s%",
                                "name": "Success90s%",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3d4b194-c3ee-4d0f-b103-324cefa7d0f5",
                                "id": "Effective_Calls_3min",
                                "name": "Effective_Calls_3min",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e834bfb-e4f4-4e38-af5a-524d72afc997",
                                "id": "Effective_Calls_5min",
                                "name": "Effective_Calls_5min",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "16bd3a4e-2ca1-4c78-b7e3-deb315cb801e",
                                "id": "Effective_Calls_8.5min",
                                "name": "Effective_Calls_8.5min",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "36f23b2e-9860-44ea-b835-45c254f18ad4",
                                "id": "Effective5min%",
                                "name": "Effective5min%",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98fd1bb7-f4b7-43f8-9137-ca56ac2a347b",
                                "id": "Effective8.5min%",
                                "name": "Effective8.5min%",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d40e106-31c6-452d-aa3f-2d7e958c7450",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-14T09:09:40.239Z",
                                        "oid": "ea34a994-e56e-42ae-8d13-85e651515900",
                                        "expression": "lookup([FXVC_Customers],sitename,accountcode,customer_id)"
                                    },
                                    "indexed": true,
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 65536,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "1b037c56-f4ee-48cd-8fdf-b0e45dd8eba7",
                                    "hidden": false
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "5fe3622c-b710-4c9f-a612-253fcb600db7",
                        "configOptions": {
                            "importQuery": "select agent_num,\nyear(calldatetime)* 10000 + month(calldatetime)* 100 + day(calldatetime) as calldatetime_key,\ntime_format(min(calldatetime),'%H:%i:%s') as First_CallTime, time_format(max(end_time),'%H:%i:%s') as Last_CallEnd, \ntime_format(TIMEDIFF(max(end_time), min(calldatetime)),'%H:%i:%s') as Log_Time, \ntime_format(SEC_TO_TIME(sum(work_sec)),'%H:%i:%s') as GrossPhoneTime,\ntime_format(SEC_TO_TIME(sum(conv_duration)),'%H:%i:%s') as NetPhoneTime,\ntime_format(SEC_TO_TIME(time_to_sec(max(end_time)) - time_to_sec(min(calldatetime)) - sum(work_sec)),'%H:%i:%s') as Idle_Time,\nconcat(round(SEC_TO_TIME(sum(work_sec))/TIMEDIFF(max(end_time), min(calldatetime))*100,0),\"%\") \"Time_Active(Gross)\",\ncount(*) as Outgoing_Calls, \nsum(if(conv_duration >= 30, 1, 0)) as Successful_Calls_30s,\nsum(if(conv_duration >= 90, 1, 0)) as Successful_Calls_90s,\nconcat(floor(100*sum(if(conv_duration >= 30, 1, 0))/count(*)),\"%\") as \"Success30s%\",\nconcat(floor(100*sum(if(conv_duration >= 90, 1, 0))/count(*)),\"%\") as \"Success90s%\",\nsum(if(conv_duration >= 180, 1, 0)) as Effective_Calls_3min,\nsum(if(conv_duration >= 300, 1, 0)) as Effective_Calls_5min,\nsum(if(conv_duration >= 510, 1, 0)) as 'Effective_Calls_8.5min',\nconcat(floor(100*sum(if(conv_duration >= 300, 1, 0))/count(*)),\"%\") as \"Effective5min%\",\nconcat(floor(100*sum(if(conv_duration >= 510, 1, 0))/sum(if(conv_duration >= 90, 1, 0))),\"%\") as \"Effective8.5min%\",\nmax(accountcode) as accountcode\nFROM prisa\nwhere \nagent <> \"\"\nand in_out = 'OUT'\nand left(dst,5) <> 00972\nand calldatetime >= date_format(now() - interval 2 month,'%Y-%m-01')\ngroup by 1,2"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619e09ed9e2760002cba74a0",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLam5ZQW8ROk1Sm626dr9z//HXd9/Fn3t8RhwQLq+J6WR1uIE6UsW1S4Zi1ts0BFl9fqvWEWHDL+YT7+d8y6njg0Yp4mfBZNaVmQl2JYz8Fj4s8YM0b0NG6N99sHdZXGLs/zF+mWW539k9IlYI+CreT9JTUnWDQdcL/GEtpTkvT/pEBRJ7pXNDXg7MU8NgFCWlco1HuX8KvN7+G2R00NoHr+Cxt3iADHkxqwTC6EAubro",
                "schema": "callcenter_11",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0c87db2c-76ae-4aa2-be5d-86fd2ebc68b4",
            "fullname": "MySql:0021d8de-f88b-4972-849b-464218229f2a",
            "type": "extract",
            "name": "0021d8de-f88b-4972-849b-464218229f2a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9e5abfef-8db7-449b-81ef-57bb40c14482",
                        "id": "tq_sWEKud46A",
                        "name": "TheWealthCore_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0659b7f6-4699-43bf-9d92-43d085d27d2e",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "894ee236-463b-47a1-a456-901af7e472e8",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75ad8168-9ad3-4b2e-ab4b-1fda57f4b3f5",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "afc17772-73ea-4213-bd51-ef53ddbe2f3b",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3961c01a-bdd5-4e0e-acce-4e5a7aa87682",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "458a7128-c65e-464f-b1b9-c3d600ad5b71",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "231631d5-8773-4c1a-8245-dab3797f7b0b",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54ef87cc-847b-4435-a288-41bacc65cb35",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db1bb99e-a5cf-40b2-b3c6-26c0f0dc84dd",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71ef26c8-edc1-4714-bbab-b18bfee48e11",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b55d83be-f29c-4da4-8c48-a46ba94f00a7",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1eb0574-703a-45c1-a16c-873dd8b55271",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "25d7dc7c-732b-4b9e-8ed6-e6b0df422360",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "288efec6-ec14-47db-9e36-bc201119eb15",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4de93275-794e-461b-96e6-ba71cd8090ea",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9b091e7-232a-49c1-897d-ae48fa026fdc",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3455aad5-8ce0-4137-b65c-d9320b4edd5f",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "54169918-957f-48ed-9354-8892db57b3bc",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc3b62a3-bc65-4e35-88fe-1a6fe2a0991c",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6491415d-5934-46fd-bd7c-c83c5fb928ca",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d407520e-c3e2-4f2a-9d78-efdc04a8e40c",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "246a27f9-3398-4283-bfed-f1d99ec6d2b3",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9de226bb-52a6-4a9a-b9e5-7f682f03e222",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c2e9966-d8c2-4b6d-a160-3bcae14b4e4e",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56b69619-bc7e-4f39-86a9-54eeb50e8095",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b7291575-c869-4ede-876f-0e70ad9ffae3",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3e0b653-b70b-43ba-8c29-7c4bd5a05492",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0404b759-0173-4165-acb9-b34fa8509904",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c3bed69-99f0-4b16-b733-08b6e038536e",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e7e48269-b9eb-49c1-a684-eba4579d04f4",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5c454584-aa35-48d0-a344-6840bcc04700",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "95ba965a-384e-4ba5-a5ce-6b1bcd159b1c",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b60f377b-a361-4e1b-839c-2242b437a8bc",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d60778c8-a3d2-43a8-8f2d-1631d1421af9",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f49e829c-2077-416c-b933-282f158cbc48",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "26f16b1b-9a21-4da9-bc61-01a893d976dd",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3bf4cd2d-d1f6-4f32-8392-3130cc7c1448",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83a00332-9755-4e41-a836-e84a05e792b8",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53eab50c-ceb2-498d-8f23-14a9de666746",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ca66f4b-c689-4d8b-9c5d-abe004ccdb04",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b04b1a2d-a455-4dea-a119-6e7f77feeaed",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0538dd72-dcb7-4982-868c-a2b9b4f0bda7",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6614f923-225b-4f69-8361-a8355f16bacc",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a1af65cc-d133-4d26-b819-82fe71f8d6cf",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6d90155f-2863-4e88-b508-a749e2030702",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "afe11ab5-7c96-4f0f-940c-e9585fef4d26",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3187282d-25f9-4ab1-a0ac-98ccb79a4f6e",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff065fb7-3a88-41ed-afa8-179fffb60678",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "749d9f9e-a831-4788-bb32-46c2a92aef83",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d810f3d5-be5e-404a-9d39-7e2c5d336591",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "afc17772-73ea-4213-bd51-ef53ddbe2f3b",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "56b69619-bc7e-4f39-86a9-54eeb50e8095",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "3b7feecf-dad4-4902-8ebf-2670511ce2e5",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(1000 + brand_id, '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,251) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 109, 10009, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61951415fd9249002de3c51e",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0f1c8d16-3ae5-4235-ac88-60fac442c26d",
            "fullname": "MySql:ea81f887-99aa-4693-a6c4-50dc3f743315",
            "type": "extract",
            "name": "ea81f887-99aa-4693-a6c4-50dc3f743315",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "5c2b0a9f-6785-4c8c-a1e4-3cd40e5d76db",
                        "id": "tq_X3dvGua2e",
                        "name": "Aussie_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5bf6e37b-40ee-49e4-823a-a555b5b276cf",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "33c29cce-5ed8-49c6-baf0-12d5355e6d1b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f757c1aa-caef-44b1-b051-39fa766eee6c",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23f8f5e7-1e47-46eb-985a-9eb91ce556a9",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b43a76b-6dc4-4d80-bdff-3b34c64bc483",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e7fa826-3419-484e-8caf-1ca6263f1b2a",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "918911f0-e801-43ef-a87e-2d53bf1385df",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "201974d7-bff2-416e-8ccb-fd7a6e34f821",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "124d617a-1ade-4c91-9518-7ad1d05d51c7",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eee5195a-36cd-45e3-86da-a2f892e39627",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84d41de0-c307-4c91-8342-645683f6e823",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a28c007-e57b-4f3e-b8f5-849acdfa6028",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5c06d2f-1b8d-4538-880d-5fecc4e78e30",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6904ad32-8292-4f4e-8902-d87ed14e46f4",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0c6589b5-9993-4550-ac66-1f02967282dd",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "f6b38f64-3f51-444f-9912-71be70301bea",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61951738fd9249002de3c531",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "14e5b56c-9364-43e7-b722-6bafdfb1b740",
            "fullname": "MySql:b1d696d0-a60a-4ea6-b43c-6605eb70da7e",
            "type": "extract",
            "name": "b1d696d0-a60a-4ea6-b43c-6605eb70da7e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "451d77ae-8b8e-4026-b460-902dd3477b50",
                        "id": "tq_6uv3VDTIj",
                        "name": "WinGroup_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "42af8fe3-9cbf-4a45-be9c-1fd651d4b8b7",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4e63cba-4432-4d64-94f7-b8c4d5ed7df9",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3674e011-db97-4ba6-8917-720d7c33df85",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c07ddd92-906b-4dcd-8a48-d4f2cf5ed66e",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5214ed02-1bb9-4b8f-9f0f-f315657e93d9",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c11e4128-3597-4d69-8383-7779b9de9435",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab4876e4-0792-4512-88b9-f6f250740824",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9bfb73a-ac7a-4b0b-939e-88a4e39d93b6",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "369a819e-6c21-4133-aa31-f2f440aec769",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e5fc758-c9a2-4624-a26e-bef814f949fe",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "475da670-f5c7-4858-b518-5121254b0090",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5223b6b5-7457-4f5e-bc02-e52001edfd1e",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d89e732-df45-417c-be1f-57f19d8f52cc",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e89ec6a4-1ed2-4a6e-a498-4c22b97ceb21",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f29aa6d5-8039-47c5-84fb-83c2abd5b7fe",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "da5803ea-113d-405b-b208-4a36ad353328",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619517abfd9249002de3c537",
                "provider": "MySql",
                "parameters": "7niuYEzJZH44LaPxXSBFhgupfobVTnd8RwuqT0tnpje5KDJ7gduGgbtju1DOzrlHXyxYXX725adKvwo0Axykr60D4z1b1mw8WsApMJ7rY2LFOgeJZlZLv5SSECUKR37mBafSjAQv9xX/iReS54jxrRpjqt9TPCFGToA1IaapWsmrdViPoMfSyvvjgaK/3p6BzDNuzHzWZBteGVhZyUQHKDDoHtfKTScd/BFbaKhGoQOqfvtLuYR5XwGPk9gdwJzB",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "178958f8-5fdd-4d41-a7d1-1a1b2bc5ccb8",
            "fullname": "MySql:22103350-3790-4a7a-a40a-9f913d9efd98",
            "type": "extract",
            "name": "22103350-3790-4a7a-a40a-9f913d9efd98",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0de019da-92bc-41a1-8031-956bba4289da",
                        "id": "tq_0T8m81Dhm",
                        "name": "dw_parameters_campaign_type",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f3db7c9d-2774-41cb-b5f7-3b589ed03673",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee66e68e-5d96-4c7c-b11e-a1667fb9d41a",
                                "id": "param_id",
                                "name": "param_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "98b287db-7a48-49a2-964f-42b529c4c2b0",
                                "id": "param_name",
                                "name": "param_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00b4d2f2-1677-414b-a9a6-495e01342cad",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a5836388-8777-48b5-98fc-4a95c6cb77fb",
                                "id": "subject_int",
                                "name": "subject_int",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4df3d529-e41d-4a3f-9cd9-1aaaf1586ad3",
                                "id": "subject_string",
                                "name": "subject_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34510d9e-f253-4219-9c09-59af16572f8b",
                                "id": "value_int",
                                "name": "value_int",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "84e1a59f-290f-4422-913b-b3d8cef88b2a",
                                "id": "value_string",
                                "name": "value_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c6f3967-ca61-4427-a909-77fa179a0bb7",
                                "id": "additional_value_string",
                                "name": "additional_value_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67f948e6-3d20-43c6-ad09-b3e9c06aa907",
                                "id": "last_update",
                                "name": "last_update",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "1a3993a8-deff-439d-9c89-614381993be2",
                        "configOptions": {
                            "importQuery": "select * from dw_parameters where param_id = 3 "
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "4f65d4f3-f2a3-4142-b5e1-4c1fce01bab3",
                        "id": "tq_fAl3VPYlD",
                        "name": "dw_parameters_campaigns",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "be50728b-62f5-4af3-a893-535a69ce62ca",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05f8c29d-b4c6-4997-b467-13ec7c7d3702",
                                "id": "param_id",
                                "name": "param_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c0faef02-f661-400b-a0b3-4f78ce74244c",
                                "id": "param_name",
                                "name": "param_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e3e4e6c-a147-4fbd-83d6-236bb943d94c",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "00ea5710-c4cb-46d1-894d-d10ae6fdd038",
                                "id": "subject_int",
                                "name": "subject_int",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "81c0a284-fb18-4c69-9f96-518a054d6049",
                                "id": "subject_string",
                                "name": "subject_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a86fc77-b82f-49d2-9d67-04773ab2c108",
                                "id": "value_int",
                                "name": "value_int",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1288666b-cc3f-461d-bc1c-4ccbb0282aac",
                                "id": "value_string",
                                "name": "value_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8d57794-f92c-499b-b598-2ae2885561e7",
                                "id": "additional_value_string",
                                "name": "additional_value_string",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6de0dc5a-65c9-433f-a4f2-687e33731c27",
                                "id": "last_update",
                                "name": "last_update",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "5e6b982f-5c41-4591-ba9b-efa7e30ee551",
                        "configOptions": {
                            "importQuery": "select * from dw_parameters where param_id = 2"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "ea3e36bd-c86b-4e5b-81dc-2bf4192e0506",
                        "id": "tq_A6X9x0NlT",
                        "name": "DW_DimDate",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0c241b6a-af15-4a6f-a844-e4d4346bae38",
                                "id": "DateKey",
                                "name": "DateKey",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bbf36bfc-38b3-44d5-97ab-fd6b7673247f",
                                "id": "Full_Date",
                                "name": "Full_Date",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88733fcd-b734-41f2-aadc-003b9eba8524",
                                "id": "FullDateTime",
                                "name": "FullDateTime",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01166092-687d-4854-9a7e-4bcef9d5efed",
                                "id": "Date_Name",
                                "name": "Date_Name",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e9fcd30-bc3b-4539-83bb-4521749ad49a",
                                "id": "Date_Name_Us",
                                "name": "Date_Name_Us",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "630a8cb7-5909-4d5d-8461-925daacfcc7e",
                                "id": "Date_Name_Eu",
                                "name": "Date_Name_Eu",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8fe5524-7600-4128-9559-cd8deb3b3576",
                                "id": "Day_Of_Week",
                                "name": "Day_Of_Week",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1728c8f-15ab-4a6e-82fb-ab374eba196e",
                                "id": "Day_Name_Of_Week",
                                "name": "Day_Name_Of_Week",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0fba88f3-fc84-4d3d-8bdf-321b2aa4c774",
                                "id": "Day_Of_Month",
                                "name": "Day_Of_Month",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d7d0e08e-6487-411a-a02d-41fd594a2753",
                                "id": "Day_Of_Year",
                                "name": "Day_Of_Year",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cfb29335-2a3e-4047-bcd7-488f1d9f4f09",
                                "id": "year_day",
                                "name": "year_day",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fefb1cec-18c9-4dd7-a5b6-6cb32b7a9297",
                                "id": "Weekday_Weekend",
                                "name": "Weekday_Weekend",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0aa4655-991b-4b63-868d-6a9879802be8",
                                "id": "Week",
                                "name": "Week",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02a14f4e-32ed-4f7e-b5fc-0aa76d76d042",
                                "id": "Month_Name",
                                "name": "Month_Name",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22074b92-ee49-45e2-872a-10e3ba166032",
                                "id": "Month_Of_Year",
                                "name": "Month_Of_Year",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "13ff675f-417b-4ba4-8813-233b134f901a",
                                "id": "Is_Last_Day_Of_Month",
                                "name": "Is_Last_Day_Of_Month",
                                "type": 18,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba24e38a-c242-459f-9bb7-178a9f6ffbba",
                                "id": "Calendar_Quarter",
                                "name": "Calendar_Quarter",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "17ed3120-0efb-427f-aeb4-6808483976cc",
                                "id": "Calendar_Year",
                                "name": "Calendar_Year",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d57f613e-7b1d-4093-80ac-ff4d958bea8d",
                                "id": "Calendar_Year_Month",
                                "name": "Calendar_Year_Month",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b5a95d4-7b40-44ee-9434-023e7c8282b3",
                                "id": "Calendar_Year_Qtr",
                                "name": "Calendar_Year_Qtr",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98c55e9a-2f0b-4b4b-93a2-0b7a64b04d72",
                                "id": "Fiscal_Month_Of_Year",
                                "name": "Fiscal_Month_Of_Year",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aef2722d-57bc-4478-8ad1-2a043a45e5d8",
                                "id": "Fiscal_Quarter",
                                "name": "Fiscal_Quarter",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f7b532f8-a930-44fb-880e-5e0015188b80",
                                "id": "Fiscal_Year",
                                "name": "Fiscal_Year",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a61e7174-ffd9-44a8-a7fa-aba1d19337bc",
                                "id": "Fiscal_Year_Month",
                                "name": "Fiscal_Year_Month",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9a47c15-1d95-4370-8750-b4f46c2fbb18",
                                "id": "Fiscal_Year_Qtr",
                                "name": "Fiscal_Year_Qtr",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5b16578-293e-425b-964c-5176210234d8",
                                "id": "Today_Ind",
                                "name": "Today_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "338aac18-b1e3-4d29-a788-221becaa47e6",
                                "id": "Yesterday_Ind",
                                "name": "Yesterday_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2c204139-fd0c-436e-8909-cc4da3fe2881",
                                "id": "This_Week_Ind",
                                "name": "This_Week_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bcdb5b2d-461b-4d57-a031-aaef50d793c1",
                                "id": "Last_Week_Ind",
                                "name": "Last_Week_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7aeab19a-c63e-42d7-a535-4f45e9eb1580",
                                "id": "Last7_Days_Ind",
                                "name": "Last7_Days_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6d6471b3-f913-493e-83f4-3e4beed7f337",
                                "id": "This_Month_Ind",
                                "name": "This_Month_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cfe3d7ff-1887-45bc-9d4e-7c1e910424bc",
                                "id": "Last_Month_Ind",
                                "name": "Last_Month_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "df7e7554-6cf7-48dc-9e8f-86b3ad9cd7a9",
                                "id": "Last_30_Days_Ind",
                                "name": "Last_30_Days_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "57a01b90-02db-4639-903c-6c17e3ed2485",
                                "id": "This_Year_Ind",
                                "name": "This_Year_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "78619bb3-dc95-49c7-b26e-250fad78b840",
                                "id": "Last_Year_Ind",
                                "name": "Last_Year_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9360cc7a-7bf5-4fde-a333-d4988a8d4ab9",
                                "id": "Last_Week_Equivalent_Period_Ind",
                                "name": "Last_Week_Equivalent_Period_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "80001c74-dc96-40a0-a90c-df92ba947908",
                                "id": "Last_Month_Equivalent_Period_Ind",
                                "name": "Last_Month_Equivalent_Period_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "847bae88-2a0f-4689-a658-b849d5c317ca",
                                "id": "Last_Year_Equivalent_Period_Ind",
                                "name": "Last_Year_Equivalent_Period_Ind",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "12213aa5-1e22-4b18-87db-75bcfb31ecb5",
                                "id": "Retention",
                                "name": "Retention",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "0c241b6a-af15-4a6f-a844-e4d4346bae38",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "152e49a6-0870-4045-9f48-9a74558acbb9",
                        "configOptions": {
                            "importQuery": "select * from dim_date"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6115b740d57b1e002c67123d",
                "provider": "MySql",
                "parameters": "vbzYfS4H8zKaaa63Q8eVyx36cxK7oYg+4Q5WunfT3zgdww2iSGhTLrUnq7V9U0erIOY0jNYmKt9GMi/AOy4uJor53Wy5pKADZZQU4IywmnjHaGH4fezFLpM4Qgb/nP5Qo2z3T75JjWg0asinZRH4nPIpWIWzjBZUhPLin/PXCjhJiUvrOtcx64Deeph0+EQDy1nQEeRpJE9+RWm+KH4ERg==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "1bef77c1-2ba6-4daf-9a91-601b8bd1c982",
            "fullname": "MySql:a52e3927-aa7c-48c8-993c-86d72ba4b07c",
            "type": "extract",
            "name": "a52e3927-aa7c-48c8-993c-86d72ba4b07c",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "78687a75-d50a-43fb-a941-a2f37e0b1b97",
                        "id": "tq_hxazIqZ0Z",
                        "name": "Aussie_Calls",
                        "type": "base",
                        "schemaName": "callcenter_11",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0b6f05b0-dcc3-4f12-86ae-de1fb14e6d06",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "585f7584-0410-4b0d-961c-25a115d2e848",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52ac48df-e6ab-4420-ac25-44036d9d5c6a",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee1dc475-645d-4cab-9db2-b6f0f3e43e2f",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17d237fe-c573-4a9d-9bda-b1a3deaa4e56",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2b358de-052b-4bcf-891e-11a089a3ee94",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a3a7a7d-6c38-463f-b1ec-09394c209473",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34a30e80-26f9-46d4-a2ae-bbb689277e44",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abe87591-0854-41b3-8a47-338a851f9bd7",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "746060ae-7d3d-40e3-8fed-0c6536817357",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69f1688b-0584-49d2-9604-4dac416d3ce2",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25280cba-cc7f-477a-be56-aa7218cecaa9",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-07-28T13:50:01.314Z",
                                        "oid": "e90bc8b0-5f5d-4a55-9668-200bb9adafb2",
                                        "expression": "lookup([Aussie_Customers],[SiteName],[accountcode],customer_id)"
                                    },
                                    "indexed": true,
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "00900de0-7d26-43c2-8d5c-f96596d36863",
                                    "hidden": false
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "186899cf-f456-48df-a826-f7bebab0d249",
                        "configOptions": {
                            "importQuery": "select call_id, calldatetime, waittime, conv_duration, in_out,agent_num, work_sec,accountcode, calldate, uniqueid, dst,TIME_FORMAT(SEC_TO_TIME(conv_duration),'%H:%i:%s') as call_time_duration\r\nfrom prisa \r\nwhere calldatetime >= date_format(now() - interval 2 month,'%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619b75b65d21c0002cc89b3a",
                "provider": "MySql",
                "parameters": "k02nnyjxpe0z7Xff+gRG0oN5j1BVyaaKZK4y+sakdzOlGHgxOrKQy/O4g8s5nM72W9GylrkWnZdutJpjPWKMPaoKcT7C+aI+Q49my8+167ed+OHwol9hU0Mf1UAmWyfSaf8go6DkGTiqlJXr6hQfRAcEf/EQgoll7G5n3LBDQ/HYBLb0dY2bjWRpArye1WWeQcHXTC4kPjGVICbAuXLow6pBSFmNIty32aJJEyQyyQqf2J8hqGvKrkPZVtdEu2Uo8iamhVX7/SzGBWXfdGhqG0XVEB6Uf9abDB0JAfFXkpg=",
                "schema": "callcenter_11",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2212d36c-3fed-4b4d-9424-681df25edc7d",
            "fullname": "MySql:f2d7e3d3-83f1-4d21-bbfe-52927e9d9c02",
            "type": "extract",
            "name": "f2d7e3d3-83f1-4d21-bbfe-52927e9d9c02",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "6a0a3b77-1453-4300-9610-6bfefff6e854",
                        "id": "tq_Z6oIdSPGk",
                        "name": "InfinityCapitalg_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f0a3cc4c-f5b5-44ad-894b-5d7673076b5c",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "29f7b74c-6aa3-4a6c-94ea-414fc5761145",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ecbdcb1f-714d-4de6-9c4f-6bea3656901b",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33069914-3988-4b36-8b9f-d556977681de",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7370d16-2c52-4f88-88a7-dcf30baf358f",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "158c964d-a865-4da7-9402-235df68c62ca",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8f5dea8-10d8-45ea-8c97-975363b42328",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd3c542b-c987-4e9d-a5d1-32391d1cd0c8",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c30376e-3552-4edb-a0c1-5224e0bc6c14",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47f93fdf-3bcb-4ca9-bd81-d30b69e769df",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a139d52d-8684-4fc2-8ea5-fbbf6b5d097e",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2042e0fc-0ce2-4407-8385-19674d61937b",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf5b66c5-7017-444e-8db3-cd4717679723",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c93bb38b-c00e-42ad-b23a-bdd98bbf7749",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2e37ab3-1d98-4538-aa38-8ba19e73e91a",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "f0f9a94e-6c6d-4045-90b1-882a502bf161",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195171efd9249002de3c530",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "22897b6f-1984-42f2-9c35-ac32ef84b193",
            "fullname": "MySql:1d7c60c2-39ef-4e19-90dd-c1b4c565e3ed",
            "type": "extract",
            "name": "1d7c60c2-39ef-4e19-90dd-c1b4c565e3ed",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8a4f49c5-cfa3-46d7-a9ec-f5cafc859a4b",
                        "id": "tq_l9geNXY1h",
                        "name": "YorkCustomers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "879694e6-e9f3-45fc-abb3-9dc239724322",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "595e5260-4fc2-49e4-9bad-4be5979fe1a1",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7f703654-4eea-4088-9386-8a3dc26cb107",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cb5c26c-45d7-4085-8628-3d6b81ea5e37",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b2c27820-61e1-4346-8b07-8c06c3b04ece",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f2da5743-67a7-4ee4-ae74-5e407f1dfe5d",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 40,
                                "precision": 40,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c937b1d-52f4-47c3-a6ec-3af64c730b5b",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4db6fbd5-367e-4e50-880e-0005350bb484",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5a47bcf-9f86-46bc-bdc7-0d4c66ef3317",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff497d5d-2d90-4e2d-851d-211fbda7e915",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f02cc14-6708-472b-b7dd-7b528158328a",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1ab794c-2932-4d9c-921c-09a1b0d53f30",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9abded38-4732-4f9e-b448-c3611ad8d2e6",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2ac14af-90fa-4c3b-b4b8-f51474be096b",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "573678fb-c09c-44e8-99d2-c53105fbbfb1",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4aef434-5235-4f5e-a889-52fb9900d066",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6bf3e054-a799-4113-90c1-db1f5e9734d2",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cddcc5ee-3c36-4e70-82d2-cb3830d8239d",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4541e5a6-03d1-412b-ba61-a682b455c2bd",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16b69f3d-8216-495a-bccb-87e24bed7469",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eab7d557-51c8-4fc6-8ec0-8dd52b34fb3a",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4d6d4e1-a09e-4d83-baea-ae1ee41656f6",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa329749-eea7-4cad-9928-645515d5316a",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cf2fd9d-b86e-45b1-ac7a-d1603956be59",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "004c5cea-e5e8-448f-a49d-d628df0fadb9",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "081c64bc-b6c5-45b5-b346-75da293aa522",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d03f84ff-e1c9-4644-9dee-508d31e07089",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6d026322-beab-4863-9aec-a0c8f10589c3",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be714521-454d-4124-9a6c-a48f8f8b4daa",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4f22f657-88ed-47cf-b9a3-1187a00f618a",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1f2d476a-c61a-4b45-97d5-f9f712c00280",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "502e02fd-2bd9-4905-ac2c-64f831b2dbd6",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8a5dd00f-f374-4168-bfd8-1e7f6b8ff884",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8154b932-0a45-4314-b506-f589fee1a4c7",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4c3dcc68-dcba-4222-83e1-3dafe20c1084",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14ff1fde-3337-4658-bc11-d87154ff36da",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14b0a677-5baa-4f0c-893e-4df0adce01df",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9bde03c-425e-4659-93c0-8a69ee56eac6",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8ffbece-820d-4fb8-a381-7b28ad3b25ca",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf6bd93e-0d11-4b86-a4fa-37ab5f6ea16d",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10f68a93-b310-4955-af8e-81d22c4ebfc4",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "109f6d6e-672c-4a58-9df4-10ef9be8f43e",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b47b2333-638c-43cc-94cd-dd8f0528f041",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b02f6d44-b9a7-4b78-b9f4-cf96e72f98fa",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4b4ec1d0-2c18-4ff4-87c3-5140e7f26ca1",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a48e4e0d-0ae8-4284-b587-d065f139b968",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a2b6743-fbcb-441d-98a4-a892bd138edf",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbc8d916-9d28-44cc-84d5-bc6fb3a784cd",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f2008002-292d-4227-9478-a642d00a061d",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3dc9ccb1-994c-445e-8ae2-5686e31426a3",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "8cb5c26c-45d7-4085-8628-3d6b81ea5e37",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "004c5cea-e5e8-448f-a49d-d628df0fadb9",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "5ff1df30-a2b5-4ad5-a1ef-25ec481e27b3",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\tCOALESCE(1000 + brand_id,\r\n\t1001) as site_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1001), '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1001), '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\ttrader.email,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader.created_at < 20190923\r\n\t\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\t\twhen trader.created_at >= 20190923\r\n\t\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\t\telse trader_marketing_data.utm_campaign end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\ttransaction_withdrawals.first_request_date,\r\n\t\tdates.last_call_date,\r\n\t\tdates.last_effective_call_date,\r\n\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\tdatediff(current_date(),\r\n\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\tdatediff(current_date(),\r\n\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\tCOALESCE(employees.full_name,\r\n\t\t'null') as employee_incharge,\r\n\t\tCOALESCE(employees.team_name,\r\n\t\t'null') as team_incharge,\r\n\t\tCOALESCE(employees.department,\r\n\t\t'null') as department_incharge,\r\n\t\tCOALESCE(employees.group_name,\r\n\t\t'null') as group_incharge,\r\n\t\tassignments.assignment_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\tDATEDIFF(assignments.assignment_date,\r\n\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t'null') as full_name_assign,\r\n\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t'null') as team_name_assign,\r\n\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t'null') as group_name_assign,\r\n\t\tcase\r\n\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\telse 0 end as is_split,\r\n\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t0) as is_1k_redepositor,\r\n\t\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,251) then 1 else 0 end as is_selfie\r\n\t\tfrom\r\n\t\t\ttrader\r\n\t\tleft join country on\r\n\t\t\ttrader.country_id = country.id\r\n\t\tleft join trader_marketing_data on\r\n\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record\r\n\t\t\tinner join transaction_deposit on\r\n\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\twhere\r\n\t\t\t\ttransaction_deposit.payment_provider_id not in (24,32,54,68,96,128)\r\n\t\t\tgroup by\r\n\t\t\t\t1 ) FTD on\r\n\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\tleft join (\r\n\t\t\tSELECT\r\n\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\tfrom\r\n\t\t\t\ttrader\r\n\t\t\tinner join trader_account on\r\n\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\tinner join transaction_record on\r\n\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\ttrader_id,\r\n\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\tfrom\r\n\t\t\t\t\ttrader_account_position\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) positions on\r\n\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`call`\r\n\t\t\t\tinner join `user` on\r\n\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\tleft join user_group on\r\n\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\tleft join `group` on\r\n\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\twhere\r\n\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) calls on\r\n\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\twhere\r\n\t\t\t\ttrader.is_test = 0\r\n\t\t\tgroup by\r\n\t\t\t\t1 ) dates on\r\n\t\t\tdates.customer_id = trader.id\r\n\t\tleft join kyc_status on\r\n\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\tleft join sale_status on\r\n\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\tleft join trader_account on\r\n\t\t\ttrader_account.id = trader.default_account_id\r\n\t\tleft join currency on\r\n\t\t\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\n\t\tleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32,54,68,96,128)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t`group`.name as team_name,\r\n\t\t\t\tgroup_type.name as department,\r\n\t\t\t\tgroup_name.name as group_name\r\n\t\t\tfrom\r\n\t\t\t\t`user`\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\tuser_id,\r\n\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\tfrom\r\n\t\t\t\t\tuser_group\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) user_groups on\r\n\t\t\t\tuser_groups.user_id = `user`.id\r\n\t\t\tleft join `group` on\r\n\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\tleft join group_type on\r\n\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\tleft join `group` group_name on\r\n\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\temployees.employee_id = trader.user_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tc.id as customer_id,\r\n\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\tfrom\r\n\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\tleft join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\tc.id = d.user_id\r\n\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\tand\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\tleft join `user` b on\r\n\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\tleft join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\tuser_group\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1) d on\r\n\t\t\t\t\tb.id = d.user_id\r\n\t\t\t\tleft join `group` e on\r\n\t\t\t\t\td.group_id = e.id\r\n\t\t\t\tleft join group_type f on\r\n\t\t\t\t\te.type_id = f.id\r\n\t\t\t\tleft join `group` g on\r\n\t\t\t\t\tg.id = e.parent_id\r\n\t\t\t\tinner join trader c on\r\n\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\tinner join trader_account on\r\n\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\twhere\r\n\t\t\t\t\t1 = 1\r\n\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\tand\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\tassignments.customer_id = trader.id\r\n\t\tleft join (\r\n\t\t\tSELECT\r\n\t\t\t\tredeposit.id,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\tinner join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t`user`.id = user_groups.user_id\r\n\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t0) not in (24,32,54,68,96,128)\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1) redeposit\r\n\t\t\t\tinner join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\tinner join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t`user`.id = user_groups.user_id\r\n\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\tredepositor.id = trader.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ttrader_id,\r\n\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_withdraw\r\n\t\t\tgroup by\r\n\t\t\t\t1) transaction_withdrawals on\r\n\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195120e6780f2002c37ecde",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiXsMSYsuAL/CbGN4aqsTqQK37h2jvswX7OUxbO5ncsXT5ZAQx6xX8RhjlXWOBl+OUE=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "257dec98-137d-4ccd-bb25-a74cef26fd38",
            "fullname": "MySql:6f6eab54-6a4a-481b-8d2e-0390e7694bda",
            "type": "extract",
            "name": "6f6eab54-6a4a-481b-8d2e-0390e7694bda",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "619b75a95d21c0002cc89b38",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLRHz5V1LANZdll5oxHlUI6FjMSm+f9vk9kScdNo548NC3qcRlB5eH3IqGLe16Z1seYScp1EZuDmkm9LO/MU3RDgN381uB2G3FNAlhmFbvuexmVo7ZAPS/w07g953hEfMH7vAgvQJItfw8e8PsT5svf0pjymoyDtZiymTIvmIa/8VLShoMdLqtm3FZ8wB2gN20QuROoeet9pH3quLd3S7xKw=",
                "schema": "callcenter_11",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2f7b7b03-0df0-4f1c-8f89-61a239646467",
            "fullname": "MySql:51297eae-260a-437f-8e34-472d42f3c58c",
            "type": "extract",
            "name": "51297eae-260a-437f-8e34-472d42f3c58c",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "bfa94baa-ebc4-473b-85cf-e1d49d6d70d4",
                        "id": "tq_JBLexghzf",
                        "name": "Genius_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c5bc0459-45a5-4fc9-a438-f943aee477ed",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73ca4528-ba5a-472e-97fb-3966b268e025",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6643db5-a3cf-4322-8a90-9dff84ef2882",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06e4f919-f42b-477a-9864-4aa948845190",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "821620ab-66f6-423f-8c6c-d110be225301",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f9242f2-6d8f-44cf-bba5-3581ce13f75a",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 40,
                                "precision": 40,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bacc8700-9b3e-4187-a290-7232cf66c9ce",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4118268-5519-4e2c-a174-5723d5c3f07a",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17a5992f-4b5e-42f3-b7ac-1c7c2c2aedc4",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbd4c52e-8776-4f7d-9bea-4d24a5d4b836",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d691d74-d7b7-4f30-b0ee-5f750ab33d95",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "994ccf4f-4598-4cfe-ba09-ff298fc0dde0",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac1fa29e-f5b5-49e3-80f9-d8638f919515",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d5eb864-6601-409d-a90e-dc81c9abfa05",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66923b46-692f-484e-ba27-c59b780956ee",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5bb5003b-1f40-4b04-b845-dcd9b1f433df",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4e20498-b550-43d0-b068-d8fda5dc8b7a",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "60892a70-ddfb-4c9b-a453-ee457fdf1f21",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a5a06d0e-7c4f-4336-aaae-731f4d9af78e",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3da7e89a-af94-4e88-b5fa-d23508dfb787",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3fe9641-ba06-43d7-8232-86d6809da928",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1b47401-3251-411b-bcd5-6f74a0da07b7",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bde2648b-e1a9-4651-9e40-0f499575c331",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0db15279-b214-44d7-8309-1c89b555a91f",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f8a3501-25d3-4e0a-96e5-870de6a1654e",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2268068-b9c9-4397-a815-f769b0da5f95",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6a80451-d4e9-4608-aeeb-81f62f466468",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d883995c-653a-4c8b-83be-51da18d963c7",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55024502-52a5-4af0-a6b6-a4eacedafdac",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b05fb19c-c99a-4c55-869a-9a18bb09e718",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1fd3657f-cab2-4523-86ed-103032c746c9",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94befa0a-19b3-4ee0-9be9-4fa70af8448a",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "581279f9-3925-4ca7-aabe-c45310c8633c",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ceeac00-f1eb-4c9e-ab20-3d057fd861e0",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c034fc5c-8ffd-4a31-bfb9-10ebce5291a0",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3251d621-b419-4b6f-8be4-cdb38cd50fac",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29119d18-cbc0-463b-8aaf-5468454daae6",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b321f7f-7024-4238-9f72-186b6cbb2335",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c0c054f-d1f4-49df-968b-72ea2cf88bf9",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0a87cd9-0796-4c05-a024-8c5194204a07",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bfe71a15-0e9a-433a-9fdb-1bf1958386ae",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8c16d4f-78dc-4c07-93e6-4cb963c20cf3",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14c0c155-670c-486a-a42e-02f285fd58e4",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffe160f6-b73a-4cc6-956a-c0b279df4db3",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d0a0f41-aa19-4198-bfa5-609948f7196c",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79a7e9db-7332-45bc-890c-a37de3daaa73",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ac41812-293a-43be-b2b7-08f4f964856b",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3373dd25-4691-46fa-a827-7079679ea9e0",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da733773-0d63-4af1-aded-b7b92729c64f",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f640c52-fe2c-4007-88a8-d8c61bd24d9f",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "06e4f919-f42b-477a-9864-4aa948845190",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "0f8a3501-25d3-4e0a-96e5-870de6a1654e",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "2f256f35-129e-4652-b6ab-9e0f5a5ae5a9",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\tCOALESCE(1000 + brand_id,\r\n\t1001) as site_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1001), '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1001), '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\ttrader.email,\r\n\t\tcountry.name as country_name,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader.created_at < 20190923\r\n\t\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\t\twhen trader.created_at >= 20190923\r\n\t\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\t\telse trader_marketing_data.utm_campaign end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\t'test' as account_type,\r\n\t\ttrader.lead_score,\r\n\t\tdates.last_deposit_date,\r\n\t\tdates.last_withdrawal_date,\r\n\t\tdates.last_position_date,\r\n\t\tdates.days_from_last_position,\r\n\t\ttransaction_withdrawals.first_request_date,\r\n\t\tdates.last_call_date,\r\n\t\tdates.last_effective_call_date,\r\n\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\tdatediff(current_date(),\r\n\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\tdatediff(current_date(),\r\n\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\tCOALESCE(employees.full_name,\r\n\t\t'null') as employee_incharge,\r\n\t\tCOALESCE(employees.team_name,\r\n\t\t'null') as team_incharge,\r\n\t\tCOALESCE(employees.department,\r\n\t\t'null') as department_incharge,\r\n\t\tCOALESCE(employees.group_name,\r\n\t\t'null') as group_incharge,\r\n\t\tassignments.assignment_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\tDATEDIFF(assignments.assignment_date,\r\n\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t'null') as full_name_assign,\r\n\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t'null') as team_name_assign,\r\n\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t'null') as group_name_assign,\r\n\t\tcase\r\n\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\telse 0 end as is_split,\r\n\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t0) as is_1k_redepositor,\r\n\t\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,251) then 1 else 0 end as is_selfie\r\n\t\tfrom\r\n\t\t\ttrader\r\n\t\tleft join country on\r\n\t\t\ttrader.country_id = country.id\r\n\t\tleft join trader_marketing_data on\r\n\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record\r\n\t\t\tinner join transaction_deposit on\r\n\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\twhere\r\n\t\t\t\ttransaction_deposit.payment_provider_id not in (24,32,70,78)\r\n\t\t\tgroup by\r\n\t\t\t\t1 ) FTD on\r\n\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\tleft join (\r\n\t\t\tSELECT\r\n\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\tfrom\r\n\t\t\t\ttrader\r\n\t\t\tinner join trader_account on\r\n\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\tinner join transaction_record on\r\n\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\ttrader_id,\r\n\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\tfrom\r\n\t\t\t\t\ttrader_account_position\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) positions on\r\n\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`call`\r\n\t\t\t\tinner join `user` on\r\n\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\tleft join user_group on\r\n\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\tleft join `group` on\r\n\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\twhere\r\n\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) calls on\r\n\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\twhere\r\n\t\t\t\ttrader.is_test = 0\r\n\t\t\tgroup by\r\n\t\t\t\t1 ) dates on\r\n\t\t\tdates.customer_id = trader.id\r\n\t\tleft join kyc_status on\r\n\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\tleft join sale_status on\r\n\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\tleft join trader_account on\r\n\t\t\ttrader_account.id = trader.default_account_id\r\n\t\tleft join currency on\r\n\t\t\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\n\t\tleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32,70,78)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t`group`.name as team_name,\r\n\t\t\t\tgroup_type.name as department,\r\n\t\t\t\tgroup_name.name as group_name\r\n\t\t\tfrom\r\n\t\t\t\t`user`\r\n\t\t\tleft join (\r\n\t\t\t\tselect\r\n\t\t\t\t\tuser_id,\r\n\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\tfrom\r\n\t\t\t\t\tuser_group\r\n\t\t\t\tgroup by\r\n\t\t\t\t\t1 ) user_groups on\r\n\t\t\t\tuser_groups.user_id = `user`.id\r\n\t\t\tleft join `group` on\r\n\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\tleft join group_type on\r\n\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\tleft join `group` group_name on\r\n\t\t\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\t\t\temployees.employee_id = trader.user_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tc.id as customer_id,\r\n\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\tfrom\r\n\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\tleft join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\tc.id = d.user_id\r\n\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\tand\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen f.name = 'Branch'\r\n\t\t\t\t\t\t\tand e.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\twhen f.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\telse f.name end = 'Retention'\r\n\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\tleft join `user` b on\r\n\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\tleft join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\tuser_group\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1) d on\r\n\t\t\t\t\tb.id = d.user_id\r\n\t\t\t\tleft join `group` e on\r\n\t\t\t\t\td.group_id = e.id\r\n\t\t\t\tleft join group_type f on\r\n\t\t\t\t\te.type_id = f.id\r\n\t\t\t\tleft join `group` g on\r\n\t\t\t\t\tg.id = e.parent_id\r\n\t\t\t\tinner join trader c on\r\n\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\tinner join trader_account on\r\n\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\twhere\r\n\t\t\t\t\t1 = 1\r\n\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\tand\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\tassignments.customer_id = trader.id\r\n\t\tleft join (\r\n\t\t\tSELECT\r\n\t\t\t\tredeposit.id,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\tfrom\r\n\t\t\t\t\t(\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\tinner join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t`user`.id = user_groups.user_id\r\n\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t0) not in (24,32,70,78)\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1) redeposit\r\n\t\t\t\tinner join (\r\n\t\t\t\t\tselect\r\n\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\tinner join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t`user`.id = user_groups.user_id\r\n\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\tredepositor.id = trader.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\ttrader_id,\r\n\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_withdraw\r\n\t\t\tgroup by\r\n\t\t\t\t1) transaction_withdrawals on\r\n\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619513f5fd9249002de3c51d",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCqSYW1fxIKnnsNg912qKxnkNYDWZ+cKc2+OkWR4TYeDqigQx2Gby0V+VIiWD8xSpNgDPteNtIjPQwF2M5JVHV3yvqczUgSrKzkSFvYE7o1nmx7tTUV6bpCu/O4DX4PS0SqEZssDUcXG1n8CtVH7jOf4wbMBe/zM2QWg0IpP004O",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "37b53659-484d-49b7-9711-46ce857f5430",
            "fullname": "MySql:115e345b-6f88-4b57-a9fa-565dc4d5eac2",
            "type": "extract",
            "name": "115e345b-6f88-4b57-a9fa-565dc4d5eac2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f276394e-cc6f-45bb-92c0-36b09e54839f",
                        "id": "tq_9xaaRcG9r",
                        "name": "YorkEmployees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6bd71347-9236-4b2b-9d52-35b332d52207",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2beb3775-10be-4182-9e5b-4762fd2dcc33",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 5,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3bed89a-f044-4810-adcb-3818a9c042b0",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "264bc1ef-65e5-4d8e-90c8-7933e930c4cc",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ef710da-0630-4a6c-a177-f6962bca0476",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71c34a1c-76d1-40a6-9855-c70f8b3e31c4",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be0d0cc8-3d0b-4fe5-ace6-5a69e39d38cb",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ae405d0-ff9a-46eb-8fcf-2f8031064aa0",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8428192e-fadc-435d-81fd-65c8affd872c",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79e0a9f4-6351-4243-8380-503f93a07d1f",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bc57f50-b3df-43e9-858b-24012244cecd",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2eb84dc2-0af1-4ffa-8e17-52b90e78869c",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74c16294-fa24-4ded-bd22-487b99f12d30",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b27e549-4f29-48dd-919d-1ce2006f6253",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9716b87-07dc-4921-9a7b-438710aedb40",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "cf0c3beb-4ffe-48d9-8a99-3ef7214b2eda",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tCOALESCE(\r\n\t\t1000 + brand.id,\r\n\t\t1001\r\n\t) as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat( COALESCE( 1000 + brand.id, 1001 ), '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (\r\n\t\tcase\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id\r\n\t\tend\r\n\t)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on\r\n\tuser_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1 = 1\r\nwhere\r\n\tuser_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195164cfd9249002de3c524",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiXsMSYsuAL/CbGN4aqsTqQK37h2jvswX7OUxbO5ncsXT5ZAQx6xX8RhjlXWOBl+OUE=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "38988875-10e3-4273-bbef-06919cbbf798",
            "fullname": "MySql:3dcdb182-2fec-4310-9563-372966b5bdc2",
            "type": "extract",
            "name": "3dcdb182-2fec-4310-9563-372966b5bdc2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "fe4f3600-91fa-4da8-be69-065933a1d324",
                        "id": "tq_uNFB2519e",
                        "name": "Genius_Voicespin",
                        "type": "base",
                        "schemaName": "callcenter_11",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8880f3e4-8792-4923-9d99-133d2620301a",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ad0bed6-b309-4f50-8257-84f0a1cdfc11",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1fb5c34-bdf6-4390-bef1-dcbf497b0894",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87424b66-0574-45c8-9751-f7d212ef0fe6",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "328af06e-eaca-4111-91a9-8fb02d9e55f3",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86a6f7a3-7a65-419b-a0a7-20b7e4bab8e5",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2fefe5cf-2e67-478e-b315-c86eaca53c80",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3669d8c-2c2c-45b9-8614-964f4e7cf2f2",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2efd075f-f96e-4956-9d3b-2ead21267bf4",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a2e804f-6419-4180-a74d-5efe5328fb30",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7df90be2-66d8-40aa-98de-234a59e8facb",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34ce3551-fbec-4232-85de-741b896b24b6",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 23,
                                    "size": 0,
                                    "scale": 0,
                                    "precision": 0,
                                    "lastUpdated": "2021-11-08T14:34:27.926Z",
                                    "oid": "0e6b88e7-e056-4c89-b2e3-8758646a0bac",
                                    "hidden": false,
                                    "indexed": true,
                                    "expression": {
                                        "lastUpdated": "2021-11-08T14:34:27.926Z",
                                        "oid": "161c140f-ff6f-4e05-a622-e460f51bd2e3",
                                        "expression": "NULL"
                                    }
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "b3b6b132-065f-4531-991c-f47a94a99626",
                        "configOptions": {
                            "importQuery": "select\r\n\tcall_id,\r\n\tcalldatetime,\r\n\twaittime,\r\n\tconv_duration,\r\n\tin_out,\r\n\tagent_num,\r\n\twork_sec,\r\n\taccountcode,\r\n\tcalldate,\r\n\tuniqueid,\r\n\tdst,\r\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\r\nfrom\r\n\tprisa\r\nwhere\r\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619b76315d21c0002cc89b3e",
                "provider": "MySql",
                "parameters": "Trf8OffZhHHN6PBlE3JR8UZushSDR+Z28GkOu7xyfLtx1ErTJ84P2EUqJAUf3JKCqWlmoqyWsqTVSF9dqsvmpgNZZr8N7pJiqf9p7mwYKRQyiKhPoBTMZHopabrU4vbEjt48EWlETzDdfTuyBJdhwuGkINABR/lelGlynliN1KLGDbRaOKOQWjcigQR6OcILjWWg4LN7OfA+hu1jsclCwMGi1BuyDNxL7d5qjP4Lrq4Rs8pQt80FqdN1BzAek3Soe0qm5VKrT8GWBeQwIEHfSw==",
                "schema": "callcenter_11",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3b176adf-31fc-429e-b6a9-78f30c13c302",
            "fullname": "MySql:8cee7997-0fdf-486e-9c0f-957c3a8e2213",
            "type": "extract",
            "name": "8cee7997-0fdf-486e-9c0f-957c3a8e2213",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d38ced43-687a-4290-a43e-90babf853bda",
                        "id": "tq_AMnkmeA1P",
                        "name": "Ashford_Voicespin",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5dc8b755-6044-4e30-b5d3-7b714a1f42f8",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b559cd4-21a4-4352-b938-8e96309b6bb5",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc6fda7f-4127-4cc6-96af-fe756c566feb",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1018b5d-d87e-4a75-871d-bc656a740e97",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa1175c5-464d-41ae-a3f2-4de970242cb7",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c38bd8fc-a64d-4776-92da-1a92ccfeb457",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d38d7cb5-79f4-41be-977a-136836990d76",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "add1e70c-3230-4b1e-9fbf-f95f101a5975",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7566f790-b24b-4e8d-a82a-7e611489308f",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0caa425-5eee-402d-b810-5f4924d504e9",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "766db74b-e4b8-494e-858b-50a8a85451ce",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37a97b3a-fcc1-4249-9539-94aaa1acd789",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "lastUpdated": "2021-11-30T09:44:05.022Z",
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "scale": 0,
                                    "precision": 0,
                                    "oid": "98c1ac1a-6de8-4b98-8e3b-47a2c50bcb93",
                                    "hidden": true,
                                    "indexed": true,
                                    "expression": {
                                        "lastUpdated": "2021-11-30T10:22:11.475Z",
                                        "oid": "ad6eaa50-56a3-4bd8-8d01-bb409ce6439c",
                                        "expression": "'Ashford Capital'"
                                    }
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "4d44942b-da9b-41ce-b1ad-97459ffd5ac9",
                        "configOptions": {
                            "importQuery": "select\r\n\tcall_id,\r\n\tcalldatetime,\r\n\twaittime,\r\n\tconv_duration,\r\n\tin_out,\r\n\tagent_num,\r\n\twork_sec,\r\n\taccountcode,\r\n\tcalldate,\r\n\tuniqueid,\r\n\tdst,\r\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\r\nfrom\r\n\tprisa\r\nwhere\r\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a5f247fa70ed002ca32bbf",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLTyt3+SbJTKqUpu36g0ffdJbQQ5ZvPWo+V0JNes6kp4OsgIW562SQ2LD6Y1g9bxyKEG9JedmtqZxwAD7HM/eszD335J0GwGG6xGkYuevx/icGtmYDXw7yu3CTs6HVVqk/tNSEtLbT2Gk/9f6lZDZta38FKZ3YOYuzrlUYsJ0s0F1D+MvnQHgubyDSJ6Sb6UUEtpg0jhjoOFelEQky6CH8bps7o9v413OS5qIXw8AyLsQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3e9e4f76-cb4d-4410-afd3-f81391b705c6",
            "fullname": "c05b1092-53d4-4876-bc44-27f8ac48f3cb",
            "type": "custom",
            "name": "c05b1092-53d4-4876-bc44-27f8ac48f3cb",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1054ad6d-f5c6-4ec3-8a69-023d3db5b0c1",
                        "id": "Customers (1)",
                        "name": "Customers",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "c1c3e230-61e1-436f-9e83-0a6e69c28ffe",
                            "expression": "select \r\ncustomers_join.*,\r\nfirst_presale_call.first_call,\r\ncoalesce(dim_campaigns.campaign_name,customers_join.campaign_sub_id) as campaign_name_new,\r\nDayDiff(first_presale_call.first_call,customers_join.firstdepositdate) as diff_from_first_presale_call,\r\nhourDiff(first_presale_call.first_call,customers_join.firstdepositdate) as hour_diff_from_first_presale_call,\r\nCustomer_Dwh.is_ftd_less_than_10usd,\r\ndim_campaigns.*\r\nfrom\r\n(\r\nselect \r\ncustomers.*,\r\n0 as customers_join,\r\nSiteName + '_10000_' + customer_id as customer_key_join\r\nfrom (\r\nselect PrimeOTCustomers.*\r\nfrom [PrimeOTCustomers]\r\nunion all\r\nselect [IvyTrusts_Customers].*\r\nfrom [IvyTrusts_Customers]\r\nunion all \r\nselect [FXVC_Customers].*\r\nfrom [FXVC_Customers]\r\nunion all \r\nselect [TheWealthCore_Customers].*\r\nfrom [TheWealthCore_Customers]\r\nunion all \r\nselect [Arrowteks_Customers].*\r\nfrom [Arrowteks_Customers]\r\nunion all \r\nselect [Aussie_Customers].*\r\nfrom [Aussie_Customers]\r\nunion all \r\nselect [YorkCustomers].*\r\nfrom [YorkCustomers]\r\nunion all \r\nselect [Genius_Customers].*\r\nfrom [Genius_Customers]\r\nunion all \r\nselect [InfinityCapitalg_Customers].*\r\nfrom [InfinityCapitalg_Customers]\r\nunion all \r\nselect [TheBPCA_Customers].*\r\nfrom [TheBPCA_Customers]\r\nunion all \r\nselect [WinGroup_Customers].*\r\nfrom [WinGroup_Customers]\r\nunion all \r\nselect [BitfinityFX_Customers].*\r\nfrom [BitfinityFX_Customers]\r\nunion all \r\nselect [NostraCapital_Customers].*\r\nfrom [NostraCapital_Customers]\r\nunion all \r\nselect [Ashford_Customers].*\r\nfrom [Ashford_Customers]\r\n) customers\r\n) customers_join\r\nleft join first_presale_call on first_presale_call.customer_key = customers_join.customer_key_join\r\nleft join dim_campaigns on dim_campaigns.campaign_sub_id = customers_join.campaign_sub_id\r\nleft join Customer_Dwh on customers_join.customer_id = Customer_Dwh.customer_id and customers_join.site_id = Customer_Dwh.site_id"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0ee199bf-f82e-45ee-a19b-2b448f4a3948",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72f42684-c24f-4bd9-a2d7-c48b738cca52",
                                "id": "dac0f4a7-3ee5-474c-9bc1-bb311156b71e",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45eb1f7b-bdf3-4650-9936-26617c475678",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f178eac-0b04-4c5c-892f-78783462f19d",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ea9f3d7-ec61-49aa-b838-d458ac6f1be6",
                                "id": "21ef2702-62d7-4943-a973-4b606e433bb2",
                                "name": "hash_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b93b03c6-caa5-4bbe-9153-65379bc77c04",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ee278ba-19f0-4e94-9288-b4123210f6ad",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd501c0b-d54b-4085-8a20-077df7463ad6",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8b362bb-4ce7-471b-bfa1-ebfa737e679d",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7d6bccf-ed85-426d-b50f-e989ff2987b2",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2dd624c5-5402-4d6c-ab41-475d65a12f2f",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0f0bd5e9-2630-4aa4-9676-10c38fe9ea9c",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d5d401df-5523-4e0e-9d62-4e22ff447ff7",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "341a7b12-146d-496f-aa13-ee84e87e543b",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bb88855e-b21d-4a66-8398-71919eff222f",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7243804c-5070-4595-89da-136f8e864eee",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d501837-eaa3-4f4e-b2e1-d40cce08ee85",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9213fdf-66fb-4d4c-b9ba-97c03968124f",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d24d1e61-e810-4f86-aea3-53d249651452",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa1c9cb1-08c4-4dbf-bb78-60806513a5f7",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb39dbb8-1b5f-488d-bc76-e1b3030fcf9a",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cefe4bce-11e9-4990-9cc7-7011f6342476",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2654ebb-69f4-45bd-90b0-8b6e3484922b",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "969486b8-37c0-49b5-809a-d1b9ed3ca8fd",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44817d28-9a87-4490-a91b-2d51384a7dd3",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c2d6e303-2efd-440f-8790-509e31ccb7bd",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f49c3c1d-545b-4bf9-857e-265acc7daaa2",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "98e6bbb4-0882-4940-ac08-5250c7639658",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d07a660b-7246-4f8c-b29f-107e0c8d2362",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c474822b-86b2-416d-91fd-5403619d10db",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b345acf4-fef1-41a3-9eae-9fdefbe9258d",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35783f0c-7a4b-4a5f-bd94-bb569258aaaf",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a159abe0-eeb1-41e1-8b09-c690f69ee4b2",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d5b98d8b-4b4a-4db8-8a8f-eadbc95982fb",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "42245c7b-8dd4-4e47-8c95-f30a46c7726f",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9773dac5-af9a-4e97-8d98-ce027cf4b411",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3cc3932d-94b5-4405-8928-8aed5a541b88",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4c715ddd-fe27-4b3b-8517-694bfd37c036",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e024e73-c102-4111-bc41-fb284f93d6a1",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "beed2f7c-b8b1-4cd8-9d2b-f62dd722fdf1",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b86ef30e-b8dd-4566-a7c1-8f67a7e2d7b5",
                                "id": "8e83185c-18ca-4598-a1f1-2e91ee886e4b",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "370553e9-2dc1-4e05-b6bb-59dd7bdb922b",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e9ebf86b-f474-458d-972b-707f46c26050",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e56eb58b-3e7e-430b-9d5a-922fee384248",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c24e5776-faf5-44f5-88cf-1d3f64a689d9",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a24dbe7c-8454-425e-b52b-985c05d87748",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebed8127-7e99-4db6-981b-d2ca961a8470",
                                "id": "9665a88a-7a11-4199-afd0-50f5de119d18",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1baa253-b1dd-4dc4-93fa-b9eceeed98db",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c5416ebc-9b0d-4734-9878-f3648d8222e2",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee118485-e070-4a55-b0b8-aad58dc14cdb",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f2e3b31d-d969-47ea-94f2-f02e01bdd5a1",
                                "id": "customers_join",
                                "name": "customers_join",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1a293dbb-3e0b-435f-8ac2-31fb27c64dc1",
                                "id": "101b0da7-9b62-4869-b543-d39662c57f5e",
                                "name": "customer_key_join",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d446152-e23e-4f02-9d53-1978b94d9c23",
                                "id": "a7c23601-ae31-4129-b0a1-4b2f786d600b",
                                "name": "first_call",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "721bc5ed-35bc-4de7-aa25-e4c3419a6ad0",
                                "id": "campaign_name_new",
                                "name": "campaign_name_new",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "867587d2-ea26-46bb-882f-05ec1f020fd8",
                                "id": "7fbc8098-75c7-4bbb-a289-334a458479bb",
                                "name": "diff_from_first_presale_call",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78a102bb-a381-4ad9-b4d5-767dccdf52e4",
                                "id": "ab425d82-0cbf-4b19-ae13-97fe7ff09b11",
                                "name": "hour_diff_from_first_presale_call",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01be0746-8a56-4dcd-a560-c52d98a6ab6a",
                                "id": "63ad7d12-baa8-499f-8398-ffd486eb385f",
                                "name": "is_ftd_less_than_10usd",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "643dd696-52aa-47e6-8949-1f8e7c6ce8cb",
                                "id": "cc63027a-eabd-4d2b-9ef2-3cdd7dde725f",
                                "name": "id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf2b675e-ccdf-4239-b04d-793be4136e70",
                                "id": "c62bd803-8b3b-4fd5-a06c-c9b950e5c0c1",
                                "name": "campaign_sub_id1",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab29cef0-1fbc-4051-beba-acf2b2bff9f6",
                                "id": "028bc19d-4867-45ad-aff6-a07333935a68",
                                "name": "campaign_name1",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15f9a31b-3775-4162-aa34-144a31b6c79b",
                                "id": "914d3225-f0f4-4819-b432-fd89b8ccfbf4",
                                "name": "campaign_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2abae4f6-ad87-4be5-9eb8-9b1401ecd279",
                                "id": "a234883b-19b2-4f5f-b471-c94d1930cf79",
                                "name": "is_wh_campaign",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abccf717-aa14-4020-88a1-c45dac5a249f",
                                "id": "44b34073-150a-40c7-bd82-5adcf69abf34",
                                "name": "cpl_value",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "2778316e-5687-4e16-8780-7b66460f54e5",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "3ef4c3d0-451d-4899-b27e-77b45331b594",
            "fullname": "EC2EC:99db4278-828e-441b-865f-f90335b6d1ef",
            "type": "extract",
            "name": "99db4278-828e-441b-865f-f90335b6d1ef",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "676ad00e-0e98-4dba-8f97-11a6ed8325b3",
                        "id": "tq_QcN98x7xm",
                        "name": "Customer_Dwh",
                        "type": "base",
                        "schemaName": "DWH&Crm_Sites",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f0de9ec5-b1f6-4a6b-9573-d20da15032ed",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09651ac0-9ed3-414b-b2a8-d3bb8792197f",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 10,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f99a8173-b6c3-4833-9780-911388132ad0",
                                "id": "is_ftd_less_than_10usd",
                                "name": "is_ftd_less_than_10usd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97399a08-50f8-4caf-a01a-3c01e988b4fe",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 10,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "09651ac0-9ed3-414b-b2a8-d3bb8792197f",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "182faf43-bbaf-45a2-be0e-70425924add2",
                        "configOptions": {
                            "importQuery": "select customer_key, customer_id , is_ftd_less_than_10usd, site_id\nfrom\ncustomers \nwhere is_ftd_less_than_10usd = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "615b19dd3e0f65002cee95b7",
                "provider": "EC2EC",
                "parameters": "7yuZ6l2ZCWHvRbgJqiddD7r8aUVSAXcrDWaxYWeknhKl7TscfL+FxesFUBaFV5vsk23mDPfOuUglMdZyh8FIqAGEOHSGc3SYOC+Ev0c6U3U/s1X+xGNhSurg4+qw3CLjhVdP0+8xdo3BaKlH9cepC/pIyJ2/HPxCMIU1ttxcGNGmVZt+Dn/gnz5Fj8Qw0TxQ",
                "schema": "DWH&Crm_Sites",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "49acab6e-14fb-4b76-abea-3325b2c71881",
            "fullname": "MySql:f356c942-bb34-40d6-87d2-309cfcb3f8c7",
            "type": "extract",
            "name": "f356c942-bb34-40d6-87d2-309cfcb3f8c7",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6115b740d57b1e002c671252",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFL6czB0CGbzkCaBUw+ZXoqcNee235Svk4bYIKmOxmfPKvz/IKZSnvsxykz7VlQXl9sCIXqwArPxFie6FTw/8+52XMLXO7uFglHMTGaJKI92RhOHN+UoCe2DRjs2B+27H2w==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5c8a5d64-54f6-44cd-a04a-e975872797b3",
            "fullname": "MySql:b4173415-5d9f-4fc3-830b-ec42f8e90806",
            "type": "extract",
            "name": "b4173415-5d9f-4fc3-830b-ec42f8e90806",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9fa0c442-631d-4a3c-8dba-b870a73f9173",
                        "id": "tq_qNhKQnlme",
                        "name": "Ashford_Customers",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2d46d5c8-73ab-47b4-8d65-92fe38486539",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe71790b-65fe-4936-a7cf-3d89270780ec",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "749acc80-cabe-430a-b12c-6c8d821074cd",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa9c99d3-dcfa-479e-8cd2-947aa446d26f",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52834eab-6a48-435c-9554-d862565b8ee7",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "741712d2-a297-4d12-8b4d-8595b71aeda2",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68833b54-2c4d-47f2-8433-bcb551702b12",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06edfc38-2e65-43e7-afc1-46d5dd7fd19e",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0cbc23a1-25fa-4553-a219-4f04bcb512df",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a2fd5ac-1737-456f-b83e-394ee3b5c828",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "023f8a31-962f-4329-87c4-93e2a3508668",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "382757f2-d145-4571-9be6-540360f2011e",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18a291a7-9396-4b18-9b94-62d9b5864ed8",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f4347dd-14c2-4e5c-bcd6-6046e769505e",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab8633be-d676-4bd5-a47f-a0d1c84b87b3",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "569eef39-f382-46e5-afc3-1e976e0c178e",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21ac861c-7322-4437-a6f1-90898822caf3",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f8a110f-8af9-43cd-8844-0ca82ac6a964",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a9a2e2e1-7e7e-4278-924f-11e0dfa022c2",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f44f30ee-f498-45b4-8e30-86fe6c2e504e",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db4da57c-572b-475d-b5a9-7769a84d83ec",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3341ed47-d582-4366-a752-4ef99f8ba3db",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e25131e7-3840-4b63-b85e-891a45737271",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b127b73b-07e3-4a58-b819-7497e89d24b7",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72ad8832-940f-46c6-b27b-4a33935cc474",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47a45dbe-9928-4c32-b5e9-57a94345fc0b",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29482391-59ac-4f97-9b02-1c66ab35402a",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8b8c991-7dec-430b-b5eb-d6674baf98e9",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dce72d8a-6b21-4e50-b5cf-f458a4f9b559",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9446a63-16d0-4cdc-90a5-4d34f0fd71f0",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "783694db-d064-4580-966f-19ec32a4e122",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8bfe761a-3873-4858-a543-fe2beeba29cc",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec73ea0f-c3e6-4efb-9cf0-3371ac1e755e",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e958db5a-9499-4d03-87e1-9077fdd06c72",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ebdc720-22f4-427c-af22-e30f328028f3",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d5624ae-57cf-43b1-8a9e-fd7eaffe679d",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f81d512-42ee-4aea-a52b-e3568a79edd8",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "185c591d-ee79-43d9-8e19-5cfe20fce66e",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a109ddb3-03e8-4017-9417-5bffb78487fc",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d1d9a3c-7d67-414c-b3ac-13baa3c08b3a",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b36dc155-b40a-41c4-9c89-3b4125c44da1",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "266873a0-f91c-475d-a10c-2b738be14e89",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7dbaaac-10de-4571-84dc-214eca702ee7",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "665fde45-4e55-4f00-b22d-4ac5e7a41142",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c30334dd-2612-421b-9c6e-ccb98fc1c8fa",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f542607-d8eb-4436-a733-b76e1c2f8bd1",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b60017f-189b-4ab6-83f9-b3fb277ebceb",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b16195f-3a8c-4e3e-87a3-5ac16bd7d918",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a67c70cd-9841-4273-952f-ccec8d859139",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac9d399a-c963-43af-bba6-4bff6d356628",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "fa9c99d3-dcfa-479e-8cd2-947aa446d26f",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "72ad8832-940f-46c6-b27b-4a33935cc474",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "f49bf7f2-d7c1-475d-a256-06a825e82bd3",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(1000 + brand_id, '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,377) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 112, 10012, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a5f1a2fa70ed002ca32bbb",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W98jdN6y1VxIFBWxa29tvuje0Vh/h9Skfs40u3f9B2Pn9Q/vy1/cIQVvIRU4jxZi9LvRhxq655ISW3p91xDIPdQLmLtM99mwqwkgPfY9NPQxjhbgp5k4PSTIFixcnitqVgNkwPNkz7JB+yqiZUGqo3aSJcg5LWeGqR3ZTU146LijdvPE9U842xv8Z+uVszDBfKYtOLqyMJId1LR+ldfzTKg",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5ff5b809-dfa9-4633-8868-dff6c06d1bad",
            "fullname": "MySql:2076bb46-f266-4e8c-a38a-a73d49b7fc24",
            "type": "extract",
            "name": "2076bb46-f266-4e8c-a38a-a73d49b7fc24",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "82384645-ac53-4e3c-be76-1d718a09f1fe",
                        "id": "tq_bDZW7HbAn",
                        "name": "Ashford_Employees",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1947907e-eca9-4286-919d-a09fe21b0fd8",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6003ff55-5268-4d28-aedd-10ebe03786f9",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea93151a-c394-4867-8cc6-bdbde37149b1",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "395c4dfa-2c2f-4a43-90d2-aa4da5546328",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "700ab683-8cc0-447a-bf09-9bb909a0ce62",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22dcdc83-be42-4b96-a33e-8057acb66ced",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17778b2d-b06d-40fd-a50b-2ba9724fd660",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca268ad5-2904-43fa-a8aa-43b93e0c1d99",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99c78fb2-9ff7-49b3-9ba2-611af05bb16c",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1e13caa-8b1f-41ab-8367-0716f87c612b",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fc6f311-6cce-48b7-b5b1-265a0f560e75",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b689700-6c3f-4b9a-ab9a-1ac3b1b159e1",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a14a0854-f5ee-4472-b1b1-dc6305bfc822",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c349b800-9d5b-4b68-ac1a-0c33bf7fa1f8",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2936b66e-1065-43ce-a96c-5e544a57cfbe",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "878b6ac4-e687-4648-8465-497c514acae3",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a5f1c2fa70ed002ca32bbd",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W98jdN6y1VxIFBWxa29tvuje0Vh/h9Skfs40u3f9B2Pn9Q/vy1/cIQVvIRU4jxZi9LvRhxq655ISW3p91xDIPdQLmLtM99mwqwkgPfY9NPQxjhbgp5k4PSTIFixcnitqVgNkwPNkz7JB+yqiZUGqo3aSJcg5LWeGqR3ZTU146LijdvPE9U842xv8Z+uVszDBfKYtOLqyMJId1LR+ldfzTKg",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "69b34f20-f49a-4e3b-92bd-8e3fa67ea4eb",
            "fullname": "MySql:f2f92956-8291-40c2-abf7-b9b24200553d",
            "type": "extract",
            "name": "f2f92956-8291-40c2-abf7-b9b24200553d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "fe236aad-74ea-4c14-95e5-512674b0cbdc",
                        "id": "tq_zqGCzG0JL",
                        "name": "Arrowteks_Voicespin",
                        "type": "base",
                        "schemaName": "callcenter_11",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e111f920-5c8b-44b2-8fdb-e68a3d1f8218",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f79bcbd-20cc-425e-8c21-39c12503a131",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "39f6547c-8984-43a0-b23c-f5e2caca819b",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3db0378b-bb54-421a-9313-be93c31361ed",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "719899ef-0b11-4c5e-8a2b-3d3db37c03db",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16554401-3ecf-474b-a3c4-3bd2cdffd76a",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd3c6afe-6e44-4850-802e-2237938774e8",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1f6b4440-d9b2-485b-a289-713bfb23cc28",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "433133f8-0ba7-4662-bc49-55d55008652b",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b2ab078e-a733-4ee4-832a-ce7c77de1b19",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3bb1dd49-45bf-4990-98ba-725df5c4cfa8",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3bb80a5-3c6f-46a8-9fa0-90a6402db14b",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-14T09:09:40.239Z",
                                        "oid": "9c32465a-ca88-4375-aebe-5a3027a5eee4",
                                        "expression": "lookup([Arrowteks_Customers],[SiteName],[accountcode],[customer_id])"
                                    },
                                    "indexed": true,
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 65536,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "beffdf8e-eeec-41f4-8730-98b4f0cbb1e5",
                                    "hidden": false
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "66e13e51-6593-40b5-af9a-f5e21ca54ce4",
                        "configOptions": {
                            "importQuery": "select\n\tcall_id,\n\tcalldatetime,\n\twaittime,\n\tconv_duration,\n\tin_out,\n\tagent_num,\n\twork_sec,\n\taccountcode,\n\tcalldate,\n\tuniqueid,\n\tdst,\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\nfrom\n\tprisa\nwhere\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619b76375d21c0002cc89b3f",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLRHz5V1LANZdll5oxHlUI6FjMSm+f9vk9kScdNo548NC3qcRlB5eH3IqGLe16Z1seYScp1EZuDmkm9LO/MU3RDhba4PFMnGsEltEzmmxIrhpRs4KrXTFAbXs8kEv+xA0QPwuaKukorbN2cyNxPelSX6Dw4nrmIPU7zQho+nDQs1/42pZsMA2IhXMQqiXPDd0SlWlkrYCufQLcYDFvAyNko/gHOr8kvyUReD6R/eYzQKL",
                "schema": "callcenter_11",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6eae1ac8-47d2-4864-8b65-762b3f091e6e",
            "fullname": "MySql:c87cd54d-4c07-41ec-9013-6078a1c082f5",
            "type": "extract",
            "name": "c87cd54d-4c07-41ec-9013-6078a1c082f5",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "3c98c6a8-2cf9-4e0a-a3b5-639b57d3e45d",
                        "id": "dim_campaigns",
                        "name": "dim_campaigns",
                        "type": "base",
                        "schemaName": "dwh_prod",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1af49170-773c-4cc2-8423-b2d4168cbda6",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d780a36-3435-4671-b946-891de192f7fc",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 255,
                                "precision": 0,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "947507d1-e351-4d62-a6b1-a4087ee32a29",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 255,
                                "precision": 0,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7b54c49-a8bf-4fc2-a3d3-5c46463f9b75",
                                "id": "campaign_type",
                                "name": "campaign_type",
                                "type": 18,
                                "size": 255,
                                "precision": 0,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12c918b3-7993-42f8-b1fb-8944d05e03d7",
                                "id": "is_wh_campaign",
                                "name": "is_wh_campaign",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69b5d4e7-357d-474a-b066-8991aedb8627",
                                "id": "cpl_value",
                                "name": "cpl_value",
                                "type": 8,
                                "size": 10,
                                "precision": 0,
                                "scale": 10,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "bf939558-e4d2-4c95-8ec6-e172509a03fc",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6115b740d57b1e002c67125b",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE9pIO/3IyHFej0+wBAtFu9K37EXVDVdP+ZKmgHokohn9Pgq3c9Uz6q/3Wxj2YLkpZYTPefyH9SajEHpVYABMWBCGNvngE5MqUZxbaclFB7BKhvhA5Laf2xL+zI6AkpKecfS5A02up/cytMuxIwru2O3bsz57aLnYwH/QNGE9jasZw=",
                "schema": "dwh_prod",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "73915249-22ce-492b-beaa-f22dddac0306",
            "fullname": "MySql:a94050c9-e67d-4054-8c1b-067c7da9046e",
            "type": "extract",
            "name": "a94050c9-e67d-4054-8c1b-067c7da9046e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "92b2ff65-5b0c-46d0-8437-83c338efe568",
                        "id": "tq_kSTM6kjtG",
                        "name": "TheBPCA_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "347f259e-36a5-4989-89cd-526b1cf3c1af",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07bac77c-0b32-4daa-b276-f06f0a07c811",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69dd4be5-61bb-4c3f-9c2f-095760a11315",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4167b66b-ab34-4f48-b8c6-04cad5ee7166",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6d6859a-7ac6-4c34-acef-6c61ff47da9a",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8130f779-fa46-4ce3-b200-f0dbc1fa0762",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0afabfc8-0383-4689-b2a4-07024c743f3b",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "284d1d55-8691-457f-a5b6-51be39141763",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f904c618-2e02-498f-998a-6fd61db42ce8",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5316e5fa-99ec-4ce6-8103-930aabe475d6",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c56b8e62-84e8-4fc0-b9ba-64ca54d185da",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c059aa42-0275-49fb-99ab-e8d27a7e6940",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3dcc9476-a615-4cf2-a47f-1cc65a2cd824",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "008e08f4-99f1-40bb-ac22-e02283569389",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b63418f-4138-47c3-b48e-5c777328f92b",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa1cdad6-02f4-4e86-840a-a0fcab2ef3e5",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26fedd1c-5bf6-4f4c-9e0a-3c1aaa2505be",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7848e4e4-913e-42eb-bf00-0e758fb57a0a",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b8e4c357-26a3-4580-a914-1337b1e45f45",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ef726240-4913-472b-b626-aad5b06454c8",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0117a9e8-83ea-4106-9187-8f4aafd37248",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "843f89e1-d375-4574-81be-546744ab5912",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6e5d569-ca45-471b-aae8-6f0dcb6b04b8",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66b14096-fdf1-43f2-b02e-3b458c865a0c",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae12ce2c-c09b-4f12-bf84-80ddad7514cb",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc5f4e54-4656-4647-83b5-53e7ea58c71b",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68853f27-b166-4052-86d2-a5923b9400bf",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a3d1153-160a-45fa-896c-ec167cb25027",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81574ffe-a99e-484c-91bc-10695b92d243",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "577bb905-b10e-4352-b519-d1dadbe3ae7d",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c18ceff-a101-4a4c-ab67-a43f4f6490b2",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f712668-b83a-4b1e-b4fe-b9649546e334",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5405998-2756-4288-a160-0497a75205f1",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af02cc35-9ef2-4a09-b069-4eb7c83afffd",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "339ee8a9-8121-408b-b19d-cc1c9c38886d",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e0f842c-ae68-45f0-adf2-0eba904d92bc",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e318c943-667e-4a2c-bb06-7409c1987586",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15e6c567-9080-4abf-8047-83def0fbffcc",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec50a55c-e570-47d7-909e-d6fced6337ba",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f65675f-8b8b-4711-afaf-0b76db5fe98d",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37337f1a-b2a1-4ccd-95db-676b36858411",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb1b6e60-c75b-4788-adec-0b281707bd7d",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40129ab0-e710-4545-b609-6c6d0249b268",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d0f2a80-0451-4b6b-9fec-a1de9c66d40d",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5e85af9-fa19-4581-8b78-1119c5ef5d3f",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c916bfa-ea8d-4678-9a4a-6dfdb443bdfe",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33c66c55-df4e-4605-bd9e-534f866dc7a6",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e28fc491-fe68-43cc-94c7-d9b68ccfc7c6",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a8eac43-b28a-411d-8463-1d9642607b9f",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e74326b3-3e88-4c8d-9a5b-cde4feba961b",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "4167b66b-ab34-4f48-b8c6-04cad5ee7166",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "ae12ce2c-c09b-4f12-bf84-80ddad7514cb",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "3e047ef2-3fc7-458a-869b-f037b62753bb",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(1000 + brand_id, '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,377) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 112, 10012, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61951436fd9249002de3c51f",
                "provider": "MySql",
                "parameters": "Li2FpOBZkuQVFHmglvVO3unF3cyE7uQhXYenrn6ytNP08dPSNopcrZhCPhIEZbJq3GHeZmZNPZrQfHZy7Mo7S3QwZl+lJvy8mcXjoPWADHn7fHD/TXsGlpkaRPNOQnFO1tEd5xDHMHRh7i0mnvMheVsy39u8/PLd+UW23hnoTWzeGuy1jl1t9vmXt8xw1uh0Lw271DKaGVhOc5Lst9nqXnRu5pPfVPjIho4oBLMYdZDsXAdGAFkgsULvW5O9Ut8l",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "75424c08-8634-494c-bee7-5bf70fc18b0f",
            "fullname": "MySql:b8e8895e-df32-4073-9cef-23bb74ac3818",
            "type": "extract",
            "name": "b8e8895e-df32-4073-9cef-23bb74ac3818",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a202e840-3184-4b9a-9af2-4fb8b9788920",
                        "id": "tq_YQ8BBUBAJ",
                        "name": "InfinityCapitalg_Voicespin",
                        "type": "base",
                        "schemaName": "callcenter_11",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0e9966ba-7083-473d-9173-0c31f358189d",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5f088eb-bbe3-4b96-893e-908895235f6b",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0df3ebf8-df8d-456a-b1d1-b2b5623ba618",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c317106e-3672-4276-bfc8-22b1112e6790",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4f881076-729c-4205-8f74-d8e54e85ce9f",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "945d370e-bbfd-47b6-b7a7-d8cbf84ec8d9",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a6c610d-0deb-4b52-abc2-b10221b5a81d",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "222ffc4d-3416-4ffc-b186-ed35924edbfb",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "240f1d71-0ea2-42f6-b9bf-1c5303d79cab",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9fd55212-8c2a-4efa-95f4-90febb1db70b",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87a07339-94cf-46a7-8ab6-7941e8ce6adf",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f1ab002-ef56-472c-9198-34474ef23d91",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-14T09:09:40.240Z",
                                        "oid": "a3f2fd5f-bbfb-4cd7-b679-a88a598d23d8",
                                        "expression": "lookup([InfinityCapitalg_Customers],[SiteName],[accountcode],[customer_id] )"
                                    },
                                    "indexed": true,
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 65536,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "dc8abff4-22da-479d-983c-f69b54328190",
                                    "hidden": false
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "46b6608a-aa0c-4065-b17f-25affd43ff95",
                        "configOptions": {
                            "importQuery": "select\n\tcall_id,\n\tcalldatetime,\n\twaittime,\n\tconv_duration,\n\tin_out,\n\tagent_num,\n\twork_sec,\n\taccountcode,\n\tcalldate,\n\tuniqueid,\n\tdst,\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\nfrom\n\tprisa\nwhere\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619b75b05d21c0002cc89b39",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLRHz5V1LANZdll5oxHlUI6FjMSm+f9vk9kScdNo548NC3qcRlB5eH3IqGLe16Z1seYScp1EZuDmkm9LO/MU3RDgFf6cq1foM3vtQxs1AHJ52KWEOu9Sf1YBzGGZkSHZQAjtIRI2Chvex/xVerrs3dBhScvQR9pFQuXKfySW5ZGRxto2LH9FjnO09JeTFfwTkYhq7/iYRcRq3epYLu2nZI9dLyVduF1bHy+5T7Rnt8ukR",
                "schema": "callcenter_11",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "795bfb43-dffc-461f-b72e-81e7db9b0bb2",
            "fullname": "MySql:aacfa08e-a6ad-4a9b-b511-8d7471ac199d",
            "type": "extract",
            "name": "aacfa08e-a6ad-4a9b-b511-8d7471ac199d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7f9ee065-5d6b-497e-a746-93dbb43aaec4",
                        "id": "tq_EqfByiMYR",
                        "name": "FXVC_Int_Coperato_Calls",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "be925175-f26d-456b-ab67-5ff807c4d1c1",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 8,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e043f8cd-7f41-46dc-8ef8-d9fa307f1dbf",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "365f3eea-29f6-4312-989e-b3825cd800b0",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca32bfd9-e74c-4ee3-92bb-f977660116b1",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86bbba9d-fe0c-4933-8931-bde089a92cf1",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "849ff6d7-3e09-4449-b15a-38bb0641edf9",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 8,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0393a3b9-b990-44ac-8c73-548bb250beeb",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ce190ba-18d9-4624-9abd-8d69b4c4472f",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ce65fd3-bd66-4602-b14f-863f417a049e",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81d91dac-9bf0-4c6c-85fe-1a873867d45d",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 8,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "252cb9e1-3337-4541-86c9-99eefabced8e",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 40,
                                "precision": 40,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd8aa008-d230-4462-8362-b2a5de9fd92c",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-07-28T08:19:59.267Z",
                                        "oid": "fdc72e54-81d9-46b1-9ece-a0d95c43a167",
                                        "expression": "lookup([FXVC_Customers],[SiteName],accountcode,[customer_id])"
                                    },
                                    "indexed": true,
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "279f3eed-2c77-439d-9f00-2b23316f8f1c",
                                    "hidden": false
                                },
                                "type": "add-column"
                            },
                            {
                                "arguments": {
                                    "column": "be925175-f26d-456b-ab67-5ff807c4d1c1",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "849ff6d7-3e09-4449-b15a-38bb0641edf9",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "81d91dac-9bf0-4c6c-85fe-1a873867d45d",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "89253bb7-bf9d-4c7c-af93-2564d617f258",
                        "configOptions": {
                            "importQuery": "select \r\nid as call_id, \r\ncalldate as calldatetime, \r\nduration - billsec as waittime,\r\nduration as conv_duration,\r\nUPPER(left(recordingfile,3)) as in_out,\r\nagent as agent_num,\r\nbillsec as work_sec,\r\nc2c_talking_to as accountcode,\r\ncalldate,\r\nid as uniqueid,\r\ndst,\r\nTIME_FORMAT(SEC_TO_TIME(billsec), '%H:%i:%s') as call_time_duration\r\nfrom vw_cdrs vc"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6115b741d57b1e002c671265",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE9YWOYKK0sDPFHBmCLTJH+DtrPzRsuu8NHmSgJR+S6VuJehKJMRzPoiWH1FE6GlKhr8xHj3xv03KZudv1z8I/Bvk0thRK28QJYiZ8PkW18un80RanOjbwprPf6TmWPQAW2eNg3MoSU2Lr/Jp5aYyU5h+EOJf8764T4RC6tfx5rC3aH17ftlg5ojDQg2xuxJPdk2O4vXQP5xbu77RM7jfvC6g==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "800b0102-e39a-4d4f-80ac-46feebab3aa2",
            "fullname": "MySql:807396b2-ae5b-4107-98b1-e6166688ef5b",
            "type": "extract",
            "name": "807396b2-ae5b-4107-98b1-e6166688ef5b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8f264403-5f47-4468-bc95-fc8d4e0f3b08",
                        "id": "tq_uma22uEs6",
                        "name": "Aussie_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "511e0928-2fb0-4ad2-8cf8-dd9a2e7f0bed",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d1e369e-e6bb-47b7-9ce4-d9ce268e4f23",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "09af1fa0-7069-483b-81a7-93311e606e0c",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "708fb53c-a472-48be-b096-6ce310a3928f",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3a0c744-3b21-482c-b51f-c0ae1a08413f",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c4a6828f-fe62-4a52-953e-37bfa9e87343",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48295890-6bba-4e80-a162-736a05728705",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b68b08f-e093-45f4-a028-92c4ce07aabe",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8c166c9-672c-48de-bf33-21efd9513989",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de40a041-04a2-4c49-9496-760cbc35e820",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e88709dd-0c0c-4a0d-aec9-be4e4aa2803d",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1d4ff709-6e7c-4727-8d6f-636887a4f0b9",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "77a4c58e-86dc-4f0f-ad11-680859bc06d2",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "19ca70e4-f439-403c-8456-171de8c23b5d",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a0130687-0f32-4092-aa2d-31b1fd79797d",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1037b47e-acdb-4cce-a746-8e2317435af5",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "effb043a-5fb0-4eb1-a6fa-e2172da83066",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "494ea0d6-ca17-49f4-9810-5ceb1ca93eb1",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f54554f-dbac-4a18-a8dc-ccbc38820937",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90d63281-75aa-474e-87a8-9e6b317847b5",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "995169fd-9e77-4fa6-bbf0-2977fccb178e",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07dc6bfb-f8c9-4f1a-92d4-52f05fd4fd90",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb1dddbe-47d1-49d4-a2df-78e866774a3e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f09920e-40b0-4681-b94d-ae12d6b7d525",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d80d4c1a-c80b-432f-b441-0188a960acb1",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4a3cc812-adc8-4737-bc95-fe662953dbf5",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35fb67ab-58d6-43c3-b83e-09d3d9506ffa",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "576928bc-5615-4300-a350-40707e34eeae",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "525d293a-8dd1-463c-a13d-489b6244e8c2",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f5c3db2-c020-4921-93b4-9579fbbd8aea",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f7672b7-525d-4983-a672-cd9e1ec1b453",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "916785bf-259f-4bf5-a7b3-a4489b34cb56",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a995564-e3da-40f8-aa93-aca1042214c9",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b30ff8d-4b1a-41c7-ad03-6f0a536718e1",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6aa78f9c-c367-48c0-b103-e84a3e24aed2",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e64b5469-d7a6-4a06-82df-0c4f912ab927",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f25a4ca0-9e6f-490d-98b1-a32359600232",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2dc0f4ea-f55b-42f5-a73f-ba12d0e97a74",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "181b3646-214f-4d8b-97e4-361a846668e4",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25c1f9da-4612-44f5-8e99-192a760bfde6",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f901154-d856-4927-a62d-5527224da2c7",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "acabeca1-dd05-4ed9-8950-726af0f409a9",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1ac456fd-2ccd-4d4c-abba-de9866757e22",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd87d3b7-1119-452b-bc9f-aea0cac358e0",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e0b3ad0f-a135-4dac-b52b-ebc2347e1610",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d95be5b-1dda-4844-9f1a-c3ea372b01b0",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25192ddc-1c71-42f5-a06d-64c2e06bfdcc",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5eca1335-8053-4e58-9760-c1c7475ca2cd",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e815c66-a3f4-41cc-826d-06b2ddcbd1f0",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "150288ed-327c-4168-97b4-108a1a9a67c8",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "708fb53c-a472-48be-b096-6ce310a3928f",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "d80d4c1a-c80b-432f-b441-0188a960acb1",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "c19e8fa7-ad81-464b-b5ce-a5789fc2f33b",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(1000 + brand_id, '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,251) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32,67,75)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 111, 10011, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619513d2fd9249002de3c51c",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "807642a3-3a60-4f7b-996b-570bee14a79a",
            "fullname": "MySql:e0dd796c-ae00-4908-b82e-126c2e107a38",
            "type": "extract",
            "name": "e0dd796c-ae00-4908-b82e-126c2e107a38",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "916fee1d-be86-42e6-bfdf-bae6fb4c71e2",
                        "id": "tq_8A4oMBMkB",
                        "name": "York_Calls",
                        "type": "base",
                        "schemaName": "callcenter_11",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2c4596ac-bb10-4f6b-9467-51317086a9ee",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4e4d790-17d9-46f4-b6f2-8c6102ecdb1c",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40cdb1ab-8606-40a8-92eb-3ba80dc849e5",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc06b1bf-8b6b-40a3-9837-54914b5a5d4f",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de1a171b-d294-40d4-b182-5451cf0bea2a",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44c28ff5-6b2a-4285-b4c1-5566c6e0747c",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4ffa39f-f43a-49d5-9c98-e855d8e9b315",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82a704bc-34bc-45d3-b56b-d701e029eafa",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e90e6d3-4917-4f93-b3bd-ba0c034b20a1",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4043e796-1474-4c6d-949d-c8fca36115ba",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a50922b8-59eb-4015-89d3-be6666953090",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84533f41-404e-4d23-8982-2ea550f0c4e8",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "scale": 0,
                                    "precision": 0,
                                    "lastUpdated": "2021-11-29T12:56:06.759Z",
                                    "oid": "b51eecae-a6a8-4507-bb02-c8eacff03ccd",
                                    "hidden": true,
                                    "indexed": true,
                                    "expression": {
                                        "lastUpdated": "2021-11-29T12:56:02.091Z",
                                        "oid": "7f3af6cc-8d6e-4ade-8a2e-52f0a5420aa7",
                                        "expression": "lookup([YorkCustomers],sitename,accountcode,customer_id)"
                                    }
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "5421c765-d9e8-43a5-90b0-734668f7c43c",
                        "configOptions": {
                            "importQuery": "select\r\n\tcall_id,\r\n\tcalldatetime,\r\n\twaittime,\r\n\tconv_duration,\r\n\tin_out,\r\n\tagent_num,\r\n\twork_sec,\r\n\taccountcode,\r\n\tcalldate,\r\n\tuniqueid,\r\n\tdst,\r\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\r\nfrom\r\n\tprisa\r\nwhere\r\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a4cdbd356021002c50aabd",
                "provider": "MySql",
                "parameters": "FzeDaWiA0Ia1we2BSgnTwVq3+YlZ3BosQ7cs1LkStsxmj4jUQSrnOq5CBpk9z9uLTNoyn3KQ4WFi7j/IH+BJPYq0JFK3S+K1S1j6wB1H2B3pD0qP33XDVAQSBbXQyXS6c8E7PBdi1WaSfngadUsKY1xXSZRFkEb/UNvnQ/3+M5iiuII631/FnoOAV3s471kSrqvsKilFrbWzNhwsNXT4TJRJ+lQCI3VSSlFP/361iq0=",
                "schema": "callcenter_11",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "814e9bba-9c48-471c-b6c8-613103ab5c31",
            "fullname": "MySql:58c6b7c0-f405-474e-85ce-217c9170236a",
            "type": "extract",
            "name": "58c6b7c0-f405-474e-85ce-217c9170236a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "29e8f134-89a2-4b36-8826-6290476799ed",
                        "id": "tq_FkkFPRUfA",
                        "name": "Genius_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "342123f7-1a54-4379-81e4-41743fb63d03",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0077b5b5-abfc-4f75-bc55-9ce243df3ffa",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 5,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fdd03b42-6542-4740-9f97-4473ffeaf163",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "828fc45f-edde-4676-8986-9060a4f85a60",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "433d8072-c6dd-4e80-b5d0-c35bc042f726",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33cd798d-9ad0-44af-954a-7c891ee696a8",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbc52d3a-0489-4096-8fca-624b92611be1",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a50e7fcb-397a-445b-aaa6-256e4086f03c",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d90011b-e7ff-4fd3-a793-c616e3296cbd",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26a39204-deff-4c9a-b99c-87e6bc985d47",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3be0f280-bd58-454b-a047-dc45ed0b5a02",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0bc941b-c6e7-4166-949d-80034a858920",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93f0942e-e0af-4f0a-a177-55b821878eee",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9eb30749-5ced-4430-bdb5-566bb1c74434",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbb8513c-3b8b-4bad-96d9-53f9b27523f9",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3f6c91e4-1460-426a-a66c-b1d701575809",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tCOALESCE(\r\n\t\t1000 + brand.id,\r\n\t\t1001\r\n\t) as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat( COALESCE( 1000 + brand.id, 1001 ), '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (\r\n\t\tcase\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id\r\n\t\tend\r\n\t)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on\r\n\tuser_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1 = 1\r\nwhere\r\n\tuser_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61951758fd9249002de3c534",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCqSYW1fxIKnnsNg912qKxnkNYDWZ+cKc2+OkWR4TYeDqigQx2Gby0V+VIiWD8xSpNgDPteNtIjPQwF2M5JVHV3yvqczUgSrKzkSFvYE7o1nmx7tTUV6bpCu/O4DX4PS0SqEZssDUcXG1n8CtVH7jOf4wbMBe/zM2QWg0IpP004O",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "83b5531d-bb6b-4c62-ad06-fa15edf2d0a2",
            "fullname": "e2d48ea5-824c-4a35-8b0f-1156f8f29bad",
            "type": "custom",
            "name": "e2d48ea5-824c-4a35-8b0f-1156f8f29bad",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "cd37693c-c74c-4b0f-80a4-218597e64168",
                        "id": "dup_extension",
                        "name": "dup_extension",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "c87946b9-82e3-49e4-bfed-73867bc635a5",
                            "expression": "select distinct extension_number, site_id, count(employee_id)\nfrom employees\nwhere 1=1\ngroup by extension_number,site_id \nhaving count(employee_id) > 1\norder by count(employee_id) desc"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a9040659-9cbb-4c20-baa5-e186bf61d24d",
                                "id": "8b7cb9ad-fcfb-4643-9e99-c2549805bac7",
                                "name": "extension_number",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc7c081d-87b8-4456-ab5d-5fd074196fb6",
                                "id": "40b9abf6-2f49-4e1a-b520-29617e7b7a9e",
                                "name": "site_id",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30cf57be-411e-4e11-b3ab-c31eb8cef56a",
                                "id": "339c4474-c163-4722-a7e2-f1744bc03208",
                                "name": "Column",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "c9986e30-48a4-4c24-ab7f-c721828fcce7",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "85a16b12-6088-4335-8d91-62e0e9bdfa85",
            "fullname": "2bce22f2-ac25-4130-9ee7-60a865ba386d",
            "type": "custom",
            "name": "2bce22f2-ac25-4130-9ee7-60a865ba386d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0345e738-f3bb-4d76-83c6-7aaea00aa192",
                        "id": "Duplicate_extensions",
                        "name": "Duplicate_extensions",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "f72abf19-89c7-48fa-b438-45ab3b6b667b",
                            "expression": "select distinct(extension_number), site_name, count(employee_key) from [Employees] group by extension_number, site_name"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1bc5e4c0-0ab5-4487-9597-f1db46ed02fe",
                                "id": "afee9dd0-73de-4c54-b50b-1b8f67504d2d",
                                "name": "extension_number",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b4c1987-0014-4768-b140-f49669aa9f83",
                                "id": "0f9578ff-aca7-463a-8974-68183bf1bfb9",
                                "name": "site_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4723e65-0138-449f-82a5-dfc8afa2fe6e",
                                "id": "7115a2f9-c0de-49f9-a697-545ba2508726",
                                "name": "Column",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "af41c6ce-eb38-40c1-94c6-b020c2af9fd2",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "8883aa23-8aa2-400b-9e83-8e27706c64df",
            "fullname": "c7f3e9ef-0118-4679-927a-5d37a15826ec",
            "type": "custom",
            "name": "c7f3e9ef-0118-4679-927a-5d37a15826ec",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "bad5983b-3e56-4bdf-8a6d-9a22b5f1f7d5",
                        "id": "FXVC_Calls",
                        "name": "FXVC_Calls",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "21ac10f7-c1cd-4e49-bb79-af9a3bb6b54c",
                            "expression": "select * from [FXVC_Calls_voicespin]\nunion\nselect * from [FXVC_Int_Coperato_Calls]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c11e5a77-bd00-42b6-8a6f-e259a5b21e32",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a590c517-371c-4b60-abaf-c88e00c19af2",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db56fd94-9b0d-4d0a-a97e-d283375330ef",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4d8501fc-9f95-4ae9-8249-7af820ee636d",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35528172-88a3-4594-9b3c-ea465b477707",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd0dbd32-43f9-4f6c-a402-a1c797c7cfc9",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2a7d7c1-d364-45bc-a1e1-bad896066df7",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd62667d-9046-4b01-b34d-9f30b6a69a51",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4133514b-14c7-41ca-87ef-1ca176eaf339",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d6525ca6-a52c-4485-8257-b13d50fe667e",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd5898cc-bd58-4bf5-a3e4-8a95ccb66a1c",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c50188f8-948a-43c7-be17-e9fe226462f0",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ed70ef1-1d69-499b-913e-33d5b13d8a5e",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "c487fb31-4bde-470d-844b-c42bdcaa74bd",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "8cb11fa6-48bb-45cb-8272-5587c518d29a",
            "fullname": "MySql:4b37d9a4-4464-48fd-8ea8-c1b503d037a7",
            "type": "extract",
            "name": "4b37d9a4-4464-48fd-8ea8-c1b503d037a7",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b5709e78-b62d-4213-a4dd-5f6b6f91d80b",
                        "id": "tq_7DA6t3PDe",
                        "name": "PrimeOTEmployees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "69b048a1-85da-471e-83dc-ffa497b8bcd1",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "940eade3-4657-4a84-9a5f-bf93019dc191",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 5,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d23bdd9a-dbf8-4132-942b-28509d7518a8",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6aef828-1d68-4bee-b98c-482f4b963c0c",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1dad0a28-d267-436d-b647-1dc12246e8d0",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2fa88ac-4a3c-4273-8ce2-04621a1a1aba",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c120d62-5ca5-49b6-8102-11575421c63b",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "670d5ed3-f283-40fc-a2f7-edc47f614c0c",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc959b98-3bb2-4f23-a018-c5d08064f5f4",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee35de58-1185-4cf1-8117-ae221648913a",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "474c6e93-4b50-43fc-bd5f-188ceeac5569",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e1180ce-221f-4685-87e6-cf45d7c7b99b",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8508015-9e9b-492a-b15e-22d66fa9ba36",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3720191-c423-4898-8120-cc8600b8c10d",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "926c8007-71fa-4169-a4c1-263ec019a673",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3b08fb34-804e-4fa4-ac09-8b02895c4af4",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tCOALESCE(1000 + brand.id,\r\n\t1002) as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(COALESCE(1000 + brand.id, 1003), '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\tselect\r\n\t\tuser_id,\r\n\t\tmin(group_id) as group_id\r\n\tfrom\r\n\t\tuser_group\r\n\tgroup by\r\n\t\t1 ) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id =\r\n\t(case\r\n\t\twhen `group`.parent_id is null then `group`.id\r\n\t\telse `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on\r\n\tuser_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61951686fd9249002de3c527",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CLQO1pn40szcYNg2rZoiX1Vg29Vp5lwLqTDoBiPX74Z7tq4A1c99blLl+UTfHxXxv3fHMdNaD6ZQ0AYwLSELF3A=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "94ef56a6-23f5-4b81-b51b-493ec375b602",
            "fullname": "MySql:e60e9f33-91a2-4cf0-83cf-26f5fc245301",
            "type": "extract",
            "name": "e60e9f33-91a2-4cf0-83cf-26f5fc245301",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "e2cfc17d-be58-4563-ab98-6f10fa72a2cf",
                        "id": "tq_hb6syKX8Q",
                        "name": "NostraCapital_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0e8481f6-4c82-4f70-89cb-7f467770b656",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee9b3466-7ff0-473c-b8d5-24ee67946d98",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e49a55f2-990c-492d-94f8-3f4f951edd87",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "951275fd-10dd-4730-9657-d0cc815571ca",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7372e3d5-b486-4b25-9f0d-e8b6649608fa",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c3760c1-75b6-43db-a516-5ec039604953",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "85049aed-cb14-4fd0-9469-e1e04556ee55",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d749c72d-010b-4e6f-b43f-e7d08534dc23",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51910104-6b69-4d25-9677-a8a73bba63c5",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ced5c01-b4cc-40b5-bafa-89686fc4dea9",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79a0a788-b468-4b2b-8ab9-bb9a77f878ad",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6cda5ab0-ce17-48b2-b8ef-2cbf3f0ea73c",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86f73581-a985-4364-92b9-b671c3023c46",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c7a853b-f906-4128-8899-b3a45bfe6d10",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c97a782b-3455-403f-852d-025e6fedd41a",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "0da79df8-e39a-4fa9-a348-9e42da6dbb56",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tbrand.name as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619516a4fd9249002de3c528",
                "provider": "MySql",
                "parameters": "5zpNi1/ivLrPCYd3lQIeMwzQq5sAuc2YxZlngeeRz8hpTWd0H8LeepAHS57ZrJJbLGMhcYYJi5jTdTs58x9Ifb38GYxx5LABrwlbp4PgUKEopCjg+Bdl9PQiGCx8H7K7nWAdNIkesmJqig4SBGeNKtw1XDvwnBW3u/rrXgFKnw1iQo69EEWu7CqZHboIqgmOLsXk4QP+RQIQ0ffDKky9F0uishDV78kkCxoNl+Mfe8tBKYck/ulmOghb0RL9ZKCb",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9935e721-7ca3-4fdf-89af-7efb3c8546ea",
            "fullname": "MySql:5ff22e5a-0744-477d-a938-2b0d805bd2f4",
            "type": "extract",
            "name": "5ff22e5a-0744-477d-a938-2b0d805bd2f4",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "51734be6-5c22-4f95-9a76-18d24645a80f",
                        "id": "tq_cmzwDLfn6",
                        "name": "Arrowteks_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "79cba163-4ad4-4195-ba4b-de2f0b09856d",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5aa8dd9-72ee-4d42-9ad8-739b8870bcdf",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2507b921-a18d-42f3-bb0a-4da35fbf5f34",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26a448eb-6c91-483c-93b9-e0487b89d6e9",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cff9cce4-5b3b-46ca-8966-e5b7b3691d6b",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "10971dfc-be1f-441a-8387-853b890299f7",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 40,
                                "precision": 40,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b2afa18-0c94-4596-8f4a-88c263660a3b",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba53b591-0801-4653-aedd-fcadaefb8a36",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8de32b39-1b05-4f1c-8c16-0fa810734322",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0af9626-9de1-4822-b3db-f700bb86be42",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4cddaae2-a14f-4bea-bf2c-f19f5378f020",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5316a8df-ee8f-4811-959a-4eaac9957329",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7de1c14a-4bd9-4d8d-b01c-4f568b33e4ac",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ea4742b7-de9a-47d5-85c8-32f3ab99da25",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "578a52d2-da1b-4f91-93cf-896e8839c0b5",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4acff85c-e60b-4783-b917-b4300e153714",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "507cd43d-79a1-4ecf-897c-8dec4238bbac",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "823ab1a5-c224-4351-9072-8d98440c445e",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9093cdc-9c29-48cf-a5fe-1e519f238ec3",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d308811b-c733-49a7-a0da-c464db2c305e",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd2a72b3-629d-4f3e-b2fa-67b16d0fd4ae",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29ba7e42-f8fc-4f62-85d5-47486c2abb12",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e00e0bf5-9bf3-4f98-abc1-ba31998167e8",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0478f947-a68c-4cda-938d-a0b1925f24b4",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f286c3c3-b447-4a28-857c-761db56bf293",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "077b28f9-034e-4fa8-812d-a61050bb78a2",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bb9de60a-fc66-4b12-9e49-8ec710accf98",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "461d732b-36b1-42da-891d-99aacf114c44",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7b0844df-f504-46ed-98a2-d3328c1dfc4a",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a0bf8baf-0573-4ed4-8fc8-653a9e2ced27",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cdc2e8d6-86ee-4d71-adc6-acf3a7055969",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4387b712-f267-44d9-8a1c-349f043ab809",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "afa3f598-8dca-42d8-9bac-6d5da71be4ff",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fee142ce-d27b-48a8-9cb2-45dd5d6da8e9",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ecd59f0e-5185-4791-89a9-c66c81d94d1a",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9d8ca7f-9dff-4301-b98f-8335bf86e0ce",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "49b53dda-2864-46d7-940c-d111b03bbc34",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "64bfaaf0-3d1e-485d-8839-995156ddc8b3",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e63c8b0-d314-43f8-9def-7c4a433c4d1a",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08aab92e-584e-4635-b7b1-777bc24a4112",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a299fe8e-4533-42e9-be39-fbcdd8d4b184",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "777215bc-9e14-4506-9423-67aa78b65c7c",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14ebd8be-a448-4026-9386-4af7e123f228",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "092277f3-de70-4959-8d42-d2bb20342f2b",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f070f619-9926-406d-b7af-f294dc56a5e4",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d782bf1d-c125-43c2-a777-8cf973678e2b",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70ed69e9-4c90-4fed-a64c-798416a5929b",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c053457-b6f6-4720-897a-285f829ab287",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1cf459b-3f99-4c61-b470-f7b83de5881f",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b62c28d4-58d4-4acd-95fa-65d2d1a8018e",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "26a448eb-6c91-483c-93b9-e0487b89d6e9",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "f286c3c3-b447-4a28-857c-761db56bf293",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "97bf5de8-4d36-4b87-9852-d3cbf7cae9ea",
                        "configOptions": {
                            "importQuery": "select\r\n\tcase when brand.id = 14 then 'Arrowteks' else brand.name end as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1001), '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,251) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32.65,73)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32,65,73)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 110, 10010, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32.65,73)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195147bfd9249002de3c521",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a3b3fb92-191d-4c5d-8a1a-a94537f6104f",
            "fullname": "MySql:a401386b-645c-40ce-ac50-8a7f974ff9f2",
            "type": "extract",
            "name": "a401386b-645c-40ce-ac50-8a7f974ff9f2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "65230ae5-7f8f-461f-814b-0d3b0fb299b1",
                        "id": "tq_wwrgF39TY",
                        "name": "NostraCapital_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1c3b37cc-cd54-4ce2-aa98-67822283482a",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a47bdfbd-d8f2-4a02-bcbd-ed7342b4f1e7",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c68afd8-5801-42a9-8208-dbe85057a452",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8205457-ee2f-46a4-b38c-ff6d13a5f876",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2621110e-26eb-4adb-98ab-92f5f23752e5",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f0fa48c-1dc2-4947-80c9-7f32f70ec36f",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e9cda5ba-00b0-4b98-b73a-e2298e5dfd49",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94dc46e1-66b8-4459-b45c-918be82fea5a",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c618a9d4-db0f-41b2-81cd-3784fc294a8e",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "65eb9e4d-dc4f-4702-a0bf-56cef5227b74",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76597e9f-3c7d-432e-a525-301b4580e8bc",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6f34924-4439-4195-8a60-f54bd8766235",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9193ed49-234d-4167-abf5-b0c2620279e1",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ddc0307f-f7f0-48ba-a9cd-32baa7db90b1",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7eac1019-e41d-4a20-b3aa-84bb0e2c293d",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1c012ff-fe4f-4fd7-a977-51608c9de1da",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7267d554-22ca-43a6-ac98-175b666364ff",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92c0b270-e3ad-47fa-a07c-121cad55e953",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "33e70548-1a66-4c3f-9745-b52bb74b458f",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7a75dc91-e336-46e1-93ee-d90de3cc48a0",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "937cbb65-781a-490c-83b1-7c12e4d31c1c",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b94eac01-afc0-45e4-93db-95694ac6fcb0",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6af30e0-4c9c-4b01-8f92-e89c4279dafb",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93b822d6-f9be-49e8-b40a-fbd4f06508cb",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9747037f-bd41-4395-b9d8-c6b14d32cf59",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bdcbba9b-60c7-4962-9417-5d22f4317b17",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc2b2e89-da6f-44af-84e8-42a2a05a345d",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e216d1fe-8a0e-4c54-ab2e-4ea178de4aa8",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a36f98cf-7f86-47f4-a332-b0e75bd2cf9f",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0ab46ed-9f2a-4f29-8233-c4efe9aee0a9",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c57d9b7-44ce-457d-8b96-045ca2cbb841",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "502dfe86-f488-46f4-a5a6-82c885e8ab7f",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b05df59-ce26-425e-8a71-39d1c9c49657",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ddd29e2b-c8e8-4660-80d3-2305abfc805b",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a105c8c-b189-4b66-8649-5b01abd9a75d",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71b68f6e-0d8d-47a5-9ade-fa90da7e9e3c",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a8a1ac2-d657-48e7-9042-fe0683d52de6",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9185e84e-368a-46fd-b9df-1df99e7c747e",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f870b5c-b392-4a49-b094-ef39b4952ab9",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "426dd49b-c30f-418c-9274-a5872d08ff0e",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e65aab21-781c-484d-a161-6cef8e3fb45a",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "019b14e9-a967-41b3-b7c9-ddcab87bcd20",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b91a4a46-d951-4471-90b1-090ad8917f1b",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "271c4796-5cef-4edb-ae6a-24bdd07248b1",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "134b9ca6-e472-40e3-857a-4f0b7d614bd6",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fa22b9d-a912-4ca7-9ff5-1ba09eab6361",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec1ab64c-0e43-4275-a5ea-6d3da22b58ca",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a04539e8-5c43-4b2c-b23a-d37eee7a58c1",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e46333f-2108-468a-9a94-1dc8f9ec50ab",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab46913a-6e43-465b-8eea-1c9b0144fddc",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "d8205457-ee2f-46a4-b38c-ff6d13a5f876",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "9747037f-bd41-4395-b9d8-c6b14d32cf59",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "272ad0c2-4c95-4cc7-8b03-cc07248b12d4",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(1000 + brand_id, '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,377) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 112, 10012, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619512f16780f2002c37ece1",
                "provider": "MySql",
                "parameters": "5zpNi1/ivLrPCYd3lQIeMwzQq5sAuc2YxZlngeeRz8hpTWd0H8LeepAHS57ZrJJbLGMhcYYJi5jTdTs58x9Ifb38GYxx5LABrwlbp4PgUKEopCjg+Bdl9PQiGCx8H7K7nWAdNIkesmJqig4SBGeNKtw1XDvwnBW3u/rrXgFKnw1iQo69EEWu7CqZHboIqgmOLsXk4QP+RQIQ0ffDKky9F0uishDV78kkCxoNl+Mfe8tBKYck/ulmOghb0RL9ZKCb",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a63013e1-3c5e-4551-b41d-61cae96cd0e5",
            "fullname": "MySql:a43aa349-ff21-4bb5-a67b-ae9fb36fbdd7",
            "type": "extract",
            "name": "a43aa349-ff21-4bb5-a67b-ae9fb36fbdd7",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c81bf3ae-6269-4bd2-b39d-3882547bbe3b",
                        "id": "tq_DRvRTg75i",
                        "name": "FXVC_Int_Coperato_Agent_Stats",
                        "type": "base",
                        "schemaName": "asteriskcdrdb",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d264f57e-1ec7-40b8-9042-cd350f320d8d",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06605d80-e2f4-4f8c-9187-82579c194f16",
                                "id": "calldatetime_key",
                                "name": "calldatetime_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b76974d-0076-4f1d-a844-5e7f4baea8f6",
                                "id": "First_CallTime",
                                "name": "First_CallTime",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6308fad-adaa-4e41-bf63-40fb671251ff",
                                "id": "Last_CallEnd",
                                "name": "Last_CallEnd",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d736eb5c-7ea1-4adb-916c-dd4ae522e360",
                                "id": "Log_Time",
                                "name": "Log_Time",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec6d2462-8477-43ac-b3c4-f8235b6cd62c",
                                "id": "GrossPhoneTime",
                                "name": "GrossPhoneTime",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "907cbdb7-8fd2-48d8-9800-df6676c9f62a",
                                "id": "NetPhoneTime",
                                "name": "NetPhoneTime",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2478a12b-66c5-4541-b74b-9dd975aacade",
                                "id": "Idle_Time",
                                "name": "Idle_Time",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "572f1941-1041-4669-b620-e742ff6fe8d5",
                                "id": "Time_Active(Gross)",
                                "name": "Time_Active(Gross)",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2350cfa5-a297-4a41-b536-61567b4d2f6b",
                                "id": "Outgoing_Calls",
                                "name": "Outgoing_Calls",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c032f4f-dfa8-43e4-a250-bb0445b19475",
                                "id": "Successful_Calls_30s",
                                "name": "Successful_Calls_30s",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42274231-92c2-44a0-81f9-ea9c7cd82317",
                                "id": "Successful_Calls_90s",
                                "name": "Successful_Calls_90s",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "59a0dc5e-b47d-4a0e-a332-e2f98f8e81b3",
                                "id": "Success30s%",
                                "name": "Success30s%",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49a1da33-ae1d-497b-83be-f0e5062dec06",
                                "id": "Success90s%",
                                "name": "Success90s%",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "75adc060-b815-4d7e-8ba3-9de47da1cb1d",
                                "id": "Effective_Calls_3min",
                                "name": "Effective_Calls_3min",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3107959-9f1a-48cf-b8b1-aab9e775753d",
                                "id": "Effective_Calls_5min",
                                "name": "Effective_Calls_5min",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35aa1c39-cdd4-46d3-b58c-e3556f8c146d",
                                "id": "Effective_Calls_8.5min",
                                "name": "Effective_Calls_8.5min",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf658b36-6d89-4971-9c44-f8c9ca53ef4b",
                                "id": "Effective5min%",
                                "name": "Effective5min%",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e350b626-38a6-4bc5-aa25-b1d065b498aa",
                                "id": "Effective8.5min%",
                                "name": "Effective8.5min%",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "877c6695-c565-4d14-b3b8-e7ff76fde669",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "d264f57e-1ec7-40b8-9042-cd350f320d8d",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-07-28T08:26:07.521Z",
                                        "oid": "d85ae6c0-ab64-4a53-869c-27ed0073a312",
                                        "expression": "lookup([FXVC_Customers],[SiteName], [customer_id], [customer_id])"
                                    },
                                    "indexed": true,
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "d69e536e-befb-44fd-b71f-91ab4acd8038",
                                    "hidden": false
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "97087cd8-1798-403c-b031-e0f5fd461208",
                        "configOptions": {
                            "importQuery": "select \r\nagent as agent_num,\r\nyear(calldate)* 10000 + month(calldate)* 100 + day(calldate) as calldatetime_key,\r\ntime_format(min(calldate),'%H:%i:%s') as First_CallTime, \r\ntime_format(date_add(max(calldate), interval max(duration) second), '%H:%i:%s') as Last_CallEnd,\r\ntime_format(TIMEDIFF((date_add(max(calldate), interval max(duration) second)), min(calldate)),'%H:%i:%s') as Log_Time,\r\ntime_format(SEC_TO_TIME(sum(billsec)),'%H:%i:%s') as GrossPhoneTime,\r\ntime_format(SEC_TO_TIME(sum(duration)),'%H:%i:%s') as NetPhoneTime,\r\ntime_format(SEC_TO_TIME(time_to_sec(date_add(max(calldate), interval max(duration) second)) - time_to_sec(min(calldate)) - sum(billsec)),'%H:%i:%s') as Idle_Time,\r\nconcat(round(SEC_TO_TIME(sum(billsec))/TIMEDIFF(date_add(max(calldate), interval max(duration) second), min(calldate))*100,0),\"%\") \"Time_Active(Gross)\",\r\ncount(*) as Outgoing_Calls, \r\nsum(if(duration >= 30, 1, 0)) as Successful_Calls_30s,\r\nsum(if(duration >= 90, 1, 0)) as Successful_Calls_90s,\r\nconcat(floor(100*sum(if(duration >= 30, 1, 0))/count(*)),\"%\") as \"Success30s%\",\r\nconcat(floor(100*sum(if(duration >= 90, 1, 0))/count(*)),\"%\") as \"Success90s%\",\r\nsum(if(duration >= 180, 1, 0)) as Effective_Calls_3min,\r\nsum(if(duration >= 300, 1, 0)) as Effective_Calls_5min,\r\nsum(if(duration >= 510, 1, 0)) as 'Effective_Calls_8.5min',\r\nconcat(floor(100*sum(if(duration >= 300, 1, 0))/count(*)),\"%\") as \"Effective5min%\",\r\nconcat(floor(100*sum(if(duration >= 510, 1, 0))/sum(if(duration >= 90, 1, 0))),\"%\") as \"Effective8.5min%\",\r\nmax(c2c_talking_to) as customer_id\r\nfrom vw_cdrs \r\nwhere \r\nagent <> \"\"\r\nand calldate >= date_format(now() - interval 2 month,'%Y-%m-01')\r\ngroup by 1,2"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619b75c25d21c0002cc89b3c",
                "provider": "MySql",
                "parameters": "NeqIFycvOz1fQMgnTiKwXNvHKXDfkkBcIWBEmIivIdFW7JVw4mQu1zRKc+ybyboceNC0tYh5tBAdcnhNrwdRvgzv/SuEAZohyrGt0qzcV8k4EgWn/d8vH7qom018l0iP8cLnFNWC0cF3xvIhLWuBIrvGNnu7oU0ib+2BPuDb0YkQeVN76lYH+4L3OID2RcHDg5TIY0r2sxfK82hzIuEDhdPH2tqAk+UO32VhTM7ovKqvXUGR13MUHwR7c9JaSYj1ezHt2WWjxu4iXMGlsjnXjA==",
                "schema": "asteriskcdrdb",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a716a601-04cf-4570-8969-0c64a97890c1",
            "fullname": "8b54164a-e3d5-412a-a3ac-962791babbdd",
            "type": "custom",
            "name": "8b54164a-e3d5-412a-a3ac-962791babbdd",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d5790c12-967b-49cd-9aa5-896afa9b8319",
                        "id": "Duplicate Employees",
                        "name": "Duplicate Employees",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "ebe239f0-12e2-447e-9fdf-5dca6bbbe78b",
                            "expression": "select site_name, count(employee_id) as count_employees , count(distinct ext_employee_key) as count_distinct_employees,\ncase when count(employee_id) != count(distinct ext_employee_key) then 1 else 0 end as not_matching\nfrom [Employees]\ngroup by  site_name"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5350d107-838e-4a77-8723-4273a65fff3e",
                                "id": "5ee6b6d7-28b1-449c-8c9b-7e0798febf6f",
                                "name": "site_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d969d6c0-4ae7-4b31-8e63-fd4a6cf87f3c",
                                "id": "a808c8ab-04a9-4b93-949d-f07d95583679",
                                "name": "count_employees",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a915c27-6406-4090-b52d-8508e5978750",
                                "id": "fdd85401-4d70-45cf-886a-a828e592f7ad",
                                "name": "count_distinct_employees",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b7d916e-1dfe-4161-9152-5b203c131297",
                                "id": "2a5226a4-c257-4c55-9836-15fe57bdc5a6",
                                "name": "not_matching",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "471e90b5-b73b-45a4-ae3f-12b65e3d01b3",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "b2f25092-ac83-4db0-a540-fb9e28becca6",
            "fullname": "MySql:3e447664-eafb-4a01-a5f0-7c0812e90115",
            "type": "extract",
            "name": "3e447664-eafb-4a01-a5f0-7c0812e90115",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "cb530ee2-9e0d-4e7a-8614-f46e53b9e40c",
                        "id": "tq_v4ZbJlVJL",
                        "name": "WinGroup_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "4997544f-e263-411a-9ac2-5aa5ef90281b",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed08b232-ec2e-4e88-8818-b30dee04dc43",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ed4bbef-b78d-4329-b5bf-aa8ebf2cc309",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d893aa22-9c1f-4df1-a276-8222191494ac",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad9feea5-a35d-4169-b87c-29362b0ff073",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23c37d26-1de5-4b3e-9d0d-82598ca47b42",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c78835b-20b2-4b52-9155-7866f8eec9fe",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb293fac-829f-42a6-834c-a7473141dc41",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a04d6d4-e16c-4113-b093-3999399d8bfb",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67d63f1f-d32e-47b8-b3af-6b471fde7026",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab93199d-e5ae-4352-8243-aac2a9f8a632",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5210a4b-ff03-402b-a8b5-1d5b7b0e3b9e",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19d9e1e8-b382-425a-ba3d-980a3ddbc8a7",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1156a3cc-acb9-457a-96bb-346dd6df50ef",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92aad6d4-31e6-4618-a6a3-d41421408651",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8c3aa98-ec30-413d-808c-ee1991f77dbb",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ab8d881-756c-47c1-a04e-a72f2ba6b3f9",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3f1ced7-c733-4140-9b6e-196d41f63530",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3c492b62-cbdc-4a5f-be51-717dbff04eec",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5baa28cd-f692-4f6e-91d3-6be52debd41e",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98448240-d18c-4424-b9c2-68c93002d546",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dacefe01-eb70-4576-acc4-28e1f5b1ec7e",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "816c85b8-8228-4a4c-beed-d27bb8454f6b",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca48b83b-b2a7-4a6e-b5d4-212c577b9ea5",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cfcf35c-8676-406a-b286-ce0f38a50ca6",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3122b5f3-5c93-4c50-831d-737dd4b53c08",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93798a2b-710c-4c2e-a13b-809bbcece958",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6656117-fe3a-4096-993e-deaaa42456bf",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be24c4f5-a253-4adc-84d2-8f9906e5cf8e",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5be8204-1112-432d-823f-9effa2ed477c",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d54a054-f198-4666-95ae-8a341338c6fc",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eace786a-9af8-4fcc-b5e6-c3f371fc91ee",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a26ee253-330f-479d-beb3-66c5cd59c6cf",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9646d70-5c40-45cf-a8e5-a3d8df0ede72",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "108aef8f-ce77-4536-a495-d227fc9036b8",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd91f3f6-3170-4995-931b-062b7e4efcaf",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bc5417b-e22b-4f4f-be52-81d10e751a68",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1e58cdb-7e4a-4270-a0d9-f9a62ca1c2e9",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "beb19fb8-be5b-4092-ad8a-9dd8300c00fd",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "847761a6-b8b9-4bf0-9712-b24ea82d37a4",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df94ea22-fd15-4225-a782-812d0f14436e",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0707393d-be14-46be-852c-e112a34030c3",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90bcfa01-daca-4e95-b445-0c8d107113f3",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8bcb0ae3-d963-4e7d-a4af-4bae5ee4f66a",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8bbd8f6b-6d1f-4de6-a1c6-5a1bd494db1c",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f72b73b-5f80-4c94-bfae-d062a27da591",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6da8eac5-bebc-439a-b55a-67c37856b18c",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16aed227-8186-469a-a985-2005ea689182",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d5b7063-b4e9-4cf2-aefc-d1f4e7904868",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff34e592-f5f4-439a-bb65-6521c912c7ec",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "9cfcf35c-8676-406a-b286-ce0f38a50ca6",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "d893aa22-9c1f-4df1-a276-8222191494ac",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "07588e24-7e5a-4f0d-b8ee-bfb8a9e143c3",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(1000 + brand_id, '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,377) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 112, 10012, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61951459fd9249002de3c520",
                "provider": "MySql",
                "parameters": "7niuYEzJZH44LaPxXSBFhgupfobVTnd8RwuqT0tnpje5KDJ7gduGgbtju1DOzrlHXyxYXX725adKvwo0Axykr60D4z1b1mw8WsApMJ7rY2LFOgeJZlZLv5SSECUKR37mBafSjAQv9xX/iReS54jxrRpjqt9TPCFGToA1IaapWsmrdViPoMfSyvvjgaK/3p6BzDNuzHzWZBteGVhZyUQHKDDoHtfKTScd/BFbaKhGoQOqfvtLuYR5XwGPk9gdwJzB",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b6e94f0c-670c-4825-acae-76e93da21e2f",
            "fullname": "MySql:8dafc5ac-4abb-48ab-8f65-c4da498d3b45",
            "type": "extract",
            "name": "8dafc5ac-4abb-48ab-8f65-c4da498d3b45",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f0a81144-13d0-4e86-8c96-d634dedf221b",
                        "id": "tq_8AhpVNb1H",
                        "name": "InfinityCapitalg_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "fed34203-a178-4ea2-b056-c39a8cfc7304",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51bf4f85-7088-489a-b86a-f22e199f860d",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "efef9cc4-3d73-46fa-ba65-3e17b6eca2dc",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ac40c29-7f41-4576-aad5-3c5df62bd560",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8386d3d1-71b6-4ea9-a8d2-98f6f0a66500",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7596ea99-3e84-4f20-8e57-5d5b806d277a",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5004c1f2-73e0-4cf3-a7f0-0cbbde072c4b",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a8c768e-4f2b-4117-a05b-4538fa11c2b2",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4abaf03c-0494-48af-81e3-256db2974f72",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0bf775b-ad99-496d-805a-a22e2b60a058",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67f9f08c-5569-4ff0-a169-b1b9f83d5873",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ab857e93-5a4e-429b-81a5-10142b4061ff",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "caf6a9e5-5c32-4d08-bd32-66b2b7016078",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b7885132-72d2-4dab-9b7b-6bc03d5f0563",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d20997a0-479a-40ac-93ad-ddf4fdd310d4",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "193e7777-7441-47a6-81d5-ae4ad17cb7f9",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcfb9f4f-6611-4893-8ac2-1f74c07cbf40",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "128f9002-e070-406f-9d31-8278f194d103",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f8a626b2-ff09-402c-9071-3270652ee903",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f34930b-0b2b-4856-ae08-7d4d3c4e1332",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a77c63c6-a710-4fc2-80b7-e72e4ce6ee2e",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc32e136-2017-498d-95f9-4e315ea5fda5",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c9d1b5c-f5be-41fa-84c5-05efb3bfb2ae",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e87f9be-6ae4-466a-a037-d16868444209",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91740a66-ecc6-49c0-ac47-6efd20207fee",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b5265919-251e-47c7-818b-47640164e3a0",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bd0aa654-6d8c-48e8-833a-bae6369e7e66",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "34c00c7f-b16f-4bf2-9841-878ba1414adc",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b762c422-5942-4dd8-a499-855954a7ee40",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1e70ab9-c4d4-4dea-9750-95647bce288f",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "251dd21b-d1e7-40a5-a83f-57404ebd0230",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bdaeb717-5490-4122-9b40-7a7ef7054a41",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bd8e634d-7058-4017-9dae-9c196608d33a",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e83b926-8f20-4f65-84fd-6400090690f6",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9227eb9f-5c01-402a-b3f8-b0898a9f00be",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "23079b3f-ed28-46a4-80b3-c8887741ced4",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "27014f6d-e94b-4057-bf3e-c4b994defed7",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e3056e3d-b612-4c9e-87dd-18b2f656e75e",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b03b7af2-1b1a-4cdb-8fb2-52dc64c697c3",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb5eda13-ec34-4024-bf45-cf5fe036a69d",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "127877b2-c964-49d8-b6fa-23de070b1468",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "196e28d8-0fed-4aa5-aec4-6f1263d6d99e",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b99a1b2d-d211-4237-85b1-4a892edd0e11",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3dc96fb-6ea1-4047-8d48-dd168968c956",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd1aa360-25ec-4728-b69d-e6c94a2c1c27",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74984fb7-2ac8-4aa9-af72-b8ad91d8f6ff",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84328891-c639-46e3-9241-f598aa14ab92",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97342b6b-b8b0-43d9-839e-c2b6435c4253",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f8fc627-a086-40e3-a67b-d24f4d308621",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f895f748-a788-4c87-9522-ac2202097a73",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "0ac40c29-7f41-4576-aad5-3c5df62bd560",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "91740a66-ecc6-49c0-ac47-6efd20207fee",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "1abc2901-4fbb-40f8-9b63-55d4ae84db0a",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(1000 + brand_id, '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,251) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\t\t\t\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 108, 10008, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619513a8fd9249002de3c51b",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b73feac1-a923-4235-bc99-1e5acf67742a",
            "fullname": "MySql:b4a8650c-0e22-4908-ae28-a856dd455368",
            "type": "extract",
            "name": "b4a8650c-0e22-4908-ae28-a856dd455368",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "854d0611-c4b9-4da6-8f9b-30af72992a8a",
                        "id": "tq_uNbwdBYJ8",
                        "name": "IvyTrust_Calls",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9efd234c-667a-47d1-b591-e39209a23993",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a35672fe-80c5-4b87-80b8-a99bc62e325c",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82288b6a-b769-460f-9338-2caca7c14e4c",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e23d616-aa67-459b-8c6c-ddd9eaa58831",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76fd8895-af93-4bdc-8dca-01a5f15aff80",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c7bee1d-c76e-4505-b0c9-ebb3820ef7d3",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9621a1a-8243-4e0c-8edf-4ceb00ecc433",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e84effa9-c1ab-48a0-96a8-8107a5969e2a",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9b0515a-bcaf-4989-a461-749491289cee",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9bdb1bd-9459-4a0f-ac84-186943ba698f",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5df06f9-e7e3-4ca7-839b-1b64f979e464",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53cf089b-c809-4e23-aabb-d036182eaf55",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "scale": 0,
                                    "precision": 0,
                                    "lastUpdated": "2021-11-29T13:40:47.029Z",
                                    "oid": "89801f6c-032d-4315-8ce0-1bee0e525cbd",
                                    "hidden": false,
                                    "indexed": true,
                                    "expression": {
                                        "lastUpdated": "2021-11-29T13:40:47.029Z",
                                        "oid": "c108ad45-d996-45c4-84c3-663f2d6280bd",
                                        "expression": "lookup([IvyTrusts_Customers],sitename,accountcode,customer_id)"
                                    }
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "be54eace-a1ee-4c8f-9a08-84dcd3c42c5f",
                        "configOptions": {
                            "importQuery": "select\r\n\tcall_id,\r\n\tcalldatetime,\r\n\twaittime,\r\n\tconv_duration,\r\n\tin_out,\r\n\tagent_num,\r\n\twork_sec,\r\n\taccountcode,\r\n\tcalldate,\r\n\tuniqueid,\r\n\tdst,\r\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\r\nfrom\r\n\tprisa\r\nwhere\r\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a4d80a356021002c50aac2",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLa+3h96MJVGDFcDTpISdQD63+Qxqz5LfyX5Zs+JK4IbPwjBfTCbAJ1VEMXXNs4YZnXN+ZoJa9TVU1XN3itX9aEc/rbIZ7eeHbQlA/7zhyr/BzQA2q69+XuQVxc/mv3aIl+8yiRq0xWhiiN19uvl85xqdJoRBs+LXQG4kbPnugXOzluWAE1KIlnNxh5drDvGzaSsn63nolpRJD7HhN+udwbVLxYmDxsDC14BzDnrzGnHvVRBFmplGLo3VQujf9R/FeQ==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b8d63d02-4849-40c5-915f-3c51bead071a",
            "fullname": "MySql:4822a7d3-4040-4728-9ab1-95d182510362",
            "type": "extract",
            "name": "4822a7d3-4040-4728-9ab1-95d182510362",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "21f1e6a8-7e8d-4bb4-9c9d-48070b92c14e",
                        "id": "tq_A12aRyjGi",
                        "name": "IvyTrusts_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9ebd279a-1966-4ace-b5fb-0aeefc709e74",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4099cb09-8fd8-49a9-b96e-f99178d00896",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02584ede-a96e-48b8-ae0e-b3cd54742dae",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6e7ac21-861c-4eab-85a0-b55851bc359b",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bab64f8e-9ca3-43ee-87aa-5ff110b9900e",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f70d4e78-fe9f-4876-941f-fcc18cfcde68",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 40,
                                "precision": 40,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46c5bc04-32a6-4e55-adbd-7da9e12b297d",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27fed967-bcf8-479b-b378-ffcb839323d9",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b230717f-af31-47b2-8935-6e31ce348956",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 306,
                                "precision": 306,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a19af08-8072-4eef-8133-9a8c82867eb6",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1dba09f-6b67-4489-935b-c63c06b91305",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "726fab5c-90e6-4671-af3c-24499ebaf2f1",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92e1f75a-ac15-4fcc-b4df-2cefd9605578",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9a561126-e7f8-4c72-b9bf-a95ec647fc26",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "73fb44cb-476c-413a-8a02-1fa3eaa7d9da",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0c0a159-465b-4d62-a1a6-4040b0315a3d",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb625adf-e460-4d9c-b21c-55e7a0a3e5da",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "226425c3-e391-4ca7-88ab-1f77a9697663",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cdcbd64-fead-4060-9210-260fa3a2dcb7",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d1cf8d3-82e1-4efa-81a9-66bfae006116",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d883d2d-4b8d-4695-a91f-909a766f2ecc",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15b894e9-4309-4609-81b0-7591a97e81b2",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e63f1b08-73e4-444a-97b0-13913a461a0d",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d7b5898-7e0e-498e-b01e-888d337ba0bd",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "756ddffd-351d-4729-9b5b-8a699b70d0e3",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "11e85626-e816-4631-844c-ea1d2bfdc279",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d21b4b71-a43c-49bc-923c-dbfa1213f558",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "024134a3-a7f7-48a0-ac6b-76932db04662",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "58752e43-0906-467b-aff8-3de68491a6d0",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4ebb251a-b4c9-453c-a7fa-bb3c2345a86b",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "81745fbf-3099-49e2-ab96-3a0bbdd392ed",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ad327083-6afa-47f9-9559-caf2b5bc9dbf",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "735997fd-312a-48ab-a903-bfea179cd481",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "973b253d-6721-4ee5-859d-6b678545c89a",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d95c88b8-6115-4d99-b99e-55e8b4729e67",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "234b1d19-b136-43e5-aa51-34279ff1264e",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8f6bc45a-793b-4390-9f61-373bf662a2ac",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e966e89-ad4c-41e5-9a7a-f5f1b6e80881",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3fa19ce-d8eb-4402-b0bf-454e586f4281",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ba11138-74a1-43a7-a54d-fb279cf57dd5",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bf43779-1d0c-4833-8a31-21148bc67644",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8707b8c8-454b-44e3-b158-4569e80ebed2",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "28e38a6f-e2f2-4efe-a858-bab1572aa1be",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0dab271c-c09c-4064-a1a7-af3e4a5d083c",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "31ba595f-cd92-4f43-997f-6cf46079e88e",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fea44498-3820-476f-bdb4-76b5edba970c",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0756cc65-ffef-4e74-9f4e-129c8f91dff0",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a53c9db3-ed59-41c1-a096-4e6a4c5714e5",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9cea60d1-9cd4-4ddc-87e9-d4fb4c1825e3",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "25d0aaca-f204-4842-92ca-32cb838fef4a",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "b6e7ac21-861c-4eab-85a0-b55851bc359b",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "756ddffd-351d-4729-9b5b-8a699b70d0e3",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "fa39eaab-8753-444a-a608-749180eda3eb",
                        "configOptions": {
                            "importQuery": "select\r\n\tcase when brand.id = 6 then 'IvyTrusts' else brand.name end as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1001), '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_1k_redepositor,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,377) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,208,325,478)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,208,325,478)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 106, 10006, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = user_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,208,325,478)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = user_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195135bfd9249002de3c519",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiAoP3g27zBsTBhENM+dBsf62FQyEzHEvyCyA1AFqG0Wq82nAt5YxcjG5bUujZ6mLgw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c8b10810-8253-46f6-aad8-ceaacf7cc82c",
            "fullname": "4c73c8e9-8539-4e6d-a6ba-7b961ae8458a",
            "type": "custom",
            "name": "4c73c8e9-8539-4e6d-a6ba-7b961ae8458a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0435350e-1328-4a44-a3d4-5eb208434e12",
                        "id": "New Custom Table",
                        "name": "fact_ftds",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "25d0397e-60f0-4566-b38a-1b1d6600fff9",
                            "expression": "select \nftdind,\ntobigint(getyear(firstdepositdate) *  10000 + getmonth(firstdepositdate) * 100 + getday(firstdepositdate)) as ftd_date_key,\n'-100' as employee_key,\ncustomer_key_join,\nis_split\nfrom Customers "
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b50cb32a-96f6-4364-9a7d-fc07b216323c",
                                "id": "3501ad74-5451-4071-a129-472ca844070b",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08cca90d-b317-4dfc-8dad-c5aaaaee2d73",
                                "id": "d861122a-8168-48c9-9497-14e51a95dccb",
                                "name": "ftd_date_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b51c02c0-c9e9-440e-9cf1-2757f4b653ac",
                                "id": "eee16efe-bf7a-4808-afb8-d0fb2e424c79",
                                "name": "employee_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "051c6b8c-55a1-48c4-9184-1b7e51fe1180",
                                "id": "9525c41b-c2d5-4c27-b734-3da77bc0f138",
                                "name": "customer_key_join",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef3f303e-a109-4e95-a066-f46e5d604aa2",
                                "id": "47521ffe-aa96-4e22-97c7-6b3016a8d62e",
                                "name": "is_split",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "2fff4422-548d-4950-acee-fb0c9354ac44",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "c8e447eb-71ec-428f-8518-46d7b5b4a41e",
            "fullname": "MySql:c9331b24-b4d9-4fe3-a9bf-c5c3b6594c46",
            "type": "extract",
            "name": "c9331b24-b4d9-4fe3-a9bf-c5c3b6594c46",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "619b75a15d21c0002cc89b37",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLRHz5V1LANZdll5oxHlUI6FjMSm+f9vk9kScdNo548NC3qcRlB5eH3IqGLe16Z1seYScp1EZuDmkm9LO/MU3RDgN381uB2G3FNAlhmFbvuexmVo7ZAPS/w07g953hEfMH7vAgvQJItfw8e8PsT5svf0pjymoyDtZiymTIvmIa/8VLShoMdLqtm3FZ8wB2gN20QuROoeet9pH3quLd3S7xKw=",
                "schema": "callcenter_11",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c9651f52-d7ae-4b9b-bc8e-85d35860e37e",
            "fullname": "MySql:2e885fc7-d80d-46de-a9b0-4aec6b05ad54",
            "type": "extract",
            "name": "2e885fc7-d80d-46de-a9b0-4aec6b05ad54",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "617577b8-085b-4212-b460-0bcf0b12922c",
                        "id": "tq_qnsntVIrq",
                        "name": "Arrowteks_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6765f3e5-8fbf-4394-9059-6379cdf40cec",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75110c2e-1dd7-4e0b-9fd2-0a23b0148244",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "739bb8d1-447b-4177-81d4-66d9402f3813",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2146f350-4254-495a-bd42-111cd7dc7b97",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1de96d35-d4ed-4d26-b9d5-218529aec46e",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "471ad117-6b21-4524-b436-9df955179197",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4379e84-4692-4e14-bc90-e6e812a1ac28",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09c0720c-fd8b-49fe-b29f-cdc62b77cb27",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d0f79a1-f8a5-4fa5-9ccd-32d86b282313",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e166b5ed-3e15-458f-b669-679c7e1d9bbd",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bde92a16-d543-4b83-8b3c-2e165e680b6e",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11f1993a-92ad-40ce-8a16-77f284b7a2d9",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90d71e07-5535-4834-a0a4-bdfb4e1b390d",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7570af81-28e5-438d-b60b-ce236db66749",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e9c86a91-96c9-4c4d-a946-62c97125c258",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "98ea48dc-8125-4635-8af1-f06a7695b10a",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tcase when brand.id = 14 then 'Arrowteks' else brand.name end as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619517c1fd9249002de3c538",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "cbe289b9-1f63-4edf-9abd-3b0a2badb2f6",
            "fullname": "MySql:1eed4260-1b88-4cf3-9133-a4f98cc2d1b9",
            "type": "extract",
            "name": "1eed4260-1b88-4cf3-9133-a4f98cc2d1b9",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6115b741d57b1e002c671287",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoheAP1kZvNi+4VpN1pRRv3kaD/RL2IIGntCq0mo/lZJkYw5sZYML0+enaqd6ElULbA=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "cf1ea5d9-f667-41db-8e06-d87d23764d44",
            "fullname": "MySql:b8519203-a60b-4d96-9af2-7c9d57b9d90b",
            "type": "extract",
            "name": "b8519203-a60b-4d96-9af2-7c9d57b9d90b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d080c522-c5b7-4b50-aa7a-3e6c25b976f3",
                        "id": "tq_vKjlJK9L1",
                        "name": "IvyTrusts_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "97a883d3-adba-47ba-890e-4a7d3728a5f2",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f47470a-d886-41e2-96bd-ec2491d434a6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "86837a1f-4565-4604-b2af-87351a5fd44b",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "605c1d8d-a33f-4512-86b3-15dea5c4b6a9",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cbc7d2a9-8435-4861-a95d-96476f75cddb",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a34e17e8-ee1b-4161-82d3-8cb28f8d1a67",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a5dd549-aabe-414e-8b26-1107da72af9f",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b1feae2-2f14-4ccf-8e3c-42558af49f88",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81744022-2fa5-46c6-bb6e-5de6e8bfda42",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fd800d9-d1c2-453c-a079-fd2c070e77a0",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0dc80a4a-eba2-4509-91dc-60840cff89d1",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16bc376a-5294-4bbe-b1f6-a7a21cde9282",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df693358-5ba8-46af-b328-d31bee6f7038",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14f20d8a-28e4-4147-a46b-e7e3c3282944",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ac9df524-f157-469e-9611-09ef354c96b1",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "6b4cd373-0dd0-4a5e-81e6-c60073fdb6a6",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tcase when brand.id = 6 then 'IvyTrusts' else brand.name end as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin( group_id ) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1\r\n\t) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619516e4fd9249002de3c52c",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiAoP3g27zBsTBhENM+dBsf62FQyEzHEvyCyA1AFqG0Wq82nAt5YxcjG5bUujZ6mLgw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "cfeef8d1-132e-405e-beba-9d5f43a5e9cc",
            "fullname": "fee5cd10-f876-48ab-9e24-e83b7d9b48b7",
            "type": "custom",
            "name": "fee5cd10-f876-48ab-9e24-e83b7d9b48b7",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0c0d2e66-45a1-48e2-9deb-e15cd7005a56",
                        "id": "Employees",
                        "name": "Employees",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "4f094f2e-0535-4cd7-a254-1972960c5987",
                            "expression": "select\r\nemp.*,\r\ntostring(emp.site_id)+'_'+coalesce(emp.extension_number,'0') +'_'+ tostring(emp.employee_id) as ext_employee_key\r\nfrom \r\n(\r\nselect * from [PrimeOTEmployees]\r\nunion all \r\nselect * from [IvyTrusts_Employees]\r\nunion all \r\nselect * from [FXVC_Employees]\r\nunion all\r\nselect * from [TheWealthCore_Employees]\r\nunion all\r\nselect * from [Arrowteks_Employees]\r\nunion all\r\nselect * from [Aussie_Employees]\r\nunion all\r\nselect * from [YorkEmployees]\r\nunion all\r\nselect * from [InfinityCapitalg_Employees]\r\nunion all\r\nselect * from [TheBPCA_Employees]\r\nunion all\r\nselect * from [WinGroup_Employees]\r\nunion all\r\nselect * from [Genius_Employees]\r\nunion all\r\nselect * from [BitfinityFX_Employees]\r\nunion all\r\nselect * from [NostraCapital_Employees]\r\nunion all\r\nselect * from [WinGroup_Employees]\r\nunion all\r\nselect * from [Ashford_Employees]\r\nunion all \r\nselect -100,-100,'N/A','-100','N/A','N/A','N/A','N/A','N/A','N/A','N/A','-100',0.0,0.0,0.0\r\n) emp\r\n"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "654843f2-4984-4d9f-9508-e24817af430e",
                                "id": "0f27c2fc-9024-40c5-8187-b52de065fa47",
                                "name": "employee_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a37251a8-baca-40ba-bef0-a3e846019434",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b04f8f63-2908-4917-864f-6c0589c17557",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8a774a1-074f-450e-aa16-9229cee231a5",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "412fb248-547a-4fa1-b36d-34147fdc5d0f",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b9faf4e-ee8a-4d0c-8c68-ae0a27117be3",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0eb4fc55-d43d-4a5c-a1a7-fb985f0dfd91",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6db4c41-12a8-4bfc-8e18-dc0f90e96963",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67f60d2e-6485-4c35-8bfc-c43eaef2fc68",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9adfdf28-b149-4d8e-b036-bf58cd732c15",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82c4e8d2-d370-4f47-9e99-8b3d67b56b78",
                                "id": "2fba63e9-9ed1-44ea-b28b-c92f1ea4f4f6",
                                "name": "group_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6284f235-3c0c-4b17-bc20-df49215e4fd4",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79ba672c-f7a0-4413-ab52-a72cb2da53d9",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ed53de02-a128-48cd-b967-afaee2f40ffb",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "29e37740-4afa-4154-bcc7-9704ebe0886a",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2a09dc8b-1c10-4976-a2a9-13d73f63e525",
                                "id": "19ffd71c-a08a-4421-95f6-e03cb265ceaa",
                                "name": "ext_employee_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "2e48f0e6-6047-4a74-96f1-4a6e9cf44334",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "d320b97f-5323-4005-a795-05aaf79f61b6",
            "fullname": "d0ed5b3f-1141-4bdd-b833-c5e9994a09e9",
            "type": "custom",
            "name": "d0ed5b3f-1141-4bdd-b833-c5e9994a09e9",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "29301508-eead-4f53-aff7-1cc5ee0a58fe",
                        "id": "Arrow_BPCA_Calls",
                        "name": "Arrow_BPCA_Bitfinity_Calls",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "361d7608-a5ce-41d5-bad3-0704dac03a48",
                            "expression": "select \n    a.call_id,\n\ta.calldatetime,\n\ta.waittime,\n\ta.conv_duration,\n\ta.in_out,\n\ta.agent_num,\n\ta.work_sec,\n\ta.accountcode,\n\ta.calldate,\n\ta.uniqueid,\n\ta.dst,\n\ta.call_time_duration,\n\tcase \n\t    when a.[accountcode] = b.[customer_id] then b.[SiteName]\n\t    when a.[accountcode] = c.[customer_id] then c.[SiteName] \n\t    when a.[accountcode] = c.[customer_id] then c.[SiteName] \n\t    else b.[SiteName]\n    end as site_name\nfrom [Arrowteks_Voicespin] a \nleft join [Arrowteks_Customers] b \non a.[accountcode] = b.[customer_id]\nleft join [TheBPCA_Customers] c \non a.[accountcode] = c.[customer_id]\nleft join [BitfinityFX_Customers] d\non a.[accountcode] = c.[customer_id]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8ccb2447-3979-42bd-b20c-9aabfe2a17c7",
                                "id": "35c079f0-cafe-4d92-a848-ba362d55a441",
                                "name": "call_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40b8bbc2-e4fc-4cd0-9abb-1d2c5ca39961",
                                "id": "6decfc1d-d978-47a6-9326-45a35c17d5e3",
                                "name": "calldatetime",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d060888-5b48-4c1b-926c-aa69443f482c",
                                "id": "690d759f-6f5b-4408-ae96-4947ea6d0a45",
                                "name": "waittime",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23385639-6195-47f9-8d0b-760d5551d76f",
                                "id": "416c8340-e8fc-4b3a-90c7-a30ffcdc4623",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70e6b88d-6d9e-4798-9538-c93016423c90",
                                "id": "bc45452a-4080-4d88-992d-840110b534cc",
                                "name": "in_out",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f26b7246-07cf-4256-adbe-af5a8634cf96",
                                "id": "6672f1e7-28c6-42bd-b43c-89c76e3c46c5",
                                "name": "agent_num",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffb751af-ea7b-45ab-971d-44d388d8a5a7",
                                "id": "2694a2b4-6e6e-46ef-8d84-84e14b32b5f1",
                                "name": "work_sec",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "526694b3-8624-4e99-bb7a-b923e5003be0",
                                "id": "a1b210b7-5ead-4f72-b3de-bf23e9b551d2",
                                "name": "accountcode",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0b8b2e4-c5c3-441b-b074-e302615d0430",
                                "id": "4563c61f-ccc7-4e7c-a8ad-e7b171a1db18",
                                "name": "calldate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16c195c0-b919-4dfe-990b-e72e3771693d",
                                "id": "ee237214-d5c0-468e-9d39-9f46901e651e",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "032e3bf3-a115-49fc-a8b6-81079ad71177",
                                "id": "82a14491-65b2-406c-ad94-cbfd1a340bbc",
                                "name": "dst",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f1a5901-d946-4d6c-8777-d1274176edad",
                                "id": "bdeaaa00-02f9-438d-87cb-3d535afbf114",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ad758ac-8a00-4aa1-8f63-683df4be39e5",
                                "id": "248751fd-3f01-451b-8d8b-86add0de6343",
                                "name": "site_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "93db2437-53af-420a-8742-6ebe561befdb",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "d62eef4d-9734-4999-82cb-f247b4a1fe7b",
            "fullname": "MySql:9ffb9d00-96b0-4720-9cdf-df5e0c16e6a8",
            "type": "extract",
            "name": "9ffb9d00-96b0-4720-9cdf-df5e0c16e6a8",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "bea1a010-4e62-4f09-a965-00d8f03d8d29",
                        "id": "tq_qlZ48DKts",
                        "name": "FXVC_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "25eac574-92b9-417b-90c5-5196ce08f908",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "77410dc5-833b-4e55-8aee-ad723398c9e2",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "98472bbb-905a-45d7-959e-78c5a3f11484",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a9f5930-726c-4df8-98fa-9acb16765c51",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6457a98-f576-49bc-97f8-e42f93deb8f5",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8d8a93a-e2c0-4929-94eb-b7168cfde9f3",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e039fa6-1753-4e60-ba76-38c134c204a5",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a041c383-8ef7-4b76-b5cc-34c6432d3189",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53a2626d-ad31-4984-b293-9284b2804707",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f217d7f-2286-4f9e-bca1-7e217b61f252",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a53e8b10-308e-4641-882a-07a9a297c367",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9532e3a-822a-4414-be1b-dca945f02166",
                                "id": "extension_number",
                                "name": "extension_number",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc7599d2-41a6-420e-855d-70651d621cc1",
                                "id": "ftd_target",
                                "name": "ftd_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6eada852-ca17-4746-8cb1-1b66fc828d1a",
                                "id": "net_target",
                                "name": "net_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9a430b00-4fb8-4aa0-bf45-01a26de55d2f",
                                "id": "contract_target",
                                "name": "contract_target",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "234b2780-a5a5-4de4-a752-65b832fc6ae2",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\t1000 + brand.id as site_id,\r\n\tcase when brand.id = 5 then 'FXVC' else brand.name end as site_name,\r\n\tconcat(1000 + brand.id, '_10000_', `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tgroup_type.name as department,\r\n\tgroup_name.name as group_name,\r\n\tuser_dialer_extension.extension_number,\r\n\tsum( case when user_target.target_type_id = 1 then user_target.amount end ) as ftd_target,\r\n\tsum( case when user_target.target_type_id = 2 then user_target.amount end ) as net_target,\r\n\tsum( case when user_target.target_type_id = 3 then user_target.amount end ) as contract_target\r\nfrom\r\n\t`user`\r\nleft join (select a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\tuser_groups.user_id = `user`.id\r\nleft join `group` on\r\n\t`group`.id = user_groups.group_id\r\nleft join group_type on\r\n\tgroup_type.id = `group`.type_id\r\nleft join `group` group_name on\r\n\tgroup_name.id = (case when `group`.parent_id is null then `group`.id else `group`.parent_id end)\r\nleft join user_target on\r\n\tuser_target.user_id = `user`.id\r\n\tand DATE_FORMAT( user_target.created_at, '%y-%m' ) = DATE_FORMAT( CURRENT_DATE(), '%y-%m' )\r\nleft join user_dialer_extension on user_dialer_extension.user_id = `user`.id\r\nleft join user_brand on\r\n\tuser.id = user_brand.user_id\r\nleft join brand on\r\n\t1=1\r\nwhere user_dialer_extension.provider_id not in (2)\r\ngroup by\r\n\t1,\r\n\t2,\r\n\t3,\r\n\t4,\r\n\t5,\r\n\t6,\r\n\t7,\r\n\t8,\r\n\t9,\r\n\t10,\r\n\t11,\r\n\t12"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "f4c9ce1e-9731-443b-9a7d-fcf8c1328f3f",
                        "id": "tq_QrvXIe4WW",
                        "name": "FXVC_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "069822e8-a208-43a3-89e4-dab131634016",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25c9f618-8d80-4368-b31e-603c423f920e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a31a5b8-5270-4dbf-ac90-fdef91c9edc2",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5fdec76e-43be-4bf1-b1ed-ba38c489845d",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed7959af-4ad7-44c5-9ffe-901e66d1ad78",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05f4fff2-d68d-4b7f-ac48-e19c63c9cb93",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 40,
                                "precision": 40,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94839b63-140a-440a-b140-7b399d7e71ec",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5aa29e9b-b011-41fc-ba7b-504df6e1de3c",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ead5a8a-2730-4e8c-a9cf-50b14281d2cd",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 306,
                                "precision": 306,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b6fa5f0-825e-4f38-a3b9-d0a4875f2fc8",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8df61ac9-8f13-49e3-b9e5-feab65dac309",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d40a38f8-906a-4216-adc4-8f8ffa3cd2eb",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7dcd61dd-17e5-44ef-abcf-4051f85c8047",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "95615174-331a-4a9a-90cb-d29a563a9a7c",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d53be7b-297f-42fe-bd57-b15f8414d11d",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bed3b23f-2b9a-4b8b-b6b3-16a354d79de4",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8d5e1c9-f023-4aa3-ab6e-9d5e6b246bcc",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fe4cfe38-303e-4547-92c5-83f76cda83d6",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "baf6bc38-d128-4227-b382-8bdb6c044913",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b408a0e-917e-485a-b17b-344e2aa47a59",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9af16ca0-b7d8-4d3c-8ee6-3f4b82bf814f",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "391f49f0-a66f-4fd0-a46a-d8dc3e31957e",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3024b8f0-6e92-475c-98e7-193e39c03480",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5eae0c2c-df45-4eb1-b2a4-5efb1e5ea587",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc83fedd-de66-41cf-9303-e5cb2d3613ca",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b847362-6c61-408f-a41d-ba6fc8a65995",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "beab09fb-2b5b-4be0-92bf-f7be3a9c8aa7",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2cce39bb-dc0a-43d8-872c-98c47cc2aacb",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "61ae628e-7f21-44ac-9ef8-2785f7db15b1",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f4e7e0e3-3c09-41f9-a69c-ba2e65132198",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "342de58a-5a1e-49d6-8b48-f3c7fac71c15",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cc8a2306-844c-4993-8de8-557581d2ddd2",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee6ccd38-f65f-47d3-84d9-1b19b9b1bff6",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9a5471d-7455-46a2-8028-0ec9882c0c29",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c357c72b-f336-467e-9211-4117d1fcdfb7",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "96982420-c2ec-4da8-92bf-707211eb13ba",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8175ea47-daf2-4a7f-ab57-7ec6464e8779",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "13d32631-281c-4b98-b959-5aedbf8301d6",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b8675ed-856a-4fd7-8242-cdd75238f5d2",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73b71484-028c-409b-94b5-9b1dc9dd4ceb",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3f0f93a-0d0b-458f-9910-f460b81e2142",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f4ee510-2a6a-4066-a920-790c86d4c050",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4230e0f3-44cd-46fa-b526-f60d5e9b148d",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b2dcc26-ae6f-4b0d-a772-2b8085c755fb",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5a0d93ee-f9d2-4c18-a084-770b4c6d599d",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e5e2fac-99f3-4d51-8eea-fcbfde3c7cbe",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f134afb3-2232-4e44-a09d-c923ff635e63",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eda2d139-ddbe-445e-b14e-142bbb2c5168",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "753da2ee-6342-447e-97b8-2d8d4a09281b",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "77e656c3-80a0-49f6-8f94-4a7966d36fa2",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "cc83fedd-de66-41cf-9303-e5cb2d3613ca",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "909873b9-4119-4c3e-9840-959ade8be769",
                        "configOptions": {
                            "importQuery": "select\r\n\tcase when brand.id = 5 then 'FXVC' else brand.name end as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\tconcat( 1000 + brand.id, '_10000_', trader.id ) as customer_key,\r\n\tcast(trader.id as char) as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(COALESCE(1000 + brand_id, 1001), '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20200224 \r\n\t\tand trader_marketing_data.utm_aff_id = 94 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20200224 \r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tCOALESCE(acc_type.name,'BASIC') as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_1k_redepositor,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,196) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join brand on \r\n\ttrader.brand_id = brand.id \r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join trader_status on \r\n\ttrader.trader_status_id = trader_status.id \r\nleft join (select DISTINCT a.default_account_id , coalesce(sum(b.is_pre_auth),0) as is_pre_auth from trader a \r\nleft join transaction_deposit b \r\non a.default_account_id = b.trader_account_id \r\nwhere a.is_test = 0 \r\ngroup by 1 ) preauth \r\non trader.default_account_id  = preauth.default_account_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\t\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\tCOALESCE(transaction_deposit.payment_provider_id,0) not in (61,318,379,517,24,344,497,208)\r\n\t\tand COALESCE(transaction_deposit.psp_reference_id,'') <> 'CH SR Cashback' \r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end)) as days_from_last_deposit,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (select \r\ntrader_detail.trader_id, trader_detail.designated_brand, affiliate.name as aff_name \r\nfrom trader_detail\r\ninner join \r\n(select trader_id, max(id) as max_id from trader_detail group by 1) \r\ntrader_max on trader_max.max_id = trader_detail.id\r\nleft join affiliate on affiliate.id = trader_detail.affiliate_id\r\n) affiliate_table on affiliate_table.trader_id = trader.id \r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tcase when group_type.name = 'Branch' and `group`.name  = 'Cyprus EU' then 'Conversion' \r\n\t\t\t when group_type.name = 'Branch' then 'Retention' else group_type.name end as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) d on\r\n\t\t\tc.id = d.id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Cyprus EU' then 'Conversion' \r\n\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect a.id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) d on\r\n\t\tb.id = d.id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = (case when e.parent_id is null then e.id else e.parent_id end)\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect a.id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) d on\r\n\t\t\tc.id = d.id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Cyprus EU' then 'Conversion' \r\n\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect a.id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) d on\r\n\t\tb.id = d.id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = (case when e.parent_id is null then e.id else e.parent_id end)\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1) passed_to_ret on\r\n\tpassed_to_ret.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k, redeposit.is_redeposit\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date, 1 as is_redeposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select a.id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on `user`.id = \tuser_groups.id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand case when `group`.type_id = 4 and `group`.name  = 'Cyprus EU' then 5\r\n\t\t\t when `group`.type_id = 4 then 6 else `group`.type_id end = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (61,318,379,517,24,344,497,208)\r\n\tand COALESCE(transaction_deposit.owner_id,0) <> 17\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select a.id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on `user`.id = \tuser_groups.id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand case when `group`.type_id = 4 and `group`.name  = 'Cyprus EU' then 5\r\n\t\t\t when `group`.type_id = 4 then 6 else `group`.type_id end = 6\r\n\tand COALESCE(transaction_deposit.owner_id,0) <> 17\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\n\tleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (61,318,379,517,24,344,497,208)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\n\tleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_type on acc_type.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand trader.id not in (1235547,1235546)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619516c6fd9249002de3c52b",
                "provider": "MySql",
                "parameters": "WsI2hGSf+dwqwSmh3TwuaO5Wqyut2TolmY92AeMWG08Xb/qjvMSuJGDm7JgDb9ySN0Xzjcz6PcqDViRiguXgcyUcf67U5gmIeajObfUj6tad7qKg1ZyeZwUIoxukmQND00I4zC3BmvjqPn25FTUhgHP3RYM8ArHf/0HcoZWv1DmBWB+C7ubJWy8Uvvn0dZZ2wfbKHoMxLVw5QXqUnoA4Rcv4hPfy04GTGD4JjZKhQpG3q2QKft9MDNcPxMaq0dSx",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d7c95dc6-3ef8-4adb-9b7f-09ddf0d47480",
            "fullname": "MySql:88a3350b-629c-41c1-8025-d510e168de2b",
            "type": "extract",
            "name": "88a3350b-629c-41c1-8025-d510e168de2b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "31d088af-b8f1-4c1a-bb9d-cc519aac58fd",
                        "id": "tq_WD6KviktJ",
                        "name": "Wealth_Voicespin",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d54c287b-80fe-433c-abd6-b82d2d9da9c7",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cb1cba8-42a9-40a2-a762-f8527cf2bc2f",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d310043-23c6-48a3-9229-fac097e50a51",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5901b7e5-f2a3-4ab5-b766-57fffc7cf274",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aabacbff-afe5-4cee-ab2e-c630d08d58b6",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a1a2655-aa50-4486-8f3f-3aafbe9dfc6a",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68c90046-5d70-4888-a547-cda94e2da384",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9810e24-d52f-4db6-9a92-da33f5d09462",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32805833-0b89-45c6-bd5b-e811da26e34d",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cefda620-52f2-4bb6-84ff-2976847623db",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5772696c-91af-4f55-ac42-3c581adeba1c",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52a2b2ac-9450-469c-a099-5a0547724089",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "scale": 0,
                                    "precision": 0,
                                    "lastUpdated": "2021-11-30T09:31:31.499Z",
                                    "oid": "b3823437-cd79-4f5e-b2f4-2c835d42aa33",
                                    "hidden": false,
                                    "indexed": true,
                                    "expression": {
                                        "lastUpdated": "2021-11-30T09:31:31.499Z",
                                        "oid": "bd48357f-47a5-4560-85bd-92c40c037b9a",
                                        "expression": "lookup([TheWealthCore_Customers],[SiteName],[accountcode],[customer_id] )"
                                    }
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "6dda5b2e-64f8-4f95-b36b-b1ed57e27873",
                        "configOptions": {
                            "importQuery": "select\r\n\tcall_id,\r\n\tcalldatetime,\r\n\twaittime,\r\n\tconv_duration,\r\n\tin_out,\r\n\tagent_num,\r\n\twork_sec,\r\n\taccountcode,\r\n\tcalldate,\r\n\tuniqueid,\r\n\tdst,\r\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\r\nfrom\r\n\tprisa\r\nwhere\r\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a5ef4cfa70ed002ca32bb8",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLa+3h96MJVGDFcDTpISdQD6/3oIyPg3biWpKVDizOxsWXoCKcY3tZ5MDtZWA4CtA5lNHn3OFKLUJCgpNiudghqEgKlCdknDJ+2TDyVbKLdE0fj2hhbEHgkTUoWLhLQvA1oUcx0lJQuSPQp5/TwQS2n4pmG24iRBr8e5DeWw8zqmWNgkfCXY9mw3KeqfwQqVuiIxAnPDC46FiCMLJzFXgwSCkuR+8s5keRUI0xSA4LMKXNrDPU/k03Or/w2mIzEWs3U53ukqsZqMpTK+ViTzUnOc=",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "dd6527b2-1dc4-402f-bca2-80f694a71bb8",
            "fullname": "MySql:c18f052c-5672-485f-8244-551b0a71eceb",
            "type": "extract",
            "name": "c18f052c-5672-485f-8244-551b0a71eceb",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "05030847-342d-47e3-ad22-8c3a7c792b25",
                        "id": "tq_1g1F2PKd9",
                        "name": "WinGroup_Voicespin",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a47c46d0-6a5e-499e-ad11-55a44ea50495",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "981fcbb7-d08d-46ca-b037-b6298c652b31",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13e6ad54-00c4-428c-bdf4-a4009cd8bb6e",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "997ef12e-7ee9-4bfd-a204-583dc7f4ea47",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "914da692-3c4a-4173-a7c7-0e26067707ad",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d55a611-dc94-4f21-a0f3-10247626a878",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3af2608-7a82-4d82-83fa-517b23f5091d",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d89a2dc-f55c-4936-937b-b46e7473d16c",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f2ba65fd-79fe-458c-8b03-4cf994deb556",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f0c8df5-8cb2-4c69-8116-9d61b250a172",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0fc0172-fcf1-465e-a40f-4959085a0c0f",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8a8d082-43d1-4402-84d4-ea0a3bcaeffa",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "scale": 0,
                                    "precision": 0,
                                    "lastUpdated": "2021-11-30T09:03:21.970Z",
                                    "oid": "7fd7d5a7-fcbf-4ad2-b16b-dc9711d3d6f8",
                                    "hidden": false,
                                    "indexed": true,
                                    "expression": {
                                        "lastUpdated": "2021-11-30T09:03:21.971Z",
                                        "oid": "64440019-d318-4967-bcfd-d7e1c5c086af",
                                        "expression": "lookup([WinGroup_Customers],[SiteName],[accountcode],[customer_id] )"
                                    }
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "e915f157-5e8f-4e4d-8502-b5b47d66e934",
                        "configOptions": {
                            "importQuery": "select\r\n\tcall_id,\r\n\tcalldatetime,\r\n\twaittime,\r\n\tconv_duration,\r\n\tin_out,\r\n\tagent_num,\r\n\twork_sec,\r\n\taccountcode,\r\n\tcalldate,\r\n\tuniqueid,\r\n\tdst,\r\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\r\nfrom\r\n\tprisa\r\nwhere\r\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a5e8bdfa70ed002ca32bb3",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLa+3h96MJVGDFcDTpISdQD7u3XmlbtYp9v/8fBZHdMcj/n3Hx/t5Y4ejCsRyYSBQ30Whugq7DLLOwyHWeyRleU1TKVlmR/4Jvh/FjVfkblWe6APyAp6x16CR2ah0Yg8c15GieKjhcNTpy0nR+pE476+df+rOwYkat/hzTeWED3xuMlGCovung/4Ia5CJSRClcKUpWsW71VNEBCf8Zh0rZ/l1dr1Jr5MSyNrXIvJ4DuH2",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "e7a77cfd-a738-4308-bc8d-e7d457a6be7e",
            "fullname": "c117ac42-ee35-4461-a698-8c271a3977fc",
            "type": "custom",
            "name": "c117ac42-ee35-4461-a698-8c271a3977fc",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d9285a98-064b-40a9-b912-0db201748f7b",
                        "id": "Customers_duplicates",
                        "name": "Customers_duplicates",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "70b28730-985f-433a-befb-bc5f905e6c0a",
                            "expression": "select count(customer_id) as count_customers , count(distinct customer_key) as count_distinct_customers\nfrom customers"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "30c74412-ba3a-4f74-b0c4-a1d7fa895bc6",
                                "id": "42e0c1a0-d53a-4875-8c6e-d87c6b011f66",
                                "name": "count_customers",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7f205ed-a260-47ae-9ba2-069176837572",
                                "id": "caf90f36-138a-4428-94a3-c984a20724eb",
                                "name": "count_distinct_customers",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "d67dc55b-1319-4cd7-be88-7f3304eed171",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "ea870d07-308e-4c6d-859e-472dcc991e8c",
            "fullname": "MySql:552ec14c-25de-4891-84a6-5a2e51e85246",
            "type": "extract",
            "name": "552ec14c-25de-4891-84a6-5a2e51e85246",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "968044d7-1689-4753-8e63-831469528c12",
                        "id": "tq_zy91ZonmB",
                        "name": "Prime_Calls",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0ce244e8-2783-4aa1-a088-e4c3da74edd0",
                                "id": "call_id",
                                "name": "call_id",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "add23d89-b3a2-4262-8837-c79a3412ee3b",
                                "id": "calldatetime",
                                "name": "calldatetime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e7f83b3-0dc1-4d40-8ada-143e85fc372d",
                                "id": "waittime",
                                "name": "waittime",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6bccb65-a089-4bcb-97cc-b3fe5a0a136a",
                                "id": "conv_duration",
                                "name": "conv_duration",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c90bc43f-3c0d-4922-a620-43a437022804",
                                "id": "in_out",
                                "name": "in_out",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b52531ba-2c3c-4ff3-b2ad-90e842729f30",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3e97d5e-63db-4709-9fcb-30331226d3fb",
                                "id": "work_sec",
                                "name": "work_sec",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96b4aa6b-4852-4f41-affc-46e0654f6a64",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bce7680a-6e80-4497-afc7-bdfdb4f096c4",
                                "id": "calldate",
                                "name": "calldate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32fb2400-c503-483e-8970-2e607b805199",
                                "id": "uniqueid",
                                "name": "uniqueid",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49c47be9-c732-47d8-9643-1c46df77a8f2",
                                "id": "dst",
                                "name": "dst",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b746801-7705-458c-b183-f150e0f39ee5",
                                "id": "call_time_duration",
                                "name": "call_time_duration",
                                "type": 18,
                                "size": 13,
                                "precision": 13,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "id": "site_name",
                                    "name": "site_name",
                                    "type": 18,
                                    "size": 0,
                                    "scale": 0,
                                    "precision": 0,
                                    "lastUpdated": "2021-11-29T13:33:17.433Z",
                                    "oid": "a833c6bf-6e78-490a-ac0e-35d65e6af5f2",
                                    "hidden": false,
                                    "indexed": true,
                                    "expression": {
                                        "lastUpdated": "2021-11-29T13:33:17.433Z",
                                        "oid": "1fb62be8-5e32-46de-924b-feabb02b07a2",
                                        "expression": "lookup([PrimeOTCustomers],sitename,accountcode,customer_id)"
                                    }
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": true,
                        "vTag": "1a6e54ea-6631-40df-9906-99d78d4e52f3",
                        "configOptions": {
                            "importQuery": "select\r\n\tcall_id,\r\n\tcalldatetime,\r\n\twaittime,\r\n\tconv_duration,\r\n\tin_out,\r\n\tagent_num,\r\n\twork_sec,\r\n\taccountcode,\r\n\tcalldate,\r\n\tuniqueid,\r\n\tdst,\r\n\tTIME_FORMAT(SEC_TO_TIME(conv_duration), '%H:%i:%s') as call_time_duration\r\nfrom\r\n\tprisa\r\nwhere\r\n\tcalldatetime >= date_format(now() - interval 2 month, '%Y-%m-01')"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a4d676356021002c50aabf",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLa+3h96MJVGDFcDTpISdQD5cPAB7pi6Xi5MdTRnWI950olja2R1g79NLgbxlMCzujQk/Io4iYidcUJVdMU9Zd/p+fjKXo9pVCRWJdLZf3IUIzOR/pX7nOepzCUoPrYojC7p2D/3ZPPcrUi5fSdDVpzkBj24foukxx9pof8BG/nrR6SAZPTNBQGuyMYxz4M1Chmr/PP4UyGdLAg6plsLrl1k=",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fe47c4ec-9724-47a7-bdd9-bd9af4e7d072",
            "fullname": "MySql:a487303c-14e6-4d24-a577-c0a794c83d2e",
            "type": "extract",
            "name": "a487303c-14e6-4d24-a577-c0a794c83d2e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4bba264c-67e8-4c57-83dd-b9f33a54807d",
                        "id": "tq_RiN5bRsh6",
                        "name": "BitfinityFX_Customers",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1cb88d47-1b13-428b-a727-4a9e6838f843",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "432174ea-aade-4d71-aec4-3af3e405a108",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb462704-01df-4f6d-8c43-86624e753666",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb1f0414-d3af-49e9-a35e-2e7fd20dc489",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69b81da1-63a1-4b27-9a3c-eba70d3f993c",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac39bedd-a8e8-4ef4-9867-677e5d0535b0",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 39,
                                "precision": 39,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad702537-1474-4ca5-8391-ce71302681b6",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d6c81ba-42e0-4f53-8f76-c5e32afdb5f3",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47b5e437-ce79-41e3-9384-87100f431957",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "769b516c-b89a-46d2-97cf-af0c2719ef07",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1ce9618-473f-4188-b4c5-82bdacb0c98f",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b34c08cb-f5f0-489e-8aa5-cd5dd9edba85",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c159969-3de2-4191-977e-45cc1c75c358",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86aa0fff-e0f7-462f-b207-18b90437ec56",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4620a26-2d32-4712-8eb9-21f7bd88c2a4",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cd73795-cd66-4e95-9a48-ce1859c9c93f",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38423019-771e-4e16-90e9-9e29590da5ea",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fb0c2732-4a2f-46f1-ae4b-b243d1e5e715",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "73dd2118-8f88-4a7c-8dd4-603de5e51b86",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f0072266-204c-4aa7-a6c4-b11449cc1bd8",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2572b4ee-0375-4bfe-86b4-a7c9ce7b83e2",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1b22a42-f1de-4f42-b247-e150c3ffaede",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3008e517-e3dc-411e-89e6-4e3a4c62d3ec",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8422316d-f058-4e45-b54a-16ea524d1595",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d23801e0-0c5b-46e2-9b05-3e345091e65b",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b53b584-1082-4243-b557-239c23bb7b97",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a6d3779-f924-4c06-a1e1-f40983a47ac3",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c0d317c-2771-42e9-9b1e-dc093cbd572d",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97998164-b110-4c30-8a95-752f1e9991d1",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3bf8356f-4e52-43e2-bd7e-c550a303744d",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cc86c13-c64a-454e-8663-ccffd74264ef",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ddecd1b-6d90-4236-b88b-1c71d4c638cf",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "885e2e38-7e64-48fb-81ab-d7809387955f",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f9c982e-a58e-474c-b556-0d7f31ef0c22",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bfd344d3-ca81-4125-891c-505c70310d11",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f11f0ffd-2d85-448a-b739-613ea14a3eb6",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6cd00a37-77e6-469a-b179-6af57997bf63",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eab236f5-8aa1-43cf-9986-849aa3a64a11",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fe8d9ae-e32b-4420-8e38-2f89d6b2e985",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f48f2eb-212f-4d74-82d5-e5bcedb3c5c6",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01feb648-f1c1-4ade-9cc7-50f3301bfc51",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "453e038a-cd2b-43a9-86da-b8ace7feca08",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "422fb14d-1d85-477d-ab5f-c6b9cbfdc25f",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fdab44e1-0682-4959-ac8d-75b1f681ac8e",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "083abc19-5dc9-4bbc-87ba-dd1a5c415e92",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11b45513-0cfe-4782-b723-ef82ac12bbd9",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ee16885-fb0f-4376-856e-80cb5a8963ec",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "367b7e25-1c7e-405f-9a70-97d1bfbcbe50",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca54cda3-c4a3-4366-a66b-5595922b54da",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74c5bfec-c632-44ea-a614-9e7f331fd14d",
                                "id": "is_selfie",
                                "name": "is_selfie",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "cb1f0414-d3af-49e9-a35e-2e7fd20dc489",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "d23801e0-0c5b-46e2-9b05-3e345091e65b",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "7783f98d-79b7-4524-b32b-b47e7542eec1",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand_id as site_id,\r\n\tconcat(1000 + brand_id, '_10000_', trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat(1000 + brand_id, '_10000_', COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\t'test' as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),FTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(), transaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,0) as is_redeposit_1k,\r\n\tcase when is_selfie.owner_id is not null and is_selfie.owner_id in (0,377) then 1 else 0 end as is_selfie\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t    max(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\n\t\tinner join brand on\r\n\t\t\ttrader.brand_id = brand.id\r\nleft join (select first_deposit.trader_account_id, COALESCE(transaction_deposit.owner_id,0) as owner_id\r\n\t\tfrom\r\n\t\t(select a.trader_account_id, min(a.id) as ftd_id\r\n\t\tfrom transaction_record a\r\n\t\tinner join transaction_deposit b on a.id = b.ftr_id\r\n\t\twhere COALESCE(b.payment_provider_id,0) not in (24,32)\r\n\t\tgroup by 1) first_deposit\r\n\t\tinner join transaction_deposit on first_deposit.ftd_id = transaction_deposit.ftr_id\r\n\t) is_selfie on is_selfie.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 112, 10012, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tgroup_type.name as department,\r\n\t\tgroup_name.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_name on\r\n\t\tgroup_name.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand case when f.name = 'Branch' and e.name  = 'Serbia Con' then 'Conversion' \r\n\t\t\t\t when f.name = 'Branch' then 'Retention' else f.name end = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\t\tselect user_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\n\tleft join (\r\n\tSELECT redeposit.id, case when redeposit_1k.total_retention_deposit >= 950 then 1 else 0 end as is_redeposit_1k\r\n\tfrom\r\n\t(select trader.id, min(transaction_record.id) as redeposit_id, min(transaction_record.created_at) as redeposit_date\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by 1) redeposit\r\n\tinner join\r\n\t(select trader.id, date_format(transaction_record.created_at,'%Y-%m') as 'year_month', sum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\tfrom transaction_record\r\n\tinner join transaction_deposit on transaction_record.id = transaction_deposit.ftr_id\r\n\tinner join trader on transaction_record.trader_account_id = trader.default_account_id\r\n\tinner join `user` on transaction_deposit.owner_id = `user`.id\r\n\tinner join (select user_id, min(group_id) as group_id from user_group group by 1) user_groups on `user`.id = \tuser_groups.user_id\r\n\tinner join `group` on `group`.id = user_groups.group_id\r\n\twhere trader.is_test = 0\r\n\tand `group`.type_id = 6\r\n\tgroup by 1,2) redeposit_1k on redeposit.id = redeposit_1k.id and date_format(redeposit.redeposit_date,'%Y-%m') = redeposit_1k.`year_month`\r\n\t)redepositor on redepositor.id = trader.id\r\n\tleft join (select trader_id, min(created_at) as first_request_date from transaction_withdraw group by 1) transaction_withdrawals on transaction_withdrawals.trader_id = trader.id\r\nwhere\r\n\ttrader.is_test = 0\r\n\tand case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a4de22356021002c50aac5",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8C2q0mVY+o2WF4+UVAyIhGiWhSY3+Y93kyI+zrKj2Bg5HiBiNB45Ta2GGPAsEoYp8/7dK0B1NeCzhErO6Xxg3c338i0MevnkC9Yi9QGlRnh1xn5Kjp5TuCxX28iusyU+paJ5wPXzkAPGHPDNhGasnoxvMsxipUWeTclTSatITjv9eQNNH4tFpXr1gskkcrIfglENUveS4Og+oLFLIuz1xQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ff9604a9-1a62-42d3-8737-0a8f03954481",
            "fullname": "9e4b9f52-d06c-405a-a3ac-17e4ecb62152",
            "type": "custom",
            "name": "9e4b9f52-d06c-405a-a3ac-17e4ecb62152",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "59ab80eb-bdc3-460a-9649-8f9e3b87e790",
                        "id": "FXVC_Agent_Stats",
                        "name": "FXVC_Agent_Stats",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "b56074bb-f758-4858-976e-1cf5623bf117",
                            "expression": "select calls.*,\ntostring(employees.site_id) +'_'+ tostring(calls.agent_num) +'_'+ tostring(employees.employee_id) as ext_employee_key,\ncalls.site_name + '_10000_' + accountcode as customer_key\nfrom \n(\nselect * from [FXVC_Agent_Stats_voicespin]\nunion all\nselect * from FXVC_Int_Coperato_Agent_Stats\n) calls\nleft join employees on calls.agent_num = employees.extension_number and employees.site_name = calls.site_name"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "62afa18b-695d-4e2b-8877-7321d4570414",
                                "id": "agent_num",
                                "name": "agent_num",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72c48509-cd73-4ec1-a612-0dad49eeff1c",
                                "id": "calldatetime_key",
                                "name": "calldatetime_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a307881d-545e-47fb-b9dc-6b48f3ab5063",
                                "id": "First_CallTime",
                                "name": "First_CallTime",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db9c436a-07e5-44d5-9004-4d667464e4d7",
                                "id": "Last_CallEnd",
                                "name": "Last_CallEnd",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f71a89d-8845-4155-aaa6-d7a3276938e2",
                                "id": "Log_Time",
                                "name": "Log_Time",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d89181d-d716-403b-93bc-e75ea6c9dfad",
                                "id": "GrossPhoneTime",
                                "name": "GrossPhoneTime",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6f8c0e8-634f-4099-9603-b69dd7115ffa",
                                "id": "NetPhoneTime",
                                "name": "NetPhoneTime",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "125e1781-9b6f-4ec2-ae5f-288748e2a6b1",
                                "id": "Idle_Time",
                                "name": "Idle_Time",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbe5a19f-b6db-4473-be17-af7d240de504",
                                "id": "Time_Active(Gross)",
                                "name": "Time_Active(Gross)",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07bce0b0-768e-4457-b9f0-82d2a6cafd35",
                                "id": "Outgoing_Calls",
                                "name": "Outgoing_Calls",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9ebabbed-787a-45fd-972f-b5acea3c032f",
                                "id": "Successful_Calls_30s",
                                "name": "Successful_Calls_30s",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5179a233-37d9-4e28-854d-c33bcd2c40a6",
                                "id": "Successful_Calls_90s",
                                "name": "Successful_Calls_90s",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "752ffeb8-474b-460c-a10d-3018b7445080",
                                "id": "Success30s%",
                                "name": "Success30s%",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f316433-3b71-489c-b6d6-d8c63e45f5d9",
                                "id": "Success90s%",
                                "name": "Success90s%",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "493901bf-901c-4153-9c74-a17a028313de",
                                "id": "Effective_Calls_3min",
                                "name": "Effective_Calls_3min",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30187edd-2f06-43ed-a034-d34c364609d6",
                                "id": "Effective_Calls_5min",
                                "name": "Effective_Calls_5min",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b8de3bc-9972-4a8c-9042-6809eb7dfc2e",
                                "id": "Effective_Calls_8.5min",
                                "name": "Effective_Calls_8.5min",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "86ed9975-36dd-474c-8485-1bd9ef0a08b1",
                                "id": "Effective5min%",
                                "name": "Effective5min%",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec38791e-1052-425e-a782-64ba15877cea",
                                "id": "Effective8.5min%",
                                "name": "Effective8.5min%",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c873373-5c05-4905-af2f-a6ff5d75a9f0",
                                "id": "accountcode",
                                "name": "accountcode",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35c404ef-084c-46a2-8d3f-2dca51e74b80",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31d5332f-e268-4ba4-a02e-875862335843",
                                "id": "1e8cb2a9-4ad1-486c-9044-39ebf4ad130a",
                                "name": "ext_employee_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9503a5cd-0c78-4d0a-9daa-1f37be49044f",
                                "id": "9eb62bf9-22d5-4cb6-b058-1bfa3c8bd0f9",
                                "name": "customer_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "b0aa1cf7-97ea-4d72-a26b-378c55974cf3",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        }
    ]
}