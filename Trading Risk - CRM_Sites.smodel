{
    "title": "Trading Risk - CRM_Sites",
    "type": "extract",
    "buildDestination": {
        "destination": "elasticube"
    },
    "fiscal": "system",
    "relations": [
        {
            "type": null,
            "columns": [
                {
                    "dataset": "fa245316-9fd0-4f0e-88ff-654e4daeed34",
                    "table": "c9e89f70-fc4c-4238-8a43-7b47f2bc152f",
                    "column": "af43c4f3-1b41-4da3-84ec-32d06a727923"
                },
                {
                    "dataset": "d25a2cd3-960f-4f0c-a314-829e41d53e56",
                    "table": "eb6568a7-f125-45ee-964f-f388fd64d751",
                    "column": "a578deda-5d91-4e85-b57a-bd8f25ae0a37"
                },
                {
                    "dataset": "ff6a4d91-e41b-4fdd-91c5-310841e1f9ff",
                    "table": "bfefee73-3a98-45c3-9c54-74967cc3b08d",
                    "column": "b9f58912-7e3c-42b4-9bf1-1006e82ffc69"
                },
                {
                    "dataset": "00665008-bd51-4a38-8c95-b9b8994741e1",
                    "table": "94c83851-1650-4e54-a014-017823021d17",
                    "column": "f98d6510-b9a5-4a01-bfa8-5c13f0b28f27"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "d6ce6f76-f1fa-4840-9a3a-7504d9c89427",
                    "column": "56e80ae8-8064-49f2-b7df-db1f2a07c60f"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "2d0f16f2-7db5-4100-8fce-794181bbe2c1",
                    "column": "913eb826-00fe-41d8-b590-73b4ba89d58a"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "7c22a03c-63a1-4d02-a2ae-a9efe07e8aef",
                    "table": "078bc294-f253-4e25-91a5-7a49b6c1bddc",
                    "column": "8a69ff35-32b5-4778-bd25-36e72ba7d581"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "d6ce6f76-f1fa-4840-9a3a-7504d9c89427",
                    "column": "ce40f0b3-bea9-4a0d-9f46-309343f0e6e7"
                },
                {
                    "dataset": "ff6a4d91-e41b-4fdd-91c5-310841e1f9ff",
                    "table": "bfefee73-3a98-45c3-9c54-74967cc3b08d",
                    "column": "81d1a99e-c5c7-4b42-845c-82024f04f5bb"
                },
                {
                    "dataset": "00665008-bd51-4a38-8c95-b9b8994741e1",
                    "table": "94c83851-1650-4e54-a014-017823021d17",
                    "column": "2b2ad8ab-1d90-495b-9969-eca8f8a9a62c"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "2d0f16f2-7db5-4100-8fce-794181bbe2c1",
                    "column": "0f2297be-1ad6-42eb-9fbc-00810c5d56cf"
                },
                {
                    "dataset": "d25a2cd3-960f-4f0c-a314-829e41d53e56",
                    "table": "eb6568a7-f125-45ee-964f-f388fd64d751",
                    "column": "80913fc7-7aef-423d-b2dd-322db13cbdbb"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "ec878bef-0cb1-4a22-9f5d-a8d2b2192194",
                    "table": "f751a92e-17cb-49e6-8662-e4dc5cfe1437",
                    "column": "ba551f79-9ac3-435a-8b33-35d5a7508b88"
                },
                {
                    "dataset": "ff6a4d91-e41b-4fdd-91c5-310841e1f9ff",
                    "table": "bfefee73-3a98-45c3-9c54-74967cc3b08d",
                    "column": "2f7eb981-a6c7-46c8-a7fa-28dd5dc6f438"
                },
                {
                    "dataset": "00665008-bd51-4a38-8c95-b9b8994741e1",
                    "table": "94c83851-1650-4e54-a014-017823021d17",
                    "column": "23e36e02-4eab-4877-a432-5a576cd0705a"
                },
                {
                    "dataset": "d25a2cd3-960f-4f0c-a314-829e41d53e56",
                    "table": "eb6568a7-f125-45ee-964f-f388fd64d751",
                    "column": "50b62675-b3cf-45e1-8abb-f676e3f40b95"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "2d0f16f2-7db5-4100-8fce-794181bbe2c1",
                    "column": "3bb22e12-6d60-4214-9ee8-89f74ef1c4e1"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "d6ce6f76-f1fa-4840-9a3a-7504d9c89427",
                    "column": "d108759a-3496-48fc-8d8b-17b05b306375"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "d9da6d28-a053-44db-bb86-3bc83c5552de",
                    "table": "f6aa74bc-8ecf-48eb-beb6-2a6faedb3581",
                    "column": "78186718-d173-40c7-b9ee-e5c07b3942d6"
                },
                {
                    "dataset": "ff6a4d91-e41b-4fdd-91c5-310841e1f9ff",
                    "table": "bfefee73-3a98-45c3-9c54-74967cc3b08d",
                    "column": "41505ee6-be21-4344-85da-b3f05e6c003a"
                },
                {
                    "dataset": "00665008-bd51-4a38-8c95-b9b8994741e1",
                    "table": "94c83851-1650-4e54-a014-017823021d17",
                    "column": "1276251b-1a14-4557-b321-9921fa5ad37c"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "2d0f16f2-7db5-4100-8fce-794181bbe2c1",
                    "column": "9fdb6b79-1610-4411-9784-f14463713354"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "d6ce6f76-f1fa-4840-9a3a-7504d9c89427",
                    "column": "e84dd422-fb9f-4d84-968f-5e60ca3971de"
                },
                {
                    "dataset": "d25a2cd3-960f-4f0c-a314-829e41d53e56",
                    "table": "eb6568a7-f125-45ee-964f-f388fd64d751",
                    "column": "2637848c-4d73-4aa1-80ea-d8024aecaed5"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "ff6a4d91-e41b-4fdd-91c5-310841e1f9ff",
                    "table": "bfefee73-3a98-45c3-9c54-74967cc3b08d",
                    "column": "a4500fed-6c88-48d1-975d-27fbc4e00dc4"
                },
                {
                    "dataset": "92ed9e15-7f96-402c-a94f-34c4dbfc748f",
                    "table": "eb6b582b-fac6-4b39-9730-74257353162d",
                    "column": "526d1e68-7141-4198-b5a5-41d51651e338"
                },
                {
                    "dataset": "00665008-bd51-4a38-8c95-b9b8994741e1",
                    "table": "94c83851-1650-4e54-a014-017823021d17",
                    "column": "8b6c6af7-73b2-4591-989e-2e753a297355"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "2d0f16f2-7db5-4100-8fce-794181bbe2c1",
                    "column": "bc2a3ed5-62f2-4f93-81b1-d86667f4a500"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "d6ce6f76-f1fa-4840-9a3a-7504d9c89427",
                    "column": "abfe35ca-953e-4e08-ba7d-177d59c441a3"
                },
                {
                    "dataset": "d25a2cd3-960f-4f0c-a314-829e41d53e56",
                    "table": "eb6568a7-f125-45ee-964f-f388fd64d751",
                    "column": "6d2fd376-a55a-448f-9fd7-94b20e305b33"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "dcb2d159-30a7-4f5d-a31f-9aff15ecb7b1",
                    "table": "e49d15d0-31f3-43bb-9b7c-2ff8bb6bce4a",
                    "column": "1f2565a1-5ac2-4662-8fe7-de50de786267"
                },
                {
                    "dataset": "d25a2cd3-960f-4f0c-a314-829e41d53e56",
                    "table": "eb6568a7-f125-45ee-964f-f388fd64d751",
                    "column": "81041aed-68d2-4234-9dde-2011e5c041f1"
                },
                {
                    "dataset": "00665008-bd51-4a38-8c95-b9b8994741e1",
                    "table": "94c83851-1650-4e54-a014-017823021d17",
                    "column": "01e5661d-b15e-401f-b1c5-b2a4b1dcb66a"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "d6ce6f76-f1fa-4840-9a3a-7504d9c89427",
                    "column": "eedcc67b-f4c6-47b6-9128-8f3ed7a394db"
                },
                {
                    "dataset": "848fd579-e837-446f-afeb-91ac271d4f6b",
                    "table": "2d0f16f2-7db5-4100-8fce-794181bbe2c1",
                    "column": "446946c1-5539-450d-8cf4-1cd0de724fed"
                },
                {
                    "dataset": "ff6a4d91-e41b-4fdd-91c5-310841e1f9ff",
                    "table": "bfefee73-3a98-45c3-9c54-74967cc3b08d",
                    "column": "fb900b76-47b5-495f-ab52-28f20a823b91"
                }
            ]
        }
    ],
    "datasets": [
        {
            "oid": "0024e575-a88e-4d6e-9813-d479fadbc92d",
            "fullname": "MySql:ae008f00-3531-4d29-a32a-32656e30fae1",
            "type": "extract",
            "name": "ae008f00-3531-4d29-a32a-32656e30fae1",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5328a56da002c36c654",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFL6czB0CGbzkCaBUw+ZXoqcNee235Svk4bYIKmOxmfPKvz/IKZSnvsxykz7VlQXl9sCIXqwArPxFie6FTw/8+52XMLXO7uFglHMTGaJKI92RhOHN+UoCe2DRjs2B+27H2w==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "00665008-bd51-4a38-8c95-b9b8994741e1",
            "fullname": "47b277ba-7a9b-43bc-9b47-0a24bc3b6a9a",
            "type": "custom",
            "name": "47b277ba-7a9b-43bc-9b47-0a24bc3b6a9a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "94c83851-1650-4e54-a014-017823021d17",
                        "id": "PositionsClose (1)",
                        "name": "PositionsClose",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "73b48a0b-c609-429a-bee3-89d861021cbd",
                            "expression": "select\r\n\t[positions_tp].*,\r\n\t(\r\n\t\tcase\r\n\t\t\twhen [Positions_crm_union].wide_currency_amount <> 0 then [Positions_crm_union].wide_currency_amount\r\n\t\tend\r\n\t) * (\r\n\t\t- 1\r\n\t) as close_pnl_usd,\r\n\tpositions_tp.[close_pnl_curr] - positions_tp.[swap] as booked_pnl_curr,\r\n\tcase when positions_tp.[close_pnl_curr] > 0 then 'losing'\r\n\twhen positions_tp.[close_pnl_curr] < 0 then 'winning'\r\n\tend as trade_status,\r\n\tpositions_tp.[close_pnl_curr] - positions_tp.[swap] as booked_pnl_curr,\r\n\tgetyear(\r\n\t\tpositions_tp.[close_time]\r\n\t) * 10000 + getmonth(\r\n\t\tpositions_tp.[close_time]\r\n\t) * 100 + getday(\r\n\t\tpositions_tp.[close_time]\r\n\t) as close_time_key,\r\n\tcoalesce([Positions_crm_union].employee_key,'-100') as employee_key,\r\n\t\tleft(tostring([positions_tp].open_time),length(toString([positions_tp].open_time))-7) as open_time_str,\r\n\t    left(tostring([positions_tp].close_time),length(toString([positions_tp].close_time))-7) as close_time_str,\r\n\t\tleft(tostring([positions_tp].[client_close_time]),length(toString([positions_tp].[client_close_time]))-7) as client_close_time_str,\r\n\t\tleft(tostring([positions_tp].[client_open_time]),length(toString([positions_tp].[client_open_time]))-7) as client_open_time_str,\r\n        SecondDiff([positions_tp].close_time,[positions_tp].open_time)  as sec_diff_from_close_to_open,\r\n\trate_open * qty as weighted_avg_help,\r\n\tcase\r\n\t\t\twhen not isnull([Positions_crm_union].unique_id) then [Positions_crm_union].order_type\r\n\t\tend as order_type,\r\n\t[sites].site_name\r\nfrom\r\n\t[positions_tp]\r\nleft join [Positions_crm_union] on \r\n[positions_tp].unique_id = [Positions_crm_union].unique_id\r\nleft join [sites] on \r\n[sites].site_id = [positions_tp].brand_id"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a24cc3d1-e139-4bb7-82c7-0fba16b7d910",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b000fdc-a244-4cfe-b14b-e4995004727c",
                                "id": "ref",
                                "name": "ref",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5b0a3a8-e940-4828-988d-540c941c53f1",
                                "id": "type",
                                "name": "type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "952b4970-9be1-48c8-b837-161fbe640291",
                                "id": "type_desc",
                                "name": "type_desc",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3dc5ab2c-9e23-4db5-b17f-c232f1b72702",
                                "id": "open_by_device",
                                "name": "open_by_device",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01e5661d-b15e-401f-b1c5-b2a4b1dcb66a",
                                "id": "status",
                                "name": "status",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "23e36e02-4eab-4877-a432-5a576cd0705a",
                                "id": "account_id",
                                "name": "account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5c720e3c-9f45-47f8-a91c-9831e8d70617",
                                "id": "direction",
                                "name": "direction",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "895fd906-e29d-4021-aadc-1061830d9c8d",
                                "id": "order_time",
                                "name": "order_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fd2a441b-04fb-462a-8473-841ac4c06af9",
                                "id": "open_time",
                                "name": "open_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "364a3a4e-12d8-4508-8d32-4a48bc62bb93",
                                "id": "client_open_time",
                                "name": "client_open_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "25419a83-dcf2-41b3-aa0c-da0c22bd61cc",
                                "id": "close_time",
                                "name": "close_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e577d8d-e5f1-4265-b217-ef8757d40839",
                                "id": "client_close_time",
                                "name": "client_close_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "68ea12fc-9cf1-48cd-8096-21e74172a725",
                                "id": "expire_time",
                                "name": "expire_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14582b25-c370-4bc7-b4dc-c825ac716f0c",
                                "id": "trade_configuration_id",
                                "name": "trade_configuration_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "48c51d34-7d37-4c69-8575-4c89a3fa8203",
                                "id": "qty",
                                "name": "qty",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a004c73e-1a1f-4ba1-b2cc-3cea8fcdb946",
                                "id": "margin_initial",
                                "name": "margin_initial",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cc5ddd74-63f9-49c5-9cc1-129afbc31625",
                                "id": "margin_maintenance",
                                "name": "margin_maintenance",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6bf47a43-15cd-4d6b-807e-49bb2e3e8fd2",
                                "id": "rate_order",
                                "name": "rate_order",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0c5845d6-0fc1-4e59-82f9-fc7200f34c4b",
                                "id": "rate_open",
                                "name": "rate_open",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8a0d23e6-bb71-45eb-81ee-5ad8fe733cbb",
                                "id": "client_rate_open",
                                "name": "client_rate_open",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c4c569a1-9748-45e4-98bc-58cf27608ec0",
                                "id": "rate_close",
                                "name": "rate_close",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a151af5-6ddf-448e-8e22-6b1c4c29c47f",
                                "id": "client_rate_close",
                                "name": "client_rate_close",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "34b9b76a-920e-42a5-95ca-cc8b39f6e0cc",
                                "id": "stop_lost_amount",
                                "name": "stop_lost_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "755af551-d754-44dd-881b-5d37b34f0dd0",
                                "id": "stop_lost_rate",
                                "name": "stop_lost_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "429ab173-ae86-412b-8011-8d607a074e66",
                                "id": "take_profit_amount",
                                "name": "take_profit_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "222894fb-d4b0-4552-9e2c-58348fd09fd1",
                                "id": "take_profit_rate",
                                "name": "take_profit_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b4ae8d5-a7e8-4215-ace0-13758f4c58fc",
                                "id": "overnight_commission",
                                "name": "overnight_commission",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8247686a-a858-4fb1-bdfc-af115591435b",
                                "id": "close_pnl_curr",
                                "name": "close_pnl_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b37e3753-3a0b-460e-a381-f928319c5046",
                                "id": "close_by_crm_user_id",
                                "name": "close_by_crm_user_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d924b15a-43a2-4ee1-82e3-9dc013f4a638",
                                "id": "close_reason_type",
                                "name": "close_reason_type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ddb0fb90-6ada-409b-8e63-af812b2e0b04",
                                "id": "close_reason_desc",
                                "name": "close_reason_desc",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb87353d-6cff-4a14-a7b1-5c45022d1639",
                                "id": "last_edit_time",
                                "name": "last_edit_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e7cadf3c-5f3f-42d5-9b00-3b0ef31c300f",
                                "id": "latency_open",
                                "name": "latency_open",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a9f34ef1-ab43-4611-bff2-d3bc636d923a",
                                "id": "latency_close",
                                "name": "latency_close",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a85b505c-bf83-41d4-8c80-aac509a65609",
                                "id": "reject_err_id",
                                "name": "reject_err_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ebeeabc1-45ac-452a-9597-4fdae4faec4d",
                                "id": "reject_err_desc",
                                "name": "reject_err_desc",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6205084e-663e-451c-9162-cb1aee530e68",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01f56bf8-624b-4f6c-a566-ac5405ae7ae5",
                                "id": "brand_currency_vol",
                                "name": "brand_currency_vol",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "015e48ef-ea05-416b-8585-591eaa292450",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1276251b-1a14-4557-b321-9921fa5ad37c",
                                "id": "instrument_id",
                                "name": "instrument_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e406307-35cc-41e7-bd74-29626a9146fb",
                                "id": "display_name",
                                "name": "display_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f38134e-eef7-43b5-b7b1-442982c33513",
                                "id": "unit_type",
                                "name": "unit_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00e5d87d-28eb-469a-b920-cb9a3839a89a",
                                "id": "qty_min",
                                "name": "qty_min",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e6635f9-d569-4e48-8a70-e5814f696227",
                                "id": "qty_max",
                                "name": "qty_max",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d0457b7c-9bf0-478b-9f92-d4e494b08efd",
                                "id": "qty_steps",
                                "name": "qty_steps",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6cbfc676-2b04-44dc-a8a7-88306c3366bd",
                                "id": "sell_overnight_commision",
                                "name": "sell_overnight_commision",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a9215541-790a-4555-b64f-bc580adec65d",
                                "id": "buy_overnight_commision",
                                "name": "buy_overnight_commision",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5b75cd30-a423-4ece-902f-bd153540ef5b",
                                "id": "ask_type",
                                "name": "ask_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b365309d-1b02-4e80-921c-4f8c431ea243",
                                "id": "ask_val",
                                "name": "ask_val",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c5690615-967d-4887-b124-2a86d99c3998",
                                "id": "bid_type",
                                "name": "bid_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e5315071-3747-4b1d-a797-10399300cb97",
                                "id": "bid_val",
                                "name": "bid_val",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "179bb050-4018-48e8-99eb-9d717d967c84",
                                "id": "liquidity_provider",
                                "name": "liquidity_provider",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "31eba1af-ca76-4441-85e5-77d248d2d000",
                                "id": "swap",
                                "name": "swap",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b6c6af7-73b2-4591-989e-2e753a297355",
                                "id": "780ca522-a3ce-4c09-84da-34af73c7b032",
                                "name": "brand_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f85bd61-b65f-4b77-843c-6ebe0bd7255d",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d905381d-52a5-40b4-b3eb-ebf2756b624e",
                                "id": "54e8b84c-99d9-4908-91a9-d9d5a7961687",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6db7f519-5b2d-4700-b109-ec3d9e94444a",
                                "id": "Direction_name",
                                "name": "Direction_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3b8f8c6-b36b-4e55-94ca-1c8145e5f78c",
                                "id": "status_name",
                                "name": "status_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e747157-69a4-4a62-a1c6-7d4b8983977a",
                                "id": "tp_current_rate",
                                "name": "tp_current_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71b344a2-0c36-42bb-81c3-ad9978b69d4f",
                                "id": "tp_order_time",
                                "name": "tp_order_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "52f170d2-ca88-45c5-920f-1d4f679014dc",
                                "id": "tp_order_time_str",
                                "name": "tp_order_time_str",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "153b07df-17c3-4e98-adfc-2b38a7cef934",
                                "id": "sl_current_rate",
                                "name": "sl_current_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "506fe031-7ff4-42f3-a33e-9900058e5333",
                                "id": "sl_order_time",
                                "name": "sl_order_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8f1085be-048e-46f1-a118-f89ecb7608a5",
                                "id": "sl_order_time_str",
                                "name": "sl_order_time_str",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e253a3fe-eb67-4142-be31-c42ffec0b932",
                                "id": "direction_fixed",
                                "name": "direction_fixed",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0272aeea-afb1-4bf3-811d-de25943c5d90",
                                "id": "close_pnl_usd",
                                "name": "close_pnl_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "73181e4d-d7ae-418e-9401-37b90a8dd53e",
                                "id": "booked_pnl_curr",
                                "name": "booked_pnl_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a7462835-bae6-40a3-8569-fdeda0187e47",
                                "id": "trade_status",
                                "name": "trade_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76c0cabb-aaaf-4fab-a077-a61f933a3f4d",
                                "id": "booked_pnl_curr1",
                                "name": "booked_pnl_curr1",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f98d6510-b9a5-4a01-bfa8-5c13f0b28f27",
                                "id": "close_time_key",
                                "name": "close_time_key",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b2ad8ab-1d90-495b-9969-eca8f8a9a62c",
                                "id": "2d242fa7-069a-44db-bdd7-02655f4e2d04",
                                "name": "employee_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b04ea7b-2822-42fa-b275-87d6ed4fc8fe",
                                "id": "open_time_str",
                                "name": "open_time_str",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c98a1927-83ac-4f68-95aa-ad7779d42516",
                                "id": "close_time_str",
                                "name": "close_time_str",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8455109b-dfb1-4867-b7d0-0056ec3b2da6",
                                "id": "client_close_time_str",
                                "name": "client_close_time_str",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd0b5a97-73db-4a66-8fe6-0693b8987407",
                                "id": "client_open_time_str",
                                "name": "client_open_time_str",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b2355c1-2b66-4f83-85fc-ac18ca81a004",
                                "id": "sec_diff_from_close_to_open",
                                "name": "sec_diff_from_close_to_open",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3dc748e-2f51-4d5f-9d36-761c02cad0c2",
                                "id": "weighted_avg_help",
                                "name": "weighted_avg_help",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "273a5787-16f9-4d67-9e99-9a7051a0d257",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1321ba1d-01c4-481f-8e02-01134840ee9f",
                                "id": "d844a6b0-47e5-4510-a6bb-d3bde363af8d",
                                "name": "site_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "dcfdc236-4047-4a2c-a27d-036d15dc90bd",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "070d1e0f-6fd8-4067-99ea-662dcb1f06cd",
            "fullname": "MySql:c0abde4e-f0d8-4f51-9cf9-000f6d453e66",
            "type": "extract",
            "name": "c0abde4e-f0d8-4f51-9cf9-000f6d453e66",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "947b6aa1-124b-44e0-a569-9be562c2a26e",
                        "id": "tq_z3iZts6cl",
                        "name": "365TradingFX_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "fa2a968b-5264-41cf-b96b-bd0c7b8ee226",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dfb83582-5dd0-4d0d-948b-b434991eb03b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b7af761-51d9-4363-9c94-86a2c71b2097",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fcff4ec-d7ab-49cc-a8dd-d3ea33f66c61",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d506ea8-e69f-43b9-9ac8-82a000fc1787",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a686f65c-37f6-4c29-bd4a-ea1d232ad2e4",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "763ed1bc-4d02-4c37-bacd-b0e64b3f5f30",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2926c088-de0f-420f-8db6-86232722e169",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4074008-4dee-4f5c-9270-8d3f46e9be67",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49f3ad7e-6d43-40ff-aca4-e70522c1eb35",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "20625ed6-4949-4e6f-aba6-7e08a9ddd92b",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506e36780f2002c37ecd8",
                "provider": "MySql",
                "parameters": "WpjwuHhqzfDIdAFVxxbzsI0YjwvC+DbfC5SOQEIG9Hv/ov90B4e996K5jgUO+RnMIymf8vUv4ZkKAz3a9ZjFWfFx0Vo47BjpHtnTXLtkifQRqyaZfd4D6O1eqmErosIKNYe9BaLz/Dcd/UP9mDlqVceymGdLGHoVvU8f/jie8mwEQUF6aAirIkBFxSa+GAc1y/33qpuBkVC0lkCPxLhwxjFEew4CVf7nWq1YJkAA++dxReSWYPaOBwUZ1W5/aDZr",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "071e7359-e856-4140-8a83-2799b1bc1e97",
            "fullname": "MySql:330d4bfa-3a94-4c45-a0f0-83db725fb9a1",
            "type": "extract",
            "name": "330d4bfa-3a94-4c45-a0f0-83db725fb9a1",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "25de139e-ecd5-4b79-8ff9-b3172bd6a013",
                        "id": "tq_BHwtUDHyq",
                        "name": "AussieTrust_positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "da9ea133-68c9-4c24-a2bb-0cd43e8b8098",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6c172f61-75dd-4e38-989f-b81b73b6e3e8",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d17ebd8-8086-4cef-87de-ec4175705113",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02047b51-ce42-4ec5-b3e0-44df195d2885",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ded8f836-9dc6-4972-8c22-fb7dec3f4be9",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "5c0c6ff6-6a66-49cc-8ff7-d229e586e90d",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(1000 + brand.id, 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5328a56da002c36c65b",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "07cfa5cf-9577-412b-8149-0b7e23c2d59d",
            "fullname": "MySql:af72dfdd-e250-4f58-afbe-52890e9c8f9d",
            "type": "extract",
            "name": "af72dfdd-e250-4f58-afbe-52890e9c8f9d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "656a7b3a-f197-4ec0-949d-3c4773a23851",
                        "id": "tq_n9dnfN1fc",
                        "name": "AussieTrust_open_positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6ff0bee8-5723-441a-ae9a-0a009332fe31",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "995738ba-424e-4d56-aa92-1c334ed106f8",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6187848-4f83-4109-845c-dba5eccc8f14",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71c167d5-3e22-4eac-8b25-2af82483c15e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fdc7b18-31e2-4aa9-9ad1-3d30a4bb29ba",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d10075ff-ccf5-492f-9d31-e75e558ab440",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f0698103-1f39-4f37-a3ec-2bcc510f407e",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fd9aaae5-3ee7-4b75-a16d-ecc53f934cbd",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "50ecf71e-68d3-476f-ab74-1440af254f9e",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "91a8634d-6f47-4d31-9d64-b96a5e7c2d1e",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend) * (-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5328a56da002c36c65d",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFBOE7XbLtDfztzmP6eQ4KBt3tRGIH63X48U4CzSaVa+dUfhCGFpJQKmhkBC+dQUu/RMoasJpviGoRBZntP2bvD4A7ukgYI+LVnDPvsQbPi90",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0996c360-a7e9-4623-9f34-17aace78b732",
            "fullname": "5a6dd075-37aa-4afc-bf95-bdd0d46c49bd",
            "type": "custom",
            "name": "5a6dd075-37aa-4afc-bf95-bdd0d46c49bd",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "e26a5251-689c-4fa4-a831-d2b5dc0289a9",
                        "id": "Recognize_Duplicates",
                        "name": "Recognize_Duplicates",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "dad3dd27-e3a8-4bbe-88b5-c26ee180cbf2",
                            "expression": "select 1, 'Customers' as Type, count(customer_id) as counter, count(distinct customer_key) as key_counter, case when count(customer_id) != count(distinct customer_key) then 1 else 0 end as key_alert\nfrom Customers\nunion all \nselect 2, 'employees' as Type, count(employee_id), count(distinct employee_key),  case when count(employee_id) != count(distinct employee_key) then 1 else 0 end as key_alert\nfrom Employees\n"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ff0fd274-9328-4971-981e-110bbf32cc81",
                                "id": "981a13e0-992e-4ed3-9c6a-ab5016aa2000",
                                "name": "Column",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1d5f9a5-3bdc-4258-bdf8-2db10a75b0b7",
                                "id": "106b2fb6-d4de-477f-8913-1fa96d5baa6b",
                                "name": "Type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4629c68-47d5-4b2d-b6a3-c657e0e03599",
                                "id": "30bf30a0-38c1-4ba3-b3fd-e22e48a40289",
                                "name": "counter",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09cb39cd-c433-4c30-8017-fd1acff530ca",
                                "id": "d4d35a65-313b-4d7d-b6d7-b82722f7c321",
                                "name": "key_counter",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b28c690d-9613-4a58-8d69-2014c2ecb4a2",
                                "id": "7975eba4-8c5e-4d3f-ac28-f5fa97c61571",
                                "name": "key_alert",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "a89f07a6-971f-4211-a8aa-e1df851879ae",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "09d8d326-89c4-41ad-a35a-88d93d50d3e6",
            "fullname": "MySql:6f32bb7c-f3d2-4abb-b6c2-61c4d0aeff02",
            "type": "extract",
            "name": "6f32bb7c-f3d2-4abb-b6c2-61c4d0aeff02",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f5db60d8-447e-478d-94f7-db0e1096ed6c",
                        "id": "tq_xAoSYooq5",
                        "name": "BigBitMarket_Employees",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2fa5e116-c67f-4e1d-9a9e-b88b8f9a93b2",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92b3a12f-7889-423c-8f20-7544a26331e5",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8755034d-9544-404a-9470-131a2f199c95",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf435aa2-1286-4fb7-a358-2d7c3cca8eb6",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d98fe28-9360-4fdd-80f0-9bcae3e40f3c",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c061edc6-b810-460e-87b9-75633a102566",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbeab048-4574-4dea-a906-2aca1dd4a796",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "022e44ef-d143-40d3-8957-446f6f7a4724",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2026bd45-b87a-403d-bf69-65714e5e92d8",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b845d5c1-79c3-4f06-8a46-d0c12addb0da",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "85594200-f551-4cf9-9265-1fbf45dad4d3",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0e8bfb43ad1002c7a7595",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0d25d779-c741-4eb9-a03b-becc6559f5c3",
            "fullname": "MySql:4540a958-7512-45ed-9e7f-6ddb515e00bf",
            "type": "extract",
            "name": "4540a958-7512-45ed-9e7f-6ddb515e00bf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "618c67ac-341b-4bd5-9512-3bae70f88315",
                        "id": "tq_7BHKC5lWp",
                        "name": "Arrowteks_positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "68269011-9165-4f45-b6fb-dd5e6741aaf1",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1808fa0e-a945-4e5d-a2df-a892ed4e3a3b",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e03a3ae-266d-4799-920e-3d1889f762e3",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44722eae-ddc5-47b7-9114-d7ba99dc1fcb",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a00d27cf-52de-40c7-8b5d-4c0894dcab5a",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "a3da794c-e8f3-4ab7-b204-0e605cca4125",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(cast(brand.id + 1000 as char), '10010', trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\ninner join trader on trader_account_position.trader_id = trader.id\ninner join brand on trader.brand_id = brand.id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5328a56da002c36c660",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0f66bf04-ea42-424c-8227-cce723486955",
            "fullname": "MySql:13848be9-acad-43b3-8ff5-8b03debe7ac3",
            "type": "extract",
            "name": "13848be9-acad-43b3-8ff5-8b03debe7ac3",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f3343b72-5840-47ec-8ab8-2a0405560765",
                        "id": "tq_yvLidIbaR",
                        "name": "TheBPCA_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "292b5368-82e4-41a0-a8dd-c8841e183830",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fad6b7d1-f9d3-4adb-9a2a-369bd0146ccf",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "36afa22b-99b3-4628-aaab-1f6bc574b5c3",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbf3629c-dc5e-4829-bb24-2563e792337f",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49f2dcf9-9e68-45d3-b510-f11229b4782d",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "457ce32c-77f7-4c45-94ea-7d25f51c4c58",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e1777c1-fa4e-4606-82ec-5e923402ca51",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e6d2156-5871-4799-9efd-9bc5e68861e8",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b0e9d78-5a3a-4779-8f2f-51477bc03226",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d29bbe2-e54c-489e-a996-d5f9564585ae",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c9e0cc5-bac3-42c8-af64-45de1bd7b276",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c229a59-1d21-49fb-8e2f-8c6c8fdd57cc",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2e88c6e-1356-487d-a98f-3d4396fc5bf1",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3841c68a-84da-4fb4-a646-d935c91cfb50",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50958458-1827-4415-85ca-aa32b8d6e2e7",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a417e100-fb60-4264-9286-f38982481ce9",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9356df1-5593-4825-a280-1a382c231f26",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6221d08-3d7a-42b8-8643-4165de97b179",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ecb612e2-d667-481c-875f-fd4cd083920b",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0a66024-ce30-43dc-8723-7f187474cca9",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7624e390-c779-4f5a-812d-4c0f1e81c9c3",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b4e5438-2241-4900-a316-74d232f47aea",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d01e089a-fa20-4edf-9a05-d5cb88a7e544",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4424e609-f8dc-41e0-9804-d6452c9d86a9",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61e00f75-9fc0-47d3-ba89-cb9572f1aa46",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aee9f515-e4d0-4fcf-a6ec-a0afd72d61c3",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5587eb5e-6f41-4410-8538-8773f03b5e34",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f3f6e93-20ab-40db-9ddd-f348a3397204",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "caa79954-3af4-464d-9029-ab3271bf847d",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23aa249a-2009-46a3-8115-450d7761433e",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3db6e996-641b-40d8-b35a-e08f0d3bf91a",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abb2b986-50e7-4d52-9028-591a22a0581c",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "065fa148-ad18-49a1-9a94-b6960c4c2ddc",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb02b4fa-678b-42a0-b75f-a0667f7c6386",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "244779f8-87c4-40eb-8174-86599a8ea88a",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "197cd195-937e-4780-8ed7-3d8ccdda1c10",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f22b85b3-55bb-4ae0-80a0-140b12fe68a5",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b694521-7bdc-4a93-93dc-92aaedb316d2",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f674e535-b32b-478e-a6d9-5538a3be4d9a",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "197bb102-837f-4f54-ad81-f59ee00c2773",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54bb0c60-1536-464f-8f46-3d08738e9fb4",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b8f8789-f2d4-47e5-86a2-1baecc37f6a4",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55ed4433-f3ae-4359-bf87-2d3a7ee400ec",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5a972277-efa3-4ceb-ab97-aa0498f4293f",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c296ec67-f768-4a9f-8043-adf27b4b98ce",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2dbba3f7-10fc-4ae6-83c8-529329fcd26b",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff5d8e34-835a-4dde-b0d0-439a2453e541",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09153105-fbcb-4b41-adc4-b343f66dd904",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e4c1fca-3100-4472-a3d5-9ef9df5dfbff",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e4c34d1-392a-4906-8ef6-868111d23122",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05be9423-5d70-49ea-b2a3-48ba2c2b8953",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a8904c1-3a18-4b68-9d5f-179cf85749e5",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41ea30f4-7b54-4321-9728-e540b36c747b",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0698c3d0-16d1-4b05-94ad-06740e97d4db",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c509d520-645c-4d56-957b-4765cdccee99",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50bd465e-92a6-453b-833b-12c0932323ed",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7a96891-031c-435f-a9e9-f9deafd4d2f7",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b429a08e-6562-47f5-a659-1a4d5610ee81",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4228876-82d0-495b-bdff-8a82f4b62aca",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c68ec28c-5e24-4af9-bcc7-e2549048259e",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1251add-94a4-467d-b812-3ec16c80fdf8",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8d94b3a-28af-41bc-bca1-b32f11aec4b3",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "065fa148-ad18-49a1-9a94-b6960c4c2ddc",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "68872a7a-ac47-4978-bee8-ea11df62da10",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id <> 24\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) <> 24\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619505336780f2002c37ecb8",
                "provider": "MySql",
                "parameters": "Li2FpOBZkuQVFHmglvVO3unF3cyE7uQhXYenrn6ytNP08dPSNopcrZhCPhIEZbJq3GHeZmZNPZrQfHZy7Mo7S3QwZl+lJvy8mcXjoPWADHn7fHD/TXsGlpkaRPNOQnFO1tEd5xDHMHRh7i0mnvMheVsy39u8/PLd+UW23hnoTWzeGuy1jl1t9vmXt8xw1uh0Lw271DKaGVhOc5Lst9nqXnRu5pPfVPjIho4oBLMYdZDsXAdGAFkgsULvW5O9Ut8l",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "10c32fc0-da5d-48fa-848f-f2204bac0d29",
            "fullname": "MySql:4aa6c2e7-f6c3-481d-b18f-d92f98732274",
            "type": "extract",
            "name": "4aa6c2e7-f6c3-481d-b18f-d92f98732274",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "81b25b24-b46f-49ea-9863-4f7062926750",
                        "id": "tq_jc7EW7jzI",
                        "name": "InfinityCapitalg_RealAB",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "78d9ba1c-119a-441c-a9b3-631a4905df0f",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a6eb488c-7e31-43fb-8aa5-320f91e91b7f",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "24a7449f-9c40-4ea7-b399-99f47a55cb57",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bac5ffd0-6417-4cd0-9eae-312d8fa23677",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a83528e8-c0cb-46a2-9bbf-d535c0f38530",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da92b926-1ee8-4898-8ee4-6293a8625ebc",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dde8f41-aa0b-4b24-ad5e-60720e188e54",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77104fb6-41e8-430e-96b1-b88b9be98f41",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb2b04f9-d37d-4263-9595-c5371a41b97f",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1c43612c-c5d0-467b-9d5a-ef7af97363e3",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d2c4716b-f4bb-4c75-b052-2c766c7f9b45",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "973c9689-63f5-4bc1-a32a-f34e94d0a4db",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c443fc3-c475-439d-a923-dc38d3011178",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba8228c5-8bfc-4232-908d-497c70ec567a",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "43719545-798d-49ee-a618-71fb6b43f6b0",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ddc5ce5f-b183-4fbb-99a2-14e4facc0451",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e90df700-d76e-4e3a-b555-53b6ed039ba0",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1a0478a-8f4d-48a7-8017-025dd6281719",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2319c555-6a03-43c5-8bad-26a26427c36b",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e0dfe70-bb90-4028-b8ef-46e6de7f391e",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "45e64946-319d-47a7-96df-1d5e3d6e3849",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95cf8008-07a2-43ef-bc96-b5f6d506c93f",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bd8e905f-9064-48d7-93b1-dc0fcf93b666",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "84550ac3-b6b7-4c6b-9018-e1b585bd173c",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8302bc2c-3663-4f5e-9a82-2e79bec4fc33",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3afd261c-e416-4ee2-9620-d3c147589836",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4f9cd32a-bdb9-461e-8be5-a20af0b475b4",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "787a562d-8439-4e1d-8c09-d32c24988ef3",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ce5a0725-a54b-4944-8ea4-8f4b58452989",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "603c73eb-ddde-4879-97f7-cbffce3cce43",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f4a5225-db18-44dd-8bee-1582ff5ba532",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fcd0b443-79b3-4068-aa8b-27aa5f153ff8",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be46135b-fa4f-49b9-8868-77af84d8f92c",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "33d6926a-cf1e-4725-8527-152a20b1d1fc",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1e672a5e-e49b-4c11-a85c-c3a4d2c252c0",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "183a5963-3fa0-468f-930f-ad160160e998",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3455629f-40a3-4e16-a794-dfe2187fd9d0",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "55ca9868-5743-43df-9917-c03bfe0f34a7",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c7ff8a0b-1efd-49a3-827e-c3ba2d7f54c2",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "85efbcd2-cf05-4492-97aa-7172388c5931",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d937cf5-8134-4d4c-82c8-d50377330edc",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1e960850-04ca-4b74-9525-f24c4c03e6a1",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0326005a-6ae2-4300-8d1a-6161e885321d",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "03df8cc7-0458-4de4-b54b-2fe2133332a8",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f792f4b-bd15-489f-97dc-1c885b538ec4",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b0e4c2b7-3f5c-4e9e-a48c-51d9884c4b3a",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "84574a62-ac03-4627-91f7-2e8013d5e762",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "efdb0efa-f89f-44b1-9b04-5cdc5ff17dd2",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e845aabf-8ecf-41b6-a927-0c2b0e61899c",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "faf6c388-1c2c-437e-a086-26a0fdfaa97b",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0df97b72-32a2-4871-bdf8-61c305a17c8d",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c1aa9b96-a827-440a-bf66-d6c743d28c3c",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3c0afec0-9fb8-4bf2-9498-6be7e2e9c331",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "edce10ba-3da1-4e11-8a54-e58f122ba446",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b75ad84-859e-4f60-8ea7-9455501fb4ca",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b19dd9c3-eea8-4c58-abad-e4dae2e59530",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "678fc404-ba5e-47ac-8a3d-e2f2ebeb0099",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3547dc9c-08fb-47e3-8416-80d8bc4d9156",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c5ac2d76-d5d0-43a7-888b-ef95601b34e8",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "48fdfc3a-b2ec-49f2-ba8f-234ff1e28ae5",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "290573ee-d830-49b5-b0ba-c362d7635407",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4998031b-bbe7-4d44-9d82-f1735d8d4169",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c8697fe8-5acc-4396-8e2a-6593f3172a62",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2ec740e4-0291-4e20-abc4-699bbfe7eeba",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e59186ee-9760-48a4-801d-e83cc9d409ec",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fe04b823-0870-4e73-aea5-5c101f7a5bac",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e07efcb-9157-4cf2-997f-99a2e9243731",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "63eb5864-ae91-4b9c-9db4-3959761413de",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3496a70-a022-40b6-aacd-097a01885cb0",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "1c43612c-c5d0-467b-9d5a-ef7af97363e3",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "f37bc15b-4bab-427a-9820-1620efb46a73",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\n       aggCustomer.default_account_id,\n       aggCustomer.name as site_name,\n       (1000 + site_id) as site_id,\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\naggCustomer.customer_fullname,\nco.name,\naggCustomer.currency,\naggCustomer.created_at,\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\naggCustomer.date,\naggCustomer.YearMonth,\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\nend as rate,\nMaxDep.LastDepDate,\nMaxInv.LastTimeInvestment,\naggCustomer.tr_id,\naggCustomer.origin_type,\nMinDep.FTDDate,\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\naggCustomer.user_id,\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\naggCustomer.deposit_curr,\naggCustomer.deposit_usd,\naggCustomer.cashback_curr,\naggCustomer.cashback_usd,\naggCustomer.withdrawal_curr,\naggCustomer.withdrawal_usd,\naggCustomer.withdrawal_curr_new,\naggCustomer.withdrawal_usd_new,\naggCustomer.cashback_withdrawal_curr,\naggCustomer.cashback_withdrawal_usd,\naggCustomer.withdrawal_fee_curr,\naggCustomer.withdrawal_fee_usd,\naggCustomer.chb_curr,\naggCustomer.chb_usd,\naggCustomer.inactivity_fee_curr,\naggCustomer.inactivity_fee_usd,\naggCustomer.overnight_fee_curr,\naggCustomer.overnight_fee_usd,\naggCustomer.fees_curr,\naggCustomer.fees_usd,\naggCustomer.pnl_curr,\naggCustomer.pnl_usd,\naggCustomer.swap_curr,\naggCustomer.swap_usd,\naggCustomer.contract_usd,\naggCustomer.rbonus_curr,\naggCustomer.rbonus_usd,\naggCustomer.cancelled_bonus_curr,\naggCustomer.cancelled_bonus_usd,\naggCustomer.pending_bonus_curr,\naggCustomer.pending_bonus_usd,\naggCustomer.fixed_balance,\naggCustomer.fixed_balance_usd,\naggCustomer.negative_balance_fix_curr,\naggCustomer.negative_balance_fix_usd,\naggCustomer.NetdepCurr as NetDepCurr,\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\naggCustomer.NetDepUsd as NetDepUsd,\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\nb.balance as CurrencyBalance\nfrom\n(select\n\tt.*,\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastab < 0\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\telse @RealABAccHelp := @RealAB\n\tend as RealABAccHelp,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastabusd < 0\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\telse @RealABAccHelpUsd := @RealABUsd\n\tend as RealABAccHelpUsd,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\twhen @lastId = t.id\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\telse @realreal := @RealAB\n\tend as RealAccountBalanceAccumulatedCurrency,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\twhen @lastId = t.id\n\t\tand @RealABUsd + @lastabusd > 0\n\t\tthen @realrealusd:= @RealABAccHelpUsd\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\telse @realrealusd := @RealABUsd\n\tend as RealAccountBalanceAccumulatedUsd,\n\tcase\n\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\telse @RealAB\n\tend as RealABDiffCurrency,\n\tcase\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\telse @RealABUsd\n\tend as RealABDiffUsd,\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\n\t@lastreal := @realreal,\n\t@lastrealusd := @realrealusd,\n\t@lastab := @RealABAccHelp,\n\t@lastabusd := @RealABAccHelpUsd,\n\t@lastId := t.id,\n\t@lastrealpnlcurr:= @realpnlcurracc,\n\t@lastrealpnlusd:= @realpnlusdacc\nfrom\n\t(\n        select b.id,\n        b.default_account_id,\n        b.brand_id as site_id,\n        brand.name,\n        a.id as tr_id,\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\n\t\tb.user_id,\n\t\td.code as currency,\n\t\ta.origin_type,\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\n\t\tcase when d.code = 'USD' then rates.USD\n\t\twhen d.code = 'EUR' then rates.EUR\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\n\tfrom\n\t\ttransaction_record a\n\tleft join (\n\t\t\tselect b.id,\n\t\t\tb.amount,\n\t\t\tb.wide_currency_amount,\n\t\t\ta.realized_at\n\t\tfrom\n\t\t\ttransaction_bonus a\n\t\tinner join transaction_record b on\n\t\t\ta.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 1) rbonus on\n\t\trbonus.id = a.id\n\tleft join (select b.id,\n\t\t\t   b.amount,\n\t\t\t   b.wide_currency_amount\n\t\tfrom\n\t\t       transaction_bonus a\n\tinner join transaction_record b on\n\t\t    a.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\tinner join trader_account c on b.id = c.trader_id\n\tleft join brand on brand.id = b.brand_id\n\tinner join currency d on c.currency_id = d.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\n\tleft join (select 1.1448 as EUR,\n1 as USD,\n1.3108 as GBP,\n'2019-01' as ym\nunion\nselect 1.1376 as EUR,\n1 as USD,\n1.3263 as GBP,\n'2019-02' as ym\nunion\nselect 1.1224 as EUR,\n1 as USD,\n1.3021 as GBP,\n'2019-03' as ym\nunion\nselect 1.1214 as EUR,\n1 as USD,\n1.3038 as GBP,\n'2019-04' as ym\nunion\nselect 1.1197 as EUR,\n1 as USD,\n1.2637 as GBP,\n'2019-05' as ym\nunion\nselect 1.136 as EUR,\n1 as USD,\n1.2691 as GBP,\n'2019-06' as ym\nunion\nselect 1.1071 as EUR,\n1 as USD,\n1.2152 as GBP,\n'2019-07' as ym\nunion\nselect 1.1009 as EUR,\n1 as USD,\n1.2157 as GBP,\n'2019-08' as ym\nunion\nselect 1.0899 as EUR,\n1 as USD,\n1.2287 as GBP,\n'2019-09' as ym\nunion\nselect 1.1157 as EUR,\n1 as USD,\n1.2937 as GBP,\n'2019-10'as ym\nunion \nselect 1.1019 as EUR,\n1 as USD,\n1.2928 as GBP,\n'2019-11' as ym\nunion\nselect 1.1124 as EUR,\n1 as USD,\n1.3351 as GBP,\n'2019-12' as ym\nunion\nselect 1.1095 as EUR,\n1 as USD,\n1.3205 as GBP,\n'2020-01' as ym\nunion\nselect 1.1089 as EUR,\n1 as USD,\n1.3181 as GBP,\n'2020-02' as ym\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\n\twhere\n\t\tb.is_test = 0\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\n\tgroup by\n\t\t1,\n\t\t3,\n\t\t2,\n\t\t4,\n\t\t5,\n\t\t6,\n\t\t7,\n\t\t8,\n\t\t9,\n\t\t10,\n\t\t11,\n        12\n\torder by\n\t\t1,\n\t\t6,\n\t\t5\n\t\tasc) t\ninner join (\n\t\tselect @lastab := 0,\n\t\t@RealABAccHelp := 0,\n\t\t@lastRealABAaccHelp := 0,\n\t\t@lastId := 0,\n\t\t@realreal := 0,\n\t\t@lastreal := 0,\n\t\t@RealABUsd := 0,\n\t\t@lastabusd := 0,\n\t\t@RealABAccHelpUsd := 0,\n\t\t@realrealusd := 0,\n\t\t@lastrealusd := 0,\n\t\t@netdepositcurr:= 0,\n\t\t@netdepositcurracc:= 0,\n\t\t@netdepositusd:= 0,\n\t\t@netdepositusdacc:= 0,\n\t\t@realpnlcurr:= 0,\n\t\t@realpnlcurracc:= 0,\n\t\t@lastrealpnlcurr:= 0,\n\t\t@realpnlusd:= 0,\n\t\t@realpnlusdacc:= 0,\n\t\t@lastrealpnlusd:= 0,\n\t\t@currentrate:= 0) v) aggCustomer\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\nleft join trader_account b on aggCustomer.id = b.trader_id\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "a545b339-0428-46cd-a1a7-8b018529854e",
                        "id": "tq_Qe80B8BRq",
                        "name": "InfinityCapitalg_Open_Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9c4a74ff-7389-4b67-99d0-45fd68af7a59",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "789c73cf-c258-4b57-9a4c-9ed8333099f2",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b3a7ed7-8a16-404f-bb39-1d6e41450901",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c5da24c1-4f31-45ab-85dc-f6910e7eaf4a",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d66ed63e-b234-448d-bf30-ea4b5e982b8b",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a494a6c9-7f99-40d6-98f5-31e342ff3de8",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71429f0f-ffe5-4b7e-b817-a5864500019e",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ca6f97c6-bb32-4844-9e39-a754e6604c3c",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "31e1a608-5c70-4920-8f42-0bb5cf8f5c56",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "2109749f-69fa-4181-92f4-8b0e05a69991",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5328a56da002c36c666",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFDK3HBxmko3prablFaI1b6kvdaONocO4mGDvrM54DgP9W1oPEw8BC6mp/SYk7RA8xkUrf2IEbn348Yqf2PLVTaEl7QfiGiMXpcXf2f98OxAHYjeCJn2Lc3dDX6g/P/KuFQ==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "16b5676d-c9da-4ac4-b1dd-2887a9a9183b",
            "fullname": "MySql:c1a9ba7b-fe4e-4a28-9c13-9df2b2f0f5ac",
            "type": "extract",
            "name": "c1a9ba7b-fe4e-4a28-9c13-9df2b2f0f5ac",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "43a0f2f1-428a-47d5-b04c-b53ab20c9936",
                        "id": "tq_R0sP9j8DZ",
                        "name": "Prime_open_positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9b9da3df-b132-4764-a64a-dbb470e64b24",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d8cd103-5a3a-4bef-9a83-f6d3a1bf5ed2",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c68c5264-ebc9-4d19-bbe2-725532954b2e",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e8919891-dbef-4fe0-aab8-06d7099d179c",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "349b7368-af30-4e0d-9b2c-084c52b3dceb",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2d52b796-8bdf-4bc3-8ea3-e7d672148452",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2e5744f6-d52a-4220-909d-76a4deaf9cc6",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ceadb477-5c6b-4acb-8c6c-5e82c4be1317",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "37685ca9-e07e-4779-8367-b2975fc37c51",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e702d591-8b1e-4e24-8533-3aeaf1b5c115",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\ttrader.default_account_id as trader_account_id,\n\tcurrency.name as currency,\n\tuser_currency_vol,\n\tsystem_currency_vol,\n\tsystem_currency_vol / user_currency_vol as exchange_rate,\n\t(trader_account_position.pnl)*(-1) as pnl_curr,\n\t(case\n\t\twhen user_currency_vol is null\n\t\tor user_currency_vol = 0\n\t\tand currency.name = 'US Dollar' then trader_account_position.pnl\n\t\twhen user_currency_vol is null\n\t\tor user_currency_vol = 0\n\t\tand currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31\n\t\twhen user_currency_vol is null\n\t\tor user_currency_vol = 0\n\t\tand currency.name = 'Euro' then trader_account_position.pnl * 1.11\n\t\telse trader_account_position.pnl * (system_currency_vol / user_currency_vol) end) * (-1) as pnl_usd\nfrom\n\ttrader_account_position\ninner join trader on\n\ttrader.id = trader_account_position.trader_id\ninner join trader_account on\n\ttrader_account.trader_id = trader.id\ninner join currency on\n\tcurrency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere\n\ttrader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5328a56da002c36c66a",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFIX7z4hDzOA5YXgCX1CnxcziCZXnKajrGEM0j8uqIlTwHa61Byqi5RonV2GOAnegaxLOz1W84BlI+GKkc5E1HAsQGhILBGse+2uap0fm3wskdjYn5ChwEw1OciM6LjeUZA==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "18f22c52-8d1e-41ea-a6cd-e4de9b2be88f",
            "fullname": "MySql:32ec477d-74a8-4900-af87-221d8b5d3114",
            "type": "extract",
            "name": "32ec477d-74a8-4900-af87-221d8b5d3114",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b02be625-ec11-4f16-a9f2-c63f4c612ef9",
                        "id": "tq_sbDdNfLT8",
                        "name": "BigBitMarket_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "802ad152-d2a9-44df-8f35-02e6e3a94872",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83ebf2a0-5442-4afb-9820-d8c4d752d40b",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3904ad81-755e-42fc-8869-2adc3895171e",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c61336c-afb5-45b1-9512-6117b7baf7c9",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8af0fcb-bf1f-4d5a-a1c4-e7e95f8256db",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 3,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "4f5309f8-3cb3-4f68-97d4-99e63381c892",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0e88ab43ad1002c7a7591",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "1a9b602d-6fb0-4d8b-8e94-11966a3ae009",
            "fullname": "MySql:6595b7f6-47af-4f78-98c8-dc2e8686e7dc",
            "type": "extract",
            "name": "6595b7f6-47af-4f78-98c8-dc2e8686e7dc",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a942ba13-8b00-451e-9322-f513af75f2c7",
                        "id": "tq_rPT3zjV63",
                        "name": "BigBitMarket_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a4443033-02b3-4d9d-9585-238e19d98cb0",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bcaba468-1bdf-42d0-bf46-4006da616e13",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5e744db-1b18-4e5d-8336-c67a54b1a40f",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71535a0a-36b6-4b3d-9ad4-63ebc28e1764",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1de38da-bfe6-4ecc-a4ea-b0d5b508dc9c",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79758c50-c906-48a2-b5df-d1a756820ea4",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cd24185-9188-4a69-aac2-f642c65b3d95",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a858318d-04ce-4290-aa0e-4f2574155c4b",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc5de9c1-a99c-407a-a267-ca572b1a1665",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cff391b2-269d-4342-93cc-5226bfe38a8f",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c11f5c94-80ce-44ef-90ee-af95a124031b",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "486ae52e-5017-49e2-8213-89df4f32685b",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25c71286-2533-41de-a5b3-479f78525ef5",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45694321-dc63-4394-85cb-fed057144b93",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a5735eb-d1be-4fc8-b3bd-721a8f03413c",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "afad3cfb-1ff3-4cc2-a2d1-8141019fd319",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12eb85f3-4cd4-4c20-ad70-9983535c1446",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52c4042e-0617-4fca-b4b0-c56665dbb223",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3b4527d-5406-4719-859a-dfbfde5c91a2",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c4033c6-56f3-429f-88a5-86177439ba1c",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4545665-94e2-434c-80f6-cfa4205b81c7",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62a8ade1-6168-4204-8a72-8318e9bbd1b7",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c031a277-b0e5-41f2-a983-8938ea2c900b",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96328d47-82dc-4e03-aa87-80454b226173",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e42830fd-6ebe-426f-ad4e-f96a68fa3261",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88379128-ded6-4821-b542-3099274ef10e",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3b3a2e9-83fa-4e40-b9f1-5aeec66e5f2d",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dee9e9d-a1e4-496a-8a16-039d97570596",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9f68c5c-6fad-4b11-9597-ce195d68a29c",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ba651db-00c2-41e1-846e-5d97918ef9f1",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f342a81-a778-470c-afc5-d78240987d0a",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a3c126d-832a-4d0e-9680-0a87def72b24",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9278d70-e5a7-401d-baf0-e2db4f4d919f",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9619c11d-8704-4fa6-b52a-7e3334ce7229",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "322bbc96-8b82-40f2-956d-2caa0076729c",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08fe01c2-cfbc-499e-b2a3-6a19cedeb80e",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d19c9b2-1269-4aa9-bb37-5f7c37145e3e",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "942d48ca-6a31-467f-8f71-042624f9e1ac",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0752f998-6cea-40f9-94bc-904d4023269b",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "363388aa-01f5-44eb-854e-dc88ac7b6a42",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "daa067d5-1896-4338-b1c9-252bb7fb9c1f",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "613752f1-4bf1-4ebf-a837-4ddec387bd13",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c90ba015-829f-428b-8087-5502ed3d2364",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2deb33b9-3d36-4c44-9ab9-9a54496c0a34",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63087506-98e1-4414-be84-dca5a675ae64",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e8dd772-bb39-4c20-b372-300b26a1f556",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc9b34b2-9743-4413-beda-66f86bfeb07f",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17d8db7e-a681-48ee-90e1-df98825f7d12",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bec0e61-a8af-4eef-8149-0b8dd76b2b5a",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3dc3a356-222e-4cd9-ba16-3e5f2588fd15",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06f034bc-77e8-439d-965b-7a351ef565b6",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c20b168-c3b2-4818-a23c-ebdeffdb3ecd",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28beb4c9-7e48-40a4-b321-f180fa0b6d52",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbb489fa-206c-4549-ac39-a19b20da2fa0",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d6d5db6-615b-4afe-aec0-fe30bf40a312",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e5416d8a-04f7-4e69-8eae-21f65edfeffd",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40ed55aa-de81-4af5-91dc-c226ae3c52d8",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 40,
                                "size": 69,
                                "precision": 69,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "199b1b82-32e9-4628-856f-c101bdfc79f0",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed61741e-016b-46e8-8978-a6fa1989c312",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 40,
                                "size": 69,
                                "precision": 69,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af76d157-8d22-4386-862e-0897c3e1ddbc",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "991c9925-5e8d-44fc-bc61-1e2b5736d144",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a089eda-f3e9-4b1c-8ec7-3b0c5a879028",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb629d38-d01f-4001-9d96-958ef3f0b0b3",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "962a58e1-85f4-41f6-b896-5117bfe65029",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cc82659-d41d-409a-a7c6-dc3872c3a8ff",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 64,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "889128bc-8a94-4273-9035-c4fc43fc0f54",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49a28a15-2d85-43ec-8fc1-b5c4438360b6",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 64,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec8e1eab-4580-40ad-8fd3-6806a7db941b",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bcb1bd8e-e1b2-4290-af5c-b648db097ae8",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "cff391b2-269d-4342-93cc-5226bfe38a8f",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "17a70e81-f8ce-4f98-8a39-b01a3832d11b",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0e832b43ad1002c7a758b",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "1bdbf8e0-8a5d-4e1a-a0ba-44a88ac7d2d9",
            "fullname": "MySql:ad0bb2b9-7099-4ed6-ad00-2fd407ba7ebc",
            "type": "extract",
            "name": "ad0bb2b9-7099-4ed6-ad00-2fd407ba7ebc",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "e9affa8f-02a7-42cb-a27a-d97b1f6c2dc9",
                        "id": "tq_H5CLWf4SX",
                        "name": "InfinityCapitalg_Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "4cb6386f-880e-4584-92e0-b8a50b5aef90",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e6708889-e35c-4b77-adbe-73af2a3c562a",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb0d4dd0-db01-4bf3-9e5a-cd2c398707bf",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87e1030f-f7c3-45e8-bde2-d2ea2dac3bb7",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "12c2a64e-194a-41fc-871c-b4be237426a9",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "ad87d8b3-9c01-4d96-a380-e10baa853e81",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1028), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5328a56da002c36c672",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "1c3cb96c-c228-497b-90d3-7757bb430235",
            "fullname": "MySql:cc96c91b-b048-47d6-acc4-35b17d3462e2",
            "type": "extract",
            "name": "cc96c91b-b048-47d6-acc4-35b17d3462e2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "fe130be4-004a-4292-9108-50f8e60f2ae8",
                        "id": "tq_34afZRriZ",
                        "name": "AigMarkets_Customers",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "46dd868a-7e2c-4654-bfba-6c8f66a624f6",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ed25d84-60de-4179-b132-950024e263d7",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c2667e19-4803-43c2-b6d2-62b4d850d16f",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1142325-d337-43c1-91c4-b6e05bdb134d",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce237f84-1d95-49d8-80b3-bf30c0254cae",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fee0e5cd-9a09-433b-acc2-d0f957e71e26",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88620518-70af-443d-8713-5e65a8a8d661",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3580706-8c92-427c-b650-d66d33f78050",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8208d56-0df7-47f2-acd1-44e6dfc1ac23",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ef0bf77-ec04-4df1-8305-7dc5f4027660",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "063e5f95-e334-49fc-939f-b6cf847044f4",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "028e3f39-469f-4a97-98ed-ed5fe895992c",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3225a58-76da-4450-981f-59bfb6b65d84",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b133d02e-c05a-499e-aacb-4feb1aa361af",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42e3b0dd-bbab-4f9e-88b8-0279e0cb4331",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "932aa3e8-bf6d-4519-a71a-1ceace0d484b",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "295a2c48-6dc1-4b55-ae19-3de13da1f16c",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f45ec1b-d96c-4fa9-b010-cb5ffe2b2e1e",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "538da3d9-56c5-4401-bbb6-eb47ddf8252e",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c8f4d9d-eac7-42ef-b6d4-7428fdf9b6be",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "993b0cd2-20b1-45fb-b456-ed8c2f6cdbe6",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3b8c476-7456-4d7c-b543-522cdf84242e",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec468428-c90d-4f02-a328-4f630cc50328",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f57a08f-0cd8-46bd-a04f-2bd305765149",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8351d71d-e542-462c-bef9-0e4798575b27",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f699e80c-9c83-4365-ab1e-2798cc3c1b24",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "349bd25f-07f2-4c09-8422-70a7f41e059d",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d42f876b-2e5d-40ba-90cf-6db83b449f23",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d46b003-44c5-4c44-9580-020cd5a02cff",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "824fd786-a6d9-4bc4-a83a-ff199df28be3",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81daf0c6-1b47-43d8-936b-6c75b956bbc1",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e73e219-296f-4838-b95c-ecb8a0dff43f",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2cf01ee-e8fb-4a4c-9a55-57a7c97411d4",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13a9e953-76b6-416a-9882-a8ef7310b4ed",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10c14d62-d10d-424c-b220-f70a73769963",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86475e5f-e0ce-4f28-a34b-28118903ece9",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "972ac7da-8880-493a-9e5a-ef2424de868c",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96a59762-ebc4-40e0-84a3-ed02d9d33b00",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "278a5c16-b02e-4fb0-9fe3-a255939f72b6",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07f7e660-efa3-4fdd-97f9-afbd73513360",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2e17910-3323-409d-8c13-43582f98d2ed",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35852cb3-808b-4bdd-8c48-1607515724dd",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f64820f-dcc8-4129-b5c5-2e7e1705ccb9",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd251468-df3a-4033-8444-68f46ed63678",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1e0cec2-eb11-4e92-98b2-62cf90a7ab7e",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d7ed791-efcd-4643-a124-6cfac21d86ab",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7812fe4-01ad-44cc-8c0e-b6aacbf810fd",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93d500b7-0571-417c-a8b7-51e252837331",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86c3fa2f-5529-4a0f-bd4f-40650e69345a",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d03e7439-5172-4c16-b6c7-8209c504a95c",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7165457a-f8c7-4204-baa2-d86e24eadf76",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6742a79-f3cf-48a3-88c8-ad3cbace7cf2",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bd586a2-6109-4eab-9c1b-186bbcc235c0",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a16fa1e-4639-4731-8012-36e8bc694c52",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b404947d-38b8-47a6-b8fd-2e982ddf361b",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72a1b358-0fe4-4966-8cec-107e521d3d66",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45d4ff3a-caa7-444b-adb8-88b989cbbe87",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "feda56d2-9a06-411d-9d8a-d0e25b2601f9",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22e9de53-5f08-4bfe-acde-e97109350131",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c31c81f-1169-4e2a-b652-e0366bad6460",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a1fd6b3-a976-4b73-a7a8-81b1feaba2fd",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88f51f1a-91a7-48ce-a16b-099a4c619f7c",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "e2cf01ee-e8fb-4a4c-9a55-57a7c97411d4",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "30a39549-5baf-414d-ad8d-3245dfc3428e",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id <> 24\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) <> 24\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61b343fd01d520002c42b1a8",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W9vffNlEo4jtdabftiKFBxfaaQsXoFhTTM7txEhG/jLu6CBekXY22hgN88Ng0fYauS48Rg4xTl4PvHqjVbcTS5Oi9FGQfbh1gOsBXF/HnXlsW+cFPRFDXzzbo/8B2c8RpAz/uBJmRSXztf22P/MxqCvTW1lgo5PsEnrOHIw69wgwh2HIjj4R4ChudbQMprFOPzxUtJA/laJ5YRHjGrRVKxa",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "1f797a16-7d08-48d7-9a14-aceeb93273f5",
            "fullname": "MySql:331e9803-228b-4c17-87e9-611925393ba4",
            "type": "extract",
            "name": "331e9803-228b-4c17-87e9-611925393ba4",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "def972c9-d56a-47ad-8462-a90a79ef8c65",
                        "id": "tq_aHm5QNm8z",
                        "name": "AigMarkets_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5f27e867-4179-422b-8a03-1e69445d63ab",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9b6168b-85fb-4a83-84e5-1d346140f435",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95ddea24-69d5-4f22-a97c-457c84f70955",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64f0b29a-cb43-4fc2-bd16-794b1d8bb4f1",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d677c8a5-8f96-4e78-9ac3-6b368fd4280f",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 3,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "91c26e03-cce5-478e-8dd7-5be8271516a5",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61b343d401d520002c42b1a6",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W9vffNlEo4jtdabftiKFBxfaaQsXoFhTTM7txEhG/jLu6CBekXY22hgN88Ng0fYauS48Rg4xTl4PvHqjVbcTS5Oi9FGQfbh1gOsBXF/HnXlsW+cFPRFDXzzbo/8B2c8RpAz/uBJmRSXztf22P/MxqCvTW1lgo5PsEnrOHIw69wgwh2HIjj4R4ChudbQMprFOPzxUtJA/laJ5YRHjGrRVKxa",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "1fce8d1d-d7d6-4849-a900-a83f9556cc60",
            "fullname": "MySql:1074ca6e-8a25-46b2-95f5-e7628ef580ff",
            "type": "extract",
            "name": "1074ca6e-8a25-46b2-95f5-e7628ef580ff",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "04bba063-dacc-4034-8632-49941880f087",
                        "id": "tq_5aUGW4DGb",
                        "name": "TradeTheBit_Acc_Types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "7f3e5c8b-7c9f-4f29-ba70-b1eb1300a45b",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a43aea7-085d-4bd4-a1c2-25271b4625d5",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2853a644-8125-439c-9d0c-fe5545675911",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c195061-19df-43df-97af-096c5b91c7cc",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4bb9e00b-623b-403a-ad31-68b4a63ff2fc",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "45ca4cc6-eee8-4e91-b62a-d590d97e0e4b",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171345855f384002cf1020a",
                "provider": "MySql",
                "parameters": "F954Cqx2+xpp7cv613X4To3KDLtYkIILY9DKa7o2J6iwT7Hhp/LuVGR7WVoXuAJR6pANxIXoQ9aWeJiI7OcJP72ZHBxG9xyN42erULpN5ZuqvWQ4Ab7IRfQ6FHGxrmIec/RVbJ5P1EBneN6L0WOHnZFugjR8UPuM7oh3rwSSnzvjLJFOJ0c2gxjMsXRaCgVGAB0Pjz5j/uHDcFPg85fyrANVftdnJomPKg7Rk6G5kbKEybu1E9znVlAXap1CpXX6",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "1fff1af1-bbce-4823-b98f-782fcf4f1603",
            "fullname": "MySql:63f42ff1-3008-4f3d-b05c-e2d24aae3e30",
            "type": "extract",
            "name": "63f42ff1-3008-4f3d-b05c-e2d24aae3e30",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "defd5cf5-d416-4854-9366-d53714d14a4e",
                        "id": "tq_f4Nspomjb",
                        "name": "NostraCapital_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "82662608-2e29-4686-881a-6353a406a3bf",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23dc58c4-71df-4c14-b1f4-a0b74800ab52",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03fc1717-c744-4724-ac14-273b921e3783",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10f3d505-eab0-4b2c-b2ee-24ac8b19dc73",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef2d98d9-6442-4d55-850a-4caf58c912a4",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "fd13999e-bfd5-49ce-8527-1778f6f56c3e",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171339b55f384002cf10203",
                "provider": "MySql",
                "parameters": "5zpNi1/ivLrPCYd3lQIeMwzQq5sAuc2YxZlngeeRz8hpTWd0H8LeepAHS57ZrJJbLGMhcYYJi5jTdTs58x9Ifb38GYxx5LABrwlbp4PgUKEopCjg+Bdl9PQiGCx8H7K7nWAdNIkesmJqig4SBGeNKtw1XDvwnBW3u/rrXgFKnw1iQo69EEWu7CqZHboIqgmOLsXk4QP+RQIQ0ffDKky9F0uishDV78kkCxoNl+Mfe8tBKYck/ulmOghb0RL9ZKCb",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "238f5158-0ed2-4a38-8c90-132863fc1445",
            "fullname": "MySql:22347b09-08b4-49d9-84e7-fb64fc9e0001",
            "type": "extract",
            "name": "22347b09-08b4-49d9-84e7-fb64fc9e0001",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1faf3b9e-4fec-4be1-9089-257c5049371a",
                        "id": "tq_be6EMxjJg",
                        "name": "RealABIvy",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "cdcee62b-a330-4487-959c-c9d0e5e03d6f",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2116872a-83d3-4489-90f8-0d87d3e57116",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "981b277d-0250-4365-8297-ee92a3b1de21",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "341577e0-74f4-410c-b64b-ddb1cd1b72fd",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0519ca44-c765-4bdf-97a9-236f7304e368",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb017ad1-8b95-400d-bc19-31c2eb861891",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 306,
                                "precision": 306,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c191b64-385a-4db3-a79b-27085ae01dc0",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf5eedb2-14c9-4caf-9e23-deabf89a380c",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54edb009-8433-412c-b59f-ebdcdb7c824a",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "03f01f2a-9e97-46ff-87b5-18adbfbcf219",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "54e58b7e-4ccd-4620-ae24-7d8ad36ad011",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d2c3693e-9802-4b6a-8042-b56816d358ce",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12609b11-b1a4-44f0-9e7a-459d5e533347",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "84034155-6be6-417e-bc9e-9f72d581219b",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5a2c902c-c406-4989-8fb9-30f5186ee799",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02bbca8b-1c69-4956-bff2-2286ff11cf91",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c770184c-0d14-4e94-a2cc-867dea086489",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c5f756d8-a299-4360-8d1e-8fdd46506f47",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7ea3a727-9b85-4d7b-bc36-ee2ed3759197",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "72de24f2-ba03-40f9-947f-e8a3f3393390",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "10d2c900-9c8a-4180-b2a8-6e8780f87a3f",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70ac6d3c-3c77-431f-b23c-1ba26add69b6",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8640fb09-7d7d-403a-803f-5bec8c8eb20a",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "52bf3e56-63e7-4ec5-8953-c92b0325f617",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2bad7826-ac93-431e-a116-efeb7f7bbd56",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30d2ac05-adcf-4aca-a697-b3de317b4450",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "af7a9aa4-42c0-4272-b228-b8d884aca8c3",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5faf34d2-81f1-465c-9a72-eb13b467c642",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b54c643-24bf-40be-be77-68681693bc92",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7b2c5338-64de-4cfa-9294-df841dd7189d",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2268df4-d457-4080-9a78-ab134a45dc27",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "58a90efc-499b-4987-878e-929ad416ee03",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6c318a0b-1296-432d-9c52-1755abe71b34",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7ab4b937-a334-480d-91cd-cf1206b375ff",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "47de5ba7-7bae-4a9b-b71b-f95af82cbda5",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "64f4261d-9790-4b58-9e57-e821eec903c2",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b6e46c5-8fce-4741-84c9-e6610f558485",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "24862b7d-9fcb-46c1-a6bf-9f0d6e78d582",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "52e8ccda-bf3c-453d-962b-8ea9e03960c7",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf1cd40e-d5cd-43cc-86a0-7e55065ee98b",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0392b43b-b787-4430-b55d-b1c28d019f76",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7dfed365-7393-41cc-81b6-942bdece9422",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c7a2f90d-ef62-43a2-b2a2-6c341c19995c",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "58026d8e-edb9-4f3c-a1fd-1ccb500ac000",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "86a235db-08b3-4f51-9a51-b47b2fed15e5",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "901114ca-6d6f-4708-b7c3-ec4c6e1d5730",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba947a90-0780-44db-afe7-58bda942058a",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "710d56f6-ebeb-4dce-a35e-93f9b94537d3",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e5386b8-cee0-4a3f-be76-f10ab6781b5b",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ecab1588-4f02-4e86-bdf4-272e7188cded",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf3b6bd3-eddb-417e-840e-c32022a3b578",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e11c8df-4d63-4621-a1b2-e2eec432aff6",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d5d38d86-60ee-4ebd-8324-523bfa2f6e3f",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "035c4cf0-3876-4593-80d2-49055590f73e",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "496d1442-99ea-4ee6-9f51-4649e8f26845",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b32806f2-b147-457e-8e4c-7825b2846563",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "93cd602d-998f-496f-9992-640bc16ec441",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "68adb094-4e56-4083-99a1-95954eb040f8",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bc67edce-f324-4bc1-9f40-e81f824756ce",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "129e6086-970e-4b34-ae4d-a308abcd332f",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "34a3e632-e836-446c-9d37-cfa36b72393d",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7be2265e-2a87-4dc7-8dbd-9cc1f16ec73a",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "730a2c18-7b22-40b9-a39b-38ce8d25bc33",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88424273-86b2-4851-8624-a4bff0705928",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b491d7ac-a242-450b-a9ae-561e8663c7c4",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "91d0af03-8344-4d0d-acfb-6c33c69e5773",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e539a3dd-b0f8-4ed2-ab15-08b62ec84628",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c8e42a7f-0ca6-4639-a9ef-514e1f8b9ed6",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71c645d0-b4d3-4cfd-a4c2-a863b077d3da",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "03f01f2a-9e97-46ff-87b5-18adbfbcf219",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "341577e0-74f4-410c-b64b-ddb1cd1b72fd",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "d25849fb-b4cd-4ee8-8981-8dab3b776e66",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\naggCustomer.default_account_id,\r\naggCustomer.site_name as site_name,\r\naggCustomer.site_id as site_id,\r\nconcat(aggCustomer.site_id,'10003',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat(aggCustomer.site_id,'10003',COALESCE(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect \r\n\t\tbrand.name as site_name,\r\n\t\tcast(brand.id + 1000 as char) as site_id,\r\n\t\tb.id,\r\n        b.default_account_id,\r\n\t\ta.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\tinner join brand on b.brand_id = brand.id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,208,325,478,511,664)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,208,325,478,511,664)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,208,325,478,511,664) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,208,325,478,511,664) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t3,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6123762847da4e002c97ed05",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiAoP3g27zBsTBhENM+dBsf62FQyEzHEvyCyA1AFqG0Wq82nAt5YxcjG5bUujZ6mLgw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "26616aeb-f319-44d6-8d5d-a32830a1f60f",
            "fullname": "MySql:c10a896f-75f3-45b4-aa0c-d2280d5a4356",
            "type": "extract",
            "name": "c10a896f-75f3-45b4-aa0c-d2280d5a4356",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7351fb65-5eeb-447f-9e66-a02024e89693",
                        "id": "tq_jrmGjek1B",
                        "name": "GeniusIG_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1b82a288-3499-4c4e-ba7f-5971b6581360",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "efca58c4-071f-4490-b20d-7ec724288e60",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72ef4bdc-78f9-421c-ac93-26a78ee173f6",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eed32326-2455-40b7-b758-62ebf49c5a96",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e5694ef-02e2-45f3-b006-dda6b23cfb98",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d20f623f-6b10-404b-bff7-c89d19d4ef30",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6567632-a6b5-44e1-9144-e0e2ffa33fce",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9469c2e9-7972-41cd-9395-43c73ad949df",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6fc2799-8182-4efb-b798-f7e866df8667",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7cb4b13-ce9d-4045-88dc-543bdc98a745",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9bebeaae-c272-4b77-8592-94f23170bd53",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b21b829-d1ab-49ea-ae1f-ee4f0c53cdf3",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f18b124-e166-4ed7-a1c3-619163813d44",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "593b6d2b-ff5c-4be7-8943-50b836ff9c4d",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f042ac9-10aa-4efb-a4cc-51c4a338f157",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d55edf2-1f3b-44aa-a2c7-7624b54a98b5",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c7296dc3-85f7-48c7-9777-226d6687d761",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6460af20-5275-42cc-bb46-f5aa81d5bd96",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cc4038e-477d-489f-bbe5-242730749f28",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3b6f9d0-e191-410c-bd4a-502adc16368e",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f951dd9-7f9a-496c-a2a5-d426674bdee5",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2023dc30-930f-401a-9387-d97a2071dd5a",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30d286cf-07be-41d5-82f2-99d37684f068",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe63e5f0-52ac-4fbc-8ea2-4daea02c68f2",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e269530-8b99-4f43-bade-d3d5fae8c705",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9d821561-caa7-4915-8078-ad9e15aa205b",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bd659eb2-8ce1-4f4c-8d8f-88df4bff903e",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0f959ca6-99cf-4a97-8242-e817fb36a893",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b31cdf29-ed2b-46b0-96e5-9e87c916fa44",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbde877e-1ffb-40a6-8ad5-621c701aa62e",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69210c06-e231-437c-ae07-751b88f2c427",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11df58ae-2225-4c5d-a36b-2ec7f6054670",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "388762fb-2f79-4ecc-9e12-fe4e5c366e3b",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "917775af-94fe-48c2-a8a0-8aa31f665d1e",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be45dbd0-7ed6-4aa3-8c56-e3b3252f6d0c",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4fe3107a-1d5b-4ebd-98dc-5945edfcfd53",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d193b01e-0d70-44d4-9111-08debce21fa3",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b107d5e-0fcb-4cfa-ae03-50361d06136b",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc94166e-1d9e-4952-8860-569b1a1b90e2",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d365258-8620-4c29-a2eb-a765e20ce5b5",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d246142-1b57-417a-a261-6f24b0d3f33d",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c6a7097-7727-4018-89e6-986a6b5f47b5",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c72d1c9b-b887-420e-95fc-b01e0ebd93e6",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a8ea70e-7b98-4ddb-a9e0-7435db0d6966",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9454cc18-ed7d-4281-9921-73caab6ddcd2",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd599834-763a-4991-b069-349d53798b64",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ba5529c-2fb2-45ef-b5a3-0b9ebef700c7",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ada83bb-f40b-4b12-bde9-6f6b4b843327",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40fc5056-26e6-4dde-84f5-3d7a4269de04",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5e16450-6b88-42fb-a9d3-0f74e7471eb1",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b73e1f5-1ec9-44e0-9ac1-d05f30ea267f",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8995811-cc8c-4fa4-b6be-70e2c0b0ddd1",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccf8367d-1814-46c3-9bba-cb3c21ae5854",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62f2be6a-a6b7-431f-8615-fbebde857c64",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51a26bfb-fb27-4f88-a6c6-0ecf514cfcdf",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52e20ee8-f430-455e-9d1a-4740e8995554",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52dd06ab-a4c1-4a7e-aa3d-1f8b95f2604e",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "228ed818-1191-4aca-a8b7-6b4bb89be40b",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a7cd37c-5c13-4674-9a6b-dcf0c05ac227",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f8d00dc-ec57-43de-91c6-3af0062a81d7",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "37ac63ae-f6fe-4dec-8f57-b3d7daa06678",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72a747bb-360b-4326-a623-b18715b562c6",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "388762fb-2f79-4ecc-9e12-fe4e5c366e3b",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "3e76230d-9df3-4c30-8146-e283eb344417",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32,70,78)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,70,78)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195046b6780f2002c37ecb4",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCkM37LkFbGnRhmt2tYLFqO1gr0leFAbxvqr45h97aRL2uFXV6bnmXjrx+upQdOgFiG2n1XzowSr7ML18mjmQhnzqjq1V2FUQMfFFcLg11wwiXozn0iLcNZcjGmBoyCW6IdyK2k1UjDiKqlSqoJZSuzAb/GTm3+JvHrvJTMCSB28",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2677bd6d-9828-4b34-82b7-349c79e988b8",
            "fullname": "MySql:e647231a-fa4f-4207-b8c5-c7b5a65c2ddd",
            "type": "extract",
            "name": "e647231a-fa4f-4207-b8c5-c7b5a65c2ddd",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "3b5743ea-f951-41f7-bcaf-5054794dc356",
                        "id": "tq_s2mH40JI5",
                        "name": "TradeTheBit_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f29f266c-ff78-42a8-a443-a2c6bdff4a86",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b189f8f-c5e2-4f27-9adf-002d03f72c7e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e32bf554-3da7-4003-ba4e-6152ffafb7b2",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "201d268e-c705-47a0-aa3a-ba122d2cd3db",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6923baf-ad27-4763-a272-d6aa3a49ace7",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5bdee9f-4ed4-48c5-a517-ee7fb5328d74",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0b3e9f9-fab8-482f-ab43-600b523cc07a",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc5f498b-28f4-4a8c-a4f1-9d14d1be1e2d",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa5106c6-be75-440b-9e8b-defc46695d9a",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f3bb549-e953-4cc4-8025-e0a2f022c7a0",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f75802a-72db-4e7b-98db-8e61e3a365f7",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cdc4849-4d2c-49b5-960b-ade11ea360f3",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79ea82b1-cb43-4421-8541-fffe17d44a59",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74035f50-3ee2-4c4c-97f0-53b16db637f0",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a867c170-5426-44b6-8503-ebe4c69120a3",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee198913-b52f-400a-84b1-8ed9a0f5308e",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "986098ac-0bb2-466e-9fc1-bdb84e2958b3",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f539b81-fdf0-439d-9061-0e466077b3fd",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0e471c3-94d9-4682-8c65-39b69d42b612",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0eeefb3-e5a3-4ecc-a62c-5ff75a91796c",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58253ac0-f4e2-47d1-91de-a4bc72934c01",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91c52e89-8309-4c6b-acdf-1565dc2fdb9f",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57070868-f56c-4af4-a581-4059ce29da79",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18d1010b-8048-40ac-8b27-759b4308ed4b",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a422d351-eeac-4fe9-99cd-0cbb72f53269",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "120e7a4c-5345-45b7-8487-aca5c7394dcf",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9130d08b-baf0-4488-91e3-ad2b3c70f0ba",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be6029b6-018f-41a7-86f6-05f756397fd0",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eed84b97-18cb-49ac-a51d-9a4d3ff55bb2",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "681e0601-08ca-429a-a658-e088dd2f1acd",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5de3fbf-0859-47c7-9a3f-d7093b66e348",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8940033c-cac5-4187-b7d1-845a3b8ae548",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c2589af-6b2c-4404-b2db-9bf92d113e09",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ccee1115-4e9c-4227-9386-731cf9d6fab6",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "654f7e60-335f-41b2-924f-169a98ad1372",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12718665-5d0f-4c1e-a299-3fff0b67062f",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "59ef2808-fcbd-41bb-8dd7-138487b4e737",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ffb29fe-3dbc-46c2-bc1f-574a86645e9f",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21ba7a44-e858-4603-80d6-3d3d6c67d428",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9d0722f-9ca9-4d4f-8500-4f43fa2294c4",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbb3f421-1441-4a94-9a5c-a919bd2b86d2",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d926a77-9f95-49bc-9489-d3658b48735c",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0df6e3b4-f26f-432f-80bd-db457d667b59",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d7d896c-c125-4e7c-8d62-86ac3953cc1c",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31e6dc0c-d2c2-4366-8fdc-f4a55cfa3e5b",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "829b0cae-7d2b-43b3-9fe8-cfaf7570cb7c",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "353c7ab3-8495-469b-8a06-25c48ed20d87",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "359056c9-05f8-4de9-850b-aee1b1abd320",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e17c9e9f-069d-4fcd-9ac0-55eec6b6a91a",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f19126fa-ce00-474e-8bd1-b202640359f8",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4aa02e1d-12ee-4675-89ad-2514abaa8f84",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "626fa256-1b5b-4f4f-a095-16e5ca7fd31f",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a69a112d-bbd2-467d-823e-647af3eedeb1",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "feeccadb-0931-4e77-9f08-9854d259bae8",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "804ae480-b48b-45d1-b00d-795924b73595",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7fb44444-154d-49b9-b154-2485e9d7455f",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2cfd09b0-0642-4ebf-8d16-16ad4db4f969",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1b9d5c0-8244-448a-acdb-a5fdf0cab677",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c12df023-3b12-4f2e-9beb-deecc89539ab",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09381c4c-daf7-42ed-bcc1-54312864d721",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba25a9d6-b994-41dc-a947-9be70d95a6e6",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f22ba4f-50de-4282-9d38-e2e00b97dab4",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "9c2589af-6b2c-4404-b2db-9bf92d113e09",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "43470715-8ac3-4011-994b-da356931d921",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32,70,78)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,67,75)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195043c6780f2002c37ecb3",
                "provider": "MySql",
                "parameters": "F954Cqx2+xpp7cv613X4To3KDLtYkIILY9DKa7o2J6iwT7Hhp/LuVGR7WVoXuAJR6pANxIXoQ9aWeJiI7OcJP72ZHBxG9xyN42erULpN5ZuqvWQ4Ab7IRfQ6FHGxrmIec/RVbJ5P1EBneN6L0WOHnZFugjR8UPuM7oh3rwSSnzvjLJFOJ0c2gxjMsXRaCgVGAB0Pjz5j/uHDcFPg85fyrANVftdnJomPKg7Rk6G5kbKEybu1E9znVlAXap1CpXX6",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2693c2f2-2408-4222-bdfe-f3534dd50ab2",
            "fullname": "MySql:3e1a3f66-5023-4bbd-b646-d077096e6ce5",
            "type": "extract",
            "name": "3e1a3f66-5023-4bbd-b646-d077096e6ce5",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9c0e4922-90dc-4306-8927-260aa14f4557",
                        "id": "tq_zChnh8IFn",
                        "name": "York Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "05284304-ed89-4165-8d6a-5aec76d84cd8",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "124552e8-7a1d-435d-a9df-408c676126ff",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba382676-7c67-441c-8d94-ab4ad85b17a6",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39ad9bc5-5fbe-46bd-bf3b-ec06293fb93a",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9d3f3e0-7d44-4904-ab1d-8e0b25f7ae94",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "5309b4f0-1ad4-4cd5-a5f5-e90281cc7442",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5338a56da002c36c67e",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiXsMSYsuAL/CbGN4aqsTqQK37h2jvswX7OUxbO5ncsXT5ZAQx6xX8RhjlXWOBl+OUE=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2aec64c7-d258-4767-9474-0ae6b57cd23f",
            "fullname": "MySql:112ca852-f7b5-4b55-b3c2-d47ddb4b681f",
            "type": "extract",
            "name": "112ca852-f7b5-4b55-b3c2-d47ddb4b681f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c6c736df-28fd-46fd-970f-43fad45db41f",
                        "id": "tq_Qx9Aj96QZ",
                        "name": "Bitfinity_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c93e0437-6709-4a57-85c8-9e7754a1c0b1",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "634ff554-bc69-4421-ae7d-8f450d3ca3da",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7d64d18-2971-4eb7-b78b-58dddd7baa97",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f1f5f00-8d71-49e8-9cad-0cb45ffed30a",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c7feed7-9b7c-40b6-b7d6-c5c0a700cdb6",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 3,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "656370e5-58a1-40e0-8306-264aefa8597f",
                        "configOptions": {
                            "importQuery": "select\r\n\ttrader_account_position.id,\r\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\r\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\r\n\ttransaction_record.wide_currency_amount,\r\n\ttrader_account_position.`type` as order_type\r\nfrom\r\n\ttrader_account_position\r\nleft join transaction_record on\r\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\r\nleft join trader on\r\n\ttrader.default_account_id = trader_account_position.trader_account_id\r\ninner join brand on\r\n\tbrand.id = trader.brand_id\r\nwhere\r\n\topen_at >= 20190923\r\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61964b7a3f1f2f002cf16c41",
                "provider": "MySql",
                "parameters": "19x2eB8ph2aYc/juzRJhdXmHOGk/Q0LOo1mcPAZAkzQ0rOYfaoDxpFcxuWNBv7R5KV0O5tYU8i2V/PjWAUeDSLhONZ0UCFxUB12m91h1eHOHdzR+SB2d9VJoCcpD2m9S5HXy2q9B6RLuhWzexgEBZWWpbuLtRZNIioiIe+Aak0+UQZCbTaPF44h+UqblYtn0GbA9u96R0kzZhm8bt0OQY3NtWmYnwdwQiprKhRjTZlxlHYq4bo/AURRzeuo5J+ph",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2b38e5e8-5571-4f8d-9418-aacc63ce6ac6",
            "fullname": "MySql:6aab2da1-56d6-4d51-bd3c-c228dc0cbb90",
            "type": "extract",
            "name": "6aab2da1-56d6-4d51-bd3c-c228dc0cbb90",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b6fa244e-81c0-4a7f-b81f-d0b805830cac",
                        "id": "tq_19ZJWFGXJ",
                        "name": "Chelsea_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "56b9fc8d-9f2d-4191-913b-670dfe17ee01",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "feb032dd-d0df-4084-b45d-2b0f56960b52",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78af5461-2f66-43f6-8d43-5b3b0299d345",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3dc7415-e677-45c4-95a3-7b3feed3b939",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "088a781e-7af7-4901-a11b-ed885aaf378a",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "5ae7b8e8-84bd-4806-b4e5-0432c5ab509c",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5338a56da002c36c680",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lmoVQsTevINebgL5jFjt37tZHVE1yfCNBl6wIlYq6wI7NUggy3EK86zDSbM4Fw27FcQ7WJjO+t052mJVx7AZ+Z6gWRvGvZ4n1PPPLo5KaSvMstq72ErNzPegcuzwKce1NBllSBZUAXHjSilY0GlglY61i6z48l5MvN5HzcxxLj8",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2c760779-86e5-4687-bbce-aa5350b57de5",
            "fullname": "MySql:6b8f11a2-c8da-48b1-ba9c-6d4979ea1ced",
            "type": "extract",
            "name": "6b8f11a2-c8da-48b1-ba9c-6d4979ea1ced",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "2ec6903b-e7be-483d-811d-5160b10b8e2a",
                        "id": "tq_qxmcnR5Sk",
                        "name": "Prime_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "73267600-3d30-456a-a195-0390f7b49c7d",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "318f5066-9350-442d-a13a-5cad37042c30",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73d3c236-1a28-4784-a806-b12ff166c739",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4b959730-4da3-4d87-83de-251a5c727d24",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de6f7181-96cd-4c3e-be32-c05e932a19b6",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c43b7119-f1e6-48f0-ae87-97d19a5e2c32",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 \r\n"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171338755f384002cf10202",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CLQO1pn40szcYNg2rZoiX1Vg29Vp5lwLqTDoBiPX74Z7tq4A1c99blLl+UTfHxXxv3fHMdNaD6ZQ0AYwLSELF3A=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2cb5f74b-a975-4ba9-b5f1-abb47c9f569e",
            "fullname": "MySql:dbc037b3-f5c5-4bdb-aa83-19446eeadf00",
            "type": "extract",
            "name": "dbc037b3-f5c5-4bdb-aa83-19446eeadf00",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8ae5f9cb-e9c4-4f57-a799-8c53244d23ec",
                        "id": "tq_Yka3xuwba",
                        "name": "TheBPCA_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d5583e8f-1b2c-4c96-92f7-c86566cbfefb",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38899b6f-bd91-4188-8d03-a17319303f4f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b3c6b20-1394-4ce9-93aa-c748b388d5ec",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b09e9b21-ce62-4c4b-a120-9bfc8f841d86",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "886482a2-4480-45b2-84d1-384cf5c829e2",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ba4b8a4-2f26-40e9-9027-d628be30ceb7",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "853fe19e-ac9e-49af-ad7d-d3a8477611f1",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "430430ef-f60e-4b1c-a769-b186161b6a8f",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f73af64e-1b2c-4969-90d6-d7b697fef135",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03c6cf77-5a98-431b-897d-da550fd1da17",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "64552d05-15c8-4cfc-8f6a-1de447a4caec",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506d16780f2002c37ecd4",
                "provider": "MySql",
                "parameters": "Li2FpOBZkuQVFHmglvVO3unF3cyE7uQhXYenrn6ytNP08dPSNopcrZhCPhIEZbJq3GHeZmZNPZrQfHZy7Mo7S3QwZl+lJvy8mcXjoPWADHn7fHD/TXsGlpkaRPNOQnFO1tEd5xDHMHRh7i0mnvMheVsy39u8/PLd+UW23hnoTWzeGuy1jl1t9vmXt8xw1uh0Lw271DKaGVhOc5Lst9nqXnRu5pPfVPjIho4oBLMYdZDsXAdGAFkgsULvW5O9Ut8l",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2cebd4be-6193-4769-91e4-889f9ae785d7",
            "fullname": "MySql:d2791c95-6dd8-4d87-b03d-95a7925fd3d7",
            "type": "extract",
            "name": "d2791c95-6dd8-4d87-b03d-95a7925fd3d7",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "2744326e-aa92-463e-be31-83e72527bfc2",
                        "id": "tq_79l9spQhQ",
                        "name": "Chelsea_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b1d99368-bc27-4b70-b318-22ba1f033e0a",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3204803-cccc-4ac1-a893-a108a7612395",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e342762b-5a19-458c-aefb-b3edea71288d",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48451b2a-cf39-4d17-87c9-a68fdb75a15f",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9f0a09a-1f4a-431a-87b5-f7f8b6faabba",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a48cbaf-6080-4109-8bcc-9626fa303c8a",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1e4583b-f5c0-4c44-a5d5-e5e57def8ef6",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25788982-b3c8-4fd4-b371-8cd69c2fb2d9",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "959810ff-7c92-4d66-aa8b-6da5fec72f65",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0386f6c8-38f2-4266-8891-ab298db304fd",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "974b9028-c391-4cf3-97a9-287788a0fd77",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506c46780f2002c37ecd1",
                "provider": "MySql",
                "parameters": "BE4OxiDqsaVb+1ukLM/AG3kiM0mBmEnf5+RF0FNWdMvVMRLKEGHP7i8Jb4OVv7CAoJrH7a/nkykrGiit3FSG/m85DPOX2IUqB6qOs2clw5riXmxFSMuiF3F8MgrP3MH12R4ofvsfF/fYNHAGVdVhOGjYUgjhzKoG+h+ur0i61f2xq5hHO9UjwqjzFmrYrN8ntau9AUUkD/MC6QOashL2AjWRcvpvZbZikoelSn8/Tb4Qv8PiC23gjgUiJBr0/QAq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2d3ceefd-557b-4bb2-9d25-a44145d75df2",
            "fullname": "MySql:fbf0c69c-37e8-4b92-a2ec-ce14a07eb2bd",
            "type": "extract",
            "name": "fbf0c69c-37e8-4b92-a2ec-ce14a07eb2bd",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1d111d81-ac89-4bec-906f-f09e57fe035b",
                        "id": "tq_0eJf3Past",
                        "name": "AshfordCapital_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b0ce7fb1-22fc-4b8e-910a-de066e295b4e",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b5ca572-2735-447d-9d2a-195d06043c83",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "483529db-0bb3-434a-8c33-46273e87c098",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "640f220a-6bce-4377-91bb-b2c0a5f292f2",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0d09399-7019-4407-a5ad-1a81de84851b",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf64fee1-4d3c-4056-a635-c5353d15ffec",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c872b5ef-0a05-467d-aebb-491e3ac197be",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "194622b0-42c5-4724-9f45-ef269011c490",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "876fa614-d037-4b14-a12b-8449d7ce332d",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3f566e0-9d2b-4f37-9577-5c43bbc633db",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c31c106e-8966-4524-a143-9196576061e5",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506966780f2002c37ecc9",
                "provider": "MySql",
                "parameters": "Oz2AfvRo3srlztUw24mN8xjULQgCsDxE8xdGvyNUDfDIDVlPEvzGPi9X1pOk7WkJorypT3vAhcaensqPr3DxJWq4DMDr4Ntq8hg/ST/QG/Ry+Mc5Itvb7ssjapRdR/f5pJGa1CgTA4+V9S7ZAeHlkIJ8fCivOQ1bPR1RbzXK2+kyaVjENBts5VNtP4yYjGtpqTycZGcbTdSdI98JCq+mp2IzDRzS7cexXuu83rKl7MG3hlCMfvhn4khms5onk7u7",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2ea7ea6a-3271-4709-8d6d-8d0a8e539998",
            "fullname": "MySql:17d29f6b-2ff1-4e87-9850-bf54f94493d2",
            "type": "extract",
            "name": "17d29f6b-2ff1-4e87-9850-bf54f94493d2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "3ec7f3b8-022c-4309-9760-b3b84b161ccb",
                        "id": "tq_sYbPzeR5g",
                        "name": "IvyTrustCustomers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e0ae6ab6-2537-4455-9c3d-4489ee504201",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4142c1e7-90a0-4987-b1ba-d6bd2d17546e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92892248-4f3d-41e7-bf74-4f5bbab3343c",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e18c95b5-3c0d-47c9-9612-bc86ecaab58d",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8aece5ba-8de6-456c-a86c-51b76f0e34d8",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "681437d0-a7c7-4804-badd-d057de2ce8dc",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "854cb865-d12d-4cf8-8526-773ca0d6a29e",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "73f0894f-5b5d-49ab-9438-71ac5ed3e7b0",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "787b6f00-7271-42f2-a1eb-113118ce3b32",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53d26ed6-6c0f-4c2c-b51c-21898d055eae",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "13ee8f55-0d0a-4fb4-a768-a2bfedb34e9c",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b262cef0-5fcf-49d6-85e8-0587ec8e6331",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f913b138-4562-4089-9e98-87aa5908af72",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7519911-f52c-48a7-bb0a-462b57041246",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17e9f9cc-caa8-4e31-8d91-d851716f3d0b",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 306,
                                "precision": 306,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19e87e3a-aafe-4816-ac90-e4bbf6cf3445",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "809e94f6-2355-4a02-9099-7ea76f2daced",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "59b9d6c0-85d1-49be-8683-b03db9f6c7b9",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "711043ec-9a96-4e82-913f-2ee27963af72",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89d482e3-1616-41e1-baad-bd76073c78d1",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be6ce3a8-909b-4048-a3de-a86027164144",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eedff359-24b6-4e94-b240-8af005e40a46",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2494dfb-a0f3-4d19-93f5-b2969323ad17",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "411f8392-d900-451b-aed6-e6712eaecec4",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9de8563b-f15f-4884-ad07-e0562718b815",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9ed2cf4b-f46a-4a01-b7ae-1756af2405d3",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17a4f31b-392e-4058-9c9a-61942279d32a",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c250baaf-6669-44de-9d06-6b953146c38a",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7118154d-d0a6-40b7-9834-83f4da4b821f",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5020238c-3535-47c7-adc6-2169cefba8da",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e8802d5-3aef-42e1-a487-c5b93437e625",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03d19cc3-41b6-4171-93d0-a7d2eeec929c",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8b50557-19d4-4174-a7bb-546ae3815e91",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7553bc10-52dc-47fa-b811-6d82df7bcfbd",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b4be24d-8123-41b8-b245-de088dde1f50",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b46296b-47a4-4bd8-8e82-7fdc2b642c64",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4759d11a-9d19-4714-bddf-4591771c5beb",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dcc51731-6638-4d18-9b7e-fbbd229b0773",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba5ad57b-61b8-4fff-9bf8-ff4f63abfe5a",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0752eaa3-561e-41f8-92b7-a48e9a870863",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b45ad060-74d7-4ad7-be6d-e6931bdcb433",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "468c9cee-6fcc-4807-b535-51d2f84fd200",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3a19e8cd-e75c-4e0e-b58c-185629852f54",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e6792f56-b7ff-483c-b005-11bebc5f000e",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0f64bdf9-9e6e-48f5-94b7-4254991b5c6b",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cf2e05d0-7be7-4fc0-8f70-a3588924934a",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "427e48ef-1925-45b5-b853-cea66fc6339c",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2be9e2ce-2879-47ab-a7db-8e1bea4efd38",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6537a5a-cfb3-4538-8d73-6355075f47f9",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8a9ac95-a034-4f6b-9a67-36a713b4e325",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "619ad5d5-ba21-4a3d-99a1-bd807544962f",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "36838152-4774-460f-b568-d24972115848",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "72012f64-2adc-4f4d-87dc-fd40014b4f11",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e24ac7f1-9e2c-4a7e-a8f4-863391f0fd08",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b49a2e0c-a3c4-4cfe-8861-967048098d2b",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9948c1c2-4c44-4fa2-a0ff-4d28cc84d492",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "333bed13-f1a3-4f90-8bf3-39494983937c",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "750b77d5-341a-4380-8fc7-64b7f9ff7c9e",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f35907d7-f5e0-4094-85e6-b20c637a03e6",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e641dec0-1ec6-4b3a-848a-cc5a45d691eb",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98488eaf-6e50-4cae-95d7-1c8dd1f0ce8a",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f0915e60-7114-4d0b-992d-dd0707e689c5",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "e8b50557-19d4-4174-a7bb-546ae3815e91",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "39f02584-257c-42d3-b038-6a1f9a822aa2",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\tbrand.id + 1000 as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( brand.id + 1000, 10003, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( brand.id + 1000, 10003, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_redeposit_1k,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\ninner join brand on trader.brand_id = brand.id\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,208,325,478,511,664)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,208,325,478,511,664)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619502f16780f2002c37ecad",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiAoP3g27zBsTBhENM+dBsf62FQyEzHEvyCyA1AFqG0Wq82nAt5YxcjG5bUujZ6mLgw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "32c60925-beb9-4238-902c-f77813497d29",
            "fullname": "MySql:e36dcca8-24ed-4319-9d69-d0c3de161682",
            "type": "extract",
            "name": "e36dcca8-24ed-4319-9d69-d0c3de161682",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "772ae374-cb1c-43b8-bafc-87805b6d7ca2",
                        "id": "tq_gc8aYRZ8A",
                        "name": "InfinityCapitalg_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "3f126609-5b31-413a-a700-c52a3f1c0f4b",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b2698db-0ddc-4c24-afad-3515734e4050",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b190bed9-8a90-45a8-bb2c-b1b56229ce3e",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0ed87fdf-18aa-4ef8-840b-7db0692d4b61",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22981b52-9bda-46c4-a056-8d946552d67a",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "dbccf16f-f1d7-475f-973c-81fe30f4cfc6",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171340c55f384002cf10208",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "33e466d8-3d4d-43ea-87ce-36f3d9988998",
            "fullname": "MySql:ebc0b79e-da7c-4b29-89b8-e56258de2e7f",
            "type": "extract",
            "name": "ebc0b79e-da7c-4b29-89b8-e56258de2e7f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ad8a0724-e036-48fe-af99-c3ddf6cdd46b",
                        "id": "tq_j3JQlXKQC",
                        "name": "TradeTheBit_OpenPositions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a77a4a61-533a-4e16-a923-323a03bd72ae",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1724c1d6-e298-4f45-8e4e-75b8d240af15",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b24f58e4-bde4-4e24-9cbd-2f89cb7c6363",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3af2f06-efbc-4689-aadd-ee508e5760f6",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9a072d0-041c-4569-96a0-3f9a82977f37",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "007df401-bcea-41d0-97fb-01e41c79a132",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91f52a80-1a9c-4e69-bf2e-5e222ac24560",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a2689af-1e30-4c0c-97d8-685a643383a7",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2105716d-f9d1-4cad-b626-008fcf8cdad4",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "96bd3f38-bc6b-4198-9c12-610fce5804b2",
                        "configOptions": {
                            "importQuery": "select \r\ntrader_account_position.id,\r\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\r\ntrader.default_account_id as trader_account_id,\r\ncurrency.name as currency,\r\nuser_currency_vol,\r\nsystem_currency_vol,\r\nsystem_currency_vol/user_currency_vol as exchange_rate,\r\n(trader_account_position.pnl)*(-1) as pnl_curr,\r\n(case \r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\r\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\r\nend)*(-1)\r\nas pnl_usd\r\nfrom\r\ntrader_account_position  \r\ninner join trader on trader.id = trader_account_position.trader_id\r\ninner join trader_account on trader_account.trader_id = trader.id \r\ninner join currency on currency.id = trader_account.currency_id\r\ninner join brand on trader.brand_id = brand.id\r\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5338a56da002c36c68c",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6tIYtFHDx4PVY74RHYbsI6IhvMp8sxqqBTdleDWDyt2e+Fyk3LcoEnGSq9Vlhg0xsd3y74BZLzC/tlv2s7a0hSsdYCs79vBVJyd5U3QQcpa+nUzjpMgHOGIHzjGpciIIMnNVFTvZoHUexzM9auLhAvlkGn+ldc2l33OfdgtL1+KR",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "375d536a-f3b3-4974-ac0f-d57323c06dfe",
            "fullname": "MySql:c70fef07-3930-49c7-8885-93f9d5d13159",
            "type": "extract",
            "name": "c70fef07-3930-49c7-8885-93f9d5d13159",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d23b80da-a9d9-4b7e-a46c-adefc75b0842",
                        "id": "tq_84JA8qMdY",
                        "name": "Bitfinity_Employees",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6fda9ee0-689a-45d7-832d-61125d06c860",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2005cece-1841-4d1f-a1c1-e0f0d2862a27",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4961e14-acc9-407c-bdd8-888d3663bc8b",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3172fdc2-f4f1-4d40-b15c-975a146b832d",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c95fca3d-7913-4c59-870a-aa76f4ccbb34",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d6aaa5c-7210-4eff-b7fa-302a3ceab8b4",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c5e6728-0198-4b80-8613-03ddb840fe1a",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1c2a8a1-6e5c-4958-bd50-ddebbe1e0a41",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e88cbc1-cac2-41c2-977a-08c9e7dffce9",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33971421-8a14-4567-ab07-6e7751b90aff",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "56b3e013-734c-4932-81d9-2bb2e64e10a7",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619648173f1f2f002cf16c3c",
                "provider": "MySql",
                "parameters": "19x2eB8ph2aYc/juzRJhdXmHOGk/Q0LOo1mcPAZAkzQ0rOYfaoDxpFcxuWNBv7R5KV0O5tYU8i2V/PjWAUeDSLhONZ0UCFxUB12m91h1eHOHdzR+SB2d9VJoCcpD2m9S5HXy2q9B6RLuhWzexgEBZWWpbuLtRZNIioiIe+Aak0+UQZCbTaPF44h+UqblYtn0GbA9u96R0kzZhm8bt0OQY3NtWmYnwdwQiprKhRjTZlxlHYq4bo/AURRzeuo5J+ph",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3b046b93-8b29-4547-b310-8d6f7a493f25",
            "fullname": "23a7c689-d082-4de2-930d-3cb051749ec9",
            "type": "custom",
            "name": "23a7c689-d082-4de2-930d-3cb051749ec9",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0370c424-2d24-406b-a20d-b67c072d38e3",
                        "id": "open_positions",
                        "name": "open_positions",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "24a38c55-6c31-4dc1-817f-a9946241676a",
                            "expression": "select * from [York OpenPositions]\r\nunion all \r\nselect * from [Prime_open_positions]\r\nunion all \r\nselect * from [IvyTrusts_open_position]\r\nunion all \r\nselect * from [MarketCG - OpenPositions]\r\nunion all\r\nselect * from [TheWealthCore_open_positions]\r\nunion all\r\nselect * from [Arrowteks_open_positions]\r\nunion all\r\nselect * from [AussieTrust_open_positions]\r\nunion all\r\nselect * from [InfinityCapitalg_Open_Positions]\r\nunion all\r\nselect * from [365TradingFX_Open_Positions]\r\nunion all\r\nselect * from [TradeTheBit_OpenPositions]\r\nunion all \r\nselect * from [NostraCapital_Open_Positions]\r\nunion all \r\nselect * from [TheBPCA_OpenPositions]\r\nunion all \r\nselect * from [GeniusIG_OpenPositions]\r\nunion all \r\nselect * from [Chelsea_Open_Positions]\r\nunion all \r\nselect * from [AshfordCapital_OpenPositions]\r\nunion all \r\nselect * from [WinGroup_OpenPositions]\r\nunion all\r\nselect * from [BendigoCoins_OpenPositions]\r\nunion all\r\nselect * from [Bitfinity_OpenPnl]\r\nunion all\r\nselect * from [BigBitMarket_OpenPositions]\r\nunion all\r\nselect * from [AigMarkets_OpenPositions]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "bec5d5f3-e17b-47f2-b748-6f9cbb93ef55",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3da429ec-6bc8-4688-b1e5-04d2264d4e4d",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed484be4-89e7-49c8-8073-62a6484c5d24",
                                "id": "bcd4321d-f91f-4dcb-b96a-9d099fb7f67b",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cd202a8-7765-4786-b9fa-3c38437ab00f",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a958863-7f65-46f9-84f4-fb8524287773",
                                "id": "7ebb5567-fc9e-41bd-a46e-385cdb5496f8",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61d1e1ce-a0f5-477d-b9b6-ec53391c4b30",
                                "id": "25066fa2-51b1-4e8d-b5de-0eb9e9336df6",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c8a88e7-5d3a-42b8-9f90-f961448a4d21",
                                "id": "9675133a-6a2d-4f24-b9d2-a78dba0b3021",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f80e7e4a-b9e4-45a4-b94d-391f78082428",
                                "id": "fb5f118e-9638-4bb7-a9f2-2e9201e7c032",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d6c5425-0e71-457c-88fd-c90cac9f70fa",
                                "id": "c34a6c21-48d4-4182-b687-5fbce9dfee69",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "1563a46f-4442-4453-8208-daae931cb679",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "3d08f45d-7063-4782-86a8-c4d014ba87bf",
            "fullname": "MySql:8417db6d-45c0-4129-ae9c-30868914e1ec",
            "type": "extract",
            "name": "8417db6d-45c0-4129-ae9c-30868914e1ec",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "96cc8c86-8146-41e5-b223-bde45c988aa2",
                        "id": "tq_xelx6lUYz",
                        "name": "Arrowteks_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "545fd29b-02bd-429e-9eff-ac0a3f384ea0",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "310b9cbc-2587-4bb6-8d16-b67dcb30a8d5",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28ad3679-e1c0-4663-ad5f-c6b27bd59a07",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d614667-1005-4813-83a0-19f96c5446f3",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db265ab9-e4d3-41a3-a414-6d4451e2221d",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "d7f1a781-6f9a-48c0-907a-14554b4379c5",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171351e55f384002cf10213",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3fe2eedc-4658-4e39-bdda-46db32676b14",
            "fullname": "MySql:85214ece-b38f-4f19-ba1f-5b63f7e953df",
            "type": "extract",
            "name": "85214ece-b38f-4f19-ba1f-5b63f7e953df",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7dc5d14a-d799-440c-9481-bd884f6278d7",
                        "id": "tq_S982DF3ay",
                        "name": "NostraCapital_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2ce12ebe-6ec1-44d8-bea4-20a802c8d9c4",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c69c7615-0126-4f65-ad3b-2f812144b7da",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e034d80b-5278-40b7-b772-f46c4a86ce30",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7addfc0-fd79-452c-85e2-4b0fa542d581",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dec53b09-a7aa-4a14-a637-34585c5daea8",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d557bff1-27e8-4e38-b349-a682e53683b0",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a432ef6a-43eb-41e4-befc-1c536e74d0ce",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b42c4b8c-d357-486d-bdf2-eba3fa8ee686",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de9e554b-903e-4bc7-a656-8bac0c6fd8ea",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6277d1b0-0205-434b-8d8b-cff37caea871",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a278eb2-333f-4b0e-baa6-f3615dbc0c9f",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23559d0b-f28b-447a-a0d2-a044a91ac8a7",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5de7fdf-6702-449b-877b-4490f1461af0",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d38ae57-2702-49a8-a390-039c6bb0a8c2",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c68d979-213e-4197-97dc-fb6993a5023d",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db08ab2f-1b0f-44ad-af90-e960721c4dc0",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c88715d-c097-48f4-b83b-736336e4b4a8",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24f0c115-ea77-4917-84e6-a4d9bdbeda9e",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8703817c-7641-412e-8640-aa933ed81ceb",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5cc5b3d-303a-4e70-bde3-bb2198225b06",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d8192b5-9d3e-45c2-844c-b10efc31816f",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72fc1dab-7567-4d7e-8cfc-2f0d124e276c",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e84cafa3-0b9f-4a8a-84de-fc93da6b6ef7",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63f6fab7-269b-4526-b210-01b3b9a32b17",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b1eb14c-b7fe-473f-890d-8aa1e491cb84",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e8dd051d-d175-4d58-bc34-648a16b3a5ba",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4ac611a3-379e-46ed-a5e7-3757832e0180",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5268adcf-533e-4d63-ab93-eb1aef37784f",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4795c57a-dd19-4650-a5e1-bc86d6275aa5",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05d5b61b-b784-4491-9d46-82727370ad43",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40d42f03-77f6-420b-80e8-b57a31ffbbeb",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e36fc80-40bf-415d-b927-e63ef913996b",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22eaac63-0d53-43fe-8246-813f72cd1f35",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "171e2454-87e0-4c74-bc02-d0eb0a67cff3",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42bdc7ea-8eba-4787-8cd2-f4e6c078057a",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de7f8d30-8c5b-4712-a7d6-bd3d43c3c40f",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e87cac8-caf8-40ab-8f6b-a61cfc1a5121",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dde0c957-b068-45e7-81dd-c5b2544bd17f",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c50b3af-99ba-4bd8-a700-7f26b3601ae9",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3aa6c90d-a5cd-4e4b-b308-9b08a6e89454",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d2425ea-ffcc-4949-9b73-5d4c09b7a6b7",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebd6b651-c616-4c9c-b4eb-f7b706de56c6",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "333e60ba-1cb9-4edb-9c0c-1870dc404a1c",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e60cedad-84b0-4a6b-ad89-0749b8f6cb9a",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "433c0ded-1b56-4afc-b0ac-bce71e866612",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51b79503-9be2-4c91-962b-42035d1a0edd",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ed668e8-44bb-4216-aa5e-9a57cd5162f9",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f838e292-36d0-47a5-8ea2-6e55cbc6fc30",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76db63d7-e699-4335-be12-7de853fe49d1",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9894d85e-c7c8-442b-a9e8-b5ddd5c9ec1f",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "760d72b6-fa1b-4b98-89f6-e4471ca2ac25",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9140a24d-89f7-4f15-8bbb-6e5ccbaccd5a",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39047de0-16e8-4c83-a810-b2e75ca0a5f6",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6d5d888-7ce1-44ed-8be4-0da04b195f6c",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82954b50-786e-45c0-8302-14abd8a2dac6",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be2cde07-444e-4b8b-ac05-dd06d94f99c5",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "481e56f2-e126-4dde-a022-77d56af8b36d",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "daad23c9-bfae-4c63-91cf-e2daa170fcae",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e9bc931-03f7-4c2a-86bd-fb5e0821b24a",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6eee2ede-7079-4393-88d0-31d89cc81c2b",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97e33bef-1126-497a-baae-c3f12f0a8851",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8dcb27ee-1f97-4c16-a3f3-201e7bff063a",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "22eaac63-0d53-43fe-8246-813f72cd1f35",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "36776c2d-0ec6-471c-8cd3-db926e964a84",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619502796780f2002c37eca9",
                "provider": "MySql",
                "parameters": "5zpNi1/ivLrPCYd3lQIeMwzQq5sAuc2YxZlngeeRz8hpTWd0H8LeepAHS57ZrJJbLGMhcYYJi5jTdTs58x9Ifb38GYxx5LABrwlbp4PgUKEopCjg+Bdl9PQiGCx8H7K7nWAdNIkesmJqig4SBGeNKtw1XDvwnBW3u/rrXgFKnw1iQo69EEWu7CqZHboIqgmOLsXk4QP+RQIQ0ffDKky9F0uishDV78kkCxoNl+Mfe8tBKYck/ulmOghb0RL9ZKCb",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "40099724-75e4-4081-b3c7-fc6ec2d95e03",
            "fullname": "MySql:2421fe6d-b6e5-4247-89b6-544cb2ffd3f2",
            "type": "extract",
            "name": "2421fe6d-b6e5-4247-89b6-544cb2ffd3f2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c183a2bc-766f-4087-a1a4-4fe299801444",
                        "id": "tq_QYVr3NBEi",
                        "name": "Chelsea_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "35ad8c55-ce10-4652-a7f3-399457b023b8",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5ed1f15-c393-428f-a163-4138d6fa8544",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "459906f7-3b0b-47c0-bbc8-555b55b5faf2",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2136410b-bd09-4e7d-bb81-dbffe03c0165",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f92049d-ba74-436d-8624-f7991e63114f",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27e42302-0c5a-4544-8cb9-4a0619a68408",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1765998a-b8ce-46ad-959c-cef15ca9f5c2",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28c4b0e0-499c-460c-b577-8493d96fd857",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "106daa9f-c7d2-4025-9434-ae402de8c0f8",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3e648bd-b73c-4282-9b26-2577a30123d6",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cac3fdd4-d162-46b1-83ce-fed5cbbcf4ba",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae0d88f1-e6d1-42f0-b279-17f91b909b51",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02c49ea2-b6f2-4d1f-93ff-b7dd947814c5",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "945a610a-628e-4a8e-ab0a-921a61a487f7",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61c54918-0b19-4ccb-9f1f-342834f1cf15",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e0025b9-f08b-4002-9ae5-97bbfe1039af",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "547107bc-2a6a-4a41-9927-b9b0504daad7",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aaa7ec91-4a4e-407f-8744-c2677b32dc66",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9724f197-3c35-412f-b0c7-9d74299f19eb",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0fcb14c4-27d1-4297-9fea-198c6f302812",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc659941-5642-4d01-94fa-40ae52febf7e",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "155cd418-e3e2-4b3e-a483-48455c7967ad",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb6a605a-f04b-40d0-b388-b45a8ee368bf",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d7c3d7d-ffb2-4dc5-8541-2211f95753ab",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "312a26e1-0018-491e-a3a2-c91ad1b76a4b",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cea73d32-659a-44b7-9dde-cec198f4305c",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "73e3dd68-85a5-41a7-b30f-7f21f4ed838b",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b04967e2-5090-4369-8965-7ae3380b4ff3",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77362fb3-800f-4b2e-96c7-4020ebb9cf74",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4245e3e-cbc1-4a77-8ff6-d88a1222cb97",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb95d12e-b7ac-4409-b96d-6e7d941cf438",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "487e3a9a-fbe4-484f-be2c-9aa5429e4226",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "801f2d51-3c0a-4ee8-9da1-e580ac890efb",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cbf809f-83c9-41cc-a899-94d2f00f2bcd",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7989f2a3-2f86-434c-b496-7557dab611f9",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17bfd0fe-8cae-4c85-8321-555c02dae966",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa2b9d3b-9fa7-4472-8467-b58431b5b9b0",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad5ecd46-c945-48d1-b3d1-f9660f6a4ae0",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9504d3f4-5889-408a-ad5d-53284694f455",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce9b3411-0fde-4421-ae11-fa6d844de534",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c052ed9a-75bb-437e-9385-583e03030b66",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f833005-64e9-47e5-a29d-41e0ec669864",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1bf17cf-610b-4023-9a9c-48a1cf6d633c",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c34a26e-da97-447b-b3ce-e4f90a9efa07",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "930eaaa0-2cb7-4a14-9ce0-272244adc994",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6f34c10-0827-45c0-9173-bfc4a6398f99",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab8d4ac3-31a5-463a-9fd5-5b37a98fb278",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "136e25b8-4d6c-453a-ad60-130c92e17eaf",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc9c5acf-1f31-47bc-95cf-eca5462e17ae",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb4f561c-1ec3-448b-a320-1e6f86558dc7",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc718941-dfc4-410e-bd17-a188e958a8b1",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d5423ed-6355-4474-8870-33300972a4ca",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c2d78c3-db64-4895-89d7-def001ca0eeb",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b37b7868-0506-4b9c-9d55-4766ed3d719c",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "651c0918-b627-4c60-8f25-589c2c60e9b3",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a73ab7c-44c9-4020-9493-9f6cdc726dcb",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcfab26c-006f-4950-92f6-900230e3eaea",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2164d866-4d3f-4ac0-9f36-1b361c814533",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "daa66bbe-18d6-415a-b766-6ea07c6616e3",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec0b17b2-8442-4466-95cf-04340fdaf90b",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53ee45c4-1835-46e0-84ce-9c199028d57a",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b789200-b6a4-4b6d-881b-78feb79831a4",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "801f2d51-3c0a-4ee8-9da1-e580ac890efb",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "1199d171-0d18-48c3-af3a-a9f3b298ea87",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id <> 24\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) <> 24\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619504d46780f2002c37ecb6",
                "provider": "MySql",
                "parameters": "BE4OxiDqsaVb+1ukLM/AG3kiM0mBmEnf5+RF0FNWdMvVMRLKEGHP7i8Jb4OVv7CAoJrH7a/nkykrGiit3FSG/m85DPOX2IUqB6qOs2clw5riXmxFSMuiF3F8MgrP3MH12R4ofvsfF/fYNHAGVdVhOGjYUgjhzKoG+h+ur0i61f2xq5hHO9UjwqjzFmrYrN8ntau9AUUkD/MC6QOashL2AjWRcvpvZbZikoelSn8/Tb4Qv8PiC23gjgUiJBr0/QAq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "4245bcf6-0797-4625-bb50-28b17adfe2b1",
            "fullname": "MySql:9bd2621e-3338-4451-9244-670b30ac5b86",
            "type": "extract",
            "name": "9bd2621e-3338-4451-9244-670b30ac5b86",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c1b58a00-5ae7-4742-985d-2ee626dd47d5",
                        "id": "tq_VaJJIlJ1S",
                        "name": "York OpenPositions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "cbccf84e-ca20-41a7-907d-42dba97f1f3b",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b5829749-f7cb-4c5b-a3ec-4a829e8c2c27",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abf1f077-0284-4494-a8d4-1309ae5e676c",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e29bcfa0-ddc0-44e3-906c-d0699760db75",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "89a76446-9569-4dff-bf27-453724eb95d2",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ac750162-7b7d-413e-8a35-c35f8f1e6a51",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd6caaeb-7b63-49f3-86cd-2941f76d0451",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cfdabca9-4310-4550-a62d-0fa728500b15",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "515010e2-241d-418f-ba63-6724461c701c",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "6ede76b2-b020-45c2-94ae-83ffb0d6c1f8",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend) * (-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5338a56da002c36c697",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFEmT/bcq/EycnRME8TGHq9ZgxIX6mgDymM7dLWqZsj+nMrkwVMLpfpzNPsDmI7cOke5W9nu6oGC9BKbiu7eT2hNVfAmhq11RY4q2NhjueqpLaC0+9I1P9SE8Goy/101MFw==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "45d3046f-a926-43c1-8645-2e5c371d760d",
            "fullname": "MySql:31e49664-2db9-43b6-ae13-1c115404f0b6",
            "type": "extract",
            "name": "31e49664-2db9-43b6-ae13-1c115404f0b6",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1b16d714-667f-46bc-8475-f73e287c002a",
                        "id": "tq_ZuszXF9It",
                        "name": "TradeTheBit_Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ed24654f-ddec-4522-849b-78e08d6ee00c",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c33c91a6-57e6-4c7b-8af5-340b02ebe24b",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7532f83-e679-4d9d-8fcc-53215976d2ec",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ade83397-d987-4bcb-9938-bf112d8d8d3d",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8b5ca58-6db4-481a-a26f-52fb4ec71c87",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "ac16ebf0-884e-4ccb-824c-d07170b604f3",
                        "configOptions": {
                            "importQuery": "select\r\n\ttrader_account_position.id,\r\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\r\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\r\n\ttransaction_record.wide_currency_amount,\r\n\ttrader_account_position.`type` as order_type\r\nfrom\r\n\ttrader_account_position\r\nleft join transaction_record on\r\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\r\nleft join trader on\r\n\ttrader.default_account_id = trader_account_position.trader_account_id\r\ninner join brand on\r\n\tbrand.id = trader.brand_id\r\nwhere\r\n\topen_at >= 20190923\r\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5338a56da002c36c69b",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6tIYtFHDx4PVY74RHYbsI6IhvMp8sxqqBTdleDWDyt2e+Fyk3LcoEnGSq9Vlhg0xsd3y74BZLzC/tlv2s7a0hSsdYCs79vBVJyd5U3QQcpa+nUzjpMgHOGIHzjGpciIIMnNVFTvZoHUexzM9auLhAvlkGn+ldc2l33OfdgtL1+KR",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "460bddc9-5577-4d8a-88d0-bd0c3598426b",
            "fullname": "bfd37486-7264-46c9-b32b-be2188a2c4da",
            "type": "custom",
            "name": "bfd37486-7264-46c9-b32b-be2188a2c4da",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c3235180-f012-49a2-9ac4-3639084e7595",
                        "id": "Count_transactions_per_table",
                        "name": "Count_transactions_per_table",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "8db3539f-c885-47ee-b58e-d08265877898",
                            "expression": "select 'PositionsOpen' AS table_name, count(*) as count_transactions\nfrom PositionsOpen\nunion all\nselect 'Transactions' AS table_name, count(*) as count_transactions\nfrom Transactions\nunion all\nselect 'Transactions_positions_Swap' AS table_name, count(*) as count_transactions\nfrom [Transactions_positions Swap]\nunion all\nselect 'PositionsClose' AS table_name, count(*) as count_transactions\nfrom [PositionsClose]\nunion all\nselect 'RealAB' AS table_name, count(*) as count_transactions\nfrom [RealAB]\nunion all\nselect 'Customers' AS table_name, count(*) as count_transactions\nfrom [Customers]\nunion all\nselect 'Instrument' AS table_name, count(*) as count_transactions\nfrom [Instrument]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5f3cdef0-7a8b-47ea-b7a0-2a312eaaf149",
                                "id": "76622b8e-9a16-40be-862d-7b076692e23c",
                                "name": "table_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7c1a441-8929-4ab0-8b75-aa7903f75edc",
                                "id": "bca27bdf-c5f9-4263-b12b-91af7584c654",
                                "name": "count_transactions",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "36e950fd-b8a5-4085-84e6-622353217b1d",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "47b2ed0f-67a9-4f52-b28d-cff4a7eb6a3d",
            "fullname": "MySql:878d9f3f-2437-4217-9d9c-aba985e31507",
            "type": "extract",
            "name": "878d9f3f-2437-4217-9d9c-aba985e31507",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5338a56da002c36c69e",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoheAP1kZvNi+4VpN1pRRv3kaD/RL2IIGntCq0mo/lZJkYw5sZYML0+enaqd6ElULbA=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "4ad91d7c-08f1-48a4-80b8-3cfd14e68a38",
            "fullname": "MySql:4516eb9c-1125-4d61-a034-ca9f38dd5b5a",
            "type": "extract",
            "name": "4516eb9c-1125-4d61-a034-ca9f38dd5b5a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8769c441-9118-4e53-92d8-22808abde095",
                        "id": "tq_cWIFandW5",
                        "name": "365TradingFX_RealAB",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c6162b3f-7b85-4be2-89c9-302d4b6d0779",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca7fb93d-737c-4c45-b799-253d39ae8916",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11eb02e4-9533-4966-86f0-99d5b34c8687",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ade3da86-cb86-4a16-932c-ee34d27b5a8f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15e84ccb-b59b-44ff-90c6-0a7b9cf97a73",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80487507-ee1e-4649-bc9f-a9ac8b9de344",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00440318-58d4-43fe-a43c-6c541c592ce8",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8e1084f-7507-4717-957a-924063bad1dc",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3622c28a-a9da-4c73-8646-f3b5b94d21d1",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "baecce7b-6378-465e-9f12-03326365500c",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "43a8c239-d972-4890-8de5-00fe3f91f8e2",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f68c900-479b-4e67-a5c3-b4eaba90ceda",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ecf9d2c-018d-452d-bac8-bd24c1e16f99",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21d90121-6bda-499c-bd90-cecd7abce9bf",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6a5ab0d-a05f-43cf-bb4d-95693a266a1e",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8351ca4-df9f-496b-a62e-9cd87698bed9",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4938b34-ee8f-4454-9185-4cd7791c62d6",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa198a4c-97e9-450f-9770-588a134cc73c",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6dd953f5-05ce-4e6f-97ed-4f1e7aad4464",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d5b9529-f879-4256-8691-ac1f66d86969",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c4534c3-5cdc-41d2-890d-d9e76c0cb3fc",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d10239cc-3d80-44b0-8763-c415793ff77b",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4216cfe-0802-4a29-8632-caecaa38e178",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d82e85a-f857-43e6-aaec-2776ceb6c05c",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5676610e-14c3-4c46-b6ba-f58afd212479",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "efafd647-3f71-4e46-af0c-827a281ff5ac",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6a42907-3a4d-412c-b1e5-edf0aeefbbd7",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f60c6e4-4005-446a-bf32-6a1c76956499",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00220072-2515-480e-b983-abc1109b69b0",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b88d7728-5e3f-4e4b-af03-f956f05c6fa0",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b75556a2-e0cd-4a3d-8fbd-a3c22f54a2f9",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9fc463fb-dedd-4545-9465-24e832228f3f",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d95a328-7053-4bf0-a334-16cca6467e98",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "173db39e-c540-44ca-9fb7-c371ee7903ee",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eec29acc-b3f8-4be8-8138-f66763ac22d5",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9345aea-4fda-483c-96b4-a12279134235",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d74202c-12f4-4484-b375-9827b4ac453c",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17954f9a-af90-4d18-aaf1-e67a62d0e10e",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e00afe2-4eb9-403f-a3a6-5436b36bab28",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cab1e84-44df-4ca0-954f-636b4486c591",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "305a726c-0c75-46c8-abe0-f534e20302fd",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb020b49-e70b-4582-9ceb-7a78c8a15f2b",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51dcddbb-8f13-4773-b3e8-17868403c390",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b800e248-a1be-41d8-9ee8-0f436e5f3afd",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66599f5a-ad7d-456c-a3fc-1d4b7f607b27",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9367bda9-097c-4e03-9fd8-9791adc1fabb",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5838f2c0-1363-4002-ae1d-1f167948348a",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55296964-fc8d-4e9e-b559-70a097934c86",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb6bfd82-b902-4083-845b-c015a3e3e18b",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca076194-1063-499e-a754-f6d35195cd99",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4629302d-a3df-4aab-a4d2-0f0e1b706e6c",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63b2f971-4d81-410e-827e-944c83e7daa5",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3d7d81f-51a2-4644-87e8-999f96060669",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "634386e3-a7cd-4221-a403-9173cb03a027",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72ad0467-1342-49e5-b404-d3a08f129fdb",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8dca920a-dd2b-47fa-8552-c30da6f9e876",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7c86468-b2d2-42c6-bcd9-446eab857d8e",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d02672a-7f00-47c2-9c18-b17ceb99a181",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81ed6068-b7a6-4f84-a66b-14dbfb85929d",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3c675a4-c890-47d8-83b3-9192d0532ce3",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83af398d-3598-47d9-a2a3-df4681c4ba13",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "facbce5f-f92e-4e93-8008-b50fd2982434",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c01d694-63cb-4f13-913e-761a062c0123",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "122f8f8a-aba7-4495-ad67-2328d38c8a8f",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b60206c1-3b66-4fb7-bc87-9a3ec30d2155",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49a7c335-2375-4905-a3ff-bfb5a30687fb",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8af98554-74f3-42ea-a656-03e58accb48a",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9fd1baad-c005-4f06-8a40-016027bd6812",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02bb378e-56f7-48f0-9152-66660aba63ae",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "baecce7b-6378-465e-9f12-03326365500c",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "b0d4c61d-af41-4b3c-af7d-b225a7288d65",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n        select b.id,\r\n        b.default_account_id,\r\n        b.brand_id as site_id,\r\n        brand.name,\r\n        a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tleft join brand on brand.id = b.brand_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,68,76)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,68,76)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,68,76) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,68,76) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n        12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5338a56da002c36c6a0",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6h2kEQfj06tSGpyh+xEzmk6Iq8paTu3ip6/rB+N1MFIYN59/xJKyq6s2pJ06bUpzhAANrOSGSl8zpPlUO8IwiG8A7d+Vz+KCoZhjqP9L+KHT5GfaypnOnu+badv06TGAXIJlaegbboPbyBtw46kZTRfJ2bJyakx/q48snRhZp8Cm",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "4bce9f1b-cda8-496e-a254-0a9cd4d41aa5",
            "fullname": "MySql:21e8da8c-4e6d-4426-a7fc-ea45adc6581e",
            "type": "extract",
            "name": "21e8da8c-4e6d-4426-a7fc-ea45adc6581e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "82f5c892-42de-4916-9265-e5575b22f829",
                        "id": "tq_P6J0HxH5G",
                        "name": "NostraCapital_RealAB",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e82bf837-9fe5-4e32-be1e-fc33dd92b5ab",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0e90af6-91ff-4a73-86c8-5e550a62a431",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6bc40dc7-6fdf-47e5-b246-ec51f2a66b8c",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b33d8771-15ea-4530-a56d-c46e9a6b81c0",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b67f73df-81bb-4fdd-82b9-c6bf40dca72a",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea9ebe0d-4d73-4839-ae6e-a182975edde1",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47a4ce25-12e1-4d88-b781-8b0a1371793f",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a8ecde0-e04b-4784-9ccf-443cb292424c",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17ca9bd6-c6a2-4f33-89f3-acd7abb934fe",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "519e4fb4-aa88-405c-a65f-32f528b5f5ba",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8865aa48-e4e8-4f3f-86ab-8c7c92d22c5e",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e4dff6d-ebd9-49b7-92e5-9ced6956a6c8",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "edaa6f22-4999-47a7-bbcd-5d24661109fa",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ae81dc2-7a8b-44f6-817e-15631a3d01a0",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "483e23c1-9cc0-461c-8231-66703b44d3c4",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dac932e-de6d-4522-ae7d-aad85019467d",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93e6bc62-f430-40e5-ae51-7e878bd6c183",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4abcea0-3ad4-4c69-9b07-0a579dadf7cf",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06e3d179-93e2-424c-b91e-3968b6d5c933",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4346a80f-c6ce-4492-b351-15b852608ebb",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "addcc151-c686-42df-a6ec-13c576edcfb0",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ef515f1-f19a-44b7-8942-727ba707e662",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb53286c-dfaf-46f9-abee-3c36fbca750b",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbb68fd9-6f7e-44ba-a912-954fe51f4a4c",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c048636-962f-4e72-801f-7f4e4cb2e59c",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00a0bf01-102c-4cda-9800-965f4e96437f",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79659767-d7ba-4905-ace1-dc23b3c60c3e",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26ba90d6-cf16-4c3f-b198-21a53e2912f2",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa8d19c8-2f67-4301-893b-c71f65a79012",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e55e817-f160-4720-9e40-aea938173631",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92e1ba5b-b615-4014-8174-61f773987093",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c543906-e38f-462b-833e-f1a3b0e70617",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0975fee7-0df0-47d2-bffb-aff23a9f4e3d",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2fcb4c83-c2a3-40e8-a50b-3f2ed6453276",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5bd116f4-6156-4a5f-92b2-44ca1f4bd002",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "336c4c2d-af7c-4fe1-82d3-6c8236a61a30",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8f46268-7d70-4797-9b73-3a3bd5ed2440",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d928bc9-acbc-47f0-850b-9b4395e6022b",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e0007235-ff56-476c-9864-1d85feb905ce",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e79efb96-8b38-48f9-b20f-4b77b600c005",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c903d12-f0f4-4616-ae75-88a072ee1c6f",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b130343-1805-4b9d-ad18-c3c68863e8c0",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e9c97f7-87a5-4b87-9e4c-53e92a28b69a",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45f40561-5007-4888-a0e1-2ce942c9c661",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52d93296-400e-4d59-8eef-ce43540c129c",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a48d23e-f8dd-4e14-a7f3-6ded3a340708",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bcd19704-89ff-40de-bff1-15bf3a2565c0",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e348135-0717-4c92-b895-c5291215f28b",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80ccae44-9cc7-460a-9730-f526c3a1017c",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c6017cd-2d9c-4a52-b4f8-97690614d815",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b7804ff-7742-456a-b68c-89f5f773beb4",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "452a32e0-4ca3-48c3-9f22-056367e5a816",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9288e731-5f4d-4f48-a9d1-817e5892b182",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40917323-b6eb-45af-8ef5-a48fca7766ab",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef3a1f15-9354-4f9a-9c9d-17b48e147253",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c272aeb9-2c7d-4533-b905-3caf98ad7cff",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5728e448-2367-4548-9b77-22925eacdcc3",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef543020-9709-4583-a384-bf21cf04c286",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "59150636-372d-4972-bda7-90178d282625",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd63c187-411a-4e2b-86a6-b3302f1c7609",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4d44d52-3d23-43a9-a26c-72d650ffadb7",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c82bf1a3-0c8d-48cb-b9a6-3b3bd82a64a9",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "145b12e4-1c45-4cf8-aa84-dee06cba7817",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55030753-19bb-4d12-a616-27f378566307",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c4992b9-f8cd-4f3d-80dd-8b52ad741aa7",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "caac33bf-d9b8-4636-a105-23e2a7b8e60e",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d08caa8-9792-4fac-9173-94652b5a0dfa",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81f40f97-de95-4259-9318-0860337c3328",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38c41998-c7dd-442b-82f5-4d6cd81e775e",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "519e4fb4-aa88-405c-a65f-32f528b5f5ba",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "71081970-ae5e-4ae4-a22b-301e6217d1c7",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5338a56da002c36c6a2",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6mkpXbI+4cVPcW9QmdR/OpFY0NV6lOS+yIHmY9aWUhUzSj1KLvCfMgcIqWzFtH2wB4wDE6J0O3kIYCeCTy2Vm2FnBTBcZ0ejYO8nr2tUHC3cyjEC9VpB/CP/XWAQHRXQ8biCOO3g3QegnOXaTTb/9ErFOuEJ8WFWhUXRuCVMOFyl",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "4c74d922-91d8-49ba-a19c-b46c0894194f",
            "fullname": "MySql:2f1a35e7-6951-4570-8f83-c85e44adeeaf",
            "type": "extract",
            "name": "2f1a35e7-6951-4570-8f83-c85e44adeeaf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8fd77336-a96d-4e83-8b9a-e0f51cb8bf7c",
                        "id": "tq_Qipjvw0ju",
                        "name": "YorkCustomers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a0832b21-1009-4079-a932-cf3081982e90",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "644e5a56-9a8a-41b3-87bb-739926787e91",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "441074dc-f648-44dd-8c32-03e417e0b869",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "106eb410-979d-4efb-8e0d-d57955e87a3e",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "665bf60d-7e07-4387-937e-0214d175d4db",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e5eb8a5-c679-4cbf-87a5-dea4f02f0608",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fa26b221-2593-49b1-8702-03fd71d8eb65",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1a9a23ed-3427-4395-a46a-2ec195dc5081",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dfbdf9cb-70fc-480c-905c-dad73d7e2415",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63fa1a69-3b83-4e22-984a-f481b172ff7e",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7fe8f511-c581-4664-8793-f2dcf4b63c8d",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "acfff896-4d36-44de-b211-80acd5969b1c",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "730f90fa-8a95-4549-a508-6eecbd3fe75f",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4218284-f8c1-4ed5-baa4-ff8f8ee39b28",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a09ab658-b67b-4ecf-937c-754b7588cc52",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f51dd10-b690-4505-a225-7ac7a2953442",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f5f82d3-ae94-4fae-baf3-fdfa01a2d2c4",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5bc28ae4-e020-4a46-b6e1-7229de53fecf",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35901a56-71a9-43be-876a-b6beeedc5a53",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "de77ee55-21e1-45d4-a332-a5e2efe7caff",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a5b9918a-4d80-420f-8db0-85deecb445c0",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b85c767-b734-492f-8729-237a5d8b068d",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ec50306-43ae-4135-aa4a-1837e78f6df9",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b7cec53-ddb6-4eba-94cd-8bcc1f3f6c3f",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30b6bb48-3cf4-4335-97b3-af0fe032ef8d",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "11edb1e7-334a-46e4-9321-a3997476e297",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94a1fa58-702e-4d4c-9daa-75ff2182805c",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b9c9624-bb9f-418f-9dc1-a1e41f559dcb",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff137cf8-917d-4fbf-955f-433142b43c4e",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b1ad8d6-acb3-4b8d-9c00-6b963fb73adb",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d80176be-ec72-4ca3-833c-15a3209d9503",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c81d46ff-e399-46a4-93f0-c7a96d070c82",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b34864b-08b6-4e3c-a0fb-d24a40399205",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ed8d460f-4772-48c0-a71b-36f038bcb7d3",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4bb6538a-574a-4b24-abae-b6fda84075df",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ddd7e0ff-6377-4ad6-9772-46b44434aac0",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0dbc1cff-0429-43f5-ac9d-4d6f353f5a4a",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cf603528-e502-4de2-aae3-0c8ce421aa4e",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "90feaa4b-3716-4144-b121-4a1890a8a68d",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1c74415-403e-4e26-84bd-0a24de32aabe",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a65bddbf-b3a1-4342-aa2f-7ce1d27e0654",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e555c04d-23ab-4904-8f29-69dd6bfa0407",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "587667ac-e4dc-43c5-84e7-0be1392f684f",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "25b3eefb-7f84-420c-be0e-50c1751e8803",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b5401ae-c7a1-451c-8fc3-4925f3aa6403",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b4796ee5-ad8a-4d41-90b1-c8a4918d7572",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "70b9890a-c1c7-4630-8063-2062d85c3da8",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3ecbc42-555c-420d-851c-ae4f6255e97c",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78f23cca-87ed-4830-aa53-7285bdd94824",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "658e89e8-8346-44d4-97d0-004a2338111b",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "940dc37d-ae99-4f4f-a2aa-c33e2fc57d93",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01313721-d960-4546-9895-82065f3cf093",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d5c9e54-ec20-4047-9df5-43dabe849470",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "41c1a8cd-2200-42a7-8d61-7b93d7dae2b0",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27228a0c-b7b8-456a-9e7d-375bfc761e82",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "88d3b086-24c4-4a23-a529-c4293e8e1e0c",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1ef823e-c0c9-44bc-ac9f-a8404c630153",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b7815f5c-2475-40b5-a1e6-140430b53757",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "046f64db-daab-4214-95cc-5bc16a3591ce",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3e0f4a25-f92a-47fd-8b4a-34b825350ef3",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2f0aa31-8c2e-4609-bee3-462d3ff32e25",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2903bde2-9211-465f-b95c-4fc84fb7a83c",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "7b34864b-08b6-4e3c-a0fb-d24a40399205",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "b60ac2e6-b373-4ea3-9800-272f88caf781",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_redeposit_1k,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32,54,68,96,128)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t`user`.id as employee_id,\r\n\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t`group`.name as team_name,\r\n\t\tcase\r\n\t\t\twhen group_type.name = 'Branch'\r\n\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\telse group_type.name\r\n\t\tend as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.id,\r\n\t\t\tmin(c.id) as group_id\r\n\t\tfrom\r\n\t\t\t`user` a\r\n\t\tinner join user_group b on\r\n\t\t\ta.id = b.user_id\r\n\t\tinner join `group` c on\r\n\t\t\tb.group_id = c.id\r\n\t\twhere\r\n\t\t\tc.parent_id is not null\r\n\t\tgroup by\r\n\t\t\t1\r\n\tunion\r\n\t\tselect\r\n\t\t\temp.id,\r\n\t\t\tmin(user_group.group_id) as group_id\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\t\tselect proba.id,\r\n\t\t\t\tsum(ch)\r\n\t\t\tfrom\r\n\t\t\t\t(\r\n\t\t\t\t\tselect a.id,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\telse 0\r\n\t\t\t\t\tend as ch\r\n\t\t\t\tfrom\r\n\t\t\t\t\t`user` a\r\n\t\t\t\tinner join user_group b on\r\n\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\tinner join `group` c on\r\n\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\tgroup by\r\n\t\t\t\t1\r\n\t\t\thaving\r\n\t\t\t\tsum(ch) = 0) emp\r\n\t\tinner join user_group on\r\n\t\t\temp.id = user_group.user_id\r\n\t\tgroup by\r\n\t\t\t1) user_groups on\r\n\t\tuser_groups.id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,54,68,96,128)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619502036780f2002c37eca7",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiXsMSYsuAL/CbGN4aqsTqQK37h2jvswX7OUxbO5ncsXT5ZAQx6xX8RhjlXWOBl+OUE=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "50d256f8-c226-4944-afc1-9dc535c51803",
            "fullname": "MySql:64bf67d0-8704-4a24-b0fb-ee0d6edcf2c8",
            "type": "extract",
            "name": "64bf67d0-8704-4a24-b0fb-ee0d6edcf2c8",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7597e0e2-bb0c-466c-bfce-966a012e3d2b",
                        "id": "tq_4w3DPVksx",
                        "name": "TheWealthCore_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6901057d-084c-4601-9df8-2591a6db9265",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "55e5d5b9-535c-4977-a4c1-0469d6264527",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29671e39-4926-4abb-b42e-224ae6b9aebc",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bb2b036a-d9bd-45a9-8da9-4d636043413f",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0db458d1-4658-4674-82ce-8e41dedbce38",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "a8b6a58b-8ce9-468f-98e5-57844aa0ed27",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617134ba55f384002cf1020e",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "52f51d9b-26ab-4f98-b2c9-470b2dc803d3",
            "fullname": "MySql:40b04e2b-4d0d-4224-8c59-1c5edd891fdf",
            "type": "extract",
            "name": "40b04e2b-4d0d-4224-8c59-1c5edd891fdf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "502c17e9-4902-4b78-9ad3-e4783a797bd1",
                        "id": "tq_elwDIV16O",
                        "name": "MarketCG - Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "016afc80-beee-4bad-aa7f-2adbb6a00895",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "40a2af11-27dc-48ff-931f-e0ecc8ffef6f",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8475586-9aa6-4593-b29c-c518b201deb6",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a21af3c7-204f-4406-b335-042292a685b6",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1697fd6-941b-4d3b-b581-5e239e598eb9",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "ce3afa7c-6c74-4d54-a9f0-50d6aa18e858",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5348a56da002c36c6ac",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NAc1gMa0VBzZ9QDyN4mgrYY4RdbmC5kaicIuBKtyLx50isgKI42gk0NUhwNAOs/C+1ClXW3UC6yk8zdu2MLwnevpcBXSYS5lL8i4M0k06sUJIQFcjc1VnpGNQCbGzv+s0=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5508644e-aa8c-4593-98f7-fdfce6a57ac7",
            "fullname": "MySql:2b0c2016-bbe5-478d-8f9e-989d69db5b8c",
            "type": "extract",
            "name": "2b0c2016-bbe5-478d-8f9e-989d69db5b8c",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a1ec7ba6-203e-4b65-9656-a0acbaf140ad",
                        "id": "tq_ODH2E9bPm",
                        "name": "NostraCapital_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "287c96bd-dee5-4e80-a216-fe339f14c5d0",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ddc87094-f956-4809-a06a-fd344381cf11",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ebed321-8d4b-46b4-8561-ceb101a26883",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "316ba298-f8fc-4d37-81df-ef4a74eac98a",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0997bb7-e28b-487a-a70b-52c94c2e67bc",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d64d863-d18a-4c53-bcef-84133d825309",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40000909-4457-4433-b7f7-18c2d3cceff6",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3dd9519a-cfb3-4a22-9efd-b9fc40329b46",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d73fcad2-b8b8-4551-9519-b781cc731446",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "260112f0-7c24-41dc-8e93-ed7ae659b301",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "8b93783a-2f3b-4cf8-947f-5da28155e660",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195066a6780f2002c37ecc2",
                "provider": "MySql",
                "parameters": "5zpNi1/ivLrPCYd3lQIeMwzQq5sAuc2YxZlngeeRz8hpTWd0H8LeepAHS57ZrJJbLGMhcYYJi5jTdTs58x9Ifb38GYxx5LABrwlbp4PgUKEopCjg+Bdl9PQiGCx8H7K7nWAdNIkesmJqig4SBGeNKtw1XDvwnBW3u/rrXgFKnw1iQo69EEWu7CqZHboIqgmOLsXk4QP+RQIQ0ffDKky9F0uishDV78kkCxoNl+Mfe8tBKYck/ulmOghb0RL9ZKCb",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5ac0fc96-32d5-4433-898c-a132c1a31aad",
            "fullname": "MySql:56cf6d29-9f18-45e6-834b-449ef35b2a41",
            "type": "extract",
            "name": "56cf6d29-9f18-45e6-834b-449ef35b2a41",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d3099407-a0da-42c5-9f28-2d2dcfafbdbf",
                        "id": "tq_pzXjJJ3mf",
                        "name": "AshfordCapital_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f7be786d-24a6-4540-8647-a8dbf2f6acbd",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9e47ccb-1fe2-4c78-9526-443ae97766f9",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4303910d-d1e9-4710-80bd-aaf9373fee44",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5757d21a-3de9-4c94-889c-e9fd969c7755",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbbb9d1a-c65d-42ab-b29f-a7abeb3325de",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "ae413a0e-39ce-4993-9414-56b30ab32362",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5348a56da002c36c6b0",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6qAqQ4wTrAjQNYhfY7egrcPCKm7Rh9+irvJBmxkN4y5OWK0b1ABUI6cX4BynT/Bb57V8dXjpQ/i465b9A+cO9KF/5WSBj4Act8xbVcAg/2E4DCkuyCXF+OKugn3wI+gXAF02li6ZiOESl71+QZkncPGh5q9fZWYJlgnkJvoKDP2C",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "5e08c7e3-6656-4a17-a6d7-c302bbc07f53",
            "fullname": "MySql:f94b46e5-ca90-494c-a954-9f492b3913fa",
            "type": "extract",
            "name": "f94b46e5-ca90-494c-a954-9f492b3913fa",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c8479df6-15ff-4b5e-860d-6a82abfa7630",
                        "id": "tq_pnOautjqr",
                        "name": "AussieTrust_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "42972693-ab51-4e21-b2ea-28c858fc735f",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "de2fab70-b7c1-4cf9-9c4c-5644075d14af",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ec8a4b7-4565-47d2-894e-8fcf6e3f4cb1",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0a56c673-685d-4cf2-b632-ad058901bfba",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55079eb5-d225-4b8e-bf9f-27c2b7647ea4",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "32ad9f03-17b3-4f51-97af-2e84a81d1f39",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171342255f384002cf10209",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6039e73f-4ae6-41fd-9ba1-768f9434aa69",
            "fullname": "MySql:a35b6a35-8650-4950-b588-832d4954f8cd",
            "type": "extract",
            "name": "a35b6a35-8650-4950-b588-832d4954f8cd",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "cd4b37e0-b5cb-494e-9621-22cebcc212e1",
                        "id": "tq_cKgxOBJf6",
                        "name": "GeniusIG_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "12fd03ab-6a64-4db2-83da-761d673fc48b",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74d5a94f-5424-4971-81b2-28fab6fbec43",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63d68e99-e68f-4b5e-8938-b1fa54b05077",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f46c4961-c368-487c-a0ce-420bfc635541",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab59ed87-844f-40af-bff5-ff7ae2ac5a69",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7529fa21-cf19-4ebd-b9f0-9f652a4b66b3",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8903cd7-96f5-4d81-84fa-8a05bcbd6fa4",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81152efe-7610-40e4-bf19-17cf2c87dd89",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7949004-a067-440b-857f-4a1eead27a37",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9be17a69-35a3-4d9c-ab5c-a7a336ad481f",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "ac5bc849-4a97-4299-8d57-70aea38e6a9a",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506b56780f2002c37eccf",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCkM37LkFbGnRhmt2tYLFqO1gr0leFAbxvqr45h97aRL2uFXV6bnmXjrx+upQdOgFiG2n1XzowSr7ML18mjmQhnzqjq1V2FUQMfFFcLg11wwiXozn0iLcNZcjGmBoyCW6IdyK2k1UjDiKqlSqoJZSuzAb/GTm3+JvHrvJTMCSB28",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "628a442f-dc21-4802-b24e-5f8eb178e3e0",
            "fullname": "MySql:4481dcf1-5961-4867-ba9e-07237ad5b850",
            "type": "extract",
            "name": "4481dcf1-5961-4867-ba9e-07237ad5b850",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1ad7daf5-ea8c-4187-bc27-cf3df38d5557",
                        "id": "tq_TO17HMFQY",
                        "name": "AshfordCapital_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "3de0beed-e335-4e43-b13b-7a85c405c060",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e368417c-3bb4-4ec5-b830-22ccaf8b7fc5",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4efa42bd-815d-44fc-9bc3-15ae6f10e6c4",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80c2eadc-35fd-4f8d-bc37-813133239cc1",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8bc17422-a0bf-4417-9c83-97d0d44d1da1",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "599fa06f-c5e0-49ef-8ddc-25431df28497",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617133fa55f384002cf10207",
                "provider": "MySql",
                "parameters": "Oz2AfvRo3srlztUw24mN8xjULQgCsDxE8xdGvyNUDfDIDVlPEvzGPi9X1pOk7WkJorypT3vAhcaensqPr3DxJWq4DMDr4Ntq8hg/ST/QG/Ry+Mc5Itvb7ssjapRdR/f5pJGa1CgTA4+V9S7ZAeHlkIJ8fCivOQ1bPR1RbzXK2+kyaVjENBts5VNtP4yYjGtpqTycZGcbTdSdI98JCq+mp2IzDRzS7cexXuu83rKl7MG3hlCMfvhn4khms5onk7u7",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "62aaf393-71c1-454a-84a1-93838ee365fc",
            "fullname": "MySql:b2f7e134-185c-4c5d-99b1-f82f145b5b00",
            "type": "extract",
            "name": "b2f7e134-185c-4c5d-99b1-f82f145b5b00",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7b3326ec-a4ef-4bca-998b-c5786cf68999",
                        "id": "tq_BQspJsiwq",
                        "name": "PrimeOT_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d13447a6-9d1a-4147-8571-a7fb063d78d5",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b3eec514-9fe9-4915-8202-62b40ad867fd",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1da9b3ac-2987-486d-b8ac-3b942c07a18d",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c123d998-5ce3-4161-9c70-ebb295c2f2c3",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30bae52e-4847-4ecc-ad9a-9df1b92476a4",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0858d178-e28a-466d-8d81-f05ed819be1f",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ff70d14-7ca9-48e4-9c61-6875317b7688",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1723448-93d5-486b-a1aa-0d7131723e8c",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49587d67-16f4-4fdd-a953-c7361f400d70",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0d3e9f12-2c56-43f2-983c-c2df8a2adb40",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee253a5c-e485-4a87-837c-a84b611356e9",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9a6c6823-a364-4392-9ddc-07623fd1832d",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e01efe6-e35f-4bc0-804b-2b2609f2ac11",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c1ae919-edbf-4835-8fd8-21e5fefae1ed",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a313a3b1-975d-4369-aab6-6d745d07f6d0",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "40d1fde1-2737-44a2-8edd-a399550e7581",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f7adeb32-6b6d-400f-aa82-142eaf5c7508",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "09464c41-7ad6-49b5-886e-a7a43c15cac6",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "21d91ff9-4f78-4bb3-b9cf-6e8678c73cda",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "68bb3d65-fbcc-4c72-969b-c5635f22f971",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e76f35f-8323-4953-99c8-f174bcd172fa",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2eecd7d1-d605-425d-a4dc-180cecaa5869",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "389f9eb6-b5a9-41f8-a91b-165de40d243f",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4186d7cd-0f58-41ed-82e8-83967f5081ec",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cab447f7-e274-44fb-9248-c1d67ad09ca5",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd0bbeea-790b-48d8-b63a-7af4073bcef9",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b394983-e75d-4149-9441-a19f3a569e54",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f55a2865-4f97-4b91-b28c-4d804c2da2c3",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3d7cc5e3-d520-435d-a6dd-560cb8fc5e3a",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bd552d66-2163-4acd-bcaa-fd2ffeae8a41",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05c37cf9-2292-425c-99bf-6461affd662f",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c4e44031-2de2-4011-bb4d-7dcae3b2f8ee",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1f0be12b-3021-4258-ba2f-ea387271c9fd",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "90a64a42-924d-489f-981e-362f04be5001",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4037918e-a596-4546-a77a-f725d90deb81",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4b0da690-ea3c-4d90-900f-443763fac357",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b09f228-b663-4764-a374-bba98e3a48ce",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b71fd81-fe95-4172-ba42-e23d8e518811",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f5e5c80-05be-4ec1-8776-91853574356f",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1f864c59-0ef1-42e7-964f-a7d9e004bf85",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee55e4e9-f10c-4dfa-a791-9840c9191712",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "12d2ae58-ec4a-47cb-95c7-04b54985131d",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e7577aa0-c76d-46af-9092-48ccd01a1758",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2929b2bf-a0e8-4ea9-9de0-118fcd0793d4",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3b4fc70-6814-4ed8-8ff0-c4d205001f15",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee7b0d94-92a0-4fb3-855e-0caa99fa3216",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0651e3dc-d902-47ad-af63-b215121fa7c2",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "18c30d16-6bd4-4235-acea-7306dde138a9",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "897a7d17-e121-4081-b6df-d509610795df",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8621088f-ad5f-4400-884f-dbad21953c0e",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "822bb13a-fb80-44a3-8a3d-d78a8eead037",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be964a32-4ecd-4d43-94d7-3abe55e0f2c7",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ff8e5279-6526-47b3-a7f1-467069e94aeb",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dde8be6f-ec54-486a-ac28-f70829df40db",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0a131868-a64d-4c15-8be3-ca8d81aea97b",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e46ad037-1ab4-40fb-94a2-e4233b10fd60",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02fe8cdb-4a81-433b-bbf6-f5d167711727",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4ee80a67-5e18-4ec2-94c8-001602e66cbd",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "96305888-c236-4a5f-a0cd-636e66bae746",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4f63f65-8913-4c94-a8d2-b2cf9502beb7",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0ddfe827-5b59-470e-bf43-ff37acc025e1",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fb74333d-7a7c-4427-ae59-373632d82106",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a9f2916a-743e-484d-ba5c-6c6423fb9adc",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f521533e-0158-48ce-8a47-597b42d21e88",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2d3d256-ed00-4141-ba4e-fbb55819b3bd",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 66,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "301f8a52-6b7a-442a-b474-7825b750702b",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0ea58762-2c41-47bc-9ec6-570d39f2f90c",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 66,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7eca8e68-0bfd-4590-b598-fc055b5674f0",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b3744a1-91be-4fcf-9ec4-0cc31de30eb3",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "0d3e9f12-2c56-43f2-983c-c2df8a2adb40",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "d76b3375-a472-42fd-8d48-8e1c37714daf",
                        "configOptions": {
                            "importQuery": "SELECT\r\n\taggCustomer.id,\r\n\taggCustomer.default_account_id,\r\n\taggCustomer.site_name as site_name,\r\n\taggCustomer.site_id + 1000 as site_id,\r\n\tconcat(aggCustomer.site_id + 1000, '10002', aggCustomer.id) as customer_key,\r\n\taggCustomer.customer_fullname,\r\n\tco.name,\r\n\taggCustomer.currency,\r\n\taggCustomer.created_at,\r\n\tyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\n\taggCustomer.date,\r\n\taggCustomer.YearMonth,\r\n\tcase\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'GBP' then 1.3\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'GBP' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'EUR' then 1.1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'EUR' then aggCustomer.rate\r\n\t\twhen aggCustomer.rate is null\r\n\t\tand aggCustomer.currency = 'USD' then 1\r\n\t\twhen aggCustomer.rate is not null\r\n\t\tand aggCustomer.currency = 'USD' then aggCustomer.rate end as rate,\r\n\t\tMaxDep.LastDepDate,\r\n\t\tMaxInv.LastTimeInvestment,\r\n\t\taggCustomer.tr_id,\r\n\t\taggCustomer.origin_type,\r\n\t\tMinDep.FTDDate,\r\n\t\tcase\r\n\t\t\twhen FTD.FTDind is null then 0\r\n\t\t\telse 1 end as FTDInd,\r\n\t\t\taggCustomer.user_id,\r\n\t\t\tconcat(aggCustomer.site_id + 1000, '10002', COALESCE(aggCustomer.user_id, 0)) as employee_key,\r\n\t\t\taggCustomer.deposit_curr,\r\n\t\t\taggCustomer.deposit_usd,\r\n\t\t\taggCustomer.cashback_curr,\r\n\t\t\taggCustomer.cashback_usd,\r\n\t\t\taggCustomer.withdrawal_curr,\r\n\t\t\taggCustomer.withdrawal_usd,\r\n\t\t\taggCustomer.withdrawal_curr_new,\r\n\t\t\taggCustomer.withdrawal_usd_new,\r\n\t\t\taggCustomer.cashback_withdrawal_curr,\r\n\t\t\taggCustomer.cashback_withdrawal_usd,\r\n\t\t\taggCustomer.withdrawal_fee_curr,\r\n\t\t\taggCustomer.withdrawal_fee_usd,\r\n\t\t\taggCustomer.chb_curr,\r\n\t\t\taggCustomer.chb_usd,\r\n\t\t\taggCustomer.inactivity_fee_curr,\r\n\t\t\taggCustomer.inactivity_fee_usd,\r\n\t\t\taggCustomer.overnight_fee_curr,\r\n\t\t\taggCustomer.overnight_fee_usd,\r\n\t\t\taggCustomer.fees_curr,\r\n\t\t\taggCustomer.fees_usd,\r\n\t\t\taggCustomer.pnl_curr,\r\n\t\t\taggCustomer.pnl_usd,\r\n\t\t\taggCustomer.swap_curr,\r\n\t\t\taggCustomer.swap_usd,\r\n\t\t\taggCustomer.contract_usd,\r\n\t\t\taggCustomer.rbonus_curr,\r\n\t\t\taggCustomer.rbonus_usd,\r\n\t\t\taggCustomer.cancelled_bonus_curr,\r\n\t\t\taggCustomer.cancelled_bonus_usd,\r\n\t\t\taggCustomer.pending_bonus_curr,\r\n\t\t\taggCustomer.pending_bonus_usd,\r\n\t\t\taggCustomer.fixed_balance,\r\n\t\t\taggCustomer.fixed_balance_usd,\r\n\t\t\taggCustomer.negative_balance_fix_curr,\r\n\t\t\taggCustomer.negative_balance_fix_usd,\r\n\t\t\taggCustomer.NetdepCurr as NetDepCurr,\r\n\t\t\tround(aggCustomer.NetDepCurrAcc, 2) as NetDepCurrAcc,\r\n\t\t\taggCustomer.NetDepUsd as NetDepUsd,\r\n\t\t\tround(aggCustomer.NetDepUsdAcc, 2) as NetDepUsdAcc,\r\n\t\t\tround(aggCustomer.RealAccountBalanceAccumulatedCurrency, 2) as RealABAccCurr,\r\n\t\t\tround(aggCustomer.RealAccountBalanceAccumulatedUsd, 2) as RealABAccUsd,\r\n\t\t\tround(aggCustomer.RealABDiffCurrency, 2) as RealABDiffCurrency,\r\n\t\t\tround(aggCustomer.RealABDiffUsd, 2) as RealABDiffUsd,\r\n\t\t\tround(aggCustomer.RealPnLCurrAcc, 2) as RealPnLAccCurr,\r\n\t\t\tround(aggCustomer.RealPnLCurr, 2) as RealPnLCurr,\r\n\t\t\tround(aggCustomer.RealPnLUsdAcc, 2) as RealPnLAccUsd,\r\n\t\t\tround(aggCustomer.RealPnLUsd, 2) as RealPnLUsd,\r\n\t\t\tb.balance as CurrencyBalance\r\n\t\tfrom\r\n\t\t\t(\r\n\t\t\tselect\r\n\t\t\t\tt.*,\r\n\t\t\t\t@netdepositcurr := t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen @lastId = t.id then @netdepositcurracc := @netdepositcurracc + @netdepositcurr\r\n\t\t\t\t\telse @netdepositcurracc := @netdepositcurr end as NetDepCurrAcc,\r\n\t\t\t\t\t@netdepositusd := t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen @lastId = t.id then @netdepositusdacc := @netdepositusdacc + @netdepositusd\r\n\t\t\t\t\t\telse @netdepositusdacc := @netdepositusd end as NetDepUsdAcc,\r\n\t\t\t\t\t\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t\t\t\t\t\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t\t\t\t\t\t@currentrate := @RealABUsd / @RealAB as currentRate,\r\n\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\twhen @lastId = t.id\r\n\t\t\t\t\t\t\tand @lastab < 0\r\n\t\t\t\t\t\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\t\t\t\t\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\t\t\t\t\t\telse @RealABAccHelp := @RealAB end as RealABAccHelp,\r\n\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\twhen @lastId = t.id\r\n\t\t\t\t\t\t\t\tand @lastabusd < 0\r\n\t\t\t\t\t\t\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\t\t\t\t\t\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\t\t\t\t\t\t\telse @RealABAccHelpUsd := @RealABUsd end as RealABAccHelpUsd,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen @lastId = t.id\r\n\t\t\t\t\t\t\t\t\tand @RealABAccHelp < 0\r\n\t\t\t\t\t\t\t\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\t\t\t\t\t\t\t\twhen @lastId = t.id\r\n\t\t\t\t\t\t\t\t\tand @RealAB + @lastab > 0 then @realreal := @RealABAccHelp\r\n\t\t\t\t\t\t\t\t\twhen @lastId = t.id\r\n\t\t\t\t\t\t\t\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\t\t\t\t\t\t\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\t\t\t\t\t\t\t\telse @realreal := @RealAB end as RealAccountBalanceAccumulatedCurrency,\r\n\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\twhen @lastId = t.id\r\n\t\t\t\t\t\t\t\t\t\tand @RealABAccHelpUsd < 0\r\n\t\t\t\t\t\t\t\t\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\t\t\t\t\t\t\t\twhen @lastId = t.id\r\n\t\t\t\t\t\t\t\t\t\tand @RealABUsd + @lastabusd > 0 then @realrealusd := @RealABAccHelpUsd\r\n\t\t\t\t\t\t\t\t\t\twhen @lastId = t.id\r\n\t\t\t\t\t\t\t\t\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\t\t\t\t\t\t\t\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\t\t\t\t\t\t\t\t\telse @realrealusd := @RealABUsd end as RealAccountBalanceAccumulatedUsd,\r\n\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\t\t\t\t\t\t\t\t\t\telse @RealAB end as RealABDiffCurrency,\r\n\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\t\t\t\t\t\t\t\t\t\t\telse @RealABUsd end as RealABDiffUsd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t@realpnlcurracc := @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen @lastId = t.id then @realpnlcurr := @realpnlcurracc - @lastrealpnlcurr\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse @realpnlcurr := @realpnlcurracc end as RealPnLCurr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t@realpnlusdacc := @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen @lastId = t.id then @realpnlusd := @realpnlusdacc - @lastrealpnlusd\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse @realpnlusd := @realpnlusdacc end as RealPnLUsd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastreal := @realreal,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastrealusd := @realrealusd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastab := @RealABAccHelp,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastabusd := @RealABAccHelpUsd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastId := t.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastrealpnlcurr := @realpnlcurracc,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastrealpnlusd := @realpnlusdacc\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.default_account_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbrand.name as site_name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbrand.id as site_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id as tr_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen rbonus.realized_at > 0 then rbonus.realized_at\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse a.created_at end as created_at,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen rbonus.realized_at > 0 then date(rbonus.realized_at)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse date(a.created_at) end as 'date',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.user_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td.code as currency,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.origin_type,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse date_format(a.created_at, '%Y-%m') end as YearMonth,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen d.code = 'USD' then rates.USD\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconcat(b.first_name, ' ', b.last_name) as customer_fullname,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as deposit_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as deposit_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as cashback_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as cashback_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as withdrawal_curr_new,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as withdrawal_usd_new,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as cashback_withdrawal_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as cashback_withdrawal_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as fees_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as fees_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_record a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.wide_currency_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.realized_at\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_bonus a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_record b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id = b.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.is_realized = 1) rbonus on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trbonus.id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.wide_currency_amount\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_bonus a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_record b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id = b.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.is_realized = 0\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tand a.status = 'approved') pbonus on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpbonus.id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.trader_account_id = b.default_account_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join brand on b.brand_id = brand.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join trader_account c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.id = c.trader_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join currency d on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tc.currency_id = d.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as amount_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_record a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.ftr_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) not in (24,29,45,62,107)) withdrawals on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twithdrawals.id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) as amount_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) fee_amount_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t((b.amount - COALESCE(b.fee_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0)) * (a.wide_currency_amount / a.amount)) as amount_usd,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(b.fee_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) * (a.wide_currency_amount / a.amount) as fee_amount_usd\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_record a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_withdraw b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.ftr_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) in (24,29,45,62,107)) withdrawals_cashback on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twithdrawals_cashback.id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.amount\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_record a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_deposit b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.ftr_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) not in (24,29,45,62,107)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tand b.status = 'completed') deposits on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeposits.id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.wide_currency_amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.amount\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_record a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_deposit b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.ftr_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCOALESCE(b.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) in (24,29,45,62,107)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tand b.status = 'completed') cashbacks on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcashbacks.id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_commission a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_record b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id = b.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.transaction_sub_type_id = 5) withdrawal_fees on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twithdrawal_fees.ftr_id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_commission a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_record b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id = b.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.transaction_sub_type_id = 8\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tor transaction_sub_type_id is null) overnight_fees on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tovernight_fees.ftr_id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.amount * -1 as amount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.wide_currency_amount * -1 as wide_currency_amount\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttransaction_commission a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_record b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id = b.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.transaction_sub_type_id = 7) inactivity_fees on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinactivity_fees.ftr_id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tftr_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tswap as swaps_curr,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tswap * (b.wide_currency_amount / b.amount) as swap_usd\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrader_account_position a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinner join transaction_record b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.ftr_id = b.id) swaps on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = swaps.ftr_id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1448 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.3108 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-01' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1376 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.3263 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-02' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1224 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.3021 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-03' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1214 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.3038 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-04' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1197 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.2637 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-05' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.136 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.2691 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-06' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1071 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.2152 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-07' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1009 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.2157 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-08' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.0899 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.2287 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-09' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1157 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.2937 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-10' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1019 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.2928 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-11' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1124 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.3351 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2019-12' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1095 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.3205 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2020-01' as ym\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.1089 as EUR,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1 as USD,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1.3181 as GBP,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'2020-02' as ym ) rates on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trates.ym =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhen rbonus.realized_at > 0 then date_format(rbonus.realized_at, '%Y-%m')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse date_format(a.created_at, '%Y-%m') end\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tftr_id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsystem_currency_vol\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrader_account_position) contract on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontract.ftr_id = a.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t3,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t2,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t4,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t5,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t6,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t7,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t8,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t9,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t10,11,12\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torder by\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t6,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t5 asc) t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastab := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@RealABAccHelp := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastRealABAaccHelp := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastId := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@realreal := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastreal := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@RealABUsd := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastabusd := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@RealABAccHelpUsd := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@realrealusd := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastrealusd := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@netdepositcurr := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@netdepositcurracc := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@netdepositusd := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@netdepositusdacc := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@realpnlcurr := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@realpnlcurracc := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastrealpnlcurr := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@realpnlusd := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@realpnlusdacc := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@lastrealpnlusd := 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@currentrate := 0) v) aggCustomer\r\n\t\tinner join (\r\n\t\t\tselect\r\n\t\t\t\ta.id,\r\n\t\t\t\tb.name\r\n\t\t\tfrom\r\n\t\t\t\ttrader a\r\n\t\t\tinner join country b on\r\n\t\t\t\ta.country_id = b.id) co on\r\n\t\t\tco.id = aggCustomer.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tmin(a.id) as FTDInd\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join trader b on\r\n\t\t\t\ta.trader_account_id = b.default_account_id\r\n\t\t\twhere\r\n\t\t\t\ta.origin_type = 1\r\n\t\t\t\tand b.is_test = 0\r\n\t\t\tgroup by\r\n\t\t\t\t1) FTD on\r\n\t\t\tFTD.id = aggCustomer.id\r\n\t\t\tand FTD.FTDInd = aggCustomer.tr_id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tmax(a.created_at) as LastDepDate\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join trader b on\r\n\t\t\t\ta.trader_account_id = b.default_account_id\r\n\t\t\twhere\r\n\t\t\t\ta.origin_type = 1\r\n\t\t\t\tand b.is_test = 0\r\n\t\t\tgroup by\r\n\t\t\t\t1) MaxDep on\r\n\t\t\tMaxDep.id = aggCustomer.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tmax(a.open_at) as LastTimeInvestment\r\n\t\t\tfrom\r\n\t\t\t\ttrader_account_position a\r\n\t\t\tinner join trader b on\r\n\t\t\t\ta.trader_account_id = b.default_account_id\r\n\t\t\twhere\r\n\t\t\t\tb.is_test = 0\r\n\t\t\tgroup by\r\n\t\t\t\t1) MaxInv on\r\n\t\t\tMaxInv.id = aggCustomer.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tb.id,\r\n\t\t\t\tmin(a.created_at) as FTDDate\r\n\t\t\tfrom\r\n\t\t\t\ttransaction_record a\r\n\t\t\tinner join trader b on\r\n\t\t\t\ta.trader_account_id = b.default_account_id\r\n\t\t\twhere\r\n\t\t\t\ta.origin_type = 1\r\n\t\t\t\tand b.is_test = 0\r\n\t\t\tgroup by\r\n\t\t\t\t1) MinDep on\r\n\t\t\tMinDep.id = aggCustomer.id\r\n\t\tleft join trader_account b on\r\n\t\t\taggCustomer.id = b.trader_id\r\n\t\torder by\r\n\t\t\t1,\r\n\t\t\t4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "613f125a387fbb002c4fdebe",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CLQO1pn40szcYNg2rZoiX1Vg29Vp5lwLqTDoBiPX74Z7tq4A1c99blLl+UTfHxXxv3fHMdNaD6ZQ0AYwLSELF3A=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "667e459c-7a16-4e5c-a43d-6c75c60a8bee",
            "fullname": "MySql:7bea94b4-36b1-43c6-ae54-c4a44b4749a5",
            "type": "extract",
            "name": "7bea94b4-36b1-43c6-ae54-c4a44b4749a5",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "6b96ccab-f27f-44a2-a110-eb106a5798d9",
                        "id": "tq_yyHxtEiVx",
                        "name": "BendigoCoins_OpenPositions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "25481392-bb82-4576-8487-7fb74a3af4a8",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd914168-2846-40e7-a468-88ac6a95f688",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa915c7b-9773-4e11-afcf-7d09d4dc0d74",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "102374ff-0e91-48cd-a312-6833fcadb2d6",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "335b9f78-288f-4c2e-97d8-4ddaf3605364",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92d82850-5b51-4bc0-afe4-5c8f3cf851da",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "251bf6a5-acb5-4695-83e3-1ed845cef911",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "453eed5f-5285-4343-8d33-feaad9c08d1b",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6dced36-2b59-44d2-b27e-07375bfaa749",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "2d4a837c-7531-47cb-a7e9-a5adcde3a028",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6160232f9d5c67002c6f1977",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLYe2SGfT8Lds+akycpW5+K9YO+8fTekLNVbA78DM/OCWbxUblK2Id8YJvnNXUQ+eTIAHMN/W71sURfgBeS0WwQxNOqj84HBxwBZ6il+EKFmHJ9FWKQZm+UDy5OxqZbFAkXbpIyiPYxJBez63/L55hNPwBFOT2h2PzJQNrmoEZCdMcWAZeNnU55kjKL1mdEhkXeRVJc9RJItZ3XYlFNc1pmocYfl2UZpPJAOkcdJcbO/5",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6740c24f-d3fe-4f61-b51b-3b85764559eb",
            "fullname": "MySql:7cc086c7-4124-4521-aaac-bdeb0184b3aa",
            "type": "extract",
            "name": "7cc086c7-4124-4521-aaac-bdeb0184b3aa",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b5f0c8f7-5b47-41e7-839a-e4687c80c428",
                        "id": "tq_MxsWiqsAQ",
                        "name": "PrimeOT_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b57f4819-1436-4aad-9e72-11491236426c",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aa695d64-8137-4695-8e3b-3b5fdd126355",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3907bfd6-84fd-4d16-91c9-af2898056c65",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7029deae-f5de-4788-a238-0c1716f6adc2",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b9ce951-9f44-4a81-ab35-e4c8fab9ab6a",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05da2115-f740-4146-91f3-89fd33ad28b5",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12cdfecb-6655-4ab2-9b9f-58dbb523ae44",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5cc96077-d941-4d13-ba03-4e5f6eb384a6",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0e48f8a-dc12-467b-87f4-3d7b3ae95746",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de2aa45f-5900-4556-afff-ed4811e4598d",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "77ceaf5c-0dd1-4f7e-8bb0-295f2da3c358",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506606780f2002c37ecc0",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CLQO1pn40szcYNg2rZoiX1Vg29Vp5lwLqTDoBiPX74Z7tq4A1c99blLl+UTfHxXxv3fHMdNaD6ZQ0AYwLSELF3A=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "694f3866-43d2-4b2b-906c-674b7fe29b10",
            "fullname": "MySql:f6377e72-6e35-426f-91f4-7bebf2325660",
            "type": "extract",
            "name": "f6377e72-6e35-426f-91f4-7bebf2325660",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9dfa9920-a8fd-4207-afb3-c60c44ecbcf3",
                        "id": "tq_tffokF8e3",
                        "name": "asset_configuration_new",
                        "type": "base",
                        "schemaName": "bo",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c409cac2-4bdd-4e9e-be3f-2f12fb881aee",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4dfddaf0-4c38-4792-a09e-e89e284b55c5",
                                "id": "source_id",
                                "name": "source_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71a5a155-d9b6-4c23-9b6f-45f42ae6338b",
                                "id": "group_id",
                                "name": "group_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e8b4be4a-7aac-4f7a-b186-96be8e8fb694",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "28572ea3-344f-44ca-90cf-470565ff9bd2",
                                "id": "instrument_id",
                                "name": "instrument_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "49818e84-80e3-4b06-bce1-c9319856575b",
                                "id": "display_name",
                                "name": "display_name",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea3352c1-9fe7-4aeb-ba20-89dd9f38c829",
                                "id": "unit_type",
                                "name": "unit_type",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2062f1d5-8417-407e-b8e7-7eea43487737",
                                "id": "status",
                                "name": "status",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7780d080-6055-45f0-a5d5-a8fe569563fd",
                                "id": "qty_min",
                                "name": "qty_min",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "207389c7-821e-425f-8f4b-4cb31751b60c",
                                "id": "qty_max",
                                "name": "qty_max",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a6eb0ed2-c655-4f9e-b562-d220e1f6fe10",
                                "id": "qty_steps",
                                "name": "qty_steps",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "adafb8c3-15d8-45dc-8792-070037f59326",
                                "id": "sell_overnight_commision",
                                "name": "sell_overnight_commision",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1c46ae4a-42b1-4382-9e5f-ec2873f38b96",
                                "id": "buy_overnight_commision",
                                "name": "buy_overnight_commision",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7ce5ed4f-4553-4b97-a100-3615f23f70a7",
                                "id": "margin_initial",
                                "name": "margin_initial",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f07b8d42-1859-4ac5-ab92-c4f6119d9056",
                                "id": "margin_maintenance",
                                "name": "margin_maintenance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "abfc5c5f-43c1-4d7e-8d07-16c02de768b8",
                                "id": "ask_type",
                                "name": "ask_type",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9724454f-81b9-4d7c-a363-0c9e6e6d530d",
                                "id": "ask_val",
                                "name": "ask_val",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "82f6f5f7-fbd6-4cec-8f1e-756b0e97abd6",
                                "id": "bid_type",
                                "name": "bid_type",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2a797a7e-3cd7-471b-a25e-ed6294a984c0",
                                "id": "bid_val",
                                "name": "bid_val",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f00b9c1e-778c-4af0-bb8e-326971ebbc85",
                                "id": "start_date",
                                "name": "start_date",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1e7be1f-62b7-4284-bc22-1ebc94650d28",
                                "id": "end_date",
                                "name": "end_date",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5b9673e3-d7a0-4818-b875-c7317d864e24",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cfb957a7-1698-46bb-8ca0-fae4c5cf69c7",
                                "id": "updated_at",
                                "name": "updated_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5b359af-c823-46a2-81ef-bc8019ad720c",
                                "id": "priority_val",
                                "name": "priority_val",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1748de03-ec68-4e3b-9437-f47ae1f51f95",
                                "id": "liquidity_provider",
                                "name": "liquidity_provider",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "de54ca35-4b11-4930-95ac-c29d1196602a",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7cc83d2d-e1f8-4b24-8508-a5b41a861517",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 12,
                                "precision": 12,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ce79996-05ca-4246-9131-47611c668d37",
                                "id": "ask_type_str",
                                "name": "ask_type_str",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c667a3a7-b248-49b7-a1ec-93ec763f26b5",
                                "id": "bid_type_str",
                                "name": "bid_type_str",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "257328f5-e3be-434e-984d-d0bfdcbd0a22",
                                "id": "spread",
                                "name": "spread",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 6,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "461a41dd-5b4e-4eed-bffd-69f181f03467",
                                "id": "feed_symbol",
                                "name": "feed_symbol",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-15T14:32:41.433Z",
                                        "oid": "10039395-a975-4e09-9dc1-0b818b17540f",
                                        "expression": "lookup([Instrument],[instryment_type],instrument_id,id)"
                                    },
                                    "indexed": true,
                                    "id": "instrument_type",
                                    "name": "instrument_type",
                                    "type": 18,
                                    "size": 65536,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "db1ecb4b-d0da-4329-a3ce-a186c6b1f1af",
                                    "hidden": false
                                },
                                "type": "add-column"
                            },
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-15T14:32:41.433Z",
                                        "oid": "2ef25317-34c7-4e26-bc49-c3e235fbde6d",
                                        "expression": "lookup([Instrument],[status],[instrument_id],[id])"
                                    },
                                    "indexed": false,
                                    "id": "active_status",
                                    "name": "active_status",
                                    "type": 8,
                                    "size": 0,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "e05ca8b0-c709-4a0b-873f-930173606efa",
                                    "hidden": false
                                },
                                "type": "add-column"
                            },
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-15T14:32:41.433Z",
                                        "oid": "a3a7d87b-9584-495a-9c29-7ece448b21f4",
                                        "expression": "lookup(AccountTypes,name,group_brand,group_brand)"
                                    },
                                    "indexed": true,
                                    "id": "account_types",
                                    "name": "account_types",
                                    "type": 18,
                                    "size": 65536,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "f5a12ab9-7082-4a85-b863-ea5008a548b7",
                                    "hidden": false
                                },
                                "type": "add-column"
                            },
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-15T14:32:41.433Z",
                                        "oid": "3a6d3dd3-ce08-4127-b4df-780c06e6af7b",
                                        "expression": "concat(tostring(group_id),concat('_',toString(brand_id)))"
                                    },
                                    "indexed": true,
                                    "id": "group_brand",
                                    "name": "group_brand",
                                    "type": 18,
                                    "size": 65536,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "c5c968f7-3047-4f7e-b5fd-0957708ab4be",
                                    "hidden": false
                                },
                                "type": "add-column"
                            },
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-15T14:32:41.434Z",
                                        "oid": "d7e55a8b-03e8-4bd5-873f-d43472228949",
                                        "expression": "case when isnull(lookup(AccountTypes,name,group_brand,group_brand)) then 0 else 1 end"
                                    },
                                    "indexed": false,
                                    "id": "account_type_status",
                                    "name": "account_type_status",
                                    "type": 8,
                                    "size": 0,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "72e97dc6-5828-456f-9709-42e8e5d480ff",
                                    "hidden": false
                                },
                                "type": "add-column"
                            },
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-07-28T09:28:26.928Z",
                                        "oid": "0084fc51-69f6-4296-8756-33a4e01e7138",
                                        "expression": "lookup([Instrument],feed_id, [instrument_id],[id])"
                                    },
                                    "indexed": true,
                                    "id": "feed_id",
                                    "name": "feed_id",
                                    "type": 0,
                                    "size": 0,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "10b1fd6c-b25c-4e8e-b698-128f0f4526e5",
                                    "hidden": false
                                },
                                "type": "add-column"
                            },
                            {
                                "arguments": {
                                    "id": "CRM_Status",
                                    "name": "CRM_Status",
                                    "type": 8,
                                    "size": 0,
                                    "scale": 0,
                                    "precision": 0,
                                    "lastUpdated": "2021-10-21T09:53:41.120Z",
                                    "oid": "b2c02c37-bf45-46b3-9ce2-0015d034dcae",
                                    "hidden": false,
                                    "indexed": true,
                                    "expression": {
                                        "lastUpdated": "2021-10-21T09:53:41.121Z",
                                        "oid": "0e97b764-d4a6-4ce1-b920-fdde7cbf4a93",
                                        "expression": "lookup(AccountTypes,active,group_brand,group_brand)"
                                    }
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": false,
                        "vTag": "02e5c4dd-b84b-4ed2-8f12-70b443f7ea54",
                        "configOptions": {
                            "importQuery": "select\r\n\tbo.trade_configuration.*,\r\n\tbrand.name as site_name,\r\n\tbrand.id + 1000 as site_id,\r\n    case when ask_type = 0 then 'points' else 'percentage' end as ask_type_str,\r\n    case when bid_type = 0 then 'points' else 'percentage' end as bid_type_str,\r\n    ask_val + bid_val as spread,\r\n    md.instrument.feed_symbol\r\nfrom\r\n\tbo.trade_configuration\r\ninner join md.instrument on bo.trade_configuration.instrument_id = md.instrument.id\r\nleft join bo.brand on bo.trade_configuration.brand_id = bo.brand.id \r\nwhere 1=1\r\n\tand bo.trade_configuration.brand_id is not null\r\n\tand bo.trade_configuration.group_id is not null\r\n\tand bo.brand.id  not in (2,5,23,36,11,33,32,21,34,17,19,8,9)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617144ec55f384002cf10217",
                "provider": "MySql",
                "parameters": "5mNCu1+ofkq0jXTrETmA2GCLZRQMR5lTs7Khy7XrLfySMPqPYDtrRlch/vLJc4vdrd/JrcAFXOWO83LKYJqdKiPldqy1FnyanGQNws7STazYO7sqyOenRvB3k8Yh2tTWh+ObQUSeC5Z1K+ABXCWQclwyUFSNZvVRfmPvhd5kdczSzfxn5xlphSBbhn43GfR7Ba+5cdGRsNbuHvErIKdI0Hwt2pvzS/KPEkwJe8SiwSO9CRwlkxe/2sKQQGQmIgTb",
                "schema": "bo",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6aa08917-d865-4024-a31d-87a7dd57867c",
            "fullname": "MySql:b4b7cb97-9c7d-48d3-abed-4c3fdbf35b8e",
            "type": "extract",
            "name": "b4b7cb97-9c7d-48d3-abed-4c3fdbf35b8e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "49df1d08-47cf-44ff-afc4-7d3797a75373",
                        "id": "tq_aXZAc3HbR",
                        "name": "InfinityCapitalg_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "60324d48-f982-4eac-b1bf-ce6b628e5188",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ab2e1697-5eb1-4b2d-99f5-830164bc9c5d",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a3d65d8d-831c-41e5-b7c2-22924bdd3d62",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa1e5933-0950-4069-8572-7ef29c0228e7",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af0fd862-4317-4e39-9378-e2374f2f506c",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76aeb33f-b4d2-4c5a-9e8f-086fe5242641",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4415ad64-f1aa-44ee-ae33-268c3b7ae167",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e5d35eec-569a-4b49-89ce-bacd5f6b3430",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f3fcb8f-7f60-43e4-bdd6-40fed5f5ae6e",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69d1b467-3c5b-4283-9f6f-81f66bd9b07d",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "446d6ffd-32e2-4f4a-bf9c-b1d75acb9e77",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195069d6780f2002c37ecca",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6ba26129-8714-4cbd-b835-3a96c737a0bc",
            "fullname": "MySql:58412930-7dca-4743-923c-20cf38ea0483",
            "type": "extract",
            "name": "58412930-7dca-4743-923c-20cf38ea0483",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "2f3f7b69-0964-40ab-82bc-c7f163551d0e",
                        "id": "tq_7yUYAO01K",
                        "name": "AshfordCapital_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ff0522eb-5b29-42dd-b157-54d8ee2d84d8",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a769d1a5-663b-475e-8ba4-86187b509cfb",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a28516eb-75cc-4af0-90ce-8152b93178f0",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32408bd7-4ad3-4668-8d38-51ff717668f6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19e9790e-42d9-453d-ac02-d7654f94659d",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6deae1cd-0eb2-4cbd-8159-013fb720bf90",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dfcc864a-038f-46eb-80a1-40eaf8448c72",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74ae22ba-90ff-4dec-bd6c-ce01f7c62e48",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "144208b5-e671-4940-add3-5a68acde373c",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "522f7215-7736-4e34-9508-362a1941ccfa",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09678063-2830-4f68-a15b-0ab598c16a6c",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "578d7948-0df7-416f-a019-bb9cb3ad7f73",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d0fc3c7-2750-4017-a5df-622b68eb2599",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68bdeaff-ef41-4cdd-a092-951b626037b7",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53ad706b-df7d-4568-9fe0-7b2a678df46c",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e6a95b6-2d41-424a-9a13-1322986d3242",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a264d12e-0745-4925-b615-63a4b7c6a69f",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7b236d4-204f-45c1-aecf-5f0ae61721aa",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd335dee-0f7c-4f85-8ac1-f2d73aa01f82",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc52b95f-e02f-43a9-aebb-1ad2a6a9b3d6",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c827538a-0481-4306-8390-cf0565a94f55",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "604b2118-6270-455b-a2d9-4e10461ccdd8",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c6e8e51-f22b-42c1-8cbe-39404ea64b78",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "175e02d2-2261-4960-8ca6-acf8320b2743",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0742c1ed-eaa4-44d1-98d7-cfea7695a8fe",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d495f835-f653-44bc-82a8-7b28fde2f86f",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c1598f6-7b1f-44a2-b99a-eff45d92056f",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3fbcac1-f562-4b87-b978-987ce101e98d",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92dc70ae-cf52-4ffe-9a76-32c809cc4245",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc8fb80f-7b37-41f9-b763-b4d951498e88",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70da7f52-5d4d-48da-9514-083984538881",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe0540cf-3faa-4893-8e33-0edee3d8f25d",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9da05892-6601-4537-b00e-8e2cfbfe3c3d",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a26da4c0-7c96-462b-b158-527200ce3581",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a9a30b7-62d5-4c3a-882b-01bad51cf316",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd776738-7716-4be3-9205-b637286fdbc9",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68c81559-804c-48ee-b777-3b96211a049b",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f936941-e2c5-49fa-8ad4-795463dc7734",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f2dcc48d-7a43-4df6-919d-44b4e0230d7b",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11cedbe2-0d81-4d1d-a4e7-e72e61ff7ccc",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b5406c5-6149-480e-bfe7-9024ab6693c2",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b9db719-1151-446d-ba0a-4de76cfccec4",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c778dd4-1374-458d-91b3-078fae61cd0d",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "babac1f5-d398-4b03-bbab-a3ac56978531",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2bbd0e73-8886-44bc-9bdf-052839d628e3",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76269633-92fc-4ac1-a7d0-b3f0394c41d2",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd412319-482d-4025-833b-5e8333fa6de2",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67cc3cc2-3e2b-47c9-8866-96c1d3af7060",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ab82d44-1418-4eaf-8662-cc032f2d4c57",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "462cff7d-5caf-446b-bf19-5a8956610809",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc6eb869-8dc5-4a5c-a6fc-35ca5bfd885b",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b7e631c-6d8c-4866-8fb2-07f1df856ce9",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50162220-10d4-477e-8f8e-b5ca73828884",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82d1cb15-df47-425e-b2de-9b91eeb3dfc4",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b758faed-a096-42cb-a79e-c0cad0ab15d7",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1436596-fa25-40a7-b4b7-6c36a7ba2d12",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10eaec2d-93bf-47b0-92df-a32b94e21c44",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ca6eb68-5605-45d7-a36d-a6980bf74712",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1ea29cb-497a-4239-bea2-c14dbe371ba2",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58b7a8aa-d9ce-41ad-8895-fb23c0b1e6b1",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9bfed421-9351-445b-8f44-7b629760ef5a",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10787c60-0fe4-474a-94d5-1d1e19984994",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71508bee-6d37-4503-a0ca-5fa92f75a9c2",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1218de9-0e69-4a95-a733-f43700bce397",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "604506cb-b061-4644-a905-fb8e7852981c",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3449530-6e30-4270-9af5-5e40392f47a8",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3005744-191e-47bc-bbae-a64b697fbf7c",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cbb15f08-ab78-4883-93e6-dcacdddcc6a1",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0334a03f-c757-474d-a9df-21dc6aa37667",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "522f7215-7736-4e34-9508-362a1941ccfa",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "2ce2497b-8715-4dde-8e64-36d539bf781f",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5348a56da002c36c6c0",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6qAqQ4wTrAjQNYhfY7egrcPCKm7Rh9+irvJBmxkN4y5OWK0b1ABUI6cX4BynT/Bb57V8dXjpQ/i465b9A+cO9KF/5WSBj4Act8xbVcAg/2E4DCkuyCXF+OKugn3wI+gXAF02li6ZiOESl71+QZkncPGh5q9fZWYJlgnkJvoKDP2C",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6be32a8b-b610-406c-9a97-582979f2aea1",
            "fullname": "MySql:3cc7775f-2dab-4a65-b568-67fde376ff3a",
            "type": "extract",
            "name": "3cc7775f-2dab-4a65-b568-67fde376ff3a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "101e6046-bea7-404d-87c7-18b5e02cf4cb",
                        "id": "tq_SUeqW4RhL",
                        "name": "NostraCapital_Open_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8d8bc83d-9dcf-439f-950d-0b2b91d57041",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aefb7303-b7a9-460d-808b-43646eb9c920",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f47978e-7150-4d11-aa69-361de5203cf0",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4689af5-1223-4028-8b2c-a6661234a6d2",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ce0f457-be10-4955-a1f3-080caefdaeda",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6550ed4-8792-48da-8d6d-89edbdbc0124",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f43e2301-3645-43d6-af11-fec5eda9ee56",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61582cf6-8700-48f5-8714-214648fec2d3",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11560f85-a80c-4498-bae2-9c0bfe5fec73",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3e15ad22-a641-4a66-89a7-1442e1d593f6",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5348a56da002c36c6c2",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6mkpXbI+4cVPcW9QmdR/OpFY0NV6lOS+yIHmY9aWUhUzSj1KLvCfMgcIqWzFtH2wB4wDE6J0O3kIYCeCTy2Vm2FnBTBcZ0ejYO8nr2tUHC3cyjEC9VpB/CP/XWAQHRXQ8biCOO3g3QegnOXaTTb/9ErFOuEJ8WFWhUXRuCVMOFyl",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6ef0a3ce-09ab-4e71-b145-63a1b2952734",
            "fullname": "MySql:e5fa717a-f40a-44de-a9af-af1fd1c0d03b",
            "type": "extract",
            "name": "e5fa717a-f40a-44de-a9af-af1fd1c0d03b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "6fecd87b-f644-49a0-a373-df7b024f807f",
                        "id": "tq_18uim4T7v",
                        "name": "Chelsea_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e8161f25-174b-49cb-b5bd-c1f5ef6330d8",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ace42e1-1fd7-41fc-a37b-a6faf5d4fa80",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ece0c493-846e-4072-aa01-842eac382d2c",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b5bd7cc-c61a-4e73-bdb8-677288481337",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dee2fb2f-d019-452b-b812-ddbc3a0b5994",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "1a9d0ddb-ba28-471e-867b-16e427b52ee3",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617134a955f384002cf1020d",
                "provider": "MySql",
                "parameters": "BE4OxiDqsaVb+1ukLM/AG3kiM0mBmEnf5+RF0FNWdMvVMRLKEGHP7i8Jb4OVv7CAoJrH7a/nkykrGiit3FSG/m85DPOX2IUqB6qOs2clw5riXmxFSMuiF3F8MgrP3MH12R4ofvsfF/fYNHAGVdVhOGjYUgjhzKoG+h+ur0i61f2xq5hHO9UjwqjzFmrYrN8ntau9AUUkD/MC6QOashL2AjWRcvpvZbZikoelSn8/Tb4Qv8PiC23gjgUiJBr0/QAq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "71e904c4-b6ed-43af-b823-dbe922e312f7",
            "fullname": "MySql:9f1fd607-20f7-4300-96ad-de60e40520dc",
            "type": "extract",
            "name": "9f1fd607-20f7-4300-96ad-de60e40520dc",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "5b0a4fde-0711-45a0-9aa2-78041792be5d",
                        "id": "tq_xEpmAYhPU",
                        "name": "WinGroup_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "06ade872-951f-4182-9634-a65c67cac568",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f80a35ef-cc16-4574-9561-88e20421f756",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64789eb3-e124-49ee-b234-9cd106972dcb",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "774e9b24-6146-49ac-ac86-de58804de19f",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e7bd3c0-396d-4394-bebe-709a5facf0ed",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "2c19d324-c9c2-43f1-aa7b-febe50b9ff8a",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5348a56da002c36c6c6",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oISZYo/jnBBiedN+eL7iEVmicVz5zdJvnkTnDpGXX+jM3jkWwQH1GDq4EovBiX29q5VS6x+Z07G9BXJJzwZT+nGfZWcVbeOv81/ipF/iAkEydLA1qCoilSMT7qJlQub6SW5eExTvv+75JqKLkCs/jkkYjDgSKl1b0MSB6ZMr8WT",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "749cccf2-dc9d-4ce5-bdca-9c2be7bf4133",
            "fullname": "MySql:6e690883-e05b-4bde-b96e-f41978e02eac",
            "type": "extract",
            "name": "6e690883-e05b-4bde-b96e-f41978e02eac",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "94f269b6-071d-4563-bee1-752c5ea83693",
                        "id": "tq_jqNi8HawF",
                        "name": "WinGroup_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "192b8cda-f9ef-4757-b844-a769fc3ed526",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4dbf27c3-31f9-4bff-b285-911996f27edc",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bee26968-8ef8-4c94-a8ad-6d2ee21dbd14",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ebbe189-c69d-4499-8487-ff8ccca1996b",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1422f2e-8280-4f1a-a7ad-e339cf4f4966",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7871add7-5aae-4f7c-aed4-c8e32025b436",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5134507f-4c26-4877-8355-aa014fee6545",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "468ed05b-feab-4ae7-b20d-236e2dd9c257",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0c66f83-07c9-4962-be0f-01700fb6b750",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c72d3d69-f51b-4079-95d6-533734a9f85b",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c92cc01e-c084-409e-a270-995aa04838d5",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506dd6780f2002c37ecd7",
                "provider": "MySql",
                "parameters": "7niuYEzJZH44LaPxXSBFhgupfobVTnd8RwuqT0tnpje5KDJ7gduGgbtju1DOzrlHXyxYXX725adKvwo0Axykr9WoMGo9e6lj1avkQiOehykewRR3dL0bFhZy2PD1D/s214ZB/FP6EjZLCw1IBo8M2ECB8F5338o8R/suGfqjWRnOflsq2MUpBYr+Wc7GJM/Dz7GG94Zi/zFyYcZz2sw/RvGv2nW3dmxfd2U2fn5h1ubfdO27mRkN4g+kxmvyY8s8",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "79e41ed2-052c-492f-bc2b-2e47a04ffe71",
            "fullname": "MySql:08f1d832-97ad-439d-b049-5f2fcc38ad54",
            "type": "extract",
            "name": "08f1d832-97ad-439d-b049-5f2fcc38ad54",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9c914c15-886c-47fd-9c32-f14f2be21a1b",
                        "id": "tq_tyigwikwy",
                        "name": "Bitfinity_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "81a164a5-0651-45a9-a2e7-bffdd103e47e",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25c96c4c-bd7e-49b9-adc2-beaf3bfd6c86",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "914ea2ee-65ad-4b8f-970c-d0131b07ee53",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea884975-1134-48ad-94b9-583a463b84b0",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "616e0ee5-f869-426f-b2e0-47b2a9e5a6d4",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb2e3159-4a1c-4016-a23e-8e414eb22687",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "880de25a-ad3e-44a7-9018-c6625ba34508",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "963ee4ee-3774-4306-9a66-58ce4c8e5945",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "475ea989-f8f5-446e-9d60-99b167aa6b13",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b74ce368-2c8e-4a99-bace-d861311c93ea",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17735475-f03a-476b-839a-4b655d2f070e",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd0efe74-0005-4517-8c93-723ce7ea1684",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba3b8350-de21-47e7-bb14-d5aaaa41f9d3",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c1fc1a5-dbc0-420f-bff2-1a9024d2bfb1",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "485c176b-b86f-4664-8d10-ff3dd79f834e",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c860fd1-8e7e-4ae9-997e-30b75fa4a0d5",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84d7a115-fd8f-4e29-b744-a7cd529ceb41",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "085c1615-e7a9-4dca-b1ed-b351e1a0b2e4",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d56d9b9a-da32-49fd-83b6-199dc10145e8",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e666a997-35c4-4042-ab5c-ce7b1e129e0c",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c8d1e20-e23c-4c9d-bcdf-e17825d61830",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8224179-6462-498e-890e-330857b63b5b",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25c248dd-1772-4c05-adad-b30bf6488023",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "93ec6c8b-cd39-4b2d-b9c6-c70cd761ab03",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "781970e8-c2ea-4eed-aed1-74b63e6cfea8",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eeeb4928-1b62-41b8-b5ab-face6545f41b",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24a1a6b9-a1f7-4316-be15-c2b27659a2b5",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c22ba09-322e-4e1d-97a9-6fab70cc1623",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62242c6d-2e46-49ac-a6d3-fd333ee9c774",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "447f3725-13c3-4db8-93ce-0ab42b428891",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef38cead-aaa6-44e3-87ef-392a65524c76",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b814023b-6d6e-4ed8-ad24-a1be19d50916",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c94c8d67-2bba-44ed-9f11-e757c7b14352",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "357fad4a-fb87-4749-9adb-1b44ea64db54",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef62b8a2-f8ba-4176-be54-5726a69542f1",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9230f3f5-a7ba-41e9-b587-0645c8b8ded1",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16f73d2b-6678-4c2f-92a7-cedb6adaa4b5",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cdb3580a-d067-4c01-9162-7e976fc98910",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b14907b-0c44-4bad-81ed-fe6049b44f8f",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ce15c70-a55b-4375-8675-89c125d5066c",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8911510e-fe8a-4e42-ba76-debe49302d99",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f06b538f-055c-49ef-a7e0-489c7f8d0776",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c720f9bd-697e-4b8b-8daf-13348fd428d1",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ee2c3f1-4a52-4be5-bd53-c5e8951a5306",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e756ca39-2fe1-47a0-b63e-2a416d3b0065",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b705ed9d-67d4-4ed4-b82d-7f22e1bb7be7",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39931f68-5f04-4250-ba21-a47e23563b8c",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "641d8dcb-0433-4cc7-8166-5e9a2b5c48c6",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79694aa6-6b5d-407c-928b-723a0640290c",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "056e08b0-5162-454e-acb3-995769f5bcc8",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62efef5c-4fb6-48dc-ac10-1bf89c7ab696",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3492016-152e-4f2f-a04f-731f8c043ec9",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09de3f67-9bdc-47bd-b033-bdf14f0125e4",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e21eea9e-871d-44aa-8130-bcbcb40e1191",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b41e37d5-1538-45cb-9186-eed46434d92e",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db38c1a1-dbf6-43c5-9d1e-9b368b515bbd",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d75e49b4-9bc9-4123-946e-8f3f4760d9f6",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 40,
                                "size": 69,
                                "precision": 69,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10041933-f5d6-4f0f-aaf7-e23cf4bcf359",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e86706c5-060b-4adc-a061-bf8f57143908",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 40,
                                "size": 69,
                                "precision": 69,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50ca17fb-9ce0-4abf-a02a-573045524dea",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef1d4764-fb76-4114-88b4-2b10e41f4dcb",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4e96b71-eed0-461c-87ec-01b05d34fb2d",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92a81cb3-24f3-4b92-b51e-a0995e4f0eab",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26615ab6-c5c6-4c98-bca3-f5a1c9f6d188",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "707250f9-6efb-4399-85cf-4d2115ae1d27",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 64,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ef488d9-c967-43b2-b782-a377bbd295d5",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9853b276-8a4a-4abb-9f1e-2c0c61898088",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 64,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbc7fba4-a4b1-4250-b491-05e84103eccf",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "deecded4-edcc-4245-8754-3acfcedec083",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "b74ce368-2c8e-4a99-bace-d861311c93ea",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "d011ad9e-3cf8-45a1-bfb7-045d6743dd95",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       site_id as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61964bca3f1f2f002cf16c43",
                "provider": "MySql",
                "parameters": "19x2eB8ph2aYc/juzRJhdXmHOGk/Q0LOo1mcPAZAkzQ0rOYfaoDxpFcxuWNBv7R5KV0O5tYU8i2V/PjWAUeDSLhONZ0UCFxUB12m91h1eHOHdzR+SB2d9VJoCcpD2m9S5HXy2q9B6RLuhWzexgEBZWWpbuLtRZNIioiIe+Aak0+UQZCbTaPF44h+UqblYtn0GbA9u96R0kzZhm8bt0OQY3NtWmYnwdwQiprKhRjTZlxlHYq4bo/AURRzeuo5J+ph",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "7b6b837d-cd11-4ec7-836e-04c3254a9052",
            "fullname": "MySql:808cf0cc-f3ba-4fa3-bf40-609f1266ba14",
            "type": "extract",
            "name": "808cf0cc-f3ba-4fa3-bf40-609f1266ba14",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "2ec55d20-038a-4dcb-bf1c-f2d56aa69cc8",
                        "id": "tq_raMrqQQoj",
                        "name": "IvyTrustsEmployees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b8b7b7e7-6468-4eec-b801-a5c208ba9852",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d21cd6b9-88fb-412f-85d9-a6df5d90aee8",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b050b844-37b8-4926-a64d-d2af9a78b740",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cef820f-865d-4aea-99f7-a949bd52bdb8",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5a09ab11-1670-432c-82b9-47069d45a537",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd8682d3-8b4d-4b99-bcf0-55e41f200f06",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1ebb066-e7a1-4bee-9534-526c676bdebb",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f50eaed8-0ff2-4126-be73-e4d82c048426",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "511ce25b-cdb1-4533-b252-a379a3098200",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f35aca46-7503-4aac-895b-55581ebc5fd3",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e632345b-db1b-4321-837a-2c0b0bcc79e4",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506826780f2002c37ecc5",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiAoP3g27zBsTBhENM+dBsf62FQyEzHEvyCyA1AFqG0Wq82nAt5YxcjG5bUujZ6mLgw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "7c22a03c-63a1-4d02-a2ae-a9efe07e8aef",
            "fullname": "b0a1939d-2c5d-4560-b6ea-a30225d26a79",
            "type": "custom",
            "name": "b0a1939d-2c5d-4560-b6ea-a30225d26a79",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "078bc294-f253-4e25-91a5-7a49b6c1bddc",
                        "id": "Employees",
                        "name": "Employees",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "77e105b7-ee07-42da-b964-bb343da2a0a5",
                            "expression": "select * from [PrimeOT_Employees]\r\nunion all\r\nselect * from [YorkEmployees]\r\nunion all \r\nselect * from [IvyTrustsEmployees]\r\nunion all \r\nselect * from [MarketCGEmployees]\r\nunion all \r\nselect * from [TheWealthCore_Employees]\r\nunion all \r\nselect * from [Arrowteks_Employees]\r\nunion all \r\nselect * from [AussieTrust_Employees]\r\nunion all \r\nselect * from [InfinityCapitalg_employees]\r\nunion all\r\nselect * from [365TradingFX_Employees]\r\nunion all\r\nselect * from [TradeTheBit_Employees]\r\nunion all\r\nselect * from [NostraCapital_Employees]\r\nunion all\r\nselect * from [TheBPCA_Employees]\r\nunion all\r\nselect * from [GeniusIG_Employees]\r\nunion all\r\nselect * from [Chelsea_Employees]\r\nunion all\r\nselect * from [AshfordCapital_Employees]\r\nunion all\r\nselect * from [WinGroup_Employees]\r\nunion all\r\nselect * from [BendigoCoins_Employees]\r\nunion all\r\nselect * from [Bitfinity_Employees]\r\nunion all\r\nselect * from [BigBitMarket_Employees]\r\nunion all\r\nselect * from [BigBitMarket_Employees]\r\nunion all\r\nSELECT -100,0,'-100', 'Selfies', 'pool', 'Selfies Pool', 'Selfies Pool', 'Selfies', 'Conversion','Selfie'"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "4ce1fa4b-c6bb-4c8b-94a4-3f0dc60d1ef1",
                                "id": "753e0457-32d0-4e94-af2b-a011c6dc2188",
                                "name": "employee_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a235b20-47d6-4a78-9456-47918118208d",
                                "id": "338e1f5b-71aa-4d77-a453-88f3f0a9a832",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a69ff35-32b5-4778-bd25-36e72ba7d581",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4445eccb-a898-4849-af3c-48e56bd6bb25",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70156998-79bd-4233-844a-b0a55a6aabd4",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0fbdfaae-f418-419c-86e8-b214115d19e0",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f7a93bd-41a7-48d6-9515-4f81a31363de",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2840b466-1c1b-4ce8-8bde-892c196c35cb",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61f1579c-a027-4463-9110-b425feba7621",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90c1d158-b504-4cb7-9974-8e399c047568",
                                "id": "65961300-6bd0-44e0-8372-655599f25e62",
                                "name": "group_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "e628ae74-ea58-47e6-a416-84c681657b12",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "7c5803be-e544-4946-be24-0ae31bb3c0e8",
            "fullname": "MySql:31bad081-9b11-4f45-8b8a-a12a43104faa",
            "type": "extract",
            "name": "31bad081-9b11-4f45-8b8a-a12a43104faa",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f9afefe1-1c4d-40d0-9a49-15d3161d73de",
                        "id": "tq_uBlzv96s1",
                        "name": "TheBPCA_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ee594675-1e04-431b-8997-00dbd3f37a5d",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14d988cb-ece5-4467-a179-2645243b244c",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e73bbe7-e236-4b7d-a0fe-88706c372f1d",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22a103b8-6063-4512-878b-7201327f634a",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "116b57a6-390a-45f1-b449-1ac37b498262",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e7eca380-2159-4c80-b34d-ef5329f58b0b",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617134d755f384002cf1020f",
                "provider": "MySql",
                "parameters": "Li2FpOBZkuQVFHmglvVO3unF3cyE7uQhXYenrn6ytNP08dPSNopcrZhCPhIEZbJq3GHeZmZNPZrQfHZy7Mo7S3QwZl+lJvy8mcXjoPWADHn7fHD/TXsGlpkaRPNOQnFO1tEd5xDHMHRh7i0mnvMheVsy39u8/PLd+UW23hnoTWzeGuy1jl1t9vmXt8xw1uh0Lw271DKaGVhOc5Lst9nqXnRu5pPfVPjIho4oBLMYdZDsXAdGAFkgsULvW5O9Ut8l",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "7c8fff18-5ddb-43eb-b617-2a57e3d8db0a",
            "fullname": "MySql:7c69096b-d26e-4e62-a5b6-e3b6b71d071b",
            "type": "extract",
            "name": "7c69096b-d26e-4e62-a5b6-e3b6b71d071b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "6c9b1203-847b-4f5a-bdab-4220e952e91c",
                        "id": "tq_Adh0hrLq3",
                        "name": "BendigoCoins_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b8d81e09-b429-446c-a742-d3c49b5fc927",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4c306f0-7ead-4f9a-a1da-f19f60223527",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33d32bf7-d978-4309-8802-7bd42ccdf72c",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72862e96-46ba-4658-b0f9-7d2db5d72a57",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70ee1cd2-3bfb-4b09-973c-b19f3f9b0dc8",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bab73af-549c-476d-bf45-2650b6d6034b",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cdf84b10-8797-4771-a64f-c9d3ec58be8d",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dcc8972c-5b2a-4c74-8a6f-2f0d4b81a467",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cbffeef-94f3-433f-986b-90821406a988",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a059bbaf-eafa-4e7f-918f-b6d035fcf153",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "af23e2c1-b526-4441-81ba-5c159cf7022e",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506bd6780f2002c37ecd0",
                "provider": "MySql",
                "parameters": "FhwKndxsEm4karcTRhcRhQ31JuodaLCOkLCPAL5UDyKQmplY4PGQirEicte+5XlO7CmeguqIciMcA3dWSPlLRdyZQQBa8rSl7481iBoEVleEKNnY0oZY59Uua0u3yiz/U5itDzyqwT3hV27JP+osZrKYLMelBUn+F7vnCn46CtacVjNzMfL/BmkfA2U0DhrLnI0aG8HaWhblMUs9PMPHSLPgZ1yWRCKlfMFEAtsVU51Jg4PyWiAT5+nvRZJBKlUf",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "7d5976db-c3dd-4e67-ad48-036dec2a578d",
            "fullname": "b26189f4-6def-4c50-ab48-445ca7248403",
            "type": "custom",
            "name": "b26189f4-6def-4c50-ab48-445ca7248403",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7e94f429-c30c-4cd6-b084-9c2c6dcb2b17",
                        "id": "Postions_union",
                        "name": "Positions_crm_union",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "733aafa9-27de-480c-a89d-abd0d4a67e95",
                            "expression": "select *\r\nfrom [York Positions]\r\nunion all \r\nselect *\r\nfrom [PrimeOT_Positions]\r\nunion all \r\nselect *\r\nfrom [IvyTrysts_positions]\r\nunion all \r\nselect *\r\nfrom [MarketCG - Positions]\r\nunion all \r\nselect *\r\nfrom [TheWealthCore_Positions]\r\nunion all \r\nselect *\r\nfrom [Arrowteks_positions]\r\nunion all \r\nselect *\r\nfrom [AussieTrust_positions]\r\nunion all \r\nselect *\r\nfrom [InfinityCapitalg_Positions]\r\nunion all \r\nselect *\r\nfrom [365TradingFX_Positions]\r\nunion all \r\nselect * \r\nfrom [TradeTheBit_Positions]\r\nunion all \r\nselect * \r\nfrom [TheBPCA_Positions]\r\nunion all \r\nselect * \r\nfrom [GeniusIG_Positions]\r\nunion all \r\nselect * \r\nfrom [Chelsea_Positions]\r\nunion all \r\nselect * \r\nfrom [AshfordCapital_Positions]\r\nunion all \r\nselect * \r\nfrom [WinGroup_Positions]\r\nunion all \r\nselect * \r\nfrom [BendigoCoins_Positions]\r\nunion all\r\nselect * from [Bitfinity_Positions]\r\nunion all\r\nselect * from [BigBitMarket_Positions]\r\nunion all\r\nselect * from [AigMarkets_Positions]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "bca1cf9b-b7de-40ae-a527-1b5ac97ca329",
                                "id": "46c3ca11-f7a8-49fe-9d66-2844b88ca160",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d57f3d0b-3225-4421-8aa2-21437133ab7d",
                                "id": "f1c26622-8863-4779-bd7e-1d161e8ab815",
                                "name": "unique_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "964dabe5-6853-474d-85f6-c44bc9aac432",
                                "id": "3fc81fe4-7f8e-481c-9361-6afb6738ce00",
                                "name": "employee_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1060a750-d5ba-4e67-88c3-59c1924c2226",
                                "id": "0f99a3a6-9e77-4dd6-960e-62e0d328fa11",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c58e9a0e-7140-4ad4-8845-7e04f1b27514",
                                "id": "cf731aa4-ca30-4f8f-8ff0-3fe9f214f389",
                                "name": "order_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "f69cd7d4-616a-4a9c-9ef4-a1ff00a4bf79",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "7e1e76df-47f7-4889-98d8-926099a9d641",
            "fullname": "1dd21f5c-6004-4faf-876d-5b76f20cf28d",
            "type": "custom",
            "name": "1dd21f5c-6004-4faf-876d-5b76f20cf28d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a07dab5b-9c9a-46f9-820e-90551976b4e1",
                        "id": "open_pnl_customer",
                        "name": "open_pnl_customer",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "57c7bfac-bd67-49ce-8297-c4bffc52de29",
                            "expression": "select account_id, sum(case when PositionsOpen.status = 1 then [open_curr_pnl] else 0 end) as open_pnl from PositionsOpen group by account_id"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9d4a6fe1-f54f-4736-a39d-bf70dff32f9d",
                                "id": "account_id",
                                "name": "account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eedb8b04-ed4f-4b8c-9665-b311bdeed7b5",
                                "id": "open_pnl",
                                "name": "open_pnl",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "5cf38301-3ffa-4b79-a981-024462fd808b",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "7ebbf74c-9407-4f9e-8fbc-6614c1809f94",
            "fullname": "MySql:c59089c3-a581-44cb-b35a-2eb933bf84e0",
            "type": "extract",
            "name": "c59089c3-a581-44cb-b35a-2eb933bf84e0",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5348a56da002c36c6d1",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8OSfPYhJH5R3HPnPvPUq9ufFEejHbQ5noMM+s2I3j9hfV4ghZOttugRuXVbNWlMq51sPWEQ79B4SIfJgGwbgIEwugkCtRlhGLq4p5Jfb15dVDFMoI69c+dcUuN1SDyQ57I=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "80698503-1ec2-4da1-8f31-e0e5e4232a3e",
            "fullname": "MySql:e09e4f20-f677-420c-be79-07ceee453ae1",
            "type": "extract",
            "name": "e09e4f20-f677-420c-be79-07ceee453ae1",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "cc505697-a4b5-4665-b38b-8993267cd4af",
                        "id": "tq_ab5oXUdxT",
                        "name": "WinGroup_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e324ecf8-79ae-4b8b-a5d8-17be3ccd0c50",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23607561-ba69-49f6-af4d-e85c8fe4796b",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abeb5900-88f0-420e-9480-7f36ded10a0b",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32e5a3af-2236-494d-a0a7-c7e31d061206",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0013740-260f-4a8a-aaac-c14196f7e79d",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5819da7-1baf-4b96-9831-fc84eb648d2b",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0e1f1e4-63f1-40ac-a246-db533fba63b3",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4aa0d5d-a70f-4555-a3b9-45e12dc985c6",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66e269f0-ef73-44fb-a033-f56655013f6b",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc5bdd1e-34a7-4641-91c5-3288bddca9b7",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8661fdd-2c4f-42a6-8a37-e7d09ca48262",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72a0c473-d653-4eb8-90ab-85db07d99bb6",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce0fa9be-c0df-41e9-a4c2-2f65848edb07",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c31109c7-b387-4c8e-bb4d-6f10547d4303",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5da780d6-2a15-4a45-bebc-b5103ffc78bd",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c705823-6b5b-4219-9eb6-f22016ae2a74",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4df49f24-0dbe-489b-8059-ba0c07e368b5",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84ba1380-88a7-4096-9809-86ea96b63139",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a2bd5d0-828b-49c8-84dc-e23e5b404105",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4903fe5a-b669-4477-87e8-075bee839b79",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eeebdfe5-a12a-48b3-87ae-d7aac6c3a148",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ad27745-e363-4626-97b2-1762855b20d0",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf4c2cea-0a74-454b-951c-de25362ee705",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "efaa46d8-cc0f-4daf-927d-e5eb4d25b14a",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23693e03-b12f-4317-aaaa-a68c8d31cfe1",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a865d7c9-eb2f-4f06-8179-6d3dc3a21dca",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0008e4fc-0d6f-4d3a-90bc-9ce1c52adc36",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a4162614-5416-4e27-bbc6-96ecde3e039c",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "85b84583-6be6-4c3b-83a1-1b4c81a05ec3",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f9f22e0-c20e-49e1-ad14-bebccb63f962",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63130048-27ee-4453-a9ba-658e0dca9c3d",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2fa89d3-33db-4eba-8573-9b0cf7d1380f",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba13d686-947a-4cd7-a5a6-0ded92e842a5",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41b57daa-6e27-4e3f-9eaa-362bb07c0420",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4b243d4-ff50-4e48-ac02-88cdab88f05a",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a9763a1-6ce1-4af6-93c7-f575df506d49",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe44e3aa-55af-4efb-803e-84636519afa2",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4421bae4-cfb3-438b-887b-9b13ec2223c3",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38b86e30-32e5-4b9f-9983-0f1589c999bd",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0a81250-3b27-441e-8374-475066579e26",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "777e966a-3771-4227-9025-c36c10f0ad1c",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed468fb1-ab66-4d12-8fbd-3cfc0a836a77",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "29c7b6c3-16b5-406f-bc77-7889f1022c7f",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f32ab3bd-46fd-46f4-9199-8d62fc1e2b19",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc0580e9-3d3b-42cf-b2cf-d6866e2fb459",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c70df1a-1cb5-448c-8488-57c7aba6e513",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a67245eb-1397-4dd7-afcc-37e44d321ab2",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea64f2b8-304a-4eba-86f9-20634b2d7333",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ded8a61-c8f2-41d6-b03f-49482383aa45",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b69a64dc-afc0-4eb2-8016-1601fb28102f",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5da6018-3a57-4fed-ac48-b091d72865b7",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78d208ba-56af-4d79-b9d6-2a5cf913f56c",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3014b72-b5bd-4947-adae-08d67e54d042",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "346a4e46-6ac9-4c79-98e0-82ed0871fcd5",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eef2fc2f-38bd-4e13-b8ec-9874637926c3",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77328164-29e2-487c-9062-59b6c01a6a75",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21961957-7dec-4538-99d8-b7023589355a",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7593fd1a-d798-4278-be74-6c37d1eec977",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2d958ac-bf78-4116-95e5-900aa0cefd38",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b7ba5ea-7dd3-4a8e-9178-42ada5f365cd",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13293e43-d3aa-41e9-be40-7ad58827b349",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3d8fd0b-1717-4a00-aa09-8d87aee81e16",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "ba13d686-947a-4cd7-a5a6-0ded92e842a5",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "eedf0914-96b4-4cd4-a3e0-58eeb0eb1c63",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id <> 24\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) <> 24\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619505b76780f2002c37ecba",
                "provider": "MySql",
                "parameters": "7niuYEzJZH44LaPxXSBFhgupfobVTnd8RwuqT0tnpje5KDJ7gduGgbtju1DOzrlHXyxYXX725adKvwo0Axykr9WoMGo9e6lj1avkQiOehykewRR3dL0bFhZy2PD1D/s214ZB/FP6EjZLCw1IBo8M2ECB8F5338o8R/suGfqjWRnOflsq2MUpBYr+Wc7GJM/Dz7GG94Zi/zFyYcZz2sw/RvGv2nW3dmxfd2U2fn5h1ubfdO27mRkN4g+kxmvyY8s8",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "80728306-e66b-4c85-bb6a-815e19b69510",
            "fullname": "MySql:c91a6226-586f-4cb0-b835-ad48b6fea3cc",
            "type": "extract",
            "name": "c91a6226-586f-4cb0-b835-ad48b6fea3cc",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "3ceee03e-1f5d-4434-860f-b680f72d0750",
                        "id": "tq_oRsOU0mFl",
                        "name": "GeniusIG_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "506a4d67-ed74-48d3-8ac2-e4feac7a14c2",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "843fcfb4-f8d7-42db-a4f9-11387b2bc3f0",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81deb0de-43e0-4196-9dfa-34bbf7ca70b9",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d74597c8-0169-49aa-8245-e34622143839",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48cf49fc-9526-445c-936b-e49fcd742630",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "72a88a0f-a42d-470a-8239-754c6298bd83",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5348a56da002c36c6d7",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lNqu9YjU4aq2UrD1B4elNg9lVKQFHRdfOjSDmdho2O0BcE4ZGSnDY66nmV13xmTftBiPAwAPjQRY3WaG8+JajVjq0bDUxyyXSBahftWfD+BqWv3e7qI4k/hTBGAZLgcMyNOeLODquQbmqREECx1kSDm5qX7TJaisk1mvdLWSNPK",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "81b4fae5-4a29-4b5e-88f2-978498558a82",
            "fullname": "MySql:22b7f787-00d1-4a0c-a87b-ea077b8f78a2",
            "type": "extract",
            "name": "22b7f787-00d1-4a0c-a87b-ea077b8f78a2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "31cce46d-81ab-4f80-b656-aad51a6e78cd",
                        "id": "tq_FsnNzUYAD",
                        "name": "AigMarkets_Employees",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f3c4ee66-40b1-44fa-af33-e4a0a077f7b1",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "959c5f81-984e-45bb-ae08-02ad640f8140",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b6f7331-97e2-40fb-90ee-c1bd19e57221",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f4ea4d4-952b-452e-a193-add1daa38f8d",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0fe7ead3-a05a-408f-88d1-619950ac6c1d",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35ca3d6f-56a0-45f6-8098-7965fa698f01",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9defb92-df56-4646-a93a-c60f542093e3",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf6715e3-fa3c-430c-8dd3-fe1b9fd9d938",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb984479-f443-426d-8153-73401427c066",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa6c3027-8c05-4335-9a5a-9f24b6ebbc43",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c3cc0f1e-8c81-4b64-8e08-679eafacec2d",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61b3442201d520002c42b1aa",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W9vffNlEo4jtdabftiKFBxfaaQsXoFhTTM7txEhG/jLu6CBekXY22hgN88Ng0fYauS48Rg4xTl4PvHqjVbcTS5Oi9FGQfbh1gOsBXF/HnXlsW+cFPRFDXzzbo/8B2c8RpAz/uBJmRSXztf22P/MxqCvTW1lgo5PsEnrOHIw69wgwh2HIjj4R4ChudbQMprFOPzxUtJA/laJ5YRHjGrRVKxa",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "848fd579-e837-446f-afeb-91ac271d4f6b",
            "fullname": "MySql:62bd1375-0d6e-42ea-85c6-b6c95244c252",
            "type": "extract",
            "name": "62bd1375-0d6e-42ea-85c6-b6c95244c252",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0819c344-625c-4d67-8ac1-e889fd47971c",
                        "id": "tq_cYzBkQPB7",
                        "name": "positions_tp",
                        "type": "base",
                        "schemaName": "trade",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "15f3a41c-d43c-4f26-ad48-354402d263ab",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bb1973db-c162-4655-928d-9315150c8f04",
                                "id": "ref",
                                "name": "ref",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fca1c89c-f503-4f91-bf85-8191b5efe699",
                                "id": "type",
                                "name": "type",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f16d505-5ab6-4dc2-8864-0c8e0a124196",
                                "id": "type_desc",
                                "name": "type_desc",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fdb7e77-bc08-4455-b243-22bf9e33b71a",
                                "id": "open_by_device",
                                "name": "open_by_device",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4848de15-3825-4c9c-b144-4a58969e1c04",
                                "id": "status",
                                "name": "status",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7f537ce8-af25-40cf-8f5e-116e8ba1b766",
                                "id": "account_id",
                                "name": "account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5de10887-afaa-4647-960d-9e152b84c6c0",
                                "id": "direction",
                                "name": "direction",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92870159-a9eb-448e-9fd9-0a1ff550b41e",
                                "id": "order_time",
                                "name": "order_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5185e35-7498-4d5d-bfbe-6def8942983e",
                                "id": "open_time",
                                "name": "open_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "68dd0da4-5599-41e5-8ab0-d841c2f8b3f7",
                                "id": "client_open_time",
                                "name": "client_open_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2df9276d-bcb4-433e-bdd6-3842514cdf20",
                                "id": "close_time",
                                "name": "close_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e720a886-26fc-4c95-955b-222715a29cde",
                                "id": "client_close_time",
                                "name": "client_close_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "49d23031-664e-4b7a-b4ea-2e668a102593",
                                "id": "expire_time",
                                "name": "expire_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d212f9f5-cc90-4467-b23e-62c1dac772ce",
                                "id": "trade_configuration_id",
                                "name": "trade_configuration_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dbde5c2c-0375-4b15-afa7-2879d3a73b97",
                                "id": "qty",
                                "name": "qty",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7f8edba9-8ba6-4c89-800b-e894184b0eb3",
                                "id": "margin_initial",
                                "name": "margin_initial",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "99cb9dc9-ada0-492b-b9e4-28a63b989db8",
                                "id": "margin_maintenance",
                                "name": "margin_maintenance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd886dc8-2880-48ed-bc0c-950de3682a80",
                                "id": "rate_order",
                                "name": "rate_order",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3cf526a5-20a5-4022-b325-8bd592a94b47",
                                "id": "rate_open",
                                "name": "rate_open",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a01a358a-ceed-4793-a15c-9b3a7ebc456c",
                                "id": "client_rate_open",
                                "name": "client_rate_open",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ff0d0362-d31f-4b82-90d3-fc70dbf70c9c",
                                "id": "rate_close",
                                "name": "rate_close",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cae9ac1f-646d-4e01-afed-8f67da1bbffc",
                                "id": "client_rate_close",
                                "name": "client_rate_close",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e3ab2a05-7b3f-40c3-87ea-d93b92811994",
                                "id": "stop_lost_amount",
                                "name": "stop_lost_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5fca5955-d37c-4b5e-afc3-20f43350f620",
                                "id": "stop_lost_rate",
                                "name": "stop_lost_rate",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d5238588-0ab2-47ed-a621-491ffebe45f5",
                                "id": "take_profit_amount",
                                "name": "take_profit_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1b4dc818-38dd-4c5a-967a-caeb03cb9b12",
                                "id": "take_profit_rate",
                                "name": "take_profit_rate",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "619fc797-2201-4e8b-af3b-da6df5d0b616",
                                "id": "overnight_commission",
                                "name": "overnight_commission",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "25ed31d0-5d74-4514-9530-0d4b1770dc88",
                                "id": "close_pnl_curr",
                                "name": "close_pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "426aaf2e-f644-4827-867b-c365d03c687c",
                                "id": "close_by_crm_user_id",
                                "name": "close_by_crm_user_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4ba564d3-3635-4040-b0ee-e258aed2f99a",
                                "id": "close_reason_type",
                                "name": "close_reason_type",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8aaba57e-3119-42c4-b2b6-021db172a539",
                                "id": "close_reason_desc",
                                "name": "close_reason_desc",
                                "type": 18,
                                "size": 15,
                                "precision": 15,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05edc6e7-4887-4d45-bd5a-fdf85528f82b",
                                "id": "last_edit_time",
                                "name": "last_edit_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3baa4e0-f768-4662-9e82-27290ddcbf9e",
                                "id": "latency_open",
                                "name": "latency_open",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f64db6b-4fc3-40be-a565-59babbcadbb1",
                                "id": "latency_close",
                                "name": "latency_close",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "caa11ecf-a8b7-4fe3-aa27-b1eb004deb62",
                                "id": "reject_err_id",
                                "name": "reject_err_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b5a0c935-c4ad-47c5-9210-29b561754b18",
                                "id": "reject_err_desc",
                                "name": "reject_err_desc",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8e8f260b-1531-40b8-a572-69f5cc135bc6",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "040c223b-67ec-4c9c-950b-e77131d2ded8",
                                "id": "brand_currency_vol",
                                "name": "brand_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "899280fb-4f07-46c2-999d-bd8a659c23ae",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "38f6bc23-c4f4-4da1-9ff6-662abe6b8038",
                                "id": "instrument_id",
                                "name": "instrument_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1687c06-d9f1-482d-807d-974d62fd82b0",
                                "id": "display_name",
                                "name": "display_name",
                                "type": 18,
                                "size": 30,
                                "precision": 30,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de2a042a-5032-49fc-ae8c-d540db86c841",
                                "id": "unit_type",
                                "name": "unit_type",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a43fe73-1fdc-4d73-973a-6d1d0e51662b",
                                "id": "qty_min",
                                "name": "qty_min",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ceb38cfd-f000-4ad7-89f5-e2e570de0d8f",
                                "id": "qty_max",
                                "name": "qty_max",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2cc0efa3-c4dd-4b44-a49a-277f1b9869d4",
                                "id": "qty_steps",
                                "name": "qty_steps",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c354b48e-3f2b-419a-9a71-38750e60c3e6",
                                "id": "sell_overnight_commision",
                                "name": "sell_overnight_commision",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd0b1729-19d1-4ca0-97a0-fe89df30e198",
                                "id": "buy_overnight_commision",
                                "name": "buy_overnight_commision",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f40fd5f6-a772-4371-ba19-0a610ebd1266",
                                "id": "ask_type",
                                "name": "ask_type",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b0a0c4c-089d-4d23-985f-884b6632402a",
                                "id": "ask_val",
                                "name": "ask_val",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "61c34ccb-b2d8-40cb-b4d6-6e6bfc4c5e44",
                                "id": "bid_type",
                                "name": "bid_type",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "66a0fc67-0bb5-4160-b715-443f22db0968",
                                "id": "bid_val",
                                "name": "bid_val",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c8fcdfe9-d6ee-4083-a437-3e2a6fdc7db6",
                                "id": "liquidity_provider",
                                "name": "liquidity_provider",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "315bb1e8-a944-447a-9112-1784b05136a9",
                                "id": "swap",
                                "name": "swap",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f0ac5bb4-bb68-4daf-a5cc-806c237a9f92",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "44ae1597-ec4c-47ea-98f9-e77a5c00c5f0",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 32,
                                "precision": 32,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3112cb7d-bca4-4c3d-952a-3f298c4adab8",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63b3bf92-54a2-4f28-aaa9-dc0f957e047a",
                                "id": "Direction_name",
                                "name": "Direction_name",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be4d9c26-e4b6-48ea-8045-9c100c5ca97d",
                                "id": "status_name",
                                "name": "status_name",
                                "type": 18,
                                "size": 8,
                                "precision": 8,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83cbf84c-c4ef-4452-82f8-997dc90c7813",
                                "id": "tp_current_rate",
                                "name": "tp_current_rate",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f4c845e-4520-49fb-88fc-514e9419eb7e",
                                "id": "tp_order_time",
                                "name": "tp_order_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3d56f1d9-e684-4c5f-8e68-4b4977bfe6ab",
                                "id": "tp_order_time_str",
                                "name": "tp_order_time_str",
                                "type": 18,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a3f5fa1-a994-44eb-8408-faa82c531227",
                                "id": "sl_current_rate",
                                "name": "sl_current_rate",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b8db7d76-e8c5-4110-b41c-1d18e571e315",
                                "id": "sl_order_time",
                                "name": "sl_order_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75806d2d-3811-4e83-a2ac-c7ac4445f215",
                                "id": "sl_order_time_str",
                                "name": "sl_order_time_str",
                                "type": 18,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-15T14:32:41.436Z",
                                        "oid": "92fb0279-5d8f-435d-9310-d03a09f3ba7d",
                                        "expression": "case when [direction] = 0 then 'buy' else 'sell' end"
                                    },
                                    "indexed": true,
                                    "id": "direction_fixed",
                                    "name": "direction_fixed",
                                    "type": 18,
                                    "size": 65536,
                                    "precision": 0,
                                    "scale": 0,
                                    "oid": "44449152-4d1b-4849-bd5d-82b8cc1b72a5",
                                    "hidden": true
                                },
                                "type": "add-column"
                            },
                            {
                                "arguments": {
                                    "column": "f0ac5bb4-bb68-4daf-a5cc-806c237a9f92",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "084c204a-4884-411a-a217-5b9f27203147",
                        "configOptions": {
                            "importQuery": "\tselect \r\n\t`position`.id,\r\n\t`position`.`ref`,\r\n\t`position`.`type`,\r\n\tcase \r\n\twhen `position`.`type` = 0 then 'Market'\r\n\twhen `position`.`type` = 1 then 'Limit'\r\n\tend as type_desc,\r\n\t`position`.open_by_device,\r\n\t`position`.status,\r\n\t`position`.account_id,\r\n\t`position`.direction,\r\n\t`position`.order_time,\r\n\t`position`.open_time,\r\n\t`position`.client_open_time,\r\n\t`position`.close_time,\r\n\t`position`.client_close_time,\r\n\t`position`.expire_time,\r\n\t`position`.trade_configuration_id,\r\n\t`position`.qty,\r\n\t`position`.margin_initial,\r\n\t`position`.margin_maintenance,\r\n\t`position`.rate_order,\r\n\t`position`.rate_open,\r\n\t`position`.client_rate_open,\r\n\t`position`.rate_close,\r\n\t`position`.client_rate_close,\r\n\t`position`.stop_lost_amount,\r\n\t`position`.stop_lost_rate,\r\n\t`position`.take_profit_amount,\r\n\t`position`.take_profit_rate,\r\n\t case when `position`.overnight_commission is null or `position`.overnight_commission = 0 then `position`.overnight_commission else `position`.overnight_commission * (-1) end as overnight_commission,\r\n\t`position`.close_pnl*(-1) as close_pnl_curr,\r\n\t`position`.close_by_crm_user_id,\r\n\t`position`.close_reason_type,\r\n\tcase \r\n\twhen `position`.close_reason_type = 0 then 'Trader'\r\n\twhen `position`.close_reason_type = 1 then 'StopLoss'\r\n\twhen `position`.close_reason_type = 2 then 'TakeProfit'\r\n\twhen `position`.close_reason_type = 3 then 'TradeOut'\r\n\twhen `position`.close_reason_type = 4 then 'Expired'\r\n\twhen `position`.close_reason_type = 5 then 'CloseAllRequest'\r\n\tend as close_reason_desc,\r\n\t`position`.last_edit_time,\r\n\t`position`.latency_open,\r\n\t`position`.latency_close,\r\n\t`position`.reject_err_id,\r\n\t`position`.reject_err_desc,\r\n\t`position`.user_currency_vol,\r\n\t`position`.brand_currency_vol,\r\n\t`position`.system_currency_vol,\r\n\t`position`.instrument_id,\r\n\t`position`.display_name,\r\n\t`position`.unit_type,\r\n\t`position`.qty_min,\r\n\t`position`.qty_max,\r\n\t`position`.qty_steps,\r\n\t`position`.sell_overnight_commision,\r\n\t`position`.buy_overnight_commision,\r\n\tcase when `position`.ask_type = 0 then 'points' else 'percentage' end as ask_type,\r\n\t`position`.ask_val,\r\n\tcase when `position`.bid_type = 0 then 'points' else 'percentage' end as bid_type,\r\n\t`position`.bid_val,\r\n\t`position`.liquidity_provider,\r\n\tcase when `position`.swap = 0 then 0 else `position`.swap * (-1) end as swap,\r\n\taccount.brand_id, \r\n\tconcat(brand_id,'_',`position`.id) unique_id, \r\n\taccount.brand_id = 1 as site_id,\r\n\tcase when `position`.direction = 0 then 'Buy' when `position`.direction = 1 then 'Sell' end as Direction_name,\r\n\tcase\r\n\t\twhen `position`.status = 0 then 'Rejected'\r\n\t\twhen `position`.status = 1 then 'Open'\r\n\t\twhen `position`.status = 2 then 'Closed'\r\n\tend as status_name,\r\n\t`position`.tp_current_rate,\r\n\t`position`.tp_order_time,\r\n\tcast(`position`.tp_order_time as char) as tp_order_time_str,\r\n\t`position`.sl_current_rate,\r\n\t`position`.sl_order_time,\r\n\tcast(`position`.sl_order_time as char) as sl_order_time_str\r\nfrom `position`\r\ninner join account on `position`.account_id = account.id\r\nwhere (`position`.open_time >= 20190923 or `position`.close_time >= 20190923)\r\nand coalesce(account.brand_id,0) not in (5,23,36)"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "2ccf3a2b-9fbe-4361-bfe0-b04036c0fba1",
                        "id": "tq_oUi1wHY7H",
                        "name": "duplicate transaction raw data",
                        "type": "base",
                        "schemaName": "trade",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "74de713a-1ca3-44ce-9c9e-cd7808d9db5d",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "848524ee-f551-4171-86ed-30af676afb59",
                                "id": "account_id",
                                "name": "account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a1c547db-014e-40de-a999-c29303e102e5",
                                "id": "transaction_time",
                                "name": "transaction_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf7b7bf0-0ed0-4153-8077-b54cec77259d",
                                "id": "type",
                                "name": "type",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5955c6f4-8599-4809-9883-172c6c77e38d",
                                "id": "origin",
                                "name": "origin",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0c78b114-7837-45a9-b787-e7818ca34750",
                                "id": "position_ref",
                                "name": "position_ref",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf3d981f-ea9f-4a10-ae6f-e608cc19e91b",
                                "id": "comment",
                                "name": "comment",
                                "type": 18,
                                "size": 1000,
                                "precision": 1000,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b8853e75-4013-4cdf-a5d9-e9dd80fe4405",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "82f02245-f40b-4a6c-81e8-3c1bccb9616b",
                                "id": "balance_before",
                                "name": "balance_before",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1809bfe-9f13-4176-bfd0-abc010c10cb1",
                                "id": "balance_after",
                                "name": "balance_after",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "84122aa2-7fb5-4566-bdb3-46ed73863018",
                                "id": "ref",
                                "name": "ref",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "093f4521-6873-4a26-b399-42009687e259",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "158fdcfb-b399-4cdf-91dc-1585fe6cd810",
                                "id": "wide_currency_exchange_rate",
                                "name": "wide_currency_exchange_rate",
                                "type": 5,
                                "size": 12,
                                "precision": 10,
                                "scale": 2,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9d86728-1069-4ab1-9c5b-9db81e9920d9",
                                "id": "wide_currency_currency_id",
                                "name": "wide_currency_currency_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "00760470-3812-4837-b22c-ab76c7364bc8",
                                "id": "brand_currency_amount",
                                "name": "brand_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ab5050e-15ae-4ec2-a931-e90e97befbc1",
                                "id": "brand_currency_exchange_rate",
                                "name": "brand_currency_exchange_rate",
                                "type": 5,
                                "size": 12,
                                "precision": 10,
                                "scale": 2,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "110fdbc8-8a40-48af-b9ae-bd4c933d7324",
                                "id": "brand_currency_currency_id",
                                "name": "brand_currency_currency_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14765c20-a519-4fa1-b2da-0c30e05445b1",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 16,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b94499a-d927-4244-94f8-29877c604abe",
                                "id": "origin_id",
                                "name": "origin_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89d667bd-12b6-4f59-bdff-96974d6508fa",
                                "id": "is_realized",
                                "name": "is_realized",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02c256be-14b8-4be0-af7e-af241839a19e",
                                "id": "mm_before",
                                "name": "mm_before",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "308e2d46-f9d4-4417-b8e7-9aa5bb29ced8",
                                "id": "mm_after",
                                "name": "mm_after",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d53349a3-6606-4ebe-982c-d99aa4ae74e5",
                                "id": "equity_before",
                                "name": "equity_before",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08876328-d14b-441d-9b98-709bec56de71",
                                "id": "equity_after",
                                "name": "equity_after",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a2e977d-b2c2-4e83-8162-e2d9331f09e7",
                                "id": "am_before",
                                "name": "am_before",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a354ed25-d0d0-4605-9bdc-a9a2c9f16975",
                                "id": "am_after",
                                "name": "am_after",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 6,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9447cee6-6aea-431f-ae2e-33197c889234",
                                "id": "brand_name",
                                "name": "brand_name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "expression": {
                                        "lastUpdated": "2021-01-15T14:32:41.434Z",
                                        "oid": "214a99fe-da6e-49e3-9f77-d88c9c0c93fe",
                                        "expression": "lookup([Customers],[customer_id],[account_id],[default_account_id])"
                                    },
                                    "indexed": false,
                                    "id": "customer_id",
                                    "name": "customer_id",
                                    "type": 5,
                                    "size": 0,
                                    "precision": 16,
                                    "scale": 16,
                                    "oid": "000ad0af-6b16-46cd-8c4f-20462e23fd9e",
                                    "hidden": false
                                },
                                "type": "add-column"
                            }
                        ],
                        "hidden": false,
                        "vTag": "10abcde5-ee63-49cb-9b54-18701c8694d8",
                        "configOptions": {
                            "importQuery": "select a.*,c.name as brand_name\nfrom `transaction` a\ninner join \n(select a.origin_id, count(a.id)\nfrom `transaction` a\nwhere a.origin_type = 5 and origin_id is not null group by 1 having count(a.id) > 1) counter on counter.origin_id = a.origin_id and a.origin_type = 5\ninner join account b on a.account_id = b.id\ninner join bo.brand c on b.brand_id = c.id"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "2d0f16f2-7db5-4100-8fce-794181bbe2c1",
                        "id": "tq_rd6BPbrOm",
                        "name": "Transactions",
                        "type": "base",
                        "schemaName": "trade",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "3f9b50c6-cc28-4e2d-a0b0-4df2a707fe8b",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1dd23190-a176-434e-9ea7-c45cdf5d8ba1",
                                "id": "origin_id",
                                "name": "origin_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "677e03dc-b7f8-4980-a705-841de226ace9",
                                "id": "transaction_type",
                                "name": "transaction_type",
                                "type": 18,
                                "size": 22,
                                "precision": 22,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18ef3d24-8b2a-49fb-8b01-25b1f421358a",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 16,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5beab7d3-8f42-4523-bd7c-49314a356120",
                                "id": "comment",
                                "name": "comment",
                                "type": 18,
                                "size": 1000,
                                "precision": 1000,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3bb22e12-6d60-4214-9ee8-89f74ef1c4e1",
                                "id": "account_id",
                                "name": "account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bc2a3ed5-62f2-4f93-81b1-d86667f4a500",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a99863de-0e21-4277-bb45-06b3e460ea3c",
                                "id": "transaction_time",
                                "name": "transaction_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d50be465-f256-44b2-ba19-e45c8e7faf77",
                                "id": "transaction_time_string",
                                "name": "transaction_time_string",
                                "type": 18,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "913eb826-00fe-41d8-b590-73b4ba89d58a",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d0e28d86-0f8f-4b8b-9d74-4c63a160b437",
                                "id": "balance_before",
                                "name": "balance_before",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2914063a-d6d4-4a41-8f80-1ef7065af18c",
                                "id": "balance_after",
                                "name": "balance_after",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3971df1-ab42-475e-b9a5-e296fa7ca2ef",
                                "id": "curr_amount",
                                "name": "curr_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be9e2dfb-5280-4cd2-8240-8584bb34390e",
                                "id": "usd_amount",
                                "name": "usd_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0f2297be-1ad6-42eb-9fbc-00810c5d56cf",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9fdb6b79-1610-4411-9784-f14463713354",
                                "id": "Instrument_id_key",
                                "name": "Instrument_id_key",
                                "type": 0,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dc50e0f6-6c56-4ab1-96e4-c9767dd94b29",
                                "id": "negative_balance_cover_usd",
                                "name": "negative_balance_cover_usd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cbb49ebc-5bf1-41aa-b784-934a265a0950",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "446946c1-5539-450d-8cf4-1cd0de724fed",
                                "id": "position_status",
                                "name": "position_status",
                                "type": 0,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "913eb826-00fe-41d8-b590-73b4ba89d58a",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "9fdb6b79-1610-4411-9784-f14463713354",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "bc2a3ed5-62f2-4f93-81b1-d86667f4a500",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "446946c1-5539-450d-8cf4-1cd0de724fed",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "d3a4548d-8784-458d-99bf-a6beacd0980c",
                        "configOptions": {
                            "importQuery": "select `transaction`.id, `transaction`.origin_id, \ncase when `transaction`.origin_type = 1 then 'deposit'\nwhen `transaction`.origin_type = 2 then 'withdrawal'\nwhen `transaction`.origin_type = 3 then 'chargeback'\nwhen `transaction`.origin_type = 4 then 'commission'\nwhen `transaction`.origin_type = 5 then 'trade_action'\nwhen `transaction`.origin_type = 6 then 'bonus'\nwhen `transaction`.origin_type = 11 then 'balance_fix'\nwhen `transaction`.origin_type = 12 then 'negative_balance_cover'\nwhen `transaction`.origin_type = 7 then 'refund'\nwhen `transaction`.origin_type = 8 then 'bonus_cancel'\nwhen `transaction`.origin_type = 13 then 'bonus_expired'\nend as transaction_type,\n`transaction`.origin_type,\n`transaction`.comment,\n`transaction`.account_id,\naccount.brand_id,\n`transaction`.transaction_time,\ncast(`transaction`.transaction_time as char) as transaction_time_string,\nyear(`transaction`.transaction_time) * 10000 + month(`transaction`.transaction_time) * 100 + day(`transaction`.transaction_time) as date_key,\n`transaction`.balance_before,\n`transaction`.balance_after,\n`transaction`.amount as curr_amount,\n`transaction`.wide_currency_amount as usd_amount,\n'-100' as employee_key,\n-100 as Instrument_id_key,\ncase when `transaction`.origin_type = 12 then `transaction`.wide_currency_amount * -1 else 0 end as negative_balance_cover_usd,\ncase when `transaction`.origin_type = 11 then `transaction`.wide_currency_amount * -1 else 0 end as fixed_balance_usd,\n-100 as position_status\nfrom `transaction` \ninner join account on `transaction`.account_id = account.id\nwhere 1=1\nand coalesce(account.brand_id,0) not in (5,23,36)"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "d6ce6f76-f1fa-4840-9a3a-7504d9c89427",
                        "id": "tq_qqILzLb7t",
                        "name": "Transactions_positions Swap",
                        "type": "base",
                        "schemaName": "trade",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "421ebc8e-1f80-48a7-be42-5c8eabe9a021",
                                "id": "should_diduct_swap",
                                "name": "should_diduct_swap",
                                "type": 0,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c6387f5-5499-4434-b46a-9ae4b9274ecc",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abfe35ca-953e-4e08-ba7d-177d59c441a3",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e84dd422-fb9f-4d84-968f-5e60ca3971de",
                                "id": "instrument_id",
                                "name": "instrument_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d108759a-3496-48fc-8d8b-17b05b306375",
                                "id": "account_id",
                                "name": "account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eedcc67b-f4c6-47b6-9128-8f3ed7a394db",
                                "id": "status",
                                "name": "status",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8283a940-22da-4d5b-991f-999f1a5a5ad2",
                                "id": "sell_overnight_commision",
                                "name": "sell_overnight_commision",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb6f3c24-e98a-4ff9-b96a-e2a7799d9f18",
                                "id": "buy_overnight_commision",
                                "name": "buy_overnight_commision",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be26225c-d53c-4400-8c63-2529b04ff77c",
                                "id": "Direction_name",
                                "name": "Direction_name",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "85a5aeff-ce58-4a8b-a274-410d040b114e",
                                "id": "status_name",
                                "name": "status_name",
                                "type": 18,
                                "size": 8,
                                "precision": 8,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce40f0b3-bea9-4a0d-9f46-309343f0e6e7",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 0,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "245a6f00-25b1-4287-a516-77fe4bce0292",
                                "id": "swap_created_time",
                                "name": "swap_created_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "edda2136-1717-460a-a387-64046d46a9d4",
                                "id": "position_open_time",
                                "name": "position_open_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83db44c2-5071-4f79-93fc-ed3376fdeca9",
                                "id": "position_close_time",
                                "name": "position_close_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40f8e0ca-31cc-4f25-9152-281025d57592",
                                "id": "position_order_time",
                                "name": "position_order_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7bdcdd6-d404-42bd-8e66-1089eae20004",
                                "id": "position_client_open_time",
                                "name": "position_client_open_time",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9353e07c-2886-4a5c-aecb-911811ada58d",
                                "id": "days_diff_from_current_date",
                                "name": "days_diff_from_current_date",
                                "type": 0,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f44fb4e6-86da-4779-b8fb-0250e84a3b8f",
                                "id": "type",
                                "name": "type",
                                "type": 16,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56e80ae8-8064-49f2-b7df-db1f2a07c60f",
                                "id": "created_date_key",
                                "name": "created_date_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "57465ed7-978d-491e-b314-78e50d5e3fac",
                                "id": "swap_amount",
                                "name": "swap_amount",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "28e65961-089e-4c1a-986c-d8f4faec814a",
                                "id": "swap_amount_usd",
                                "name": "swap_amount_usd",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "ce40f0b3-bea9-4a0d-9f46-309343f0e6e7",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "56e80ae8-8064-49f2-b7df-db1f2a07c60f",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "abfe35ca-953e-4e08-ba7d-177d59c441a3",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "ee9c9a8f-5a58-42d8-add2-a8b4a2ca1768",
                        "configOptions": {
                            "importQuery": "select \r\ncase \r\n\twhen `position`.open_time <= position_transaction.created_at \r\n\tand (`position`.close_time is null or `position`.close_time > position_transaction.created_at) \r\n\tand `position`.buy_overnight_commision != 0 \r\n\tand `position`.sell_overnight_commision != 0\r\nthen 1 else 0 end as should_diduct_swap,\r\n`position`.id, \r\naccount.brand_id,\r\n`position`.instrument_id,\r\n`position`.account_id,\r\n`position`.status,\r\n`position`.sell_overnight_commision*-1 as sell_overnight_commision,\r\n`position`.buy_overnight_commision*-1 as buy_overnight_commision,\r\ncase when `position`.direction = 0 then 'Buy' when `position`.direction = 1 then 'Sell' end as Direction_name,\r\n\tcase\r\n\t\twhen `position`.status = 0 then 'Rejected'\r\n\t\twhen `position`.status = 1 then 'Open'\r\n\t\twhen `position`.status = 2 then 'Closed'\r\n\tend as status_name,\r\n-100 as employee_key, \r\nposition_transaction.created_at as swap_created_time,\r\n`position`.open_time as position_open_time,\r\n`position`.close_time as position_close_time,\r\n`position`.order_time as position_order_time,\r\n`position`.client_open_time as position_client_open_time,\r\ncase when `position`.close_time is null then datediff(CURRENT_DATE(),`position`.open_time) else datediff(`position`.close_time,`position`.open_time) end as days_diff_from_current_date,\r\n`position`.`type`,\r\nyear(case when position_transaction.created_at >= 20200716 then position_transaction.created_at - interval 1 day else position_transaction.created_at end)*10000 + month(case when position_transaction.created_at >= 20200716 then position_transaction.created_at - interval 1 day else position_transaction.created_at end) * 100+ day(case when position_transaction.created_at >= 20200716 then position_transaction.created_at - interval 1 day else position_transaction.created_at end) as created_date_key,\r\nposition_transaction.amount * (-1) as swap_amount,\r\nposition_transaction.wide_amount * (-1) as swap_amount_usd\r\nfrom \r\nposition_transaction\r\nleft join  `position`  on `position`.id = position_transaction.position_id and position_transaction.created_at >= `position`.open_time\r\ninner join account  on `position`.account_id = account.id \r\nwhere 1=1\r\nand position_transaction.created_at >= 20210101 \r\nand coalesce(account.brand_id,0) not in (5,23,36)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "615da5f6b48a9e002c4e01d1",
                "provider": "MySql",
                "parameters": "5mNCu1+ofkq0jXTrETmA2GCLZRQMR5lTs7Khy7XrLfySMPqPYDtrRlch/vLJc4vdrd/JrcAFXOWO83LKYJqdKiPldqy1FnyanGQNws7STazYO7sqyOenRvB3k8Yh2tTWh+ObQUSeC5Z1K+ABXCWQcm/9SYOW3BnV/y1ER7RLvI4cOnn48ASXLQJUrm44qp5lK6G7fV8oT7yA8OPNYSQh7A2qoIFcSLJEviCg2Kwk6XE0QEOgflKUu/piXLY16nP6",
                "schema": "trade",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "8ac3f0b9-e682-4a58-a8a3-0aac0dc70d3e",
            "fullname": "MySql:f11ad7cd-1970-4793-8bfb-cefe583f19cf",
            "type": "extract",
            "name": "f11ad7cd-1970-4793-8bfb-cefe583f19cf",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5348a56da002c36c6dd",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8OSfPYhJH5R3HPnPvPUq9ufFEejHbQ5noMM+s2I3j9hfV4ghZOttugRuXVbNWlMq51sPWEQ79B4SIfJgGwbgIEwugkCtRlhGLq4p5Jfb15dVDFMoI69c+dcUuN1SDyQ57I=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "8c5a79a5-8c82-4053-8534-a87902521704",
            "fullname": "MySql:24f17ffc-ff82-435a-b515-807cbe0b9d79",
            "type": "extract",
            "name": "24f17ffc-ff82-435a-b515-807cbe0b9d79",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b40e27c6-f3f0-4b4b-bb4f-07e11824eb64",
                        "id": "tq_B5AXoWIBl",
                        "name": "TradeTheBit_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9c4bb776-25aa-4f52-b4eb-b69dba77622c",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f2bff940-fc16-45fb-bfca-229c3d4a2cc6",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c66db25-8c02-4897-b501-58963b8262b0",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ac80f7f-a261-4419-83fe-759eb475888e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "815bd741-a2c0-4460-9a46-cb024b1f7d35",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd4c573e-2358-4d3e-8e10-ffea1016942a",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f119345-220e-4d71-99f0-14d17edc1d85",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffbc2381-268a-4835-bc7f-eeeaedcadd6b",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a427e2a-0eb2-4b49-ae0d-cd812e954b07",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0187b264-12f0-494f-90f6-c2f2d29dd5a5",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b3e0480e-9992-4423-ba37-9fda315e12bf",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07406219-f441-4983-ac22-e7e216fed6d8",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea28a467-365c-4e2d-85be-f16707bc7891",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dfd27f0-1919-47eb-bbfc-f66ebeaf432b",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "970f6078-f011-4e28-bf17-c5927ab8f7bd",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76c1a936-9579-434a-a6e8-e904153d2a67",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58b1b01c-65a7-451d-883c-ea9928e63748",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0cb8a99-cb85-4f63-aa04-ae3d0eb29993",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e96f699e-8565-4dd8-9c50-38e961129e59",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26a5bd24-a7a3-41dc-97df-e17b45e517fb",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea232526-6297-43a3-847a-0a9aab1eecd2",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53fdbe26-7f88-4443-9f81-e763040d1458",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21f1881d-aecd-4e75-b60f-e55042dd98e2",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6c10238-dcda-45e2-b2a7-bb015efc4a52",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "161ae269-ba0f-44e8-baf8-500dcd23dced",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d3ed10b-c0ba-444e-991c-be94bf42ed2e",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "996d1e66-0b83-4e6e-b034-51e19e09a3cc",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9544ed44-07e4-4bbd-8f7d-41e7088a189b",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d27b7cc9-814b-4a0d-97a5-baedc6590b06",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9bff0ec-dd8b-4b82-9a3b-28003fbe1022",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "325e733d-fc32-4d58-9fc4-fe205982cb66",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8f252c3-2405-495f-8f8b-43eea14df5cb",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "856505ad-0b11-4eef-af65-13e65eb0f1da",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78139bf1-e253-42b4-a7fa-8dd7652b456b",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16ac0ba9-335d-45ce-87dc-31316b729261",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abc2d995-e47c-4762-81d2-8e76100fec01",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e724eb01-6fff-41df-8ed4-0a74af6396b5",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e3f479b-a292-4ed0-a3a7-d65b78198814",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96410031-9fa3-4e4b-a4c9-b59380c25c84",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e878b371-9d3d-4620-8378-1106fea030d6",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d02ec5ab-ba33-4f43-9626-6a7230220d5e",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82fb545f-c3c8-4290-b7a9-23663673eab3",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf75ed4b-c3e6-42f5-8bc5-6d801533b86a",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd32da52-1cb3-41a8-95e2-ed2a0239b54f",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9653a04c-ea2a-4b24-8b9a-40c4011677f5",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "250e58c4-c6a7-4cc4-8cc2-6d34a4cb3aa5",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0e4493b-8259-4c47-b2ac-1dc159dc46db",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30a23bcc-cdcd-4484-8b13-18b9998da055",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f63a98ab-1e11-4b4e-914a-70c94e43ecfd",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9934616e-4e02-48bc-8a04-f12de76af4a5",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d219c6f1-2534-4bc7-bedb-1bab82e7af34",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dab7719e-595c-48ad-9b8f-b6ad33549a71",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b36eac8-9ad5-44b5-a0d6-f8b5c6405a89",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c2f7c784-daaa-469e-8791-2113ee46906d",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6bff8deb-f64c-4bcb-90c3-8ac8dc7ad7e4",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40d2628e-d1bd-4da0-95f1-475ab4c135ee",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15053ca0-255c-45a8-b47c-1415cf9f2974",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b00583d-215c-49fc-8167-83c49dd762fe",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03ef2d14-93f1-456d-a629-649745788fce",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da9bc092-0a34-4f8b-8da7-0496f82a2e19",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f907ef9-d5b2-4a56-8ca7-3f35839a0673",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dc4a9a4-8a5a-407d-a410-9fab5f20f71f",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2faa708-de72-48bc-8ab0-4d434f230992",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc2a63f4-cfde-4628-8b3b-e017b463f0ca",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3edbdd0-7aa7-476d-862a-cf797d69e48f",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 66,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55216065-543a-4c19-87dd-a6792cfb19fa",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c7c6d4db-53eb-4595-a3b3-9c2eb89769bc",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 66,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d00e13f-0be6-41c7-8ee9-be2c3960ad6c",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa3b0132-3726-4771-852b-beda44a9a960",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "0187b264-12f0-494f-90f6-c2f2d29dd5a5",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "e4f1538c-bf09-45bd-93cb-b6638f570055",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,70,78)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,70,78)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,70,78) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,70,78) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6166d8f2cea1e8002ce1f80b",
                "provider": "MySql",
                "parameters": "F954Cqx2+xpp7cv613X4To3KDLtYkIILY9DKa7o2J6iwT7Hhp/LuVGR7WVoXuAJR6pANxIXoQ9aWeJiI7OcJP72ZHBxG9xyN42erULpN5ZuqvWQ4Ab7IRfQ6FHGxrmIec/RVbJ5P1EBneN6L0WOHnZFugjR8UPuM7oh3rwSSnzvjLJFOJ0c2gxjMsXRaCgVGAB0Pjz5j/uHDcFPg85fyrANVftdnJomPKg7Rk6G5kbKEybu1E9znVlAXap1CpXX6",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "8d6be6ba-5229-4c50-ba64-e5f807e3d3fb",
            "fullname": "MySql:46372943-7236-4863-9768-d5b3d6a73df3",
            "type": "extract",
            "name": "46372943-7236-4863-9768-d5b3d6a73df3",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "10a727c0-0ce7-4c81-b291-4d365719f0b3",
                        "id": "tq_N2gADTPCk",
                        "name": "Markets_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f4c3afe7-df61-4bf7-8b8b-244f9f09e159",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3133b443-7755-43bb-93e4-6754b7f07cef",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0c343a0-f5d2-408a-b2a2-d84669d99521",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b68d8c9d-6674-47cc-9a98-9a4426ddeb8d",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "107fc288-545a-4f16-9e64-12baf0674df2",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "7e96f3d3-1a73-451e-ba53-fdf3f54c482b",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617133b255f384002cf10204",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NAc1gMa0VBzZ9QDyN4mgrYY4RdbmC5kaicIuBKtyLx50isgKI42gk0NUhwNAOs/C+1ClXW3UC6yk8zdu2MLwnevpcBXSYS5lL8i4M0k06sUJIQFcjc1VnpGNQCbGzv+s0=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9021b39d-bd03-4d4a-b494-0ab9c69c8850",
            "fullname": "MySql:9a4e8138-68d6-4c9e-959f-1594d2fb683e",
            "type": "extract",
            "name": "9a4e8138-68d6-4c9e-959f-1594d2fb683e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "fef11220-7cd2-450f-ab26-09dd0153e4ca",
                        "id": "tq_KbZs5kTOv",
                        "name": "Arrowteks_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "3280bf8a-1676-4c4d-b529-209c062a0512",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f8f832a-fa48-450f-880b-ac3e40bcec06",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ccf5bd43-4706-45cf-a5a7-46e4771a5773",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "61fdec85-7505-4222-bcbb-655fe3d6e236",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "317fb023-ba57-4585-9f40-788f5e7abf12",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7265163b-fd46-4be0-bc4b-9c0334324e16",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c48731e7-978f-444a-ba3b-7d8552d59816",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71af138a-e69a-4748-91ee-c5c04cabb7f0",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8c710b8e-49ae-414f-b838-56c00bd4c795",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "021210ec-28c1-4412-a870-35a961168afd",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7bf1ba79-dc35-4f61-98d2-fd6009b5ca6d",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "03c16d3e-3a88-4663-b372-184c5dad949d",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "911fd4a6-8e88-4bab-a142-87d0790a2ec5",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "040be815-c5e3-4cb0-afe2-10d5ea6acb58",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22716934-39c0-45a6-bb55-f4899ccd5f95",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "236cb86c-d19a-4b8f-a8c2-e93ecc230253",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4dbbb9fc-c634-4ef1-8b19-654fa96b122c",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "226d4a3c-ba4d-47f5-abe5-a5ef95ee7f75",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f879c26c-76e5-4a80-b2b4-7f0843f4d535",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3514af2d-af0b-48f2-9490-40e6d9ba3d25",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "315d2a24-e5ee-4dbe-be73-ec189a30ae31",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "edf1ab1a-37a5-4261-8c57-95b9d172c884",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1fd3eaa-1958-4a49-ab9b-26fbdc88cb08",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "85afa6df-1737-495a-98c3-947cd0835ab0",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "add8bc57-cde3-4156-ab1b-0a848d99d078",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ebc6f709-644b-4895-8d1e-18c3507f02c4",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00467b10-a224-41e6-b0a3-4efd47db4f4d",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7a1fc45-0165-4abd-bd4e-a0592a635f52",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1dcfb6af-3c39-4711-aa93-caedcf8661ab",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "254917b8-2c66-463d-aa57-f164f3300f81",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2785581f-d903-48bd-bc2a-2b34865a2ce2",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "493bfe1b-b573-4405-bc6b-f55fb7d83723",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a97ddfa-8d09-4180-a1d1-35bc0157f5cc",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5ac33d6-2493-4764-9581-a2d94cf16a42",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0792f627-07d5-4e6b-8172-860939848ad8",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7ed09440-f29a-4891-91a7-44e3043fa42a",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1d8cfb8-0017-44f1-aa28-252abc9970a9",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bee89130-9a93-42e6-b7aa-20a2e9ce4bd5",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5a42b3a8-1a38-488a-be17-9317a9a9632a",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ae81bc74-2c65-4ea2-8ddd-0ef27448967e",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "998d1b9b-aae2-4c28-83c5-3c7d3c987135",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3ed14018-fbc3-459a-9fab-d4894ebf925b",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "48611226-9498-4cf3-90c2-4477eccf1108",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b7203cf-9bde-4bff-85df-4e4497278091",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5a4a86ce-3d03-4b0f-9b2d-0b4ee533c655",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5d1f5efa-bb2f-44ae-9666-eaa90157e60f",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "00192a77-0adf-4503-b2a7-ac314ba49b12",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a9a2fe9-0d81-4f04-b501-c6795a302ba3",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d503b146-29ee-4c56-9008-3d01af7ffa98",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4958fc9c-1088-4b8d-9ab6-bbd7c3a45dac",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80d38a87-df0d-4cca-ac39-95977fd979ff",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bb8d4ca8-4eff-4e7e-a9dc-596708add264",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e4954025-71b2-47da-b5da-dbeead27c332",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f26c667-8938-4558-9566-fdedb2761ddd",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76505cb7-08ff-437d-add3-825e97402681",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d95c94f1-ac72-4698-8214-9ddab3a98dda",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bf35de0-284d-4248-af5d-f380267728b6",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1045907-cf19-43d1-abb5-42f040526f1e",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cf0c08d2-93c1-4188-a713-a38d249fe24b",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1b8326cf-343e-4feb-8a9d-c3c2b7e262d8",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1ed5a5c-fdd0-4c67-a071-2cd45a069d36",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8961e384-c51f-473d-b4d7-c805f21e7a56",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "ccf5bd43-4706-45cf-a5a7-46e4771a5773",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "9a97ddfa-8d09-4180-a1d1-35bc0157f5cc",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "2f1cdefb-852c-46ae-a80f-99c7ddfcb47b",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\tbrand.id + 1000 as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( brand.id + 1000, 10010, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( brand.id + 1000, 10010, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_redeposit_1k,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\ninner join brand on trader.brand_id = brand.id\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32,65,73,107,115)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\nselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,65,73,107,115)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195061a6780f2002c37ecbd",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "91a337b8-0f55-422a-b0e3-a7b8842697ae",
            "fullname": "MySql:8df491c3-48be-4bcd-8364-c1030ee2b7eb",
            "type": "extract",
            "name": "8df491c3-48be-4bcd-8364-c1030ee2b7eb",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "64136626-783d-4e9c-b790-ac0b2a7361a8",
                        "id": "tq_xlkrvOEXq",
                        "name": "365TradingFX_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "bd41d05a-59c5-4f62-a7d6-a3d06dc8eb3d",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb449ae9-d938-486a-b16b-6040d9633d0f",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7da32b1-ddd0-4ecf-920c-52e7203e5dad",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e85ea45-f4db-41bf-880b-5eb407163bdf",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18a265cf-6672-4f0d-9616-147882e711ae",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c03c11c0-3e9d-4c2a-add6-9e82a1e4a17b",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171350c55f384002cf10212",
                "provider": "MySql",
                "parameters": "WpjwuHhqzfDIdAFVxxbzsI0YjwvC+DbfC5SOQEIG9Hv/ov90B4e996K5jgUO+RnMIymf8vUv4ZkKAz3a9ZjFWfFx0Vo47BjpHtnTXLtkifQRqyaZfd4D6O1eqmErosIKNYe9BaLz/Dcd/UP9mDlqVceymGdLGHoVvU8f/jie8mwEQUF6aAirIkBFxSa+GAc1y/33qpuBkVC0lkCPxLhwxjFEew4CVf7nWq1YJkAA++dxReSWYPaOBwUZ1W5/aDZr",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9232ddd2-79ed-4e5e-960f-a8932d161d6e",
            "fullname": "MySql:9bc04eb9-3c0e-4cfe-a217-8b4799e63363",
            "type": "extract",
            "name": "9bc04eb9-3c0e-4cfe-a217-8b4799e63363",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "21b45225-4e90-424a-ba4b-3b68ca325a2a",
                        "id": "tq_yAtUo1wWr",
                        "name": "Bitfinity_acc_types",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0a8b47a1-58a9-44d7-9fea-6002680e84f4",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62319acc-81e3-41d7-8a5d-bd190ca69f67",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "232fddd0-1898-462e-be16-409d86472284",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95e2b463-7867-49bd-afa2-b3ba9dc324ed",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c8ae3c9-32bd-42c8-a7c3-7aad083e5567",
                                "id": "active",
                                "name": "active",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e0945be0-da3b-44f5-a0ad-d8fbac5cce49",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619647233f1f2f002cf16c38",
                "provider": "MySql",
                "parameters": "19x2eB8ph2aYc/juzRJhdXmHOGk/Q0LOo1mcPAZAkzQ0rOYfaoDxpFcxuWNBv7R5KV0O5tYU8i2V/PjWAUeDSLhONZ0UCFxUB12m91h1eHOHdzR+SB2d9VJoCcpD2m9S5HXy2q9B6RLuhWzexgEBZWWpbuLtRZNIioiIe+Aak0+UQZCbTaPF44h+UqblYtn0GbA9u96R0kzZhm8bt0OQY3NtWmYnwdwQiprKhRjTZlxlHYq4bo/AURRzeuo5J+ph",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "92ed9e15-7f96-402c-a94f-34c4dbfc748f",
            "fullname": "MySql:d9014830-6b25-4be3-9f2d-5a8b1bb02386",
            "type": "extract",
            "name": "d9014830-6b25-4be3-9f2d-5a8b1bb02386",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "eb6b582b-fac6-4b39-9730-74257353162d",
                        "id": "tq_K1JKdpkMb",
                        "name": "Sites",
                        "type": "base",
                        "schemaName": "bo",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "526d1e68-7141-4198-b5a5-41d51651e338",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abb0bde5-f70f-4ece-8bff-e49a41a1b99b",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "526d1e68-7141-4198-b5a5-41d51651e338",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "0cb49e70-dfa7-4c83-89dd-662de6887ae4",
                        "configOptions": {
                            "importQuery": "select \r\nbrand.id as site_id, \r\nbrand.name as site_name\r\nfrom brand\r\nwhere 1=1\r\nand brand.id not in (2,5,23,36,11,33,32,21,34,17,19,8,9)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617144e055f384002cf10216",
                "provider": "MySql",
                "parameters": "5mNCu1+ofkq0jXTrETmA2GCLZRQMR5lTs7Khy7XrLfySMPqPYDtrRlch/vLJc4vdrd/JrcAFXOWO83LKYJqdKiPldqy1FnyanGQNws7STazYO7sqyOenRvB3k8Yh2tTWh+ObQUSeC5Z1K+ABXCWQclwyUFSNZvVRfmPvhd5kdczSzfxn5xlphSBbhn43GfR7Ba+5cdGRsNbuHvErIKdI0Hwt2pvzS/KPEkwJe8SiwSO9CRwlkxe/2sKQQGQmIgTb",
                "schema": "bo",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "943683e1-5304-439f-841d-1ecc9accc0c0",
            "fullname": "MySql:024f0419-ef29-4514-9f16-5a4770fdff4d",
            "type": "extract",
            "name": "024f0419-ef29-4514-9f16-5a4770fdff4d",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "78021761-bd37-4daf-be05-ca27a0d4297f",
                        "id": "tq_9GQYkm9bE",
                        "name": "GeniusIG_Acc_Types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f75b1a8c-de86-43ef-91b2-517aa9734f47",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5679842a-ede1-49d5-a078-a7d5463547f9",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2705ed1c-3aba-48fb-b523-3b7d5f94c036",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e76fe07c-9657-4dbc-92e8-69ac2083d8aa",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1efd3cf-e04f-4ab9-a308-03b06eb63c46",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "262cb749-a5b6-486d-beb5-3f10d173fa80",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 \r\n"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171347655f384002cf1020b",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCkM37LkFbGnRhmt2tYLFqO1gr0leFAbxvqr45h97aRL2uFXV6bnmXjrx+upQdOgFiG2n1XzowSr7ML18mjmQhnzqjq1V2FUQMfFFcLg11wwiXozn0iLcNZcjGmBoyCW6IdyK2k1UjDiKqlSqoJZSuzAb/GTm3+JvHrvJTMCSB28",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "978ee195-17d0-44d9-8b01-d6458802de63",
            "fullname": "MySql:495aaeb4-b04b-44bc-8571-7a055179de19",
            "type": "extract",
            "name": "495aaeb4-b04b-44bc-8571-7a055179de19",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5358a56da002c36c6ed",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFMMaoUpheaIg1X20cwDm22EnLAAqvqavFiaH0phSqpzlex53e6kdd5tYPRE2QovPreS5AwJdfzfupHCfQ7lkIdkgGgRCQg8p+EiFSUUd+ptD",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "97f7e775-6d3b-4c1f-b49c-dcfd9537848d",
            "fullname": "MySql:cd8c29dd-7417-4c37-bb78-8827d957105b",
            "type": "extract",
            "name": "cd8c29dd-7417-4c37-bb78-8827d957105b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0a17dee0-6d17-4b65-9367-94d9e7853515",
                        "id": "tq_pxpqhHJMd",
                        "name": "Arrowteks_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a324409c-97c1-402f-aa0d-dd7a34926095",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e76a70c6-52b7-4dad-ac83-290c49d4e547",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cfd629f1-64df-4c5f-add5-e443387a63cf",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "011e4da0-28dd-4797-8b81-2ec82ad0095c",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2bedbb1-fd37-483b-8742-01b14ad3aa8e",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27eacfcb-64a8-449e-b916-822ac426b0b2",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bd8059e-ec63-4a52-942e-79792e0ca35c",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9da8e37b-e860-4e15-9981-36f6d99b0d9e",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00f21ac1-9161-407d-9f00-ef25548ef201",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ac91fb0-84db-43ed-9347-f1bcc664cfcb",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3dc0dbb6-a8c9-4aca-af9d-58f355ec6250",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506ee6780f2002c37ecd9",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9a0699f3-9b5d-4e68-a22e-4e268e2cb071",
            "fullname": "MySql:90a33b51-0597-4f1e-9b7d-7caa303e0b27",
            "type": "extract",
            "name": "90a33b51-0597-4f1e-9b7d-7caa303e0b27",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7b663904-7662-4e4c-a536-50159f9315fc",
                        "id": "tq_l0kIZ9wY1",
                        "name": "BendigoCoins_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "702dc3c3-e537-49da-a875-cacbdf214a94",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "831ca265-5f51-48cd-a3dc-be6e809c24a6",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4dbb0f4-1caa-4582-b455-e7126d6b0793",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39e63bfb-e003-4725-90df-5a507e142ea9",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "285edc92-61f6-48c1-8913-740b322cbbe7",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc6aacf1-6067-44ce-bc6c-d1ae319723fd",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79839b27-8b32-4b59-ada8-e22534f7de2c",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58375279-0d24-4b00-9791-7c56817eb1f7",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74a0112b-04f8-4e95-a017-afc0e9572346",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f87f13c-d8a8-4b30-bb6f-a78284e12ff1",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "058620d7-1aea-44f6-b154-43330b36cab7",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5dbb58eb-0ce1-45f6-a96b-d0e59bc7dead",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bbf2e7e-7bed-4a05-ac0f-e779b8626063",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87a98dd7-1250-41ce-b836-b01d8cecee21",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7fc0b47-7768-4db0-96a2-7948e13f575c",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74e92471-1b60-4ee3-b1e2-1d3ddb0b9f6e",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7609b7d-8af2-43cb-92f5-365e516aaf80",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "797425b6-8c1f-420a-ac93-084a96cbb67b",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a40ac31-7a56-4217-8a58-79b621007917",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3de925dd-7166-418b-beaf-654fecb91b9c",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "222f4d5b-e088-45f0-8ed2-822bb5697914",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "43d43e55-cef8-4343-9028-d677cadfd9a5",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aec5db6b-ed6c-4e33-a4d5-faf433927851",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02246d3f-b87b-46f0-86be-3b535afe0f90",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebf4ed0a-14ca-47ca-9ade-69bf787426a9",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02e95284-c4a4-4717-a306-7c45159e4ea4",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3335619-51bf-42c0-945a-8af4b0ab9361",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd5e4c1f-ee09-4470-8402-bedaf540d44a",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "145ac3bf-f00a-491f-8868-039bfb060990",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "23603357-3f7b-4596-a0a2-b84eaa514bf4",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d89abcd-d27e-43aa-9e36-0d24ec0a4944",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ba4deb0-ec57-4d5c-ae7a-0103759321f6",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a284527a-2451-4906-906b-5b1ffca9890d",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17d3e102-347e-4ff1-9321-f5a55a0568a1",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a65c904-31ee-4905-aa69-5fd57c97209c",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d07436c-6f2f-4ad7-9035-ec2f35dab2f5",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "afed08d0-7495-4b6f-83ea-d172135efb3b",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a4278ad-74ae-4488-8991-bf124882d44b",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a6751b4-0970-41a6-8456-8ee2c7d61907",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07ad40d5-c21d-4379-9a5c-ff38186e9789",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b061a73a-8eba-4ccd-b439-b285422d789e",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1c30160-d7dd-4a37-8716-4a2efe6ecdca",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4923e77-0096-4625-8ba9-e93ee16a5d03",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "31c320a0-b20f-4652-99c0-9aec7a5aee8a",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b67dff8-f3c4-47f6-b89c-1069f642b898",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b25a1ac4-6006-4102-b58f-10da41c929c4",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f03f8b3-cd87-4c38-9423-eb6e64e6ae29",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58a40964-a273-4a7a-9217-81a1ca0fe8bb",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5cefc3c-056b-4591-af90-d821dfd9c1f3",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62e62004-18b9-4771-b42c-741e1946d02b",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34613a22-35b3-4423-b9a2-58a189f67127",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2917c696-84b9-4201-a9b8-080a6c486cce",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ade0a9e2-2d6a-46b9-aa5c-0a8b474ffb63",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e00c50d-3b4a-4131-b39f-402a7756dd21",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cfcde898-89dd-4d64-8d51-85701554625a",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c1b836a-7c32-4d98-9176-4804f310e20c",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58565591-8be7-47aa-b000-8a1b780ff2fd",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5615bac7-cba6-4f7c-93c5-865f1ff15a23",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "449bdb77-f224-423b-9d69-2cb81f697cb9",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6b4fbbc-7392-44e5-a8b8-d23b598007e1",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec777094-c2b4-42b6-99f2-988f1d0e4d0d",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae4648a4-8e41-4567-80b0-a4b9fea6a822",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "a284527a-2451-4906-906b-5b1ffca9890d",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "ccbec2a7-c107-4f25-86ac-1fa15f74a03d",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id <> 24\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) <> 24\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619504a86780f2002c37ecb5",
                "provider": "MySql",
                "parameters": "FhwKndxsEm4karcTRhcRhQ31JuodaLCOkLCPAL5UDyKQmplY4PGQirEicte+5XlO7CmeguqIciMcA3dWSPlLRdyZQQBa8rSl7481iBoEVleEKNnY0oZY59Uua0u3yiz/U5itDzyqwT3hV27JP+osZrKYLMelBUn+F7vnCn46CtacVjNzMfL/BmkfA2U0DhrLnI0aG8HaWhblMUs9PMPHSLPgZ1yWRCKlfMFEAtsVU51Jg4PyWiAT5+nvRZJBKlUf",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9cf2fc0a-c33a-4cfb-a4f6-00252a0f38aa",
            "fullname": "MySql:6495dd5f-405e-4e45-986e-c1202fd60875",
            "type": "extract",
            "name": "6495dd5f-405e-4e45-986e-c1202fd60875",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "290e52b3-3d90-4197-b3c0-aa6b72337acb",
                        "id": "tq_ueAAAAOfp",
                        "name": "MarketCG - OpenPositions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "92be824c-070a-4259-8e7a-89b38580c497",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "72795747-a026-4079-bda3-2688ae349f06",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f535e500-5352-4765-8956-bd6ed76fb132",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d6330390-7b59-4464-b861-4792b50e2dd3",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea058c45-f5f3-46cd-ae97-50c14e3642a7",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "25a495a4-d39c-42ae-8051-1c0d7c030eb9",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b537cdbd-e910-4d1e-9abd-c75a098807f9",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d5c0a391-73b7-4ce8-b064-edfa0d3f4358",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "38c60abc-a474-4c9e-80d0-9d8b25b319fc",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "88484aec-26a9-4f37-b5fa-f8641a61083f",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "90159887-cb5f-4b0a-8dbb-d31790c9a120",
                        "id": "tq_Vd570mlDI",
                        "name": "RealABMarketCG",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b7bda13e-0f42-4dd7-bbff-202b7ea5e567",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3370bf6-5747-423a-b6f0-9adfafd0a838",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "980712c2-af34-43d5-94e8-33b35579558f",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e887e3f5-353d-4baf-adf3-74caa913271f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d91f7133-1b32-4eff-8b25-0f57a7fd39ca",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8523936c-ef54-420a-ab7f-c4a4132f5519",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "863cb372-4f9d-4385-a077-d27d16e436c1",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b2f716c-da17-4e40-8c3b-6f2f6de6bdba",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dabe132c-92a5-48f2-acdf-98f01b50f8c6",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1d789c3c-ae77-4041-a79a-19b037e6abdd",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a76a8a78-3cb7-4836-89bd-dcdeb93ef833",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9f89487-953f-4a36-b5eb-53bf62322d4a",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33fce718-1f9f-483f-be87-666eb2d62ace",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "23f9027d-76d7-4c16-b6b1-0915df153d86",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b876e70-9e8f-4d88-b9ad-f22540176464",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cdd2e352-fb05-4564-9760-02ddf821f1e8",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ade1fa85-39fd-4e58-86b5-7d2d5971bfb1",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3ab5cb4-c45a-45a2-9048-46af43535571",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a189e1f0-bb43-4444-8c07-6c8d20daa857",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1ebc7dd-ee43-44e3-b2db-8f0523a35290",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4631028c-4a2e-4b49-a046-6e717aa1bf17",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "409b0ec5-4499-47b4-ab4c-9029ecb78a9a",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71dae20a-5144-47e4-bc2b-27c754d02f6d",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1242408-67eb-4a0f-b507-4a13f9049be3",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e4fa1204-dc81-49f4-b98d-428f5f125ed7",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b855b89-b5b5-4bb6-9d6a-336491f4307e",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "532c3477-473b-4cbb-aabd-c5ec5c0babdb",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "08eeaed2-a9ee-4ba3-b48d-945580c64c53",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b29c9483-de03-47bc-bad0-be46d81af8ac",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "69b14f22-f9fc-4d4a-8c50-7fd0a4712878",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b187a4cd-0ecb-47ca-9e83-a7537701ab2d",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "03608949-622c-4e12-b99e-15bc54e91960",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1c6ebebf-62f6-4edb-a3f3-0a9cdb5f6f0b",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83b87fc6-b776-4b5f-b009-fe713ba10ac0",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "801e6141-efa0-4c5f-8d3f-f4965d658299",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9b106f8-ee89-473f-9c47-d5cb99e5ac8a",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e1dab66-941e-4637-aaa3-c72fe126f881",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c9e8f276-1bb3-48ef-8035-881f9654760d",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5ea92d80-989b-47be-a5be-496c221b02c6",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "471235e0-21f6-47b2-90b6-c9a2c0cd98c9",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c13934d-16d2-4341-ad8a-2b510325dd32",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "24eaf8a6-6b19-48b8-8ff8-a69164c82ed3",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9405a4b-e357-436c-98f7-d26392130e90",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a2bed7f-3dae-4b03-90d1-c06968136416",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ef278d6e-0385-4f18-93c7-c653d6dff5ae",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb12b421-31bd-4d6b-b8eb-69c4767d5913",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ed8951c4-efef-470c-bca5-17df7b0a2298",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2adeffa3-96e1-4123-84df-810f5fc0c02a",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88c3ab3f-98b9-49ef-9307-79c2497f83c7",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "40baa26a-9942-49de-8ea5-9df9701b9aae",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4368c19c-bda9-48ed-8da2-4b3329748bd1",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7b1fb721-589c-4f3c-a9ac-83117ba9020f",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0fcb425a-f3e4-4cb4-9cc6-b3c41fded4d1",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c502bf04-77dc-4e33-96ff-c0492ac3f07d",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "467e2665-9387-4d38-a105-ea5dc3f1613f",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "421a8a80-cc24-477f-acee-c4b9c094a26c",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e62c9e80-9b1e-4cde-aac4-e53b699aa9bf",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b20b7ca9-d8c6-43b7-9313-10a6c001c0cb",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c272b74b-8959-4d22-a8c4-189c3af8edb2",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "513943d7-9348-42e1-a033-067bba6167a4",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e8a6b9ee-293b-4fef-808b-2314b22c3162",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "27a60e93-3042-47d0-9530-25d0ddbafa4c",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2bf65ff5-00c3-40e7-ac79-de213ec50360",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "180dee31-a7ee-4340-b3e4-95d748075762",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1e2d8e9-d4ec-4edd-a416-dfaa8cb8c406",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "307af98a-b2d7-4164-996d-8d7012405894",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "de297250-942f-4a59-b975-598d5fea0b10",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1d15314-77ea-41f0-8dd3-e0394ae6ec2a",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b7ca710-6005-4e1d-adf5-f9f332bef70b",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "1d789c3c-ae77-4041-a79a-19b037e6abdd",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "7a76e1f8-bb3c-43bf-894a-93ffa5c6d33c",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\n       aggCustomer.default_account_id,\n       aggCustomer.name as site_name,\n       (1000 + site_id) as site_id,\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\naggCustomer.customer_fullname,\nco.name,\naggCustomer.currency,\naggCustomer.created_at,\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\naggCustomer.date,\naggCustomer.YearMonth,\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\nend as rate,\nMaxDep.LastDepDate,\nMaxInv.LastTimeInvestment,\naggCustomer.tr_id,\naggCustomer.origin_type,\nMinDep.FTDDate,\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\naggCustomer.user_id,\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\naggCustomer.deposit_curr,\naggCustomer.deposit_usd,\naggCustomer.cashback_curr,\naggCustomer.cashback_usd,\naggCustomer.withdrawal_curr,\naggCustomer.withdrawal_usd,\naggCustomer.withdrawal_curr_new,\naggCustomer.withdrawal_usd_new,\naggCustomer.cashback_withdrawal_curr,\naggCustomer.cashback_withdrawal_usd,\naggCustomer.withdrawal_fee_curr,\naggCustomer.withdrawal_fee_usd,\naggCustomer.chb_curr,\naggCustomer.chb_usd,\naggCustomer.inactivity_fee_curr,\naggCustomer.inactivity_fee_usd,\naggCustomer.overnight_fee_curr,\naggCustomer.overnight_fee_usd,\naggCustomer.fees_curr,\naggCustomer.fees_usd,\naggCustomer.pnl_curr,\naggCustomer.pnl_usd,\naggCustomer.swap_curr,\naggCustomer.swap_usd,\naggCustomer.contract_usd,\naggCustomer.rbonus_curr,\naggCustomer.rbonus_usd,\naggCustomer.cancelled_bonus_curr,\naggCustomer.cancelled_bonus_usd,\naggCustomer.pending_bonus_curr,\naggCustomer.pending_bonus_usd,\naggCustomer.fixed_balance,\naggCustomer.fixed_balance_usd,\naggCustomer.negative_balance_fix_curr,\naggCustomer.negative_balance_fix_usd,\naggCustomer.NetdepCurr as NetDepCurr,\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\naggCustomer.NetDepUsd as NetDepUsd,\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\nb.balance as CurrencyBalance\nfrom\n(select\n\tt.*,\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastab < 0\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\telse @RealABAccHelp := @RealAB\n\tend as RealABAccHelp,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastabusd < 0\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\telse @RealABAccHelpUsd := @RealABUsd\n\tend as RealABAccHelpUsd,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\twhen @lastId = t.id\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\telse @realreal := @RealAB\n\tend as RealAccountBalanceAccumulatedCurrency,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\twhen @lastId = t.id\n\t\tand @RealABUsd + @lastabusd > 0\n\t\tthen @realrealusd:= @RealABAccHelpUsd\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\telse @realrealusd := @RealABUsd\n\tend as RealAccountBalanceAccumulatedUsd,\n\tcase\n\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\telse @RealAB\n\tend as RealABDiffCurrency,\n\tcase\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\telse @RealABUsd\n\tend as RealABDiffUsd,\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\n\t@lastreal := @realreal,\n\t@lastrealusd := @realrealusd,\n\t@lastab := @RealABAccHelp,\n\t@lastabusd := @RealABAccHelpUsd,\n\t@lastId := t.id,\n\t@lastrealpnlcurr:= @realpnlcurracc,\n\t@lastrealpnlusd:= @realpnlusdacc\nfrom\n\t(\n\t\tselect b.id,\n              b.default_account_id,\n              b.brand_id as site_id,\n              brand.name,\n              a.id as tr_id,\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\n\t\tb.user_id,\n\t\td.code as currency,\n\t\ta.origin_type,\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\n\t\tcase when d.code = 'USD' then rates.USD\n\t\twhen d.code = 'EUR' then rates.EUR\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\n\tfrom\n\t\ttransaction_record a\n\tleft join (\n\t\t\tselect b.id,\n\t\t\tb.amount,\n\t\t\tb.wide_currency_amount,\n\t\t\ta.realized_at\n\t\tfrom\n\t\t\ttransaction_bonus a\n\t\tinner join transaction_record b on\n\t\t\ta.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 1) rbonus on\n\t\trbonus.id = a.id\n\tleft join (select b.id,\n\t\t\t   b.amount,\n\t\t\t   b.wide_currency_amount\n\t\tfrom\n\t\t       transaction_bonus a\n\tinner join transaction_record b on\n\t\t    a.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\tleft join brand on brand.id = b.brand_id\n\tinner join trader_account c on b.id = c.trader_id\n\tinner join currency d on c.currency_id = d.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,55)) withdrawals on withdrawals.id = a.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,55)) withdrawals_cashback on withdrawals_cashback.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,55) and b.status = 'completed') deposits on deposits.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,55) and b.status = 'completed') cashbacks on cashbacks.id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\n\tleft join (select 1.1448 as EUR,\n1 as USD,\n1.3108 as GBP,\n'2019-01' as ym\nunion\nselect 1.1376 as EUR,\n1 as USD,\n1.3263 as GBP,\n'2019-02' as ym\nunion\nselect 1.1224 as EUR,\n1 as USD,\n1.3021 as GBP,\n'2019-03' as ym\nunion\nselect 1.1214 as EUR,\n1 as USD,\n1.3038 as GBP,\n'2019-04' as ym\nunion\nselect 1.1197 as EUR,\n1 as USD,\n1.2637 as GBP,\n'2019-05' as ym\nunion\nselect 1.136 as EUR,\n1 as USD,\n1.2691 as GBP,\n'2019-06' as ym\nunion\nselect 1.1071 as EUR,\n1 as USD,\n1.2152 as GBP,\n'2019-07' as ym\nunion\nselect 1.1009 as EUR,\n1 as USD,\n1.2157 as GBP,\n'2019-08' as ym\nunion\nselect 1.0899 as EUR,\n1 as USD,\n1.2287 as GBP,\n'2019-09' as ym\nunion\nselect 1.1157 as EUR,\n1 as USD,\n1.2937 as GBP,\n'2019-10'as ym\nunion \nselect 1.1019 as EUR,\n1 as USD,\n1.2928 as GBP,\n'2019-11' as ym\nunion\nselect 1.1124 as EUR,\n1 as USD,\n1.3351 as GBP,\n'2019-12' as ym\nunion\nselect 1.1095 as EUR,\n1 as USD,\n1.3205 as GBP,\n'2020-01' as ym\nunion\nselect 1.1089 as EUR,\n1 as USD,\n1.3181 as GBP,\n'2020-02' as ym\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\n\twhere\n\t\tb.is_test = 0\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\n\tgroup by\n\t\t1,\n\t\t3,\n\t\t2,\n\t\t4,\n\t\t5,\n\t\t6,\n\t\t7,\n\t\t8,\n\t\t9,\n\t\t10,\n\t\t11,\n\t\t12\n\torder by\n\t\t1,\n\t\t6,\n\t\t5\n\t\tasc) t\ninner join (\n\t\tselect @lastab := 0,\n\t\t@RealABAccHelp := 0,\n\t\t@lastRealABAaccHelp := 0,\n\t\t@lastId := 0,\n\t\t@realreal := 0,\n\t\t@lastreal := 0,\n\t\t@RealABUsd := 0,\n\t\t@lastabusd := 0,\n\t\t@RealABAccHelpUsd := 0,\n\t\t@realrealusd := 0,\n\t\t@lastrealusd := 0,\n\t\t@netdepositcurr:= 0,\n\t\t@netdepositcurracc:= 0,\n\t\t@netdepositusd:= 0,\n\t\t@netdepositusdacc:= 0,\n\t\t@realpnlcurr:= 0,\n\t\t@realpnlcurracc:= 0,\n\t\t@lastrealpnlcurr:= 0,\n\t\t@realpnlusd:= 0,\n\t\t@realpnlusdacc:= 0,\n\t\t@lastrealpnlusd:= 0,\n\t\t@currentrate:= 0) v) aggCustomer\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\nleft join trader_account b on aggCustomer.id = b.trader_id\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c6ef",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFDtCLG4kXh87E24rRoJBo9V7meNmblVPjKFzTtoOKlxwWW705mQdR/VhIwhrot1AlXYWrzPLtpHhN1OQObCAqi5AUP8VagIsMxwNSNGDv+Ei8pA48VxaaW0TttN+LBzv2g==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9d4eba04-b526-47d8-93e4-7794c604c525",
            "fullname": "MySql:4d825863-684d-4ed8-909b-b8ac78f66f97",
            "type": "extract",
            "name": "4d825863-684d-4ed8-909b-b8ac78f66f97",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0d397846-4490-426d-a83e-975dc38fec56",
                        "id": "tq_PcawybLKu",
                        "name": "MarketCGCustomers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "3f9bd54b-fa08-43ad-b633-b42e54ad8d8e",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba0b93f6-70d1-48ce-b9d8-bd62676782cd",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "814994f0-182e-4ab7-81c0-3cddb5cbcaeb",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d19492cd-9198-4b94-9f85-69911e03d36a",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "661014b8-c273-4a90-ac87-e7bdfe8c696b",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e8b31aa4-e830-40b1-910c-c159c46b72ac",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a014c5c7-9399-46d0-9752-ce1fba2be9da",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b449bdf-4034-4185-a628-3707e0e229bd",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b5697f63-3436-44df-abcd-8282b963f8aa",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38155d67-0360-4d82-910e-bab9f490cc8c",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "31872844-2437-4981-bb76-9a71f77d1f47",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "80fcd9b0-348f-41a1-877e-a4b57a1ba4ef",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d249500-9604-48c5-af99-304f7d09f3c4",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4237956a-318d-42aa-b0e7-44ffb635f32d",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eacfa7a4-a038-4d58-8f14-3d8c9efefcb3",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ee48471-5703-4d1f-82cc-2514c8664dc8",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac67f89a-2aa9-4f13-822a-d982815dd700",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "51325517-5a7b-4dc5-a49d-f88c7b3e7a74",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "979de92e-88bd-4bb2-aaf5-23e8964c5081",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fd53fd4e-252d-4b35-a98c-915d01062e62",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c35cb14-80e5-4401-b425-6741af683233",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5df45cd-3a22-49a9-b800-f0a1fff3272e",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d43c83a9-b1d8-4e76-8feb-8fbf8ba9f109",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5c9d712-b7fc-47a1-bfab-bd0fb8c84072",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1756ea1c-641d-4570-b6f7-334dc5d83b9d",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4529d6b-4e87-4795-b677-bddee7423866",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7511b0c6-1068-4c75-b3e4-110eda3da32a",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be6a14c6-41bc-4b60-b53f-76539dca3640",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4eb85dbb-26a5-4998-bb13-59763cd725e5",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6e7a99f-2998-42d4-8679-f9c8a1e96cc0",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b8ef66e-4060-4fba-9b69-b1764996710c",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5179dade-9d53-4b6e-b937-2397959e8f5d",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30d21027-2a57-4e47-ac37-6d339dccaf7b",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d8696b4f-c73b-4287-834e-e580099f0c07",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "64dd4939-cae3-4588-bf43-3444a2d635ac",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1fd30dbb-b51f-4110-b5be-b4885e8da956",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4937e05f-a068-431b-9f52-76792399370a",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "50dcff7e-548e-4bbe-bc83-4528ab8678df",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9d1e9e7b-e582-4a46-b08b-8e1e54e1a6ff",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "59c7b617-f370-4463-972d-bd328071f5e9",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f16c1ae-c5f1-405b-acdc-a44302cfebed",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e071346-881a-450b-bbe5-1f91eea6c995",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eefbc1f3-befc-403b-8670-0d4a17cd3f71",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c975dc3d-509b-46cd-8074-e31cf286d7d9",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eb87badb-2443-4912-b81f-6fa475a1e716",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "303faec2-3b40-4b84-bf66-79c9eb819c76",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "040bf9fc-b9b3-49c9-b7b8-0e4f7ac895b2",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83ecd83b-5ccd-4699-8036-6fe7a4906b39",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a688a004-639a-431b-a97d-b78b603d40f4",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ba75f13-26ea-46f7-b5a2-3c9845726c27",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3da9431c-aca0-4e8b-8f84-2933c3f7e374",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a256197c-2987-4747-899a-a5b6ef226c3b",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e5c5e88-0787-4366-a4b0-2ce59fa3c9ed",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3c7a10eb-d078-48e5-a07f-9541e3bd41f3",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "151c3973-edd7-452c-8d62-f100f9a3bf2d",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd8098b4-0215-4fab-a83c-195f091bc9ee",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bec4d07d-d7b6-4157-8443-4074474b3c56",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5eb5679-1793-4b93-8ccb-d06abee0b044",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3bb5117-1fdc-4f4a-8e98-e432cf69e9c8",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0c7c0284-bb46-4f9c-9683-541cb95e75fd",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03593d74-ebe2-4eca-8e81-2553815b9235",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fcc40b7b-f50e-4c72-9b7d-c5caeb290f9b",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "30d21027-2a57-4e47-ac37-6d339dccaf7b",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "0df52292-8af1-4979-88c5-8ee481d4c97b",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32,55)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,55)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619502b56780f2002c37ecab",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NAc1gMa0VBzZ9QDyN4mgrYY4RdbmC5kaicIuBKtyLx50isgKI42gk0NUhwNAOs/C+1ClXW3UC6yk8zdu2MLwnevpcBXSYS5lL8i4M0k06sUJIQFcjc1VnpGNQCbGzv+s0=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9daf0742-707e-466f-9bdf-c6a239fb4089",
            "fullname": "MySql:d2a87038-0bb3-4928-8c5f-87a3c5bddbc9",
            "type": "extract",
            "name": "d2a87038-0bb3-4928-8c5f-87a3c5bddbc9",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9f9359d8-78c3-46f7-b601-9a16e49fa9e9",
                        "id": "tq_i356jESxP",
                        "name": "GeniusIG_OpenPositions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e26c13b9-9b8f-41e1-967b-054ee9714a78",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1260100d-660c-48a0-a0cd-06a0586a1875",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1cba06d-53c0-4672-a939-ee4211ea3cf3",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7943a0b8-4dfb-401b-9ae7-32f5200a9ba2",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6fcade4f-d2b8-4436-a825-813d32829eeb",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57fae8dc-fd89-4453-a0eb-2b185d1fd4a8",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "370bbb4e-83c9-45e8-931e-55a6b885084b",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46094fb3-b7ff-4831-a13d-31d741aff1e5",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98240dd6-0c5a-4500-823f-9b450d2fa9af",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "efbd99ed-ed36-4f2d-bb1f-e1523528d229",
                        "configOptions": {
                            "importQuery": "select \r\ntrader_account_position.id,\r\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\r\ntrader.default_account_id as trader_account_id,\r\ncurrency.name as currency,\r\nuser_currency_vol,\r\nsystem_currency_vol,\r\nsystem_currency_vol/user_currency_vol as exchange_rate,\r\n(trader_account_position.pnl)*(-1) as pnl_curr,\r\n(case \r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\r\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\r\nend)*(-1)\r\nas pnl_usd\r\nfrom\r\ntrader_account_position  \r\ninner join trader on trader.id = trader_account_position.trader_id\r\ninner join trader_account on trader_account.trader_id = trader.id \r\ninner join currency on currency.id = trader_account.currency_id\r\ninner join brand on trader.brand_id = brand.id\r\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c6f1",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lNqu9YjU4aq2UrD1B4elNg9lVKQFHRdfOjSDmdho2O0BcE4ZGSnDY66nmV13xmTftBiPAwAPjQRY3WaG8+JajVjq0bDUxyyXSBahftWfD+BqWv3e7qI4k/hTBGAZLgcMyNOeLODquQbmqREECx1kSDm5qX7TJaisk1mvdLWSNPK",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9f389599-2595-4b27-be7e-d741cbaede43",
            "fullname": "MySql:1d42a664-71fe-4759-91e2-6e55e5722edc",
            "type": "extract",
            "name": "1d42a664-71fe-4759-91e2-6e55e5722edc",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "69be4b8f-4874-4763-882b-21dee8eae24c",
                        "id": "tq_JOFmPsZwJ",
                        "name": "InfinityCapitalg_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "fc1c8101-41da-4c33-9b19-dd07424d80de",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e036dc19-8917-4bb9-8d0a-c563c12d96d1",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db7d9f9f-56e7-4acb-acda-61529bc71afd",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1d8a2fec-56de-4c13-a20a-c56885824c75",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf616ac9-4833-4290-a716-f308d2e1d3fa",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "faaedea9-df51-446f-b2a8-ff4c3b22d845",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "97e37eb3-e49c-4f10-a2c1-8eda5ae57e6e",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "60c3d593-0c3b-4fe1-8d10-1682fd52a25e",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4957f04e-62e2-44eb-9009-10083f49d26b",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73552346-d1c6-4269-baee-41ebe844c615",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e8685ca2-a7c4-4fff-af50-51a63c52102b",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d5b2475e-b3a8-4d14-bba2-7e379eb0d062",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82a25a53-2989-4200-b2a0-b4aeb208411f",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c32945b-8162-45ab-8235-f19b2d63574a",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e84f1f4-e5ad-43ed-aca7-d4af78a219aa",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fac35a1b-6188-4f6e-874a-9b3aec78c14a",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2989c67f-30bd-4d4d-96b6-9b7543bff5fb",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f6c4c6d-6741-459d-89dc-876a53f9e51a",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "85096389-bec6-4c4c-86dc-5c2cef0e84a6",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "18822c14-ae64-4a9b-b670-ae07cf06bb41",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2f3cbf2e-f72f-4972-a54d-f71ed0aa905b",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d7f7920-5add-4e34-9ea4-c3493585c9a4",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed91350b-e08f-42d6-a727-ce37fad88ced",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e58cbf79-9d05-44b7-8b63-d09bb1e4881d",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fde7ba6-1d4f-47ef-b0b7-ca0b6dd4e86d",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "740b9993-d82a-4157-92dd-f77a018e9e25",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "18e6f3d9-e232-4f81-8c28-a002a6abcde1",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b712d0f-a821-4e9b-918a-29b042a22c13",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dfda3c04-a032-4f4a-aa04-a239d3e37441",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db754a86-c0df-46ac-b690-b740b5d399ac",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e5f0e66c-492d-4b91-822f-ca93598af258",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "762a9aea-a2d1-47dd-bf04-51e3401e6ee2",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "586a1972-74de-4760-a569-d06a145277e3",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "74e7257e-8e86-4680-a764-60d591c90d9f",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4c834d45-e5cf-4640-8b4e-6a66f788bab9",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4a7ab4b4-579d-426e-9ad6-ad0588500171",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7027ba90-b03a-489b-ad7a-79afc09f316a",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e75fcb82-8865-4f57-a8c9-ab69c3bba63a",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89149514-b29e-48d8-9f66-c476d104b5c9",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a3b19540-d74d-410e-9f58-814e0f79ca6f",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1b631eb7-6618-482a-82f5-6ec1a8369633",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "732cdac9-1127-4d5d-adfb-7940c5296c6d",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d41293f0-b752-4e2f-93a6-08df98fb82c4",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3c0f5a2-2430-44ab-88d2-d466db86bbc7",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5338df24-acc1-4c86-807a-4c991fbb5b89",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "50e118d0-ae42-4677-bb1f-e0d5055aa43d",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30902b6b-9cd1-4f49-8067-3c5968e50a09",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc42e3bc-c014-4035-acdd-94485fbf2957",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3823e6c3-a603-4e8b-bb7d-7bd28de83b67",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b00139e1-7579-4404-9d13-b1372e66ea34",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d9f3a3f-24a7-4152-a2da-43a99e1f5256",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fab7513b-dcef-4bd4-9b7f-5c90776cd376",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d57d2bca-3c5f-48af-8561-bcea14467b44",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1969c6d5-ef05-4856-80b3-127c674e66a2",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8065a213-17e7-4318-b785-1d56b3f6b870",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "230a61cc-8395-415a-9868-3fd27e8ea649",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26254b6b-decc-44c3-8dda-564802e3521c",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6adb3037-e9c8-45a2-9911-e4b5001c26df",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "799516a2-784f-4ef7-a802-1eba5ac3fc42",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "098f99af-d62c-47e7-b9cb-f28d85b23c9e",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c270bf61-289a-49a2-9486-499fb5008791",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b8692fc-8e71-451f-bc9f-e9db21bf3cef",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "586a1972-74de-4760-a569-d06a145277e3",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "5a8f33e6-ba71-4775-8a3d-90ab15aa5573",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\tCOALESCE(transaction_deposit.payment_provider_id,0) not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619503a96780f2002c37ecb1",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a3b8df8e-8c87-49b7-8e06-515696c90826",
            "fullname": "MySql:0c9600dc-e304-41d6-877a-b7665df7497e",
            "type": "extract",
            "name": "0c9600dc-e304-41d6-877a-b7665df7497e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "299a7592-f1ca-4239-bffa-de7240dc145b",
                        "id": "tq_xdbI6H1WM",
                        "name": "TheBPCA_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "bf04c556-d831-444a-a9c8-5e8168b9e47a",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf2fb91c-78c9-4576-a2ed-149a8eb997a2",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ea77b7f-342b-42eb-9d1b-f48a51f87adc",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "063eb0a1-31d8-494c-be48-9f6f0ccc3204",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9f86433-f5cd-44cd-aff1-ed3e74d9e98d",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "0bf54a55-17cd-4cbe-ad65-fc8a15d3ac7e",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c6f3",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oSBHqROSJqfbavRql9qKiSLEmwl7IhJ9c6fsHLIM0OwCRHrJNGuAkZHFejMZg4JRw0O3fODsXnYpi2hUBhBsbmkJv6Fp6AFNzUCzYUMwbHmTHLlXM9s4v79bGMK/5v8OLM1d6GkztCEoQnoKHxxgdL5bqbfcU8jEEZ4JlNgR8Mv",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a5b27d0d-9a6a-4afa-8a0e-5971c135f0eb",
            "fullname": "MySql:b1ea2618-5bef-4b0d-931e-34a34351fda7",
            "type": "extract",
            "name": "b1ea2618-5bef-4b0d-931e-34a34351fda7",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "6bb53832-0d88-4ad8-adc5-360f3c7e182b",
                        "id": "tq_4lQAU6ELD",
                        "name": "AshfordCapital_OpenPositions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "97fa7d27-7ab2-4c23-9aa9-c2ad5b692910",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec2bb7a5-ae13-475f-8fb8-d0532ca917b9",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c4ebb66-286a-4068-8c80-b61cd7a55230",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcbc820e-8eb5-464b-a452-de8303715542",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4de2d40f-e272-4b4b-80ee-28aeaf61c5d1",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "306e72a4-2d01-4361-a251-52e804664cbb",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78ebaf32-9629-4329-bfb1-25b3a9400119",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e30fb6a8-b4a7-4bea-9c0f-0b9e561ef86e",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "75f70f6f-2b82-4a45-a59e-8e63d44b600b",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "983bd308-6a24-4cda-a7b2-25eed1a7c4eb",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c6f5",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6qAqQ4wTrAjQNYhfY7egrcPCKm7Rh9+irvJBmxkN4y5OWK0b1ABUI6cX4BynT/Bb57V8dXjpQ/i465b9A+cO9KF/5WSBj4Act8xbVcAg/2E4DCkuyCXF+OKugn3wI+gXAF02li6ZiOESl71+QZkncPGh5q9fZWYJlgnkJvoKDP2C",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a6122855-db31-49ee-bc26-5cb0e8364102",
            "fullname": "MySql:4781258e-7374-4e24-9909-f65cc7528cc7",
            "type": "extract",
            "name": "4781258e-7374-4e24-9909-f65cc7528cc7",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5358a56da002c36c6f7",
                "provider": "MySql",
                "parameters": "4T6wa7rsurnv9Wph1bXhzw838tmSOkVgLVD00p2Th79+olOIve7nehYXK9NMno0yUhmIACDdatYc7jvii+j9fVCaaDOnJaEC3G/Am/tgA6uIcXb8Ti8MGVe1t4WCQkwNa01w0kBcgv35Na6ciR/GbQjo0EkqOr7+ZRyfJhnhhLVfRT240pNVPU65zPhBX1grj8tsndsBe6FBEwj6yDwvcQ==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a900ecd5-76a2-4716-8c4e-67dc1312a8c0",
            "fullname": "MySql:1802c4b8-76fc-475e-bb9e-fb50d5bd8f69",
            "type": "extract",
            "name": "1802c4b8-76fc-475e-bb9e-fb50d5bd8f69",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8b310e20-86d6-4446-a142-abcd5fbd45df",
                        "id": "tq_1OJ5cM5P8",
                        "name": "TheBPCA_OpenPositions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9ad5c1d6-d0c9-47b8-bb2d-1f5c0be6faa7",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "060954c7-6a70-44ae-9cb5-9613a477479d",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbd47f02-d925-486a-86e9-6430600f6f6c",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "85636fb6-b8f5-4c5e-8ae3-f7a1c15c90f8",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56b2499c-82cf-4030-af25-4fd61c8fb747",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39e837a3-2b69-444e-a46b-116c558e48d3",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d50b463-25fa-4316-a94f-09f5a174f87e",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8db1ca9b-fe1d-4e1f-9981-6ab5b1f8de20",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9816f3e3-11a7-49fd-a0ac-bee032c72485",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "7e687acc-6ec7-47ab-bfd6-c460bd83c053",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c6f9",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oSBHqROSJqfbavRql9qKiSLEmwl7IhJ9c6fsHLIM0OwCRHrJNGuAkZHFejMZg4JRw0O3fODsXnYpi2hUBhBsbmkJv6Fp6AFNzUCzYUMwbHmTHLlXM9s4v79bGMK/5v8OLM1d6GkztCEoQnoKHxxgdL5bqbfcU8jEEZ4JlNgR8Mv",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "aad5917c-8ba6-4afa-b7e6-86647cbd7f5f",
            "fullname": "MySql:0161f99a-b87d-45ee-b3d6-733177f5fcfe",
            "type": "extract",
            "name": "0161f99a-b87d-45ee-b3d6-733177f5fcfe",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5358a56da002c36c6fb",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoheAP1kZvNi+4VpN1pRRv3kaD/RL2IIGntCq0mo/lZJkYw5sZYML0+enaqd6ElULbA=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ab9a898a-e1be-4a0c-baea-a7922fefbe0c",
            "fullname": "MySql:597138d0-0e8d-4a5f-a774-fc2c39b95357",
            "type": "extract",
            "name": "597138d0-0e8d-4a5f-a774-fc2c39b95357",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b69a2773-908b-42a7-9de8-37eb3a95e875",
                        "id": "tq_iQgFBDk5A",
                        "name": "AigMarkets_OpenPositions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "fedd5ac3-cba0-4d93-a271-c18e3f8ab3f2",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3557e091-0b3c-47a1-89f3-9dc1f7febeaf",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bca68f3d-afe4-417e-a237-ef559087c500",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a39ddbfc-f40c-4d9c-ab52-e1a5bafcc15f",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2afc5952-e158-442f-afcd-808b20940c9e",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48b2182b-1ab2-49b4-b5db-77620ce9f1b9",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aef45e99-57e4-4f09-a1d8-012c9b69cce3",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 27,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e605aeba-caaf-483a-94e9-a8cff312d2d4",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b33c4f93-c1d6-4150-9433-ddd06689a148",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 47,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "955bbaeb-1945-4231-b999-fff15c2b6ca5",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61b343a901d520002c42b1a4",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W9vffNlEo4jtdabftiKFBxfaaQsXoFhTTM7txEhG/jLu6CBekXY22hgN88Ng0fYauS48Rg4xTl4PvHqjVbcTS5Oi9FGQfbh1gOsBXF/HnXlsW+cFPRFDXzzbo/8B2c8RpAz/uBJmRSXztf22P/MxqCvTW1lgo5PsEnrOHIw69wgwh2HIjj4R4ChudbQMprFOPzxUtJA/laJ5YRHjGrRVKxa",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "af40832c-b851-472d-96a5-d5978c3a2fa0",
            "fullname": "MySql:a18bac69-db0e-46de-90a3-53d7385b5334",
            "type": "extract",
            "name": "a18bac69-db0e-46de-90a3-53d7385b5334",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "160f9017-61b9-42ad-860a-31e75a6c68e5",
                        "id": "tq_jTGaDeSNc",
                        "name": "BendigoCoins_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a71590f1-03c5-4fc9-a94b-46a50b7c6dcb",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bc1cb17-dd3a-4d3c-9e70-99272a7d3450",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "217b3cac-83f0-4009-a0a6-1feb818a9ebe",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e3a03c8-02cd-4aad-a14a-1dd1aba9381f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11ac9be1-14c1-4665-9a0a-4a97f2ca532e",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab43ec85-a76c-4bc8-8dbd-f9ecacb31976",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5afe8fc0-a1f1-4d58-bd21-9c04aa4ca728",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5856b5bf-aab8-48f5-ad4f-47ef0a25c3ce",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fde6c48f-8f66-4e6d-a79a-0533136672ef",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d273e859-9a3c-4914-a459-4fe52396de68",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aaa131c2-b057-4af8-b5cc-f6791678782d",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38cb01c3-36c2-4f5e-b3df-f767be74164d",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55a648cf-923c-49d6-b202-9b8c73260d5d",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c27c575f-c22c-4595-8dfc-ef490d28870f",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ed078fb-ac02-413a-b7af-91931c18bff0",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ccd9fce-34a6-4494-8055-7856c299e0fc",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ce68f3a-29ff-4d6f-a47f-008a9c965a6c",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "afcf8fbd-d67f-4504-b71c-dc2422dfcd4d",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "278c83f6-d536-432c-a1db-c0058f488809",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d09e60f2-a58a-4a1b-9d29-4a021e9f23fb",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f27064a-da60-4c26-8ae9-0fb3951f6a4b",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00384147-0012-496d-8668-c30cbc54c078",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "133a521a-dd58-40e4-9265-1ae1b26a92b1",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ddcdbd34-da7b-497b-a483-529f34a6ba0f",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6f7a01b-f554-426e-a89a-cc1e854339df",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb46e242-c429-431f-b7f2-f1298f12003b",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2335bf45-93d8-4388-bd7c-e0d3b60e15e0",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "82bc6a60-baa3-44f3-bb50-e84de2610d91",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79f10709-8e96-4213-b27a-7e59042682f0",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae0ee5cc-0531-4a70-ae8f-64cc4af5a82e",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5c1b0e3-7422-48f6-bb15-97a924e526b6",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0317ea42-54a8-40b3-ba64-5215983eeada",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d92322c-f27c-4fef-b1a2-e22e4db0dc92",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cccf95b9-eac4-4ec6-8204-fea1e662da08",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34661253-fe7b-48b5-bbcf-d9066f6d5b36",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c721da2c-1b70-4e33-ba4a-44cf726de490",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "65e5f14f-1cfe-4393-a13d-be4e9684a8a6",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "778fc8cd-1987-47d9-9a74-3dd7bc4affcc",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9c8e605-cd14-48ff-afa3-711f23663087",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ad376b6-b76b-4274-9ebb-42976e6efc77",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40851efa-34e6-41d8-b9f5-5357a74b75f9",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db29b331-ec60-4b0b-a915-8120bc241947",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f7d8747d-ba86-4698-9646-eddb0253448f",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc529bdd-eed8-41e4-8483-0a769cbec289",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80fd1564-bb93-4c82-bfcb-8140862deb5e",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca5288de-4c0a-43af-a47f-329194790cee",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e0d0406-73ed-47a9-81c1-0a6f0fddaa13",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73b69733-aa98-4088-b171-350937c3b2a4",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5498827-30fb-429a-8123-aac75c1c359c",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2106eecf-3067-4576-b5cd-401dd66c277e",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e0ec675-d396-418e-a6a7-105ba4a88fff",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd639e8c-813c-4f23-9c61-10028b5dda4a",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "191c5947-2712-4140-84cb-02f31f8f8318",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dff61593-6aa3-4e5c-ae8f-0844f31713e5",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6b992c7-498d-478b-b389-55b348f4553a",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f83911d-2d70-490e-bddf-608456db99d6",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a00cdb1-3794-46e6-b8b3-84c8ba24f536",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5d8cb52-df6b-42cf-b0dd-2c95bac665d2",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25043260-a3f2-497d-a15e-8d79655edc6a",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2069665b-5fb8-43c4-975e-11970545b8e6",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3bf5bc59-02a7-447e-ae7b-4c3c0de66fbd",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "055b51e4-9d93-45ac-a165-728eb63e462c",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7bdd191-6ae9-4aac-a0d2-67822410ccf2",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a943c1c-dfeb-4c97-839c-3cbbcceec1c8",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae8322d5-56e6-4077-a4cb-283925c11929",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 66,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f168bbe-5f3f-46b0-b10c-73f83a43addb",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "896693cf-1af7-4bdd-ab6c-1e83b3d767eb",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 66,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d35215a-198e-4313-94f8-64e6ae868f1b",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 0,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "317b4d28-d762-43dd-b381-0b8c38860a5d",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "d273e859-9a3c-4914-a459-4fe52396de68",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "4b18b7f8-3348-40bf-9243-38d042db375f",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\n       aggCustomer.default_account_id,\n       aggCustomer.name as site_name,\n       (1000 + site_id) as site_id,\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\naggCustomer.customer_fullname,\nco.name,\naggCustomer.currency,\naggCustomer.created_at,\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\naggCustomer.date,\naggCustomer.YearMonth,\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\nend as rate,\nMaxDep.LastDepDate,\nMaxInv.LastTimeInvestment,\naggCustomer.tr_id,\naggCustomer.origin_type,\nMinDep.FTDDate,\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\naggCustomer.user_id,\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\naggCustomer.deposit_curr,\naggCustomer.deposit_usd,\naggCustomer.cashback_curr,\naggCustomer.cashback_usd,\naggCustomer.withdrawal_curr,\naggCustomer.withdrawal_usd,\naggCustomer.withdrawal_curr_new,\naggCustomer.withdrawal_usd_new,\naggCustomer.cashback_withdrawal_curr,\naggCustomer.cashback_withdrawal_usd,\naggCustomer.withdrawal_fee_curr,\naggCustomer.withdrawal_fee_usd,\naggCustomer.chb_curr,\naggCustomer.chb_usd,\naggCustomer.inactivity_fee_curr,\naggCustomer.inactivity_fee_usd,\naggCustomer.overnight_fee_curr,\naggCustomer.overnight_fee_usd,\naggCustomer.fees_curr,\naggCustomer.fees_usd,\naggCustomer.pnl_curr,\naggCustomer.pnl_usd,\naggCustomer.swap_curr,\naggCustomer.swap_usd,\naggCustomer.contract_usd,\naggCustomer.rbonus_curr,\naggCustomer.rbonus_usd,\naggCustomer.cancelled_bonus_curr,\naggCustomer.cancelled_bonus_usd,\naggCustomer.pending_bonus_curr,\naggCustomer.pending_bonus_usd,\naggCustomer.fixed_balance,\naggCustomer.fixed_balance_usd,\naggCustomer.negative_balance_fix_curr,\naggCustomer.negative_balance_fix_usd,\naggCustomer.NetdepCurr as NetDepCurr,\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\naggCustomer.NetDepUsd as NetDepUsd,\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\nb.balance as CurrencyBalance\nfrom\n(select\n\tt.*,\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastab < 0\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\telse @RealABAccHelp := @RealAB\n\tend as RealABAccHelp,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastabusd < 0\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\telse @RealABAccHelpUsd := @RealABUsd\n\tend as RealABAccHelpUsd,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\twhen @lastId = t.id\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\telse @realreal := @RealAB\n\tend as RealAccountBalanceAccumulatedCurrency,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\twhen @lastId = t.id\n\t\tand @RealABUsd + @lastabusd > 0\n\t\tthen @realrealusd:= @RealABAccHelpUsd\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\telse @realrealusd := @RealABUsd\n\tend as RealAccountBalanceAccumulatedUsd,\n\tcase\n\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\telse @RealAB\n\tend as RealABDiffCurrency,\n\tcase\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\telse @RealABUsd\n\tend as RealABDiffUsd,\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\n\t@lastreal := @realreal,\n\t@lastrealusd := @realrealusd,\n\t@lastab := @RealABAccHelp,\n\t@lastabusd := @RealABAccHelpUsd,\n\t@lastId := t.id,\n\t@lastrealpnlcurr:= @realpnlcurracc,\n\t@lastrealpnlusd:= @realpnlusdacc\nfrom\n\t(\n\t\tselect b.id,\n              b.default_account_id,\n              b.brand_id as site_id,\n              brand.name,\n              a.id as tr_id,\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\n\t\tb.user_id,\n\t\td.code as currency,\n\t\ta.origin_type,\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\n\t\tcase when d.code = 'USD' then rates.USD\n\t\twhen d.code = 'EUR' then rates.EUR\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\n\tfrom\n\t\ttransaction_record a\n\tleft join (\n\t\t\tselect b.id,\n\t\t\tb.amount,\n\t\t\tb.wide_currency_amount,\n\t\t\ta.realized_at\n\t\tfrom\n\t\t\ttransaction_bonus a\n\t\tinner join transaction_record b on\n\t\t\ta.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 1) rbonus on\n\t\trbonus.id = a.id\n\tleft join (select b.id,\n\t\t\t   b.amount,\n\t\t\t   b.wide_currency_amount\n\t\tfrom\n\t\t       transaction_bonus a\n\tinner join transaction_record b on\n\t\t    a.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n       left join brand on brand.id = b.brand_id\n\tinner join trader_account c on b.id = c.trader_id\n\tinner join currency d on c.currency_id = d.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\n\tleft join (select 1.1448 as EUR,\n1 as USD,\n1.3108 as GBP,\n'2019-01' as ym\nunion\nselect 1.1376 as EUR,\n1 as USD,\n1.3263 as GBP,\n'2019-02' as ym\nunion\nselect 1.1224 as EUR,\n1 as USD,\n1.3021 as GBP,\n'2019-03' as ym\nunion\nselect 1.1214 as EUR,\n1 as USD,\n1.3038 as GBP,\n'2019-04' as ym\nunion\nselect 1.1197 as EUR,\n1 as USD,\n1.2637 as GBP,\n'2019-05' as ym\nunion\nselect 1.136 as EUR,\n1 as USD,\n1.2691 as GBP,\n'2019-06' as ym\nunion\nselect 1.1071 as EUR,\n1 as USD,\n1.2152 as GBP,\n'2019-07' as ym\nunion\nselect 1.1009 as EUR,\n1 as USD,\n1.2157 as GBP,\n'2019-08' as ym\nunion\nselect 1.0899 as EUR,\n1 as USD,\n1.2287 as GBP,\n'2019-09' as ym\nunion\nselect 1.1157 as EUR,\n1 as USD,\n1.2937 as GBP,\n'2019-10'as ym\nunion \nselect 1.1019 as EUR,\n1 as USD,\n1.2928 as GBP,\n'2019-11' as ym\nunion\nselect 1.1124 as EUR,\n1 as USD,\n1.3351 as GBP,\n'2019-12' as ym\nunion\nselect 1.1095 as EUR,\n1 as USD,\n1.3205 as GBP,\n'2020-01' as ym\nunion\nselect 1.1089 as EUR,\n1 as USD,\n1.3181 as GBP,\n'2020-02' as ym\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\n\twhere\n\t\tb.is_test = 0\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\n\tgroup by\n\t\t1,\n\t\t3,\n\t\t2,\n\t\t4,\n\t\t5,\n\t\t6,\n\t\t7,\n\t\t8,\n\t\t9,\n\t\t10,\n\t\t11,\n\t\t12\n\torder by\n\t\t1,\n\t\t6,\n\t\t5\n\t\tasc) t\ninner join (\n\t\tselect @lastab := 0,\n\t\t@RealABAccHelp := 0,\n\t\t@lastRealABAaccHelp := 0,\n\t\t@lastId := 0,\n\t\t@realreal := 0,\n\t\t@lastreal := 0,\n\t\t@RealABUsd := 0,\n\t\t@lastabusd := 0,\n\t\t@RealABAccHelpUsd := 0,\n\t\t@realrealusd := 0,\n\t\t@lastrealusd := 0,\n\t\t@netdepositcurr:= 0,\n\t\t@netdepositcurracc:= 0,\n\t\t@netdepositusd:= 0,\n\t\t@netdepositusdacc:= 0,\n\t\t@realpnlcurr:= 0,\n\t\t@realpnlcurracc:= 0,\n\t\t@lastrealpnlcurr:= 0,\n\t\t@realpnlusd:= 0,\n\t\t@realpnlusdacc:= 0,\n\t\t@lastrealpnlusd:= 0,\n\t\t@currentrate:= 0) v) aggCustomer\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\nleft join trader_account b on aggCustomer.id = b.trader_id\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "616022d69d5c67002c6f1973",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLYe2SGfT8Lds+akycpW5+K9YO+8fTekLNVbA78DM/OCWbxUblK2Id8YJvnNXUQ+eTIAHMN/W71sURfgBeS0WwQxNOqj84HBxwBZ6il+EKFmHJ9FWKQZm+UDy5OxqZbFAkXbpIyiPYxJBez63/L55hNPwBFOT2h2PzJQNrmoEZCdMcWAZeNnU55kjKL1mdEhkXeRVJc9RJItZ3XYlFNc1pmocYfl2UZpPJAOkcdJcbO/5",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b1b3bdca-98c5-49a1-b398-d4c1a4e439c7",
            "fullname": "MySql:59a290b5-625c-413d-aeb3-d6474255c707",
            "type": "extract",
            "name": "59a290b5-625c-413d-aeb3-d6474255c707",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "68de7800-520a-4ef1-a69e-3fcf7d0d6b29",
                        "id": "tq_IQiWYO5ET",
                        "name": "NostraCapital_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d6cb3270-ffa2-485c-ae3f-070d567ef450",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33e1e4a6-f3c0-4656-88e1-343b35f50ecc",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21cb6270-456f-4678-b856-0d0eaf899010",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f259f2a6-947e-4413-a6c1-3e5a90c0ba9f",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9500f940-46a7-453f-a842-8af81eb4f42b",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "fbfa2aa2-64b1-4d17-bb41-e28e88d4c21d",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c6fd",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6mkpXbI+4cVPcW9QmdR/OpFY0NV6lOS+yIHmY9aWUhUzSj1KLvCfMgcIqWzFtH2wB4wDE6J0O3kIYCeCTy2Vm2FnBTBcZ0ejYO8nr2tUHC3cyjEC9VpB/CP/XWAQHRXQ8biCOO3g3QegnOXaTTb/9ErFOuEJ8WFWhUXRuCVMOFyl",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b5c0b6c6-6acc-40b4-8292-8e73665e73bd",
            "fullname": "MySql:8bc59c4b-bd4e-4ad9-ac63-48449137e790",
            "type": "extract",
            "name": "8bc59c4b-bd4e-4ad9-ac63-48449137e790",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b1ca994f-484d-44c4-9937-1c6f91f68a46",
                        "id": "tq_7B01A5tzO",
                        "name": "IvyTrysts_positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1b7ecabb-408c-413c-b1ed-07d5736b80f3",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d7065b4-5c6d-4538-b47c-740a8a906c38",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab5b74a0-cfdd-40a2-a0e4-19736e6eb179",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1680ec82-2a3a-41f1-8167-8eaf88456e76",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88fd366f-368b-4546-9c3d-5ec3dda6f272",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "5f3c9a8d-ce40-4ccd-bef0-385bc2532bdd",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(cast(brand.id + 1000 as char), '10003', trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\ninner join trader on trader_account_position.trader_id = trader.id\ninner join brand on trader.brand_id = brand.id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c703",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiAoP3g27zBsTBhENM+dBsf62FQyEzHEvyCyA1AFqG0Wq82nAt5YxcjG5bUujZ6mLgw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b6265361-ab90-4fbc-a587-f7f639433a67",
            "fullname": "MySql:755ac525-81c5-4d22-bead-28dda97cec68",
            "type": "extract",
            "name": "755ac525-81c5-4d22-bead-28dda97cec68",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5358a56da002c36c705",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLUwEPzcgqqtE9a5Pnc2nll0NjZrJR/Jww0qf8hT75oIwMbiC4cqdvRvQjGYdaHTatwc8jtdTTc6AakqCYl3afdAbFiEIz5mygL60ssKBHFcvuYmPaMZXEvGKLWIIJIVObZN20nLN44fwGGsQyHS09rOejE4A9eRbTI2fp7+aEimjZESA2wrQlFBAZcDBF/y5DdYAqV+f7KO8F9idyb2Gyx8=",
                "schema": "trade",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b9c990a2-f7d4-4003-ac61-6f662b47532e",
            "fullname": "MySql:28b64dfd-b8f3-4e88-8b54-b89750ef660a",
            "type": "extract",
            "name": "28b64dfd-b8f3-4e88-8b54-b89750ef660a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8756e0ff-af04-4446-8ad9-34fa9a991cd0",
                        "id": "tq_9YHLaFclQ",
                        "name": "365TradingFX_Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "7f55d703-f3b7-4a55-bb57-3d21b815fe08",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6482de02-eade-45fa-ba95-b8fb47ec9f8f",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6164f7b0-ebf9-458b-bf65-34a9c365d1c3",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5c655f9-57c3-420b-a6bd-cfad7c60bc67",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57377f61-5f14-4de8-96cd-6f7e3d4da027",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "1b9bdb8e-dfad-4bea-ba4a-cf4df57d3f26",
                        "configOptions": {
                            "importQuery": "select\r\n\ttrader_account_position.id,\r\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\r\n\tconcat(COALESCE(1000 + brand.id,1031), 10000, trader_account_position.owner_id) as employee_key,\r\n\ttransaction_record.wide_currency_amount,\r\n\ttrader_account_position.`type` as order_type\r\nfrom\r\n\ttrader_account_position\r\nleft join transaction_record on\r\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\r\nleft join trader on\r\n\ttrader.default_account_id = trader_account_position.trader_account_id\r\ninner join brand on\r\n\tbrand.id = trader.brand_id\r\nwhere\r\n\topen_at >= 20190923\r\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c707",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6h2kEQfj06tSGpyh+xEzmk6Iq8paTu3ip6/rB+N1MFIYN59/xJKyq6s2pJ06bUpzhAANrOSGSl8zpPlUO8IwiG8A7d+Vz+KCoZhjqP9L+KHT5GfaypnOnu+badv06TGAXIJlaegbboPbyBtw46kZTRfJ2bJyakx/q48snRhZp8Cm",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "badb9b2c-75d4-4028-be0d-7359e9bd5331",
            "fullname": "MySql:8e5a602c-ef37-4e2b-b856-4789e8a92299",
            "type": "extract",
            "name": "8e5a602c-ef37-4e2b-b856-4789e8a92299",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ba7ec750-6282-481f-b303-cda7e17ded67",
                        "id": "tq_47Ov5Y0Nd",
                        "name": "WinGroup_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "61b29faa-3e97-4dd6-8b9c-1e6cd1565263",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1b123e0-36f2-4036-ae8f-dc06fd09b62d",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ca291e2-d9e6-408b-99ae-ed4780d7f2fd",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e8be69d-6bee-4d91-9ed0-17170f7593b5",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db98e157-63fb-46c6-a8ea-843635781274",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ed30bbb-d490-4fa0-b1b4-b6020452c1ae",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "242a414e-ee95-42d4-90b3-038d991aaa8f",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4c43528-6816-4e25-be30-f1d9bbd0902a",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73e9dde3-43b6-4e86-badf-e33871ba90a4",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "944f33ec-3dcb-431a-9ec1-a146bd0877ac",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d85bf7f4-2e9b-4ab2-af93-823a74315f3d",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3c7d62c-c4cb-46c0-97f3-3786fa4a7ca6",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a3f8145-6cd8-41d9-adad-174e052535f4",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5d394d2-d720-48cf-baef-45d19d98a6b7",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f634b6e-a037-47a8-b837-b4576b2a27e9",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96b3b891-b55e-4db0-858b-f254998f5b54",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df615edc-725b-449e-ae87-24551d3696ab",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44d276c2-8d69-433d-8fa0-526e426ca173",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c643cf73-8f99-4638-873c-51bddf3a8890",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8e9f06d-8c5e-4934-81d3-d7b30abff4a2",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5d0cd8e-f58d-4f06-9108-a80da95c3193",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8c6c503-dbf4-4331-b848-3a0bfb076e22",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06c8470a-efc9-455c-9d1b-fa5602e2e29e",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "356b1e33-cbf3-49f6-8ced-a3b6170d53f0",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e307aa7f-9712-406b-bc2e-b3eda64fd38a",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f01bb0f-51b4-4784-89a4-3135e3d39521",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f2647da-93bc-4625-8b98-7cbe76a0f59c",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11dc36a3-6e13-4bcc-9ebb-3890e5510cb0",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9ab3f52-2126-492e-acd7-743b6eb9e326",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e0b49b3-6134-4def-9167-b3a38bc162ee",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40d32148-2a5c-4863-a835-11dcb2254d01",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba48f47d-97ef-4b3a-af7b-bf79575f3a9a",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "554ad803-32dd-4afb-ba75-1f04dfff8e25",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83b6f2ba-47b1-424c-b0f6-d059bb765ae1",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ad8eea0-4a4a-42e8-b3a0-c82500bfd0cc",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea5ef1fa-15b5-43b0-a1b2-13ac75d69f71",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94075d09-52f9-4008-bc4d-1081d269ce3f",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d633b13-0a0c-4ca6-beb4-3c5f6e5b5f52",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98c5b41a-c204-4365-bfec-945a770e13da",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "698b9b38-c220-46d0-a3a0-f8655fb09c1e",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cacb888d-de3b-43b9-92db-50a5eb92072d",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e61c1e9-8bfc-46b3-b252-bbb39403c7d0",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d59cd61-6145-42c1-9793-a9eb1ee996ab",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90977c3a-b6a9-4446-8956-ed1f32525499",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce03b995-33b6-4932-a3c3-ad0b9c7b6021",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5bfb0cf5-0887-4f74-a583-4dab50d2d51f",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da05562d-bb9f-4c6b-b4c0-88c47877e23a",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da017dc0-ad38-44a8-8f2c-517cecb946a6",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "edb5e4f2-befd-4e88-bf0a-42c839eaa770",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78b98cf3-f320-4f55-9529-dc70405eab1f",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bebc4461-8e94-4a3d-8d78-736f9c7078de",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3657ef34-ab42-4f08-8f08-f6687bc8d759",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53e0a654-8db7-427a-92be-93bd131f0853",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0fdb0e6-67b5-4ae6-86c1-1783aa7cdbbb",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e9d3b6d2-1049-438b-8e2e-db1692af3da5",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "675edb79-692a-4cba-a264-2c690069b57d",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95e7b18d-54a6-45ed-8fba-2927a2c2bb27",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07c4e833-6a61-4c57-956d-c3e7a199b9f0",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dca94f9c-6ca2-4957-b00a-f63f2246de70",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6aa6c2ff-526a-4010-9086-fe93b7b03022",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d61a9680-7124-49e7-9fef-7fbe87f6f150",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ffc4611-c4b6-45ee-a450-f8e3eb2e6af3",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5d17e79-55a4-4986-8986-c6693b5d95da",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14e175d3-7247-447e-bd7f-e4c6d215c55e",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a73122a-dd49-4fa5-83c9-f43c28eee058",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b4558ae-2b35-4236-9564-37e867c8eae6",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a30fab2b-fea1-40e5-b1b5-8dc9a8e5813d",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86e12ba8-a9c8-4585-b7cf-2733d094f012",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e787c06b-2f81-4eb2-922b-c04011580e2d",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "944f33ec-3dcb-431a-9ec1-a146bd0877ac",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "2aad37e0-7ac7-4c36-b9d0-bc729377639a",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\n       aggCustomer.default_account_id,\n       aggCustomer.name as site_name,\n       (1000 + site_id) as site_id,\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\naggCustomer.customer_fullname,\nco.name,\naggCustomer.currency,\naggCustomer.created_at,\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\naggCustomer.date,\naggCustomer.YearMonth,\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\nend as rate,\nMaxDep.LastDepDate,\nMaxInv.LastTimeInvestment,\naggCustomer.tr_id,\naggCustomer.origin_type,\nMinDep.FTDDate,\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\naggCustomer.user_id,\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\naggCustomer.deposit_curr,\naggCustomer.deposit_usd,\naggCustomer.cashback_curr,\naggCustomer.cashback_usd,\naggCustomer.withdrawal_curr,\naggCustomer.withdrawal_usd,\naggCustomer.withdrawal_curr_new,\naggCustomer.withdrawal_usd_new,\naggCustomer.cashback_withdrawal_curr,\naggCustomer.cashback_withdrawal_usd,\naggCustomer.withdrawal_fee_curr,\naggCustomer.withdrawal_fee_usd,\naggCustomer.chb_curr,\naggCustomer.chb_usd,\naggCustomer.inactivity_fee_curr,\naggCustomer.inactivity_fee_usd,\naggCustomer.overnight_fee_curr,\naggCustomer.overnight_fee_usd,\naggCustomer.fees_curr,\naggCustomer.fees_usd,\naggCustomer.pnl_curr,\naggCustomer.pnl_usd,\naggCustomer.swap_curr,\naggCustomer.swap_usd,\naggCustomer.contract_usd,\naggCustomer.rbonus_curr,\naggCustomer.rbonus_usd,\naggCustomer.cancelled_bonus_curr,\naggCustomer.cancelled_bonus_usd,\naggCustomer.pending_bonus_curr,\naggCustomer.pending_bonus_usd,\naggCustomer.fixed_balance,\naggCustomer.fixed_balance_usd,\naggCustomer.negative_balance_fix_curr,\naggCustomer.negative_balance_fix_usd,\naggCustomer.NetdepCurr as NetDepCurr,\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\naggCustomer.NetDepUsd as NetDepUsd,\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\nb.balance as CurrencyBalance\nfrom\n(select\n\tt.*,\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastab < 0\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\telse @RealABAccHelp := @RealAB\n\tend as RealABAccHelp,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastabusd < 0\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\telse @RealABAccHelpUsd := @RealABUsd\n\tend as RealABAccHelpUsd,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\twhen @lastId = t.id\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\telse @realreal := @RealAB\n\tend as RealAccountBalanceAccumulatedCurrency,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\twhen @lastId = t.id\n\t\tand @RealABUsd + @lastabusd > 0\n\t\tthen @realrealusd:= @RealABAccHelpUsd\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\telse @realrealusd := @RealABUsd\n\tend as RealAccountBalanceAccumulatedUsd,\n\tcase\n\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\telse @RealAB\n\tend as RealABDiffCurrency,\n\tcase\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\telse @RealABUsd\n\tend as RealABDiffUsd,\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\n\t@lastreal := @realreal,\n\t@lastrealusd := @realrealusd,\n\t@lastab := @RealABAccHelp,\n\t@lastabusd := @RealABAccHelpUsd,\n\t@lastId := t.id,\n\t@lastrealpnlcurr:= @realpnlcurracc,\n\t@lastrealpnlusd:= @realpnlusdacc\nfrom\n\t(\n\t\tselect b.id,\n              b.default_account_id,\n              b.brand_id as site_id,\n              brand.name,\n              a.id as tr_id,\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\n\t\tb.user_id,\n\t\td.code as currency,\n\t\ta.origin_type,\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\n\t\tcase when d.code = 'USD' then rates.USD\n\t\twhen d.code = 'EUR' then rates.EUR\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\n\tfrom\n\t\ttransaction_record a\n\tleft join (\n\t\t\tselect b.id,\n\t\t\tb.amount,\n\t\t\tb.wide_currency_amount,\n\t\t\ta.realized_at\n\t\tfrom\n\t\t\ttransaction_bonus a\n\t\tinner join transaction_record b on\n\t\t\ta.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 1) rbonus on\n\t\trbonus.id = a.id\n\tleft join (select b.id,\n\t\t\t   b.amount,\n\t\t\t   b.wide_currency_amount\n\t\tfrom\n\t\t       transaction_bonus a\n\tinner join transaction_record b on\n\t\t    a.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n       left join brand on brand.id = b.brand_id\n\tinner join trader_account c on b.id = c.trader_id\n\tinner join currency d on c.currency_id = d.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\n\tleft join (select 1.1448 as EUR,\n1 as USD,\n1.3108 as GBP,\n'2019-01' as ym\nunion\nselect 1.1376 as EUR,\n1 as USD,\n1.3263 as GBP,\n'2019-02' as ym\nunion\nselect 1.1224 as EUR,\n1 as USD,\n1.3021 as GBP,\n'2019-03' as ym\nunion\nselect 1.1214 as EUR,\n1 as USD,\n1.3038 as GBP,\n'2019-04' as ym\nunion\nselect 1.1197 as EUR,\n1 as USD,\n1.2637 as GBP,\n'2019-05' as ym\nunion\nselect 1.136 as EUR,\n1 as USD,\n1.2691 as GBP,\n'2019-06' as ym\nunion\nselect 1.1071 as EUR,\n1 as USD,\n1.2152 as GBP,\n'2019-07' as ym\nunion\nselect 1.1009 as EUR,\n1 as USD,\n1.2157 as GBP,\n'2019-08' as ym\nunion\nselect 1.0899 as EUR,\n1 as USD,\n1.2287 as GBP,\n'2019-09' as ym\nunion\nselect 1.1157 as EUR,\n1 as USD,\n1.2937 as GBP,\n'2019-10'as ym\nunion \nselect 1.1019 as EUR,\n1 as USD,\n1.2928 as GBP,\n'2019-11' as ym\nunion\nselect 1.1124 as EUR,\n1 as USD,\n1.3351 as GBP,\n'2019-12' as ym\nunion\nselect 1.1095 as EUR,\n1 as USD,\n1.3205 as GBP,\n'2020-01' as ym\nunion\nselect 1.1089 as EUR,\n1 as USD,\n1.3181 as GBP,\n'2020-02' as ym\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\n\twhere\n\t\tb.is_test = 0\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\n\tgroup by\n\t\t1,\n\t\t3,\n\t\t2,\n\t\t4,\n\t\t5,\n\t\t6,\n\t\t7,\n\t\t8,\n\t\t9,\n\t\t10,\n\t\t11,\n\t\t12\n\torder by\n\t\t1,\n\t\t6,\n\t\t5\n\t\tasc) t\ninner join (\n\t\tselect @lastab := 0,\n\t\t@RealABAccHelp := 0,\n\t\t@lastRealABAaccHelp := 0,\n\t\t@lastId := 0,\n\t\t@realreal := 0,\n\t\t@lastreal := 0,\n\t\t@RealABUsd := 0,\n\t\t@lastabusd := 0,\n\t\t@RealABAccHelpUsd := 0,\n\t\t@realrealusd := 0,\n\t\t@lastrealusd := 0,\n\t\t@netdepositcurr:= 0,\n\t\t@netdepositcurracc:= 0,\n\t\t@netdepositusd:= 0,\n\t\t@netdepositusdacc:= 0,\n\t\t@realpnlcurr:= 0,\n\t\t@realpnlcurracc:= 0,\n\t\t@lastrealpnlcurr:= 0,\n\t\t@realpnlusd:= 0,\n\t\t@realpnlusdacc:= 0,\n\t\t@lastrealpnlusd:= 0,\n\t\t@currentrate:= 0) v) aggCustomer\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\nleft join trader_account b on aggCustomer.id = b.trader_id\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c70b",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oISZYo/jnBBiedN+eL7iEVmicVz5zdJvnkTnDpGXX+jM3jkWwQH1GDq4EovBiX29q5VS6x+Z07G9BXJJzwZT+nGfZWcVbeOv81/ipF/iAkEydLA1qCoilSMT7qJlQub6SW5eExTvv+75JqKLkCs/jkkYjDgSKl1b0MSB6ZMr8WT",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "bb89c747-716c-4e51-b037-4f23809ea479",
            "fullname": "MySql:daf039b3-f3a3-48cc-b991-8256f7159a1b",
            "type": "extract",
            "name": "daf039b3-f3a3-48cc-b991-8256f7159a1b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8ccd8551-6f16-45ec-a8b6-a9f393f385aa",
                        "id": "tq_DbuXkIaR9",
                        "name": "TheWealthCore_RealAb",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a14c6145-2b0e-44e7-bfaf-0be856faefa2",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d2d45aea-21f3-43ef-8e06-c51259a67fa0",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba7213f7-3724-4dd4-8607-acbec6aa69cc",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b29abc5f-aba8-4442-894d-508e03706365",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "688b64b8-f9bd-4c33-a2e2-4f0e6e1d9a2d",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42d5490d-940f-471f-8dca-98207a7325ae",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b0816e5-f1f0-48d7-99d1-b112afaf6760",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32c4963b-8813-4b9f-960e-cbc15aff6251",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f2aa3d77-0242-4138-876b-705fc1fda518",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cf07125b-1cab-48af-b50a-c38efc6eac38",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a51ef2d6-7a72-46e2-8b92-7640fc7a2187",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4b4ea60-fccf-44d4-b1fa-cb4c12d82ed7",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "031564d1-d879-412e-a2cd-0833ee10fd81",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2ce1af11-ba7a-4340-bdbd-b91e9e863848",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "81545ade-6758-4022-b4e7-b9b4b81d16e6",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1026fd1-73b8-4756-a4df-e441aadd66bd",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e654fbc-56c6-4563-902f-fb6201b17d12",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "67bf0afd-6694-4f49-9ff9-ea04fdccfeaa",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3f0e97a0-3cc5-4da1-bfd8-ebfc1efce35d",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "051c6b41-b2bb-4562-b6e0-3f3a601409df",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1f27f14-91ac-4afc-bb6c-56863ef9af95",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae10c8fe-d4b1-4468-bbf2-6a2ada6ef83a",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30d3a495-7b4f-4a20-966a-0ff953400eab",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "577f4e50-f886-4445-8929-5ca5d90ad1f2",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2fe8abd4-6cda-4b1c-a309-b2755787302b",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c0d221d3-8623-4d93-be4a-fe16744f9392",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "637f8896-8a2b-4340-be78-7deeef2f77fe",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3f225c7-f42e-46ca-be2b-d3434f83b9fb",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2fb9dfbf-3ad5-4445-953d-c9deb3634645",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4245f2be-802e-4cba-958b-02e428f09713",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "97db1ef2-040b-45bc-b0a5-388d2f451c1e",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88ad7f46-d9c8-4570-9e40-5263123a9013",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "31771d6e-6759-410f-a84e-c97d518a3d0a",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee9f8258-4722-4d4c-a0b5-f4f8182856ab",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0071b2df-7f06-41cb-993c-b52aaffb0643",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "777a3ae8-5fd2-4039-af5a-b0afbd276091",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1792f46f-3385-4cfc-bb54-b4865102e038",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b3881f9-4cda-43af-b848-cbc13f8046b3",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ec24d9ba-509e-43cd-a3af-c4efbe98d1d7",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e631a31-0e75-4c8c-af51-ce36c38c14dc",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e853f2b8-bfd1-4265-b287-00e3a8db2fb5",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "39c2a880-324f-475f-82bb-6bace6316ea3",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8ac71685-eb01-4366-bf1e-ab9fe4f3aa99",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3e31402-2fee-4d79-b3bb-0b58a10938c7",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b6168676-8fd9-4838-930e-449f12efa953",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "95c40bc3-78f1-4f23-b74a-9536b9a998ce",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f91ff8a1-6b23-470e-b89f-37c71309d14d",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6c810ef3-1cc8-44c2-a4d2-44ca044150b9",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b2e9f25-9946-40aa-a990-d4a241fa1b02",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f86b1b2e-39f1-4328-b863-736360896cbb",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ff8824f8-1830-4c7d-bbaa-4005f0d99d4c",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "117a0a8a-8e2c-45c3-9f1c-29b0c4b6cc70",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "59876e6e-c7db-48e8-8631-699b8130411f",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "96197cb4-f12c-416c-907c-76bed1c6300d",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6554ce3b-f4a2-4ca1-b9c5-0d6bcebe1e88",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6817a6f7-5040-4839-86a7-6ed0b3763c04",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fd3c03fa-7868-435b-ac12-266e48ca017f",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b69acc4-3cd7-4c98-9380-b4d04882ece3",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8deee7eb-c624-476f-9508-9cbe4efa56c4",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b027eaed-25f1-4fe7-81ac-26e93a99273c",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c79824ce-40b2-4057-9b01-1b9226907ab5",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "27a8bec1-f087-454a-aa13-e46e88656db4",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bfcdaf05-9f8c-4fc2-9ebc-76832cee4472",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cc204aec-188a-477a-b961-efda7bae0c29",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "abff90ba-ff88-472f-a544-f07cbd174b6e",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cca52ea9-493d-40a1-9560-c507760f3758",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01673bc4-6cf1-4ebc-a4e5-a34428c6bb75",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "903c621c-f22e-4096-b19c-2969b3b81dcc",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2ada0cc9-92b1-480e-9737-04bf7f5bc41c",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "cf07125b-1cab-48af-b50a-c38efc6eac38",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "ebe5b599-e694-435f-bd62-3271341ef8af",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\n       aggCustomer.default_account_id,\n       aggCustomer.name as site_name,\n       (1000 + site_id) as site_id,\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\naggCustomer.customer_fullname,\nco.name,\naggCustomer.currency,\naggCustomer.created_at,\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\naggCustomer.date,\naggCustomer.YearMonth,\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\nend as rate,\nMaxDep.LastDepDate,\nMaxInv.LastTimeInvestment,\naggCustomer.tr_id,\naggCustomer.origin_type,\nMinDep.FTDDate,\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\naggCustomer.user_id,\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\naggCustomer.deposit_curr,\naggCustomer.deposit_usd,\naggCustomer.cashback_curr,\naggCustomer.cashback_usd,\naggCustomer.withdrawal_curr,\naggCustomer.withdrawal_usd,\naggCustomer.withdrawal_curr_new,\naggCustomer.withdrawal_usd_new,\naggCustomer.cashback_withdrawal_curr,\naggCustomer.cashback_withdrawal_usd,\naggCustomer.withdrawal_fee_curr,\naggCustomer.withdrawal_fee_usd,\naggCustomer.chb_curr,\naggCustomer.chb_usd,\naggCustomer.inactivity_fee_curr,\naggCustomer.inactivity_fee_usd,\naggCustomer.overnight_fee_curr,\naggCustomer.overnight_fee_usd,\naggCustomer.fees_curr,\naggCustomer.fees_usd,\naggCustomer.pnl_curr,\naggCustomer.pnl_usd,\naggCustomer.swap_curr,\naggCustomer.swap_usd,\naggCustomer.contract_usd,\naggCustomer.rbonus_curr,\naggCustomer.rbonus_usd,\naggCustomer.cancelled_bonus_curr,\naggCustomer.cancelled_bonus_usd,\naggCustomer.pending_bonus_curr,\naggCustomer.pending_bonus_usd,\naggCustomer.fixed_balance,\naggCustomer.fixed_balance_usd,\naggCustomer.negative_balance_fix_curr,\naggCustomer.negative_balance_fix_usd,\naggCustomer.NetdepCurr as NetDepCurr,\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\naggCustomer.NetDepUsd as NetDepUsd,\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\nb.balance as CurrencyBalance\nfrom\n(select\n\tt.*,\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastab < 0\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\telse @RealABAccHelp := @RealAB\n\tend as RealABAccHelp,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastabusd < 0\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\telse @RealABAccHelpUsd := @RealABUsd\n\tend as RealABAccHelpUsd,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\twhen @lastId = t.id\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\telse @realreal := @RealAB\n\tend as RealAccountBalanceAccumulatedCurrency,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\twhen @lastId = t.id\n\t\tand @RealABUsd + @lastabusd > 0\n\t\tthen @realrealusd:= @RealABAccHelpUsd\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\telse @realrealusd := @RealABUsd\n\tend as RealAccountBalanceAccumulatedUsd,\n\tcase\n\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\telse @RealAB\n\tend as RealABDiffCurrency,\n\tcase\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\telse @RealABUsd\n\tend as RealABDiffUsd,\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\n\t@lastreal := @realreal,\n\t@lastrealusd := @realrealusd,\n\t@lastab := @RealABAccHelp,\n\t@lastabusd := @RealABAccHelpUsd,\n\t@lastId := t.id,\n\t@lastrealpnlcurr:= @realpnlcurracc,\n\t@lastrealpnlusd:= @realpnlusdacc\nfrom\n\t(\n              select b.id,\n              b.default_account_id,\n              b.brand_id as site_id,\n              brand.name,\n              a.id as tr_id,\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\n\t\tb.user_id,\n\t\td.code as currency,\n\t\ta.origin_type,\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\n\t\tcase when d.code = 'USD' then rates.USD\n\t\twhen d.code = 'EUR' then rates.EUR\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\n\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\n\tfrom\n\t\ttransaction_record a\n\tleft join (\n\t\t\tselect b.id,\n\t\t\tb.amount,\n\t\t\tb.wide_currency_amount,\n\t\t\ta.realized_at\n\t\tfrom\n\t\t\ttransaction_bonus a\n\t\tinner join transaction_record b on\n\t\t\ta.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 1) rbonus on\n\t\trbonus.id = a.id\n\tleft join (select b.id,\n\t\t\t   b.amount,\n\t\t\t   b.wide_currency_amount\n\t\tfrom\n\t\t       transaction_bonus a\n\tinner join transaction_record b on\n\t\t    a.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\tinner join trader_account c on b.id = c.trader_id\n\t       left join brand on brand.id = b.brand_id\n\tinner join currency d on c.currency_id = d.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,68,76)) withdrawals on withdrawals.id = a.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,68,76)) withdrawals_cashback on withdrawals_cashback.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,68,76) and b.status = 'completed') deposits on deposits.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,68,76) and b.status = 'completed') cashbacks on cashbacks.id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 5) withdrawal_fees on withdrawal_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\n\tleft join (select 1.1448 as EUR,\n1 as USD,\n1.3108 as GBP,\n'2019-01' as ym\nunion\nselect 1.1376 as EUR,\n1 as USD,\n1.3263 as GBP,\n'2019-02' as ym\nunion\nselect 1.1224 as EUR,\n1 as USD,\n1.3021 as GBP,\n'2019-03' as ym\nunion\nselect 1.1214 as EUR,\n1 as USD,\n1.3038 as GBP,\n'2019-04' as ym\nunion\nselect 1.1197 as EUR,\n1 as USD,\n1.2637 as GBP,\n'2019-05' as ym\nunion\nselect 1.136 as EUR,\n1 as USD,\n1.2691 as GBP,\n'2019-06' as ym\nunion\nselect 1.1071 as EUR,\n1 as USD,\n1.2152 as GBP,\n'2019-07' as ym\nunion\nselect 1.1009 as EUR,\n1 as USD,\n1.2157 as GBP,\n'2019-08' as ym\nunion\nselect 1.0899 as EUR,\n1 as USD,\n1.2287 as GBP,\n'2019-09' as ym\nunion\nselect 1.1157 as EUR,\n1 as USD,\n1.2937 as GBP,\n'2019-10'as ym\nunion \nselect 1.1019 as EUR,\n1 as USD,\n1.2928 as GBP,\n'2019-11' as ym\nunion\nselect 1.1124 as EUR,\n1 as USD,\n1.3351 as GBP,\n'2019-12' as ym\nunion\nselect 1.1095 as EUR,\n1 as USD,\n1.3205 as GBP,\n'2020-01' as ym\nunion\nselect 1.1089 as EUR,\n1 as USD,\n1.3181 as GBP,\n'2020-02' as ym\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\nleft join (select ftr_id, system_currency_vol from trader_account_position) contract on contract.ftr_id = a.id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1,\n\t\t3,\n\t\t2,\n\t\t4,\n\t\t5,\n\t\t6,\n\t\t7,\n\t\t8,\n\t\t9,\n\t\t10,\n\t\t11,\n\t\t12\n\torder by\n\t\t1,\n\t\t6,\n\t\t5\n\t\tasc) t\ninner join (\n\t\tselect @lastab := 0,\n\t\t@RealABAccHelp := 0,\n\t\t@lastRealABAaccHelp := 0,\n\t\t@lastId := 0,\n\t\t@realreal := 0,\n\t\t@lastreal := 0,\n\t\t@RealABUsd := 0,\n\t\t@lastabusd := 0,\n\t\t@RealABAccHelpUsd := 0,\n\t\t@realrealusd := 0,\n\t\t@lastrealusd := 0,\n\t\t@netdepositcurr:= 0,\n\t\t@netdepositcurracc:= 0,\n\t\t@netdepositusd:= 0,\n\t\t@netdepositusdacc:= 0,\n\t\t@realpnlcurr:= 0,\n\t\t@realpnlcurracc:= 0,\n\t\t@lastrealpnlcurr:= 0,\n\t\t@realpnlusd:= 0,\n\t\t@realpnlusdacc:= 0,\n\t\t@lastrealpnlusd:= 0,\n\t\t@currentrate:= 0) v) aggCustomer\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\nleft join trader_account b on aggCustomer.id = b.trader_id\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "c25a8733-36b1-4cbd-aff3-e9baaf1b3ff0",
                        "id": "tq_oQoWE61LU",
                        "name": "TheWealthCore_open_positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "7fc08f83-28be-475b-aeb0-57881533e896",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba38489e-b75d-432c-a5ae-3178e4bd895b",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42b7a497-62a8-4f27-a3d7-72c1f3816850",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8a9e393a-a07f-48f3-9587-cbaedcc6be28",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "390a728c-0d2b-442e-b731-02720545a559",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "87da8a44-5537-4805-9562-b7616152679a",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f5a73774-5e05-41cc-932d-1cdcb3e60c1a",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "036321d5-df4e-49c8-b92f-7a1bf301322f",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e1971c3-c58d-4ce7-ab37-0628740c591d",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "6e516adb-84c7-4988-a218-cc9521de8a61",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend) * (-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c70d",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFGeJv+29GMau5bsRJvrdsSZzLpCamV/EZtB0tOn3UiTkfEdBWBnBcIuotj9y1SfLA7+AQXAOy8oF31KEpdelTX7r18oo2G/kOI8SzM55/XVfOKjxYQ9olMr/vMXf2a4xGQ==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "bcaf4b86-ed4d-4d89-aba8-841adced1174",
            "fullname": "MySql:d9b82868-152e-4f2e-9507-ce4f304d692a",
            "type": "extract",
            "name": "d9b82868-152e-4f2e-9507-ce4f304d692a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "fc16ca49-a06d-42ca-863a-a890680e3fe1",
                        "id": "tq_QiLbScU3I",
                        "name": "BigBitMarkets_Customers",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "126cb37b-645f-4581-bddb-61c291e63d4d",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f1c1f6a-1eb4-4703-95b5-14a5c6088db8",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "080368fb-8004-460f-9c77-858f6af8e452",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c7e5c06-f91e-4167-8c94-a59542c9e0f0",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4e983dc-963e-436b-8c02-e792d867a0b1",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07df8ace-149c-4a91-adf4-1e4666e8156f",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b53feae2-2e9a-404f-84bb-9e7e26507c72",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c8f99a4-4944-41ba-aa64-4cf0736384a8",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "379ddc95-f581-4e04-b109-70a46595c627",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "677c83b9-5fc2-4ace-81bf-833df844ec1d",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "667e0865-aa21-4820-9761-ccfa6a923970",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2906d84f-bb52-493c-89fe-e35aa08e1a0f",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4065ff6c-faa0-4d54-9c2b-f162fc3c263c",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c1e69e7-69aa-4298-a095-0e7c59c53e60",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5acfe3ab-bb58-47f2-b982-df206f9b4ca2",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d52af7d7-4fe4-47be-a5c9-441dad1a8a85",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ef74251-7e45-42ba-b69d-c578bae09061",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58f02d4f-6f04-418b-9975-e3352605ad11",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6bf1110-c971-4264-bf51-1ee290c5d8ff",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ae4f6d1-4efd-4500-ad83-203590a15f4e",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c725b5fb-695f-4d15-9a06-db65e53f763d",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cf79f08-87b3-4c83-9b62-98f2de804579",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb41c5c8-f886-4627-bb87-14e793d85cb0",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa944e9c-2e1e-4555-a707-da7c8738d0cd",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b586ca2-c290-42e9-b5a4-d8e61069c318",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "67ad2f55-1cd7-4c5b-9c08-077116c49d69",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3630ddb-9f22-4810-a240-e6895857cba9",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "28ad4468-7702-4c1f-bc07-cbd2413cb4f8",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "adc77961-0add-47a8-90be-94c552216326",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5796c917-dd9a-4f67-a268-174f4d29e1e0",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45d1de04-dc5a-465f-9b87-df94e81783af",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "435a682b-fe6b-47f3-ac98-7bcad0f8903b",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d196797-4647-43af-972b-9e8efd991e08",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f9b37bf-f999-4d2e-aaee-2a7ef4a323db",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d53c3436-1e42-4556-82a9-c6c830fe0a7e",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "435ab067-fcdc-46a9-842c-f835cc61f774",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be6f14a1-fb15-4b34-8d0a-cb40587a569b",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c13a42d4-cb6b-407b-a330-be998cc41ac8",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "40a2e105-18f5-4f09-a848-92369c316e7b",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "964f06ab-76c2-4959-bbb1-13838b34a5be",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d84b7e82-912d-46e7-a3f9-8a9238b342cc",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76501b20-baf8-4fea-bde8-5d7484e8584b",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b19b1a36-544d-43df-bcc2-7a20092bd2a9",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "57654cbb-7621-4ae7-9904-196c368d0dd3",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a09b5db-ae68-465b-8b5f-f8c26f7dc320",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "484e876b-ea3d-44ef-a3a3-eb0cd5d9c3ce",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9866b094-d567-49ed-a1dc-ec7dbc4607ec",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16cc39d5-eb5f-473b-be6e-ee5c54b33cdc",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a882fe96-be92-4e21-9620-ccc022ce5979",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73e7ca58-6a3f-4d70-a956-aac9db1a8e21",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bfbbbbb4-7581-402e-a0b2-ca5c56fff15e",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5d86cee-64de-477b-a1eb-9e65bc05da3f",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac6699dc-03e7-4297-ad00-c80bc4e30c7b",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea20ee64-7b3c-47ac-839a-570a77ccf15c",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d9cde13-1a77-43c6-baf3-bd789205a2c9",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20ee5526-d485-4dbb-947c-3a81f0a6e930",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91aa0cce-394d-4bfe-b084-4dd7a4320869",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "170ea111-2b18-4689-8de8-8ba8e55ddf2d",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8809066a-ddbf-485c-a0a1-5f15615bfb82",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f620f50f-2475-4bee-9e49-2738daee8a24",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49cf80fb-0bc1-4581-899b-d553af850c16",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d86833ec-7a74-4e21-824f-b60198b23b51",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "1d196797-4647-43af-972b-9e8efd991e08",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "5a74238e-37b6-4716-9b43-fae4f26edebe",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id <> 24\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) <> 24\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0e89fb43ad1002c7a7593",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c0d9f259-794e-4db9-b8e2-5c90de2002f6",
            "fullname": "MySql:c459792c-46b7-4a3a-87b8-46555c8ef014",
            "type": "extract",
            "name": "c459792c-46b7-4a3a-87b8-46555c8ef014",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "5e30930f-7196-4ebc-8a29-aea2e1ad7ef9",
                        "id": "tq_ym0L58GWr",
                        "name": "PrimeOT_Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1bfdbcaf-378d-4c09-9ec1-4c4fdab25b88",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7ca3709b-f52b-4102-917c-3be8efaabb13",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41623778-4a8d-43de-bb08-57fc7c3f9ace",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c02c5767-06dc-4144-a04a-4483474adb6d",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6109f5b6-ed93-423b-9988-49106686b8f3",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "33864ed1-858c-4cc9-ad3b-b088f7832db4",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand_id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand_id,'1002'), '10002', trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\ninner join trader on trader_account_position.trader_account_id = trader.default_account_id\ninner join brand on trader.brand_id = brand.id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5358a56da002c36c715",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CLQO1pn40szcYNg2rZoiX1Vg29Vp5lwLqTDoBiPX74Z7tq4A1c99blLl+UTfHxXxv3fHMdNaD6ZQ0AYwLSELF3A=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c22b8ead-d08f-4256-8800-e33de3a63272",
            "fullname": "MySql:a6a1f47f-ef43-4e85-a296-2bab2a2eb685",
            "type": "extract",
            "name": "a6a1f47f-ef43-4e85-a296-2bab2a2eb685",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0ed4e80b-5899-4ec8-abfe-f6a62fc26c22",
                        "id": "tq_XA7az5Rbu",
                        "name": "BendigoCoins_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "56ce8cf7-edfa-422d-98b4-25be6a4525e5",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "741be818-1c19-4183-b34d-d4a45cd7b069",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6b664ac-6230-4fe0-aa75-ef095d520e37",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a31efb9d-d01f-4369-9fb0-413931c100f6",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bca8bd5b-8071-494a-af17-cf99f011bf9f",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "fd3481a9-e4af-402e-9680-b0cdd23d8739",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 \r\n"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171349455f384002cf1020c",
                "provider": "MySql",
                "parameters": "FhwKndxsEm4karcTRhcRhQ31JuodaLCOkLCPAL5UDyKQmplY4PGQirEicte+5XlO7CmeguqIciMcA3dWSPlLRdyZQQBa8rSl7481iBoEVleEKNnY0oZY59Uua0u3yiz/U5itDzyqwT3hV27JP+osZrKYLMelBUn+F7vnCn46CtacVjNzMfL/BmkfA2U0DhrLnI0aG8HaWhblMUs9PMPHSLPgZ1yWRCKlfMFEAtsVU51Jg4PyWiAT5+nvRZJBKlUf",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c39fb28f-802f-456c-b48d-a52349eac86f",
            "fullname": "MySql:0562803a-dcf2-4e19-bd3a-27fd897360dc",
            "type": "extract",
            "name": "0562803a-dcf2-4e19-bd3a-27fd897360dc",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "433905e1-daa3-42d2-b581-f17645597374",
                        "id": "tq_50asnPtWO",
                        "name": "MarketCGEmployees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "57d66997-93ad-4946-94ec-b7fac17bf651",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1026af48-c911-43c3-807b-313ed29d2300",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35e9c31a-df0b-44c4-b97a-6439ae20370e",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2a71334-5903-4383-9472-b16ca3d92ef3",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "543ee9a8-deae-42c9-bf81-89b05bc53317",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e6eca9d-a1da-41a0-bc8b-1cc6a6b037e9",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd705b42-8e78-424c-af69-1f993b782e07",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10ef7d49-221a-4d58-9177-3cb4dd25916d",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2074c030-6769-497e-b3f0-e328ebc59641",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "208355e7-82b6-4b0e-9cbb-8d9fedf880da",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "c80670c7-5c7b-441b-943e-6c6824b8dd31",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506776780f2002c37ecc3",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NAc1gMa0VBzZ9QDyN4mgrYY4RdbmC5kaicIuBKtyLx50isgKI42gk0NUhwNAOs/C+1ClXW3UC6yk8zdu2MLwnevpcBXSYS5lL8i4M0k06sUJIQFcjc1VnpGNQCbGzv+s0=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c3d3b887-9f00-47be-b02f-fe2bad6baee3",
            "fullname": "MySql:92f171e0-dc67-4083-9f18-194061629ce1",
            "type": "extract",
            "name": "92f171e0-dc67-4083-9f18-194061629ce1",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "da8d6827-802a-44d9-9950-9cc188dfc9ec",
                        "id": "tq_cwP23qgwf",
                        "name": "BigBitMarket_acc_types",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "2d64bd98-5c9a-483a-bab6-40c96b524156",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a9e2608-10a7-4b8c-ba7b-9164923f212b",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de89d3b3-ef35-4cc1-a40f-9bbcfde73b0d",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7932b85-fa49-4825-bfa4-518718a3a9f3",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c3e3240-9fc6-4825-a3ff-29e741e094a6",
                                "id": "active",
                                "name": "active",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "42859dcf-ed4c-4696-8ec1-8a290b2139ff",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 \r\n"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0e84bb43ad1002c7a758d",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c68dc059-c9a7-4f96-8e66-7301ca59ba44",
            "fullname": "MySql:9fbe7e70-a1db-4f11-8391-0246540fa89a",
            "type": "extract",
            "name": "9fbe7e70-a1db-4f11-8391-0246540fa89a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "72f5a0d3-dc08-4f40-aef2-8b7f1bfc19e3",
                        "id": "tq_fgDxVmTrs",
                        "name": "TheWealthCore_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f595998f-d241-47e8-bd5b-6e3b6c4b1838",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc2ef7e0-aaf4-497c-949d-a944974c507a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b0cd3b1f-bcb4-4c24-8599-4f6f7c9e92e1",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "76f9df56-058b-4063-aa36-d502e2ed0dbc",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c11cdb7a-33cb-451b-8081-dd9f8663f207",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "46b12c30-50f4-4272-b78f-6a1105ef2dc6",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6353eea7-33da-4f69-bd8d-4049d10e79c2",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3cec6679-46c5-456b-8f75-cc4f7eb66f51",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb5b99db-9470-45e2-9c70-4cac661b3fb3",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7bae07a-d3fa-4914-95b6-9c168b08e52e",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dc3e015c-f414-469d-b7cd-bacfb9693e3e",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "15689ac9-a527-496d-84a9-de87cd3bceb5",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53934ad1-608b-4cd2-bb36-2fdc780409c1",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd4bd7a8-a730-4a70-885d-41776e4fa034",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6a34ba9-14df-46f1-a0a3-b9d65d1e8811",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1dabcd98-49b2-463b-ae76-29036c3f4f6e",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d75e64ab-a73c-4b38-841c-dd4a94644f73",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "782e78c1-3afd-4377-93c8-78e5ba01f771",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2e415262-987a-4e95-86df-08b219e8b80d",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "adee2df6-a817-4634-a0f4-5357810b0109",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "15093aea-974b-4ef0-a735-d43b3368feb6",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "243aab9e-4516-4a18-9b1b-8ed080c9745d",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e1b74a6-fae0-4002-9e02-211c8b255ab8",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27d2c8aa-ba59-41d2-bb56-917800eb8cb0",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c93fd49-33f2-40b6-96ea-19525b43677b",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "003a5da3-ebec-483d-b0ed-ded8f9d8d206",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e922d0a-3faa-4f74-8b40-c755cb4c73e1",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc2021b3-1b32-4130-93f1-079cb1482871",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da76ee2f-9b0c-4c0f-b2e6-b2b7e43f2c37",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "428323f5-bbdf-4c5a-940b-564bcc86719e",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64d23566-8f16-45ff-b598-f719f93a0ecc",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a7d77c3-85f3-4600-a22b-a9894cecc3bd",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e4745f3-65b8-4080-9bae-bbdccdac3abb",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0b615023-17a9-485f-9294-cf7dd1575679",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c2a161e0-61c3-4e18-861b-bea31c139fe5",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "18534a8e-6646-4e9f-b602-aeeb81cb580b",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a7641cd6-e95f-466a-98f1-84cfd7f40eea",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5d66f0d4-5e13-4a0e-aa5f-e8e3a272cb95",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b4f1f6b6-a293-411d-b0ce-179ff8db17fb",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "796ae064-6c32-4122-8086-d43e67c9ab97",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89f0fa21-444c-4347-a7c2-01ec854a061b",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ffb07245-2884-4f30-99ff-e97b9684f268",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "616f31c2-efc5-4dd5-aad1-88c141b40869",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aba18b29-fe5a-44dd-84ed-669307d39037",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "13cddde8-0953-40d6-82b3-c2c23ac0b4e5",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "469ec4e7-aacd-4f13-8230-20f5e04b62de",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71a0c946-70b2-44cf-a52c-0650290596ad",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6bb2b5bd-9b06-4119-9813-1a6c365bfcbc",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "757a46f8-c5b1-4af1-bdc8-4a20a6f9caa0",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4289a9b4-21cc-44b7-81b4-7e62f44d9d7b",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4bd434f-42c9-4488-873c-79f03d70eb04",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89092575-4fc4-4282-928f-8cd89b4b2db0",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e4fab0d-9a05-4c57-be17-9e65c82db6e9",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9ea6ea88-472a-4b3a-915d-933a2b3be27a",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4da35b91-a931-4381-a2ae-1510e129e86f",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a5b75bc-0a7b-4779-9f08-3c7db9511ff4",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9446f7fa-f217-4e34-b9d9-54e635f43cf2",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2fead20-1a77-45a3-8804-d0a050c00a11",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a198178a-8ad6-4ea4-938c-46637d61c236",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a733e1ca-e8c5-4974-85bb-1c32928933a3",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f2c9be1d-8db7-4817-bcea-0aca242c9be4",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2bab7f99-237c-4b51-947e-581403932c2f",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "8e4745f3-65b8-4080-9bae-bbdccdac3abb",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "ee3451e9-19f7-475e-ac4f-87079bcbfc33",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_redeposit_1k,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\tcoalesce(transaction_deposit.payment_provider_id,0) not in (24,32,68,76)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,68,76)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619505016780f2002c37ecb7",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c6d371e9-f503-442d-a6e5-4f0000f492b9",
            "fullname": "MySql:feff4b1f-edd4-4100-ad31-63136a8229f8",
            "type": "extract",
            "name": "feff4b1f-edd4-4100-ad31-63136a8229f8",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "05719c12-cf85-471b-93f1-29aaa2c04c22",
                        "id": "tq_kA4dmKhPj",
                        "name": "GeniusIG_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c14d9093-e264-47e8-98bb-3d1e4d6501a0",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62eb6ebc-001d-4583-9d53-3e9b76b72253",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c881c7c4-4d39-4dfb-9c34-396728e6b37f",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30a2d36c-6e17-4cee-9227-449f60633290",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dfbc973d-e4d3-41ce-a3fb-15413e6e487d",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffdb82ed-bff8-44ad-83d3-1eec4d3e9cb2",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae2ed9ff-8bf8-43ea-996f-52493ff29a49",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9e1cd3e-5775-4dcb-8941-5d483b67c09b",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0eec9644-8999-478a-abae-91ee54a9174b",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5caf4ad2-509b-4f09-b4cb-1fd651478b21",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e542e70-6b98-462b-83dd-a19b7a8c5380",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "656ffd85-8dae-4596-badb-036854c9895a",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0f9096b-8569-4aa1-96cd-2592be409dfc",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14a82fe2-aeb7-4b41-a59e-916aecfaf5f4",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14bb6ab7-b324-4210-b38d-42a992b9ba8a",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8960dee-a95e-448c-aa2f-b7679d5797f5",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0cd8e03a-1d14-4207-89d9-8ae584cb01ed",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed97fc62-2956-40f9-a32b-c31410c0f197",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24624f26-4ce9-461a-9d07-0fe8ca4d1670",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee999f6c-70eb-4cdd-bf20-b524116c20f3",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac0b14b7-22b3-45bf-a71c-6d4fef183e1b",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5f9ce3e-7835-4ec9-9862-67550f836978",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8691c4a7-8ae2-47e9-a352-ebfded14f154",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60fd7199-71b7-4c44-92f4-3285a0a4924e",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c232d5a-3012-4698-99de-798b1ab01b07",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5af95bc7-4449-43ec-b961-3da9540c7fe0",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "279473c6-e270-4cbd-ac43-d52a85684e1e",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c31bc65-33a0-4361-abd2-fd051bc10e50",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a439f91-5e64-482c-aaf3-487692b356c7",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09fa442a-ca7b-4e3c-a7f0-41d7d9ce7ccf",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "311880dd-aa75-4f70-ad5a-a0ebce4fa48f",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28203a5a-9c35-46e2-8c63-a491ed2ef61a",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b90faaf-2fee-49c4-af82-0d15f1b462f3",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d9d905d-5bef-470c-978d-a92f615d5772",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aee18f1b-5cce-440f-bc63-112d0d982150",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0fe1732-f549-4da9-b463-b437d97ba6b4",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27d7d252-02cc-4eeb-b4a0-52cf108d945f",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d12d246-3154-488d-8175-f01e2c6b5355",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "724b0bc2-6a60-46c4-8bf3-4aa988f97e9d",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c56bdfd5-8e02-4470-99e2-8e267f03a9ea",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f5b55a7-2ba6-4086-ac7d-889173f28742",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b864b9e3-0d0f-40e7-9dca-ada4d1af02d5",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e466f093-6d49-491e-a6d6-a7f050861430",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c88efc81-7039-4b37-b158-21acca54a0de",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99cc7921-28e3-4048-9c77-23615bb32861",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78642693-f4f1-4299-9652-69e25e53a62a",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cb9b864-40a4-4c2a-ae11-2261d43603d1",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d76b7a5b-381e-4819-8a98-4712505a6e8b",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ee0898c-54f7-4153-be91-da6ed88b6206",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0627c8ad-8333-402c-9646-b4698bffe548",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02e10225-8350-481b-a6a0-61c0ba2bcb9b",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94327c72-5eee-48fc-96bf-22b24c199f0f",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f44065bc-d44d-4896-9e21-f7146511f55d",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16498c16-a517-4a2b-a3d3-9dbed767467e",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cbb58e8-35fa-476f-a465-f529bf2bcd2e",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5adff963-4a74-4e0a-857c-edc6a58e7341",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5a7b644e-c039-4a94-9c97-7cc2dd377b43",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 40,
                                "size": 69,
                                "precision": 69,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22d710db-54b7-4028-b9f8-434fb390c02c",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dcc534e-c36a-4e94-bc62-1bc2b8016325",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 40,
                                "size": 69,
                                "precision": 69,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b1a2ca2-caaf-4ae9-ad7a-fb5506363b06",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e93e235-9142-41e8-8cae-bef5e742df65",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6b00087-149b-4eaf-afc5-10bee15bef0c",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ecf89bae-ce79-4598-aa74-8f5c98d7fafe",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6570bda4-c205-4a1c-8792-9485628f8eac",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd30e34d-3173-4a2f-8f6e-d6889dbf7df6",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 64,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5088cca9-8292-4eef-be46-9be64edaba0a",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47fcbf47-bfef-43b3-864c-e39af2d66e21",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 64,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be0b328b-d0a2-475a-936c-d3b826f35dbd",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af19f2ee-21c0-410d-839a-528e2a04199a",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "5caf4ad2-509b-4f09-b4cb-1fd651478b21",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "0cc761aa-0c19-464a-95a5-3e3733157b95",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,70,78 )) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,70,78 )) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,70,78 ) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,70,78 ) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "618242445a2e6d002c168d8e",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCkM37LkFbGnRhmt2tYLFqO1gr0leFAbxvqr45h97aRL2uFXV6bnmXjrx+upQdOgFiG2n1XzowSr7ML18mjmQhnzqjq1V2FUQMfFFcLg11wwiXozn0iLcNZcjGmBoyCW6IdyK2k1UjDiKqlSqoJZSuzAb/GTm3+JvHrvJTMCSB28",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c781ad53-b3f1-4eb0-b857-70e6a48a1408",
            "fullname": "MySql:c86ea0f2-df90-4019-a7dd-f644fcb0f85c",
            "type": "extract",
            "name": "c86ea0f2-df90-4019-a7dd-f644fcb0f85c",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "478e0561-acca-4503-9b41-a6b5b564bfb2",
                        "id": "tq_sEnGWVD2q",
                        "name": "AigMarkets_acc_types",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f46dd2d0-f248-4c23-a56c-ddcff1b91590",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35d3b62f-178e-4594-be0f-d4fe0fdb78c3",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5561d68-4202-41dc-af19-a59a17334cdc",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "987ca3be-2829-4cbc-a8a6-f4e440692ec5",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c09c30c2-890d-447c-8ad2-79c171e7b8c3",
                                "id": "active",
                                "name": "active",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "dac51997-74d8-4c78-ae40-d65c7273aeb2",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 \r\n"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61b3439201d520002c42b1a2",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W9vffNlEo4jtdabftiKFBxfaaQsXoFhTTM7txEhG/jLu6CBekXY22hgN88Ng0fYauS48Rg4xTl4PvHqjVbcTS5Oi9FGQfbh1gOsBXF/HnXlsW+cFPRFDXzzbo/8B2c8RpAz/uBJmRSXztf22P/MxqCvTW1lgo5PsEnrOHIw69wgwh2HIjj4R4ChudbQMprFOPzxUtJA/laJ5YRHjGrRVKxa",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c794e015-f507-4e9a-80d8-5509db45336b",
            "fullname": "MySql:c37ceae8-8dc9-4d54-9b46-9c81aab72eb6",
            "type": "extract",
            "name": "c37ceae8-8dc9-4d54-9b46-9c81aab72eb6",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "5b18bc1a-9dcb-46d6-ab2c-b2852388f05a",
                        "id": "tq_gOTEUOnZx",
                        "name": "TradeTheBit_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "50380cc5-7d3a-4d51-8954-9717147a6640",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "462f0a10-57e2-4840-a389-7ad5acb65047",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8aafb7f2-f431-4124-acf6-47d441975d04",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ae4a133-897d-4db1-ad8d-92588a2fdd45",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28e378f1-f581-4caa-b594-fd4201570b13",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70c451f0-283f-486a-bbc5-b2c0cfc2092d",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a36e05d-ffda-408e-9e88-1aaa8cea1ae3",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c73168b-49d3-4417-a1ff-28a641490ff2",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38f8df8d-e34d-4acc-8cb5-8d3c9abb335a",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9fe18ab-56f8-4301-a0c6-6e022b3aa146",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "9a7c90c9-93fc-416e-a240-7ea09a7b388e",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506aa6780f2002c37ecce",
                "provider": "MySql",
                "parameters": "F954Cqx2+xpp7cv613X4To3KDLtYkIILY9DKa7o2J6iwT7Hhp/LuVGR7WVoXuAJR6pANxIXoQ9aWeJiI7OcJP72ZHBxG9xyN42erULpN5ZuqvWQ4Ab7IRfQ6FHGxrmIec/RVbJ5P1EBneN6L0WOHnZFugjR8UPuM7oh3rwSSnzvjLJFOJ0c2gxjMsXRaCgVGAB0Pjz5j/uHDcFPg85fyrANVftdnJomPKg7Rk6G5kbKEybu1E9znVlAXap1CpXX6",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c83719e9-657c-494e-947f-6fba0cde8a1c",
            "fullname": "MySql:10137d7b-da60-485b-861d-431b3e7cdcbf",
            "type": "extract",
            "name": "10137d7b-da60-485b-861d-431b3e7cdcbf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d39510b2-e847-49e4-a529-82bc6144131e",
                        "id": "tq_kKXt4PuCu",
                        "name": "Bitfinity_Customers",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "46e85801-5690-42fa-a0ff-f0eacd32d81d",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b21b5dd-f79e-4c86-9ebb-551e9a229f3c",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8267ddfa-c77a-4a59-90f3-d8d65a528f7f",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b62cc78b-d597-4d2e-8a85-d7fa9bcda592",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7def5e68-3865-4938-b211-2e670ce0b2cf",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a95cacb3-5e8d-4d6c-ba85-95978e7cd9cf",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2242c4e9-cdbe-4349-9430-ed2ce73398da",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03528af2-1aab-4da3-baed-86949eea2b9c",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "608c0f34-6f64-4999-92fd-e956f5288297",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e6cd4ee-95c6-404e-85da-c0592b8d9172",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e48b7cd6-b93f-4134-91e4-a12b3156749c",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3911f060-ca71-4985-b7e5-572f892c75c7",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc9104b7-b29e-433e-9e40-0cbe7b6aa4aa",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4df11da1-46bb-415f-8938-984faccfe69a",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b42c4c00-264e-42a6-a216-f8bd58987f42",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9b4262b-88f8-4566-ba18-9e6a02adac49",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bc90f47-44a8-4313-97aa-c14b10de28b1",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f167881c-5526-4bc6-b20b-9a90eb27ac4a",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46dc34fa-77df-4fe7-acf1-24852a05ccf1",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac6ec908-5777-453e-9c1f-58067d8d1e67",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b697548-45aa-4235-abbe-2aafae67819d",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97e2cf9b-0eba-426b-8ccf-7543c9058985",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d396d5f0-cddb-465a-a53c-00e0e7363159",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e8f475d-ec82-4901-b8e7-307b4eb1482c",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0dfe675c-97f3-41fb-b820-5a8f328001c3",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cc201834-7d24-4cc5-97c3-957030e70ab2",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1d2d68fc-906d-449a-b866-b540d49dae48",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb66be7d-0b0a-40c8-9bc7-2591cf151184",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccbfaa44-0925-49c0-9ede-8115e8f9eaab",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c6e7189-9424-4eed-aee8-98a588c2f898",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9083120-0b8a-451a-b06e-f00309ed3148",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13072ae6-60aa-465f-a5e3-cb74eaeac007",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "654617a7-1dd9-4000-bbf9-c3d9ead7a88f",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "405219cd-1687-4449-b5c0-bf613b67ceab",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "143bdbaa-30c7-41dc-85cf-6fda645999c5",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79557c57-4081-493f-87b9-1da8b1dfc5e3",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccf58496-b805-4295-899c-48df7ed8465b",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f7bab602-be99-46b7-8bf0-c9caec05e49c",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8b3f1fa-2fbf-4315-9e0e-c5e7699eb07d",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d79e9404-ee97-49e1-8fc2-f44133ad308d",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b210d7b1-e687-423a-a2f6-1f775f8b9a17",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3815914f-8fd7-4dc2-b342-65c9be6861bc",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32e6dfeb-0e87-46cb-8170-5b6e3bd63662",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "72aae9dc-7fb2-4c70-8bfa-47566bc2826c",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "54682d02-c8f5-4644-8156-b07336440f9f",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "476788b6-83ba-4e7e-812c-bacbecc4054e",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ae449e2-c2df-48b2-8be1-3ecd69ee3df1",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "180b51ad-46fd-4160-a307-3d9a49979fbb",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c583729-a378-4af4-bb96-c3e13fc7e771",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "36fd0bc5-3200-4cb9-84b0-cdbd8b31a741",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58d076c6-278e-4efb-b985-e782ed2b716c",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f32704f4-b862-4fa1-b57c-edb42345c241",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3ed13e2-fd66-443b-bc17-01289be76e69",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d53f7833-e1cc-4de1-ba47-98076ae22358",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "890296f5-886f-456f-8ade-be4dc9c29d2a",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "60f6400b-0bd4-42bb-8237-593d8f168eab",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07ff2114-fc08-4e03-80ee-14e8060a3866",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d065a0f5-b396-4ff4-b6f0-f33e7776c1ec",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cce1ec95-2c4d-4836-ab50-c90ee3754386",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "218301b6-ed83-4571-9e50-0302c71063d9",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1eed0daa-c7f9-4d57-b3df-ea36ea1bc05f",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "925ef45a-8b8d-4690-953f-f8feeb990008",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "654617a7-1dd9-4000-bbf9-c3d9ead7a88f",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "37d2fc5d-8e32-4912-862c-de48db05c58b",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619647813f1f2f002cf16c3a",
                "provider": "MySql",
                "parameters": "19x2eB8ph2aYc/juzRJhdXmHOGk/Q0LOo1mcPAZAkzQ0rOYfaoDxpFcxuWNBv7R5KV0O5tYU8i2V/PjWAUeDSLhONZ0UCFxUB12m91h1eHOHdzR+SB2d9VJoCcpD2m9S5HXy2q9B6RLuhWzexgEBZWWpbuLtRZNIioiIe+Aak0+UQZCbTaPF44h+UqblYtn0GbA9u96R0kzZhm8bt0OQY3NtWmYnwdwQiprKhRjTZlxlHYq4bo/AURRzeuo5J+ph",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "c949ef05-dd3b-4bbd-8298-0377b851dc75",
            "fullname": "MySql:205d8fe3-81c1-4358-ad5c-3e30e28ac6f6",
            "type": "extract",
            "name": "205d8fe3-81c1-4358-ad5c-3e30e28ac6f6",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5358a56da002c36c71d",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8OSfPYhJH5R3HPnPvPUq9ufFEejHbQ5noMM+s2I3j9hfV4ghZOttugRuXVbNWlMq51sPWEQ79B4SIfJgGwbgIEwugkCtRlhGLq4p5Jfb15dVDFMoI69c+dcUuN1SDyQ57I=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "cb554af8-9d06-4f99-9fe4-e0980cf928f9",
            "fullname": "MySql:e1056712-d2bf-44dc-ba50-bd68cd1e1b70",
            "type": "extract",
            "name": "e1056712-d2bf-44dc-ba50-bd68cd1e1b70",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8ce5c46a-1c8c-481e-9e9d-9cf8504e0c55",
                        "id": "tq_RxmQsnycx",
                        "name": "AigMarkets_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "14eb1945-99ef-47a0-8338-b76c2667f7fe",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a491a2e-9e81-479c-920b-bd97b6ae2382",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e0cc2da-1724-40c8-a69f-91ecd2ca43b4",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28b1452f-e2cc-4af0-af49-2c8d81244860",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8412f4b5-e0c3-4e32-a024-cdb5fe8b17ff",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98099902-0b75-48ab-88fc-3ecae3831d48",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35b35a59-80e9-46dd-8bcf-daf01a16724c",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5f5e518-a627-4eee-b641-94813ab030ee",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7514d94c-82ea-4a2f-9c3a-57fcc92bd55e",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0603895-eef3-45aa-b11b-6e87d51ac52e",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "556ec58a-7de4-46d4-b478-ee7b494a552d",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f384bb30-2040-4368-9df8-198bf804b8f3",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fcad97aa-dfa4-4e8f-8313-03087c8158fe",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d11de32f-4a22-4985-95a8-626d005b2030",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d19c45a-fa21-460f-84c9-9f4efd599be3",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41d8ec85-88a2-4b03-9966-5325cf13d5d9",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a79b949-6a3f-4014-a1bb-2fc6f1ec1e8f",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f68de7d0-9248-49f6-baaf-54cf0fd7b47e",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14fdd9db-af20-4a36-a241-67f449389464",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95b22ce4-37be-44f0-8567-513bd6f85bd8",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a33da87-f30e-4709-bcd0-01f7519819a7",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2aa3dd3b-9f82-429d-a644-99a34d51bb66",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b7a6772-485c-4567-993c-5d09f8973cf1",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02ed9b43-0389-40e2-99d3-f77d3f58520a",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0893fc3-ab98-4291-aaab-648af93db22b",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba2cfedf-6c3c-4c0e-859d-d5b235f967e4",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "feef7ffb-1610-4977-9ace-f4dd735bb465",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19d55f84-4e0e-477a-8330-24c540c2f9d3",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5227afdc-79fc-4b7c-b9e4-3a6977cea0ad",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2440f4b-4d50-433a-be07-d5ae8221bcd4",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b7a7446-cae0-4ec4-b2ca-8f2e111f196f",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6d1b7a2-aa23-4dc7-b3f6-62a81445cdb4",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51a6e3ef-783b-4dbc-95b3-29045796d43e",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8ad04c3-f5a5-4ea4-8749-4846a29b3f61",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbe9a2f0-f6bf-4b9d-b0d0-1088c96fe8e0",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ee1dbb2-bb9f-4b0e-a88b-ff6488b79d1d",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0719e2cb-9392-4c96-bc9a-9218a4c3b4c1",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "119c26bb-7992-4e16-92b8-3241daf7fc8c",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e65a1e6e-27a7-48bb-8934-435d0a8e1683",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 42,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "284de204-8db5-4224-95d0-e71e2dd3ff78",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d18ef15c-f5e0-4456-96db-693b5dc8c4da",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f6d2886-1190-4fab-ae5d-0cac0f95b3c8",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff20f686-3770-4d5b-a0c2-590bcd098cce",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3dd93887-98b8-46f7-b6d9-71a358bea258",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0cd8aa6-54f8-4b58-a4ff-da976705acfa",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 65,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19feea52-3ec4-4252-93be-fed6a1541b5b",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a66a99a-7313-4ac9-82bc-5ddb7bbf986c",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c31f5f3e-307b-464d-9a5d-56210c3f2f6f",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c06eb42-7bc1-4147-bb13-bee0d1187ef4",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41906531-daa3-49a1-bd9d-86b63780e34d",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8670a5eb-667a-4699-8014-e230a534be8d",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0511a60f-87cb-41d6-96d0-f1979ac1621b",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1e5f2e9-966e-4750-bb9e-9e6b809352fc",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb3ff3b0-63f5-42c6-9505-8155f2f65b92",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aceca15e-09a2-4f00-b979-a13d9c4037fa",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a603cf67-d5cb-448f-a430-873bcbb5dcbb",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 41,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de7eb120-8de4-43db-b062-21a5be8e68ce",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 40,
                                "size": 69,
                                "precision": 69,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "228f5374-26b2-4757-95de-8c15bd2e5ec5",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "608135a3-f517-45e2-a2fb-9b0b605f11f5",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 40,
                                "size": 69,
                                "precision": 69,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff69ed4a-1125-4706-840f-fa78410a35b1",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5a56ca39-3b2d-48a7-82c9-ca6da5f358d3",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c4a968f-dcb3-45a7-ae6c-1ce654f571b1",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc1c21d2-5ca9-4c6c-894a-e9ae326aa4fa",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 40,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4695ef6-b9a5-43ea-ae21-7b1a2111ff6b",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27edd897-bcaa-4922-9217-d98236c452b7",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 5,
                                "size": 64,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "51a645d5-8fbb-409f-b845-3d298947b3c2",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e30a46df-a3f1-455d-bf9f-9df283510e93",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 5,
                                "size": 64,
                                "precision": 64,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "922db88d-10ef-48c0-a2f6-9cca554866e9",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13d5e031-dc28-4fc1-a964-85cd24f7b0da",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "b0603895-eef3-45aa-b11b-6e87d51ac52e",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "6d3a3675-15cd-4f2b-8c60-19ea4b3b7405",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61b3437501d520002c42b1a0",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W9vffNlEo4jtdabftiKFBxfaaQsXoFhTTM7txEhG/jLu6CBekXY22hgN88Ng0fYauS48Rg4xTl4PvHqjVbcTS5Oi9FGQfbh1gOsBXF/HnXlsW+cFPRFDXzzbo/8B2c8RpAz/uBJmRSXztf22P/MxqCvTW1lgo5PsEnrOHIw69wgwh2HIjj4R4ChudbQMprFOPzxUtJA/laJ5YRHjGrRVKxa",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "cbcd636d-a6b9-4878-83e0-97f98304d526",
            "fullname": "MySql:f851a108-6081-4e1d-9ac5-a44b45410a92",
            "type": "extract",
            "name": "f851a108-6081-4e1d-9ac5-a44b45410a92",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "7f6edef5-e25c-4f8b-b2c7-8fbd947cc3a2",
                        "id": "tq_MlwmQPRyy",
                        "name": "WinGroup_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "22d0c895-9695-4071-bec2-4857ab0ed5e5",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8f51265-8bdd-42f0-9ec1-f6d43f79faf4",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be028765-59b8-469a-b68e-96e821a329f7",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1554f14e-450b-4d60-8e31-79b005e1da9a",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bce7a13c-5ec3-430e-bf94-2aa3665f1815",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "09af0177-d63c-496a-ae9a-0e79db4766f8",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617134fb55f384002cf10211",
                "provider": "MySql",
                "parameters": "7niuYEzJZH44LaPxXSBFhgupfobVTnd8RwuqT0tnpje5KDJ7gduGgbtju1DOzrlHXyxYXX725adKvwo0Axykr9WoMGo9e6lj1avkQiOehykewRR3dL0bFhZy2PD1D/s214ZB/FP6EjZLCw1IBo8M2ECB8F5338o8R/suGfqjWRnOflsq2MUpBYr+Wc7GJM/Dz7GG94Zi/zFyYcZz2sw/RvGv2nW3dmxfd2U2fn5h1ubfdO27mRkN4g+kxmvyY8s8",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "cdd0ba22-0c63-4e30-82f2-4ea84ef95f2b",
            "fullname": "MySql:f4bc4425-9446-4786-8a04-946f298e0783",
            "type": "extract",
            "name": "f4bc4425-9446-4786-8a04-946f298e0783",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "663819e3-e296-42df-bbd0-f4a8515bf36f",
                        "id": "tq_OmgZTufhA",
                        "name": "Chelsea_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "954b22e5-8079-4ccd-9077-bf8f8ac8bc7c",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c83b7a9f-4e67-4664-8111-55a70a15d4c8",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e51e3035-7b94-489d-9364-33ada918bc85",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dcdde473-26f0-4327-9576-e708ac20bdf3",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8a21635-ecc0-4d17-baa2-29cdf34166a7",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cefaeb1e-8fc4-47f8-bdd8-916ffb173575",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3ea7da3-a212-47f9-8c95-e22592deb3d1",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4987bf22-80ff-45e6-9057-b6cc48f7145e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c445b31-1f83-4104-8d5a-f8e91b24fe5e",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d74f63a4-3c6a-4ec8-b932-1973184d93fa",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd8cf4ec-bf0c-4a4c-b8a6-eca6e10a3794",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9572926f-4356-426f-bcc2-3820f5699f18",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99129390-6977-4a75-b2d8-29877f3b3fcb",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7d26e2c-ae38-4405-b717-22a09f4a699f",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8b867c7-3185-4c0f-8a15-f58e87c08207",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebbd6741-cda4-44b7-9e3c-3fde891158cd",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be392c21-7819-47ee-9ab4-d71faaebd704",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf550869-4620-4d5b-a7f1-3f75134ceef1",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b8d48d4-7ff2-4a62-872a-fa71516d5b13",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6b8478a-1f15-43e8-90d7-2172ca180061",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9be5d4f9-527b-457c-86b4-aaeff6883be9",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d22aaee0-4c03-4dfd-b880-23d88b0fcef8",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d6a9ffd-20ad-449d-ab13-d253e2fcf177",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1273bf96-6852-4b9f-9152-9ad9fef74a85",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf6defa9-b2a1-4b48-a122-c20eb261b040",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6431bd8f-03a7-4859-99c8-f7ccc25ac39f",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5366dcb6-d53e-444d-a160-63bbe10d76e5",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08852961-ead6-4bda-86ad-1d1da0822f5f",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77b7be7e-891a-48a2-93f9-cdd584014d6e",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea5bf3ca-e5f9-4318-b725-d75fa9f2066d",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a044a98-9bbe-4170-ad25-54deb95d6229",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac41a79c-d42b-4258-a893-9e050654aec0",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbf7e5b7-9d8c-4bf1-a1fb-8298de0b77fb",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ab369dc-3a0a-4752-b331-c9f4286284ce",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf97bdcc-772a-4c4b-b7a5-49c31b6d6401",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "655345db-a088-467e-812f-459fc0d83ee2",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9700cc9f-dbf2-44eb-8d2c-5c21d6daa869",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39559017-1c30-4cee-8014-bf225cf2b225",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0c02054-73c4-4963-89cd-2614bcc9e1da",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b08f9596-602a-493c-943a-8db91a0797b5",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffa44edd-2d81-4251-829c-97bb84c5ae07",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dcf760d3-58e2-4151-9cf1-87c9296eecfb",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5e7d540-f2e5-4481-b9f4-c9b255850cdb",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c997a24-f982-48e5-a948-5aa9f0255c1f",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b8d0073f-b3b3-423b-bb74-2e291a06ddc6",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9a94764-9396-4040-940c-3880d93aedd3",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "999f1ed9-2f53-424a-ad58-414a7b674938",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b210aee0-5a3a-46c0-9593-1b5d1c2e2764",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e00b714-05d7-4787-983b-257d7b47efa7",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a36c8b8f-7bbd-4a56-9fbf-a150d9dcdf00",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db4e71b3-0ca0-41b7-895c-c04384a773cc",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9887f0cb-1f5f-45db-b847-646996dbf125",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4acfc3bb-2937-44b3-87f5-96cfce2dc34d",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6fa4fe0-4a1f-47ed-8274-2da3b112cd52",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbd76d1b-ce12-4c33-877b-f9fd02e5ea91",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ec38174-043f-4d37-98d9-dcb130a0375f",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "272ce3f6-9a11-4d13-b7f4-91cd7dc8c9a3",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2d158eb-e1b0-4e6d-88f7-dbfd14c19f70",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4e24851-7cae-4354-9be9-9848426b7162",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cf257db-6984-42a5-bf22-b6fafa64d09c",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff61b4c0-ec4e-4e89-9357-c30bccb65d4e",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1501c11e-ca8e-464d-8dee-d845664cb0ca",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0129a1b8-a5f4-4ab2-a803-98d14b10bfa4",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff84a215-cf51-47ca-b913-452e8d265c9c",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7300aee-c381-473a-b249-dbc3a57f78d6",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bc0288e-2de0-48a2-8517-4f1028bb77f4",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4556aed-3f0b-4454-9663-528b40453bcb",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5b81627-83db-449b-b99d-dca09bfd9592",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e12599e8-b9d6-42a7-932d-39130eedbb4f",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "d74f63a4-3c6a-4ec8-b932-1973184d93fa",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "d6f5a8a9-7cda-4cc1-a524-9fc470686eb0",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n\t\tselect b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c721",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lmoVQsTevINebgL5jFjt37tZHVE1yfCNBl6wIlYq6wI7NUggy3EK86zDSbM4Fw27FcQ7WJjO+t052mJVx7AZ+Z6gWRvGvZ4n1PPPLo5KaSvMstq72ErNzPegcuzwKce1NBllSBZUAXHjSilY0GlglY61i6z48l5MvN5HzcxxLj8",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ce3d0373-6fdd-4be8-8191-e93d6645e225",
            "fullname": "9ac55460-0f1d-45fc-8ac9-e40d4187d046",
            "type": "custom",
            "name": "9ac55460-0f1d-45fc-8ac9-e40d4187d046",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0707f2ec-9a8c-4bf9-8612-337c5a5e566a",
                        "id": "AccountTypes",
                        "name": "AccountTypes",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "d9e3a640-fca7-459a-a39a-cc99d84618ac",
                            "expression": "select * from [York_acc_types]\r\nunion all\r\nselect * from [Prime_acc_types]\r\nunion all\r\nselect * from [Markets_acc_types]\r\nunion all\r\nselect * from [IvyTrusts_acc_types]\r\nunion all\r\nselect * from [TheWealthCore_acc_types]\r\nunion all\r\nselect * from [Arrowteks_acc_types]\r\nunion all\r\nselect * from [AussieTrust_acc_types]\r\nunion all\r\nselect * from [InfinityCapitalg_acc_types]\r\nunion all\r\nselect * from [365TradingFX_acc_types]\r\nunion all\r\nselect * from [TradeTheBit_Acc_Types]\r\nunion all\r\nselect * from [NostraCapital_acc_types]\r\nunion all\r\nselect * from [TheBPCA_acc_types]\r\nunion all\r\nselect * from [GeniusIG_Acc_Types]\r\nunion all\r\nselect * from [Chelsea_acc_types]\r\nunion all\r\nselect * from [AshfordCapital_acc_types]\r\nunion all\r\nselect * from [WinGroup_acc_types]\r\nunion all\r\nselect * from [BendigoCoins_acc_types]\r\nunion all\r\nselect * from [Bitfinity_acc_types]\r\nunion all\r\nselect * from [BigBitMarket_acc_types]\r\nunion all\r\nselect * from [AigMarkets_acc_types]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5d890da1-2504-46f4-87f2-ccf61ad389ad",
                                "id": "f8d74bd0-a070-435e-9e51-71ea0ae226de",
                                "name": "id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d65d41e-8c3e-440a-8c7d-2dd58b211acd",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e651eef3-722d-4263-8eb4-e9719484609f",
                                "id": "d3cb6777-c462-4093-96aa-b0a5535e296c",
                                "name": "brand_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c140816b-76aa-4725-aac5-49ae42857e67",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2491c3c5-faa5-4051-9144-da39a9bfc22d",
                                "id": "b6c7f09e-44b9-4199-bf60-1489f3e7eaf3",
                                "name": "active",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "032b5d72-5e7d-4195-b7cb-11131432b66a",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "cf7ea471-fa4c-4b65-a9f3-40a9a0292a77",
            "fullname": "MySql:313b77a1-6df8-447f-af8f-e7dc1251a91e",
            "type": "extract",
            "name": "313b77a1-6df8-447f-af8f-e7dc1251a91e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "aa3e8066-b89c-4d20-abad-ad43011170c9",
                        "id": "tq_V7D1xQPOG",
                        "name": "TheWealthCore_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6057867a-6fda-4932-b0b6-d93726834afb",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5eb040e7-f06b-4475-845e-a426d0790372",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "49349dcb-09a3-41cf-bc14-383f6ddb5b2e",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55be8a5b-36a4-4aba-8bb2-4476ddda4168",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e95123ab-67c8-469f-93c2-2203793836e1",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92663449-87fb-42df-8fbd-cde4b117899d",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a590e9e6-78b7-413c-8b13-e6241099ec08",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fe91c7f-2be3-4819-895b-cda2ab833caa",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c229efd-cf6f-4185-b03f-9c05f10a87a5",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ed2c872-b544-4d2e-999e-357f42f22fd5",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "f3cb962a-c41d-4bb9-b429-6b094cd41633",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506ca6780f2002c37ecd2",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d2212b6f-e3b9-4416-8c90-00d270b35440",
            "fullname": "MySql:104b594e-f301-40ef-a96f-022c88cc61e9",
            "type": "extract",
            "name": "104b594e-f301-40ef-a96f-022c88cc61e9",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8dc981c0-dc86-4265-acdd-457fa4f743e0",
                        "id": "tq_PT3HZB4UO",
                        "name": "AussieTrust_RealAB",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "4c687df3-2069-4d10-8a80-9cbe99be148f",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9f17a7b-fe7c-43e6-83c9-f0c49098b3d0",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a3958725-59ee-47d4-86e3-256a64a8c3a1",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da3f4808-f653-46d5-bcb1-7972ebae0007",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "587257c4-dc19-4f82-b7d3-58f2924e325b",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a534b07-6125-448d-8056-b9461092ea37",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9d554f3-c423-4922-9568-211c57a814b9",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c87cfb4-44d0-4d33-9a1c-a3b2f66bd5e7",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7487442-3b97-48e0-ba8c-0c6f42889a11",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b07e5da-1462-4f54-8341-087ac86225f2",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6d8e1be6-235a-4707-ae5c-3cb570757d83",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7054337f-6389-4e30-8a95-b13058292934",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a3c4723-3b09-40d5-b015-4d240607f570",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fbfbaab2-93d7-4d5d-abee-02b4c3bf5f64",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c56648ae-26ed-4100-ab57-1c3625c112fd",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c10b4e1e-8f0e-48b8-b8b0-5e3fbacd7fad",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "161c3d6d-7987-427f-951a-13541849980d",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "121077b7-6244-4a3a-9ca3-a9c3b954365c",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "36ca7365-2dbe-4ef1-bf1d-fcf3279e3b4d",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "092a29ae-c5f9-4f6b-9ba2-9e8eb98aa1de",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9440091e-e21e-4741-9c5e-ef54893c6595",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5311643-e760-4fed-9093-a89f4aea6a46",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be454cb2-d8dd-41ae-8abf-1555738cfcee",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9c360188-aab6-43e0-bd5a-ad69cbc05cc4",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e364f95-a90b-4c8f-ba34-f1cdc14f1462",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "354d3309-6b47-45db-b6eb-eaf9da1c7fab",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5b8a3fc2-2e0c-4bd0-b9db-b417f8791225",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "554102de-1728-48c7-9c09-59e72d7f6656",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eb930830-ca8a-4c33-b5e0-54f5699ff0da",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "45fdbe6c-9e79-445b-a698-741cd016c21b",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fde82a9a-2fa9-4a37-990f-b7c8101c19ca",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e4d85019-ab2c-40d6-9d58-176092648f67",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1e17ebdc-2558-435d-9ed4-c2363b737401",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3ba4834-df1f-44a3-b9fa-50628772c4e9",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "656c98cf-606f-4668-9a61-068ccc51314e",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "31b90e5e-b174-422c-8c6f-95e735ec7da8",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b704def-b9ff-40d4-afb8-3744d939dbb6",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e86b8475-ab26-4bb5-b9ae-a710c73648b1",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf94d61d-a5b4-4e67-a308-4cd47ea4ef72",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "77d8b14f-e734-403c-9019-2c4810b93f7e",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "797ce141-0c86-44a4-8b95-06314d8117eb",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e865052d-205c-461b-ae5a-be364451b2ad",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "74b1db76-bf5d-4d93-9e55-a1f2d6ea7ba1",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b55b2f65-88bc-4942-9538-be0c63c9033d",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88263361-3bc3-4a4b-876c-fe91b7e3ea1c",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5671430f-a795-4167-9676-72aee019caa3",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db751170-1705-4895-aa97-029d682f14fe",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c0517e4b-346e-4e8f-9fb6-2fee53db6787",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4a79588e-9afb-48aa-be81-91d85eb2c765",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b0efaa3-fe0f-46cf-8890-d943190e2557",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "19377597-4a74-4770-9b9f-57447ecae10c",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2ce03a9d-a218-4310-8b88-f27c8170a448",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "48860def-13b3-4bed-b6e6-215b87f21b41",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fe964b9f-2248-42fa-af82-ca8d473b6164",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4da39948-6aef-43a3-9f98-a29ca3526f01",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "20887a2e-65a1-4690-9604-502f365cff19",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9fc7a030-7087-4135-ae37-6e83f2d1bfd0",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "03bf2196-4a13-4ced-9fc9-7b5856e0d28f",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "37206829-36f7-4409-afd2-ddcc600d4db8",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0cb4cc02-8b6f-4163-b51f-1ce1aa9d390d",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5e5fe0a7-f376-4b47-b7f7-0029be39baa0",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89e2b630-b2bb-479b-993f-1289970c3325",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "52e45514-1aea-4158-9136-95429645f80e",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db698756-659e-4a46-849f-11e7341adda0",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "41c473f1-e501-414a-a991-f7a22de3b319",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e6728ad6-a894-4980-b995-a855148b4877",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "27a97e98-c3cb-4b9f-855f-2e368db0af75",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "172ad4f2-2dcc-42bb-9ee4-1f255916443c",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "db4e0713-b509-4c41-9d2f-9c3a59a0adc6",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "3b07e5da-1462-4f54-8341-087ac86225f2",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "3b4d6ba8-2ea6-4886-a12e-d0ec4463fcb7",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n\tt.*,\r\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastab < 0\r\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n\t\telse @RealABAccHelp := @RealAB\r\n\tend as RealABAccHelp,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @lastabusd < 0\r\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n\t\telse @RealABAccHelpUsd := @RealABUsd\r\n\tend as RealABAccHelpUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0\r\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelp < 0 then @realreal := 0\r\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\r\n\t\telse @realreal := @RealAB\r\n\tend as RealAccountBalanceAccumulatedCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0\r\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABUsd + @lastabusd > 0\r\n\t\tthen @realrealusd:= @RealABAccHelpUsd\r\n\t\twhen @lastId = t.id\r\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n\t\telse @realrealusd := @RealABUsd\r\n\tend as RealAccountBalanceAccumulatedUsd,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realreal - @lastreal\r\n\t\telse @RealAB\r\n\tend as RealABDiffCurrency,\r\n\tcase\r\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\r\n\t\telse @RealABUsd\r\n\tend as RealABDiffUsd,\r\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n\t@lastreal := @realreal,\r\n\t@lastrealusd := @realrealusd,\r\n\t@lastab := @RealABAccHelp,\r\n\t@lastabusd := @RealABAccHelpUsd,\r\n\t@lastId := t.id,\r\n\t@lastrealpnlcurr:= @realpnlcurracc,\r\n\t@lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n\t(\r\n              select b.id,\r\n              b.default_account_id,\r\n              b.brand_id as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n\t\tb.user_id,\r\n\t\td.code as currency,\r\n\t\ta.origin_type,\r\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\r\n\t\tcase when d.code = 'USD' then rates.USD\r\n\t\twhen d.code = 'EUR' then rates.EUR\r\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\r\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n\tfrom\r\n\t\ttransaction_record a\r\n\tleft join (\r\n\t\t\tselect b.id,\r\n\t\t\tb.amount,\r\n\t\t\tb.wide_currency_amount,\r\n\t\t\ta.realized_at\r\n\t\tfrom\r\n\t\t\ttransaction_bonus a\r\n\t\tinner join transaction_record b on\r\n\t\t\ta.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 1) rbonus on\r\n\t\trbonus.id = a.id\r\n\tleft join (select b.id,\r\n\t\t\t   b.amount,\r\n\t\t\t   b.wide_currency_amount\r\n\t\tfrom\r\n\t\t       transaction_bonus a\r\n\tinner join transaction_record b on\r\n\t\t    a.ftr_id = b.id\r\n\t\twhere\r\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n\tinner join trader b on\r\n\t\ta.trader_account_id = b.default_account_id\r\n\tinner join trader_account c on b.id = c.trader_id\r\n      left join brand on brand.id = b.brand_id\r\n\tinner join currency d on c.currency_id = d.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,67,75,138,146)) withdrawals on withdrawals.id = a.id\r\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \r\n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n\t\t\t   from transaction_record a \r\n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,67,75,138,146)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,67,75,138,146) and b.status = 'completed') deposits on deposits.id = a.id\r\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\r\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,67,75,138,146) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 5) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n\tleft join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol from trader_account_position) contract on contract.ftr_id = a.id\r\n\twhere\r\n\t\tb.is_test = 0\r\n\tgroup by\r\n\t\t1,\r\n\t\t3,\r\n\t\t2,\r\n\t\t4,\r\n\t\t5,\r\n\t\t6,\r\n\t\t7,\r\n\t\t8,\r\n\t\t9,\r\n\t\t10,\r\n\t\t11,\r\n\t\t12\r\n\torder by\r\n\t\t1,\r\n\t\t6,\r\n\t\t5\r\n\t\tasc) t\r\ninner join (\r\n\t\tselect @lastab := 0,\r\n\t\t@RealABAccHelp := 0,\r\n\t\t@lastRealABAaccHelp := 0,\r\n\t\t@lastId := 0,\r\n\t\t@realreal := 0,\r\n\t\t@lastreal := 0,\r\n\t\t@RealABUsd := 0,\r\n\t\t@lastabusd := 0,\r\n\t\t@RealABAccHelpUsd := 0,\r\n\t\t@realrealusd := 0,\r\n\t\t@lastrealusd := 0,\r\n\t\t@netdepositcurr:= 0,\r\n\t\t@netdepositcurracc:= 0,\r\n\t\t@netdepositusd:= 0,\r\n\t\t@netdepositusdacc:= 0,\r\n\t\t@realpnlcurr:= 0,\r\n\t\t@realpnlcurracc:= 0,\r\n\t\t@lastrealpnlcurr:= 0,\r\n\t\t@realpnlusd:= 0,\r\n\t\t@realpnlusdacc:= 0,\r\n\t\t@lastrealpnlusd:= 0,\r\n\t\t@currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c726",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d25a2cd3-960f-4f0c-a314-829e41d53e56",
            "fullname": "a645f5c3-f8f7-4d92-b936-c5851070445b",
            "type": "custom",
            "name": "a645f5c3-f8f7-4d92-b936-c5851070445b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "eb6568a7-f125-45ee-964f-f388fd64d751",
                        "id": "RealAB",
                        "name": "RealAB",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "ee21dc36-d16d-4cd3-ae16-f735f614e189",
                            "expression": "select \r\n\trealAB.*,\r\n\trealAB.rate * realAB.[RealABDiffCurrency] as real_ab_usd_fixed,\r\n\trealAB.rate * realAB.RealPnlCurr as real_pnl_usd_fixed,\r\n\t-100 as instrument_id_key,\r\n\tCASE \r\n\t\tWHEN realAB.[currency]= 'EUR' then realAB.[negative_balance_fix_curr] * 1.1 \r\n\t\tWHEN realAB.[currency]= 'GBP' then realAB.[negative_balance_fix_curr] * 1.3\r\n\t\telse realAB.[negative_balance_fix_curr]  \r\n\tend as negative_balance_fix_usd_calculated,\r\n\t-100 as position_status\r\nfrom \r\n( \r\n\tselect [RealABIvy].* from [RealABIvy]\r\nunion all\r\n\tselect [RealABYork].* from [RealABYork]\r\nunion all\r\n\tselect [RealABMarketCG].* from [RealABMarketCG]\r\nunion all\r\n\tselect [PrimeOT_RealAB].* from [PrimeOT_RealAB]\r\nunion all\r\n\tselect [TheWealthCore_RealAb].* from [TheWealthCore_RealAb]\r\nunion all\r\n\tselect [Arrowteks_RealAB].* from [Arrowteks_RealAB]\r\nunion all\r\n\tselect [AussieTrust_RealAB].* from [AussieTrust_RealAB]\r\nunion all \r\n    select InfinityCapitalg_RealAB.* from  InfinityCapitalg_RealAB\r\nunion all \r\n    select [365TradingFX_RealAB].* from [365TradingFX_RealAB]\r\nunion all\r\n    select * from TradeTheBit_realab\r\nunion all\r\n    select * from NostraCapital_realAb\r\nunion all\r\n    select * from TheBPCA_RealAB\r\nunion all\r\n    select * from GeniusIG_RealAB\r\nunion all\r\n    select * from Chelsea_RealAB\r\nunion all\r\n    select * from AshfordCapital_RealAB\r\nunion all\r\n    select * from BendigoCoins_RealAb\r\nunion all\r\n    select * from WinGroup_RealAB\r\nunion all\r\n    select * from Bitfinity_RealAB\r\nunion all\r\n    select * from BigBitMarket_RealAB \r\nunion all\r\n    select * from AigMarkets_RealAB \r\n) realAB"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "d71fbba5-79f1-4414-9c42-10f2d4f204ba",
                                "id": "ebf5d523-b839-44c9-b0cd-d6bcdf6d9e68",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50b62675-b3cf-45e1-8abb-f676e3f40b95",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1c0f1d4a-431b-4af9-8039-907fa269de36",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6d2fd376-a55a-448f-9fd7-94b20e305b33",
                                "id": "09794156-d182-437a-9b8c-cc522c1620e1",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb2aae51-6439-4d8c-b4ec-75fd23cd8451",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "117bae1d-eec3-4ec4-bed7-5c9cf5f3bbd9",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20d14ed1-9d1a-4651-9e03-7022c5b19e10",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe142970-8858-404a-9ef6-cb37da123cf2",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8299a57e-3c47-4ece-a931-4d2055f15f37",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a578deda-5d91-4e85-b57a-bd8f25ae0a37",
                                "id": "d33b3e35-2413-4dd8-8bb5-96661ef390a2",
                                "name": "created_at_key",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c2e43988-272e-4ec6-893a-8a69438a2816",
                                "id": "date",
                                "name": "date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9795651-462a-4037-92f4-8b8d6c6c2377",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6ecfbaf-4aa8-4b40-a5cf-57fbe870981f",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75e87100-f281-43c9-b41a-ae6bb69e1fa9",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e8d2c30-5ab8-4068-a318-9346d9d06a28",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "41b04aaf-0a13-4143-ac3a-a3cd5f9f1ee2",
                                "id": "37f7f977-4986-41b0-8a97-5c34484ffc40",
                                "name": "tr_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81a6a5d1-6e72-40a1-827c-800daaa88c75",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3815d525-9d26-484e-861b-83064d70c42c",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1202ffbb-4439-4208-a14e-f4f935b35c4b",
                                "id": "29168729-674b-4b61-8ec8-c86f5d6e2218",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90addfb4-c270-452d-88c3-1d2f37e330f8",
                                "id": "5b87668d-c782-4694-b881-631823a3a0e4",
                                "name": "user_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80913fc7-7aef-423d-b2dd-322db13cbdbb",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3466bbb-8713-4226-9784-f2c1e6c77807",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1c477b0-edf4-41b9-92a0-4aba366c613f",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3ed1df4-7a63-46d6-a72f-74c020099686",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e9f4f4f3-244f-4c14-9136-4b53cdfabad9",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4919d2d3-1b7e-4dca-b93f-24465deb1997",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dc48a01d-a149-42e0-a9bd-27f80da2c259",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "559f8529-9bf2-48c5-8361-06433a67c166",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4f24ab92-0e1f-4662-bdc7-b615037e7914",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9525fb53-1b05-406c-8e34-94df4d26e619",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "11d165f2-9c5e-4784-8d2c-18f876c8db0c",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4bd1d764-5d5a-4897-94b2-d535faa3476a",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "55a35338-091a-400d-9d83-3605cd0c0386",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a923b9cc-55e4-42a8-9a76-65c11b81218d",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1a10ed4-de11-4705-93ab-b4f88af7b461",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1c7a1102-760e-430a-bdd7-b5163fc9efc4",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da4dd8bf-8edd-463a-ab52-1f07dbb92b18",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05a684e9-7510-486b-b621-18160caa0dde",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9664fa0b-5e32-4d17-aa44-8025ec798901",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "60a5f70e-ba30-4376-9a12-3f6dea4a4a52",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ea83d716-900e-4104-97e2-ead65887df74",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0242d480-f86a-4b13-96bc-7da6860a01f2",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dda685f7-4a31-4893-8fe5-361cac8a8c6c",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "75aec8c4-be56-4e27-bba4-26764924dd8b",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c26dcf2d-ef99-4dc0-8c6e-66740976129d",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "62b5f0c1-d472-4d5f-a0ad-fb13d350666c",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05133a69-d068-4e12-8ce4-2d70eec424d6",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1eecf7c0-a877-45b0-bb39-b0726fad5dda",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "65ea5d05-1b40-4618-a307-5f12a8175ebb",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4791dd53-2d73-4f24-8171-2080c6123596",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b6491aec-af4e-4b88-9a20-bf53281bba3a",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1d079485-be0c-48df-b035-23ee3af74f10",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "340bab09-f7d3-4b31-a64c-ecf71655de8d",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3ccb6380-c2cb-4e38-8e24-d083e9f324c7",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bdde3048-3922-49ca-af16-448c9c6bee92",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e3640d95-4cdf-487b-964f-aafd07f1a61f",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e6466576-ac37-4938-8e4b-9dd4fdf68636",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4d6e7ee4-ecbf-4519-978a-604c805de4f2",
                                "id": "04aa1721-a249-4e5a-a74d-74f6ed74dde4",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35ca342f-6a8e-45eb-ba09-2b1eaea4eb77",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dbccab1e-b035-4004-b939-7fd267700dce",
                                "id": "c25ece93-1ca2-4185-9825-4746f7321176",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2f47bfe-7b1d-4581-904d-3befd249de3d",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35dcbd56-c01b-45e4-b5cb-8d421e960451",
                                "id": "76a12914-9215-4bd0-9657-354cad136b51",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11b9d468-912a-4db8-9f75-516ebd975dc6",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "af60747b-dd02-4648-a95e-6ce6008e088f",
                                "id": "496ad56e-c72f-4612-a88b-48c4cfbc6642",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63c16a1b-5fba-4558-b9d2-c48c3af374f9",
                                "id": "b918f4cb-d8af-47e4-add3-26c502262509",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dbd7b0f0-4765-4630-9d62-4862c09a42ce",
                                "id": "4bf1eba4-2fd3-432b-b110-8e57bf9bf6f5",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "714c53f9-2846-4dde-8b0b-67d65ec37aa3",
                                "id": "f95196f0-2943-4d33-bc91-303b0224c307",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3607b59d-a1a2-4043-bb20-94e4cf66e389",
                                "id": "95be67f6-a8db-4f3e-affb-4e9b22d1dd7c",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f3d0748-11f9-4e66-834a-a25fdbcde1b2",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1ab9c844-b294-4ef0-8967-a2de7221a6ae",
                                "id": "real_ab_usd_fixed",
                                "name": "real_ab_usd_fixed",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "10851d4b-427f-48d7-9eb5-44ef8d982cd5",
                                "id": "real_pnl_usd_fixed",
                                "name": "real_pnl_usd_fixed",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2637848c-4d73-4aa1-80ea-d8024aecaed5",
                                "id": "instrument_id_key",
                                "name": "instrument_id_key",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b3474f14-89a2-4e5a-ad6f-104643929680",
                                "id": "negative_balance_fix_usd_calculated",
                                "name": "negative_balance_fix_usd_calculated",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "81041aed-68d2-4234-9dde-2011e5c041f1",
                                "id": "5c933850-86d9-4367-b8f9-55e61331a689",
                                "name": "position_status",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "4d690bb8-afb2-4714-aafe-d5c32536973d",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "d38febcb-d550-4a42-b98a-5e4e4a319af7",
            "fullname": "MySql:de8e0858-b67b-435f-a9bd-edc0ddb6c57a",
            "type": "extract",
            "name": "de8e0858-b67b-435f-a9bd-edc0ddb6c57a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "9bd26475-7e39-4284-8f33-0d5a44d380f9",
                        "id": "tq_N7GNK4XRF",
                        "name": "BendigoCoins_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "90fbba34-816a-4077-a03c-d69ffd482f21",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b306e689-7333-4bb4-9e3c-41156acf1555",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26ad4a61-e3f6-42ca-9815-8dc118a87acd",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e17204e2-cb8b-43ca-aabd-593a28396a82",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fae30936-9665-4a86-8203-6c1acd86262c",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "7ed294c9-b1bb-4a97-8f74-7dcd0979b266",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6160234d9d5c67002c6f1979",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLYe2SGfT8Lds+akycpW5+K9YO+8fTekLNVbA78DM/OCWbxUblK2Id8YJvnNXUQ+eTIAHMN/W71sURfgBeS0WwQxNOqj84HBxwBZ6il+EKFmHJ9FWKQZm+UDy5OxqZbFAkXbpIyiPYxJBez63/L55hNPwBFOT2h2PzJQNrmoEZCdMcWAZeNnU55kjKL1mdEhkXeRVJc9RJItZ3XYlFNc1pmocYfl2UZpPJAOkcdJcbO/5",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d679897a-2492-4f40-b7a5-da77e7b3264e",
            "fullname": "MySql:7767ea38-9237-4dbe-b3b5-5d060292be83",
            "type": "extract",
            "name": "7767ea38-9237-4dbe-b3b5-5d060292be83",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b8be2c18-d893-4771-babb-48524cd15459",
                        "id": "tq_gPggAAGOw",
                        "name": "RealABYork",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "585bdc66-4a84-44ef-9c55-616c8ce840a8",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14b9d824-291d-4fe8-8a43-901da54a59d7",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aae7440e-d642-45af-985a-06763a900980",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ad82864-928d-4117-b7e1-e1918ffe220f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 5,
                                "size": 12,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25f48dee-295c-4289-8fbb-d0627e8c3b63",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5d5df23e-b541-4e76-bf90-ab8e5e4aaede",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c01359c-6118-42b7-9999-d86f25f811cf",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "676ac81b-ffb6-46b9-ad0a-2a38b509b76f",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78462c8e-a731-4b9a-a1a7-d84d202c7968",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd934280-b04b-40c9-9d4e-ad30bb0e7e4a",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c85af942-a971-47c4-a5d5-da54db471a22",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "097c1131-5005-4e8e-9a37-fd6d76ba5bb7",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "974c63c6-8a47-4904-87b6-37a751ffd2de",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9ed27351-3324-448c-878e-d804beb57562",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "46c5b1fd-0c6c-4e2b-acef-45b2daa226eb",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f76cc85c-8dc3-4d82-bd10-8c882ed4aa03",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eac8643b-c3fe-426a-9cb1-b38b49b0bb2d",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3fd5363f-00d2-429d-bc4f-ab27f87f7dc3",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "833f6bea-f987-4fce-a5cf-8cbdc7db6040",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b025dc0d-f415-40af-ac7c-c6e22097c413",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a2f0e15f-0937-4693-959a-592df3427792",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "805749da-193e-4cbe-b6f0-42a92fed4dfe",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7a225ce8-c445-4abb-8f0d-30ee555de088",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "32c938a9-7960-4245-8d45-b0bee2e4ab6c",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf23613d-06f2-463e-88c7-35fe00f3e5a0",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35551558-50a7-4961-8fc5-a4a3c56f551e",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bdf20bc1-400a-4276-be6d-dc1d86ae61e3",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "97b55b9b-6dae-488e-8454-5436abb5bb47",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1230481-6b60-46b5-b4bc-0fd6a5e20490",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9aa85c37-4925-42f3-a9da-9c0201016fbb",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ed1ea4a1-7219-4ebc-b68f-1cde63e73420",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e7b77d49-d48e-4b21-af93-d1fd270ea953",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3951f6c2-f5d0-4575-a008-c31687788623",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "91f88912-2d5c-4797-803b-9bf881599068",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3ea7cb47-0e14-42d0-8133-6fc8bb9253ad",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b38096be-fccb-4630-9de6-36cb749a7688",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3c8bc53e-b083-40e1-9e08-72199dee22fc",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "06b076ad-386b-4e85-8855-f726c0f4a714",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7064ff89-cffb-4bfd-92c5-45fcac6a2b4b",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e88ec7ca-d72c-4899-b00a-83cd46dd84a6",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f63aaa2f-55fb-4d91-8e63-07aa9f32182b",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c533fc79-c174-4d53-967a-8f57a048eb7c",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "60dfb7f1-b5d4-47c7-ace3-bfdfb324b27b",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89944ee7-400b-4d1f-8632-e32ffd3e133f",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eca33f57-d0a1-4c6f-a97f-12dedac48af2",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "989b31ee-53a6-4cf0-a87f-41b2a5b1d629",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9535afd0-5507-499b-a9f3-c9545086eb6e",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b742c88e-c45d-4aa8-94bc-02382131fabe",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da946142-123d-4d8f-932b-45a9d403bda1",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4428b5ec-7905-4af2-81d6-02eb7b71cae5",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fad8a31d-25af-4828-8485-f3eccf698d16",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8d9f59e9-c772-4834-b05d-58a025092571",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bb135b57-f87a-403c-acd9-beeda5eabfcb",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fb027c3e-8b64-4277-b679-bda6d1e69ed0",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5e3b0f14-b03b-4a25-ad8d-f1e0e6f79d97",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ca0eb9c0-05fd-4efb-a6fc-00cf5cd0d4da",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "978ece30-a5f2-45ee-b0a8-ba4e2c26fc25",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "867c0a59-6ae6-486d-a531-a4a70bb03896",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4b4680e4-72e5-41f7-adcd-c48e517d8117",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "66ec6fde-2a7a-43f1-ae26-34ef52d9b96a",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e5e02df6-c99d-4d24-9904-72992ca99c6b",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2bd4d466-73fd-4434-869f-45e243b0235b",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "beb62d17-ad44-4302-9128-26b3f5c05955",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "942a7568-1ef2-4b2a-b726-c58864ade8c9",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "76450723-286b-4358-9207-f9fe1b1a1790",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "02f3563d-163d-4f08-a806-ad45134ea715",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7307bad7-9554-4ae6-89b3-068a32e99c1c",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b208b71-6d87-497d-a709-af4b23c7f415",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb25d2a5-add4-4d95-b10c-c0f8f17143d4",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "dd934280-b04b-40c9-9d4e-ad30bb0e7e4a",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "9ad82864-928d-4117-b7e1-e1918ffe220f",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "8eac73a6-cbf7-4b34-96be-d14470042329",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\r\n       aggCustomer.default_account_id,\r\n       aggCustomer.name as site_name,\r\n       (1000 + site_id) as site_id,\r\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\r\naggCustomer.customer_fullname,\r\nco.name,\r\naggCustomer.currency,\r\naggCustomer.created_at,\r\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\r\naggCustomer.date,\r\naggCustomer.YearMonth,\r\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\r\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\r\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\r\nend as rate,\r\nMaxDep.LastDepDate,\r\nMaxInv.LastTimeInvestment,\r\naggCustomer.tr_id,\r\naggCustomer.origin_type,\r\nMinDep.FTDDate,\r\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\r\naggCustomer.user_id,\r\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\r\naggCustomer.deposit_curr,\r\naggCustomer.deposit_usd,\r\naggCustomer.cashback_curr,\r\naggCustomer.cashback_usd,\r\naggCustomer.withdrawal_curr,\r\naggCustomer.withdrawal_usd,\r\naggCustomer.withdrawal_curr_new,\r\naggCustomer.withdrawal_usd_new,\r\naggCustomer.cashback_withdrawal_curr,\r\naggCustomer.cashback_withdrawal_usd,\r\naggCustomer.withdrawal_fee_curr,\r\naggCustomer.withdrawal_fee_usd,\r\naggCustomer.chb_curr,\r\naggCustomer.chb_usd,\r\naggCustomer.inactivity_fee_curr,\r\naggCustomer.inactivity_fee_usd,\r\naggCustomer.overnight_fee_curr,\r\naggCustomer.overnight_fee_usd,\r\naggCustomer.fees_curr,\r\naggCustomer.fees_usd,\r\naggCustomer.pnl_curr,\r\naggCustomer.pnl_usd,\r\naggCustomer.swap_curr,\r\naggCustomer.swap_usd,\r\naggCustomer.contract_usd,\r\naggCustomer.rbonus_curr,\r\naggCustomer.rbonus_usd,\r\naggCustomer.cancelled_bonus_curr,\r\naggCustomer.cancelled_bonus_usd,\r\naggCustomer.pending_bonus_curr,\r\naggCustomer.pending_bonus_usd,\r\naggCustomer.fixed_balance,\r\naggCustomer.fixed_balance_usd,\r\naggCustomer.negative_balance_fix_curr,\r\naggCustomer.negative_balance_fix_usd,\r\naggCustomer.NetdepCurr as NetDepCurr,\r\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\r\naggCustomer.NetDepUsd as NetDepUsd,\r\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\r\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\r\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\r\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\r\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\r\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\r\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\r\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\r\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\r\nb.balance as CurrencyBalance\r\nfrom\r\n(select\r\n       t.*,\r\n       @netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\r\n       case when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\r\n       @netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\r\n       case when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\r\n       @RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\r\n       @RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\r\n       @currentrate:= @RealABUsd / @RealAB as currentRate,\r\n       case\r\n              when @lastId = t.id\r\n              and @lastab < 0\r\n              and t.deposit_curr > 0 then @RealABAccHelp := @RealAB\r\n              when @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\r\n              else @RealABAccHelp := @RealAB\r\n       end as RealABAccHelp,\r\n       case\r\n              when @lastId = t.id\r\n              and @lastabusd < 0\r\n              and t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\r\n              when @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\r\n              else @RealABAccHelpUsd := @RealABUsd\r\n       end as RealABAccHelpUsd,\r\n       case\r\n              when @lastId = t.id\r\n              and @RealABAccHelp < 0\r\n              and t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\r\n              when @lastId = t.id\r\n              and @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\r\n              when @lastId = t.id\r\n              and @RealABAccHelp < 0 then @realreal := 0\r\n              when @lastId = t.id then @realreal := @RealAB + @lastreal\r\n              else @realreal := @RealAB\r\n       end as RealAccountBalanceAccumulatedCurrency,\r\n       case\r\n              when @lastId = t.id\r\n              and @RealABAccHelpUsd < 0\r\n              and t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\r\n              when @lastId = t.id\r\n              and @RealABUsd + @lastabusd > 0\r\n              then @realrealusd:= @RealABAccHelpUsd\r\n              when @lastId = t.id\r\n              and @RealABAccHelpUsd < 0 then @realrealusd := 0\r\n              when @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\r\n              else @realrealusd := @RealABUsd\r\n       end as RealAccountBalanceAccumulatedUsd,\r\n       case\r\n              when @lastId = t.id then @realreal - @lastreal\r\n              else @RealAB\r\n       end as RealABDiffCurrency,\r\n       case\r\n              when @lastId = t.id then @realrealusd - @lastrealusd\r\n              else @RealABUsd\r\n       end as RealABDiffUsd,\r\n       @realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\r\n       case when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\r\n       @realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\r\n       case when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\r\n       @lastreal := @realreal,\r\n       @lastrealusd := @realrealusd,\r\n       @lastab := @RealABAccHelp,\r\n       @lastabusd := @RealABAccHelpUsd,\r\n       @lastId := t.id,\r\n       @lastrealpnlcurr:= @realpnlcurracc,\r\n       @lastrealpnlusd:= @realpnlusdacc\r\nfrom\r\n       (\r\n              select b.id,\r\n              b.default_account_id,\r\n              COALESCE(b.brand_id,1001) as site_id,\r\n              brand.name,\r\n              a.id as tr_id,\r\n              case when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\r\n              case when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\r\n              b.user_id,\r\n              d.code as currency,\r\n              a.origin_type,\r\n              case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,        \r\n              case when d.code = 'USD' then rates.USD\r\n              when d.code = 'EUR' then rates.EUR\r\n              when d.code = 'GBP' then rates.GBP end as rate,\r\n              concat(b.first_name,' ',b.last_name) as customer_fullname,\r\n              COALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\r\n              COALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\r\n              COALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\r\n              COALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\r\n              sum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\r\n              sum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\r\n              COALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\r\n              COALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\r\n              COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\r\n              COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\r\n              sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\r\n              sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\r\n              sum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\r\n              sum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\r\n              sum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\r\n              sum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\r\n              sum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\r\n              sum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\r\n              sum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\r\n              sum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\r\n              sum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\r\n              sum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\r\n              sum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\r\n              sum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\r\n              sum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\r\n              sum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\r\n              sum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\r\n              sum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\r\n              sum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\r\n              sum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\r\n              sum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\r\n              sum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\r\n              sum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\r\n              COALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\r\n              COALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\r\n       from\r\n              transaction_record a\r\n       left join (\r\n                     select b.id,\r\n                     b.amount,\r\n                     b.wide_currency_amount,\r\n                     a.realized_at\r\n              from\r\n                     transaction_bonus a\r\n              inner join transaction_record b on\r\n                     a.ftr_id = b.id\r\n              where\r\n                     a.is_realized = 1) rbonus on\r\n              rbonus.id = a.id\r\n       left join (select b.id,\r\n                        b.amount,\r\n                        b.wide_currency_amount\r\n              from\r\n                     transaction_bonus a\r\n       inner join transaction_record b on\r\n                  a.ftr_id = b.id\r\n              where\r\n                     a.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\r\n       inner join trader b on\r\n              a.trader_account_id = b.default_account_id\r\n       left join brand on brand.id = b.brand_id\r\n       inner join trader_account c on b.id = c.trader_id\r\n       inner join currency d on c.currency_id = d.id\r\n       left join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n                           COALESCE(b.fee_amount,0) fee_amount_curr, \r\n                           ((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n                           COALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n                        from transaction_record a \r\n                        inner join transaction_withdraw b on a.id = b.ftr_id\r\n                        where COALESCE(b.payment_provider_id,0) not in (24,32,54,68,96,128)) withdrawals on withdrawals.id = a.id\r\n       left join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \r\n                           COALESCE(b.fee_amount,0) fee_amount_curr, \r\n                           ((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\r\n                           COALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\r\n                        from transaction_record a \r\n                        inner join transaction_withdraw b on a.id = b.ftr_id\r\n                        where COALESCE(b.payment_provider_id,0) in (24,32,54,68,96,128)) withdrawals_cashback on withdrawals_cashback.id = a.id\r\n       left join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n                        inner join transaction_deposit b on a.id = b.ftr_id\r\n                        where COALESCE(b.payment_provider_id,0) not in (24,32,54,68,96,128) and b.status = 'completed') deposits on deposits.id = a.id\r\n       left join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \r\n                        inner join transaction_deposit b on a.id = b.ftr_id\r\n                        where COALESCE(b.payment_provider_id,0) in (24,32,54,68,96,128) and b.status = 'completed') cashbacks on cashbacks.id = a.id\r\n       left join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n                        where a.transaction_sub_type_id = 5) withdrawal_fees on withdrawal_fees.ftr_id = a.id\r\n       left join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n                        where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\r\n       left join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\r\n                        where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\r\n       left join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\r\n       left join (select 1.1448 as EUR,\r\n1 as USD,\r\n1.3108 as GBP,\r\n'2019-01' as ym\r\nunion\r\nselect 1.1376 as EUR,\r\n1 as USD,\r\n1.3263 as GBP,\r\n'2019-02' as ym\r\nunion\r\nselect 1.1224 as EUR,\r\n1 as USD,\r\n1.3021 as GBP,\r\n'2019-03' as ym\r\nunion\r\nselect 1.1214 as EUR,\r\n1 as USD,\r\n1.3038 as GBP,\r\n'2019-04' as ym\r\nunion\r\nselect 1.1197 as EUR,\r\n1 as USD,\r\n1.2637 as GBP,\r\n'2019-05' as ym\r\nunion\r\nselect 1.136 as EUR,\r\n1 as USD,\r\n1.2691 as GBP,\r\n'2019-06' as ym\r\nunion\r\nselect 1.1071 as EUR,\r\n1 as USD,\r\n1.2152 as GBP,\r\n'2019-07' as ym\r\nunion\r\nselect 1.1009 as EUR,\r\n1 as USD,\r\n1.2157 as GBP,\r\n'2019-08' as ym\r\nunion\r\nselect 1.0899 as EUR,\r\n1 as USD,\r\n1.2287 as GBP,\r\n'2019-09' as ym\r\nunion\r\nselect 1.1157 as EUR,\r\n1 as USD,\r\n1.2937 as GBP,\r\n'2019-10'as ym\r\nunion \r\nselect 1.1019 as EUR,\r\n1 as USD,\r\n1.2928 as GBP,\r\n'2019-11' as ym\r\nunion\r\nselect 1.1124 as EUR,\r\n1 as USD,\r\n1.3351 as GBP,\r\n'2019-12' as ym\r\nunion\r\nselect 1.1095 as EUR,\r\n1 as USD,\r\n1.3205 as GBP,\r\n'2020-01' as ym\r\nunion\r\nselect 1.1089 as EUR,\r\n1 as USD,\r\n1.3181 as GBP,\r\n'2020-02' as ym\r\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\r\nleft join (select ftr_id, system_currency_vol from trader_account_position) contract on contract.ftr_id = a.id\r\n       where\r\n              b.is_test = 0\r\n       group by\r\n              1,\r\n              3,\r\n              2,\r\n              4,\r\n              5,\r\n              6,\r\n              7,\r\n              8,\r\n              9,\r\n              10,\r\n              11,\r\n              12\r\n       order by\r\n              1,\r\n              6,\r\n              5\r\n              asc) t\r\ninner join (\r\n              select @lastab := 0,\r\n              @RealABAccHelp := 0,\r\n              @lastRealABAaccHelp := 0,\r\n              @lastId := 0,\r\n              @realreal := 0,\r\n              @lastreal := 0,\r\n              @RealABUsd := 0,\r\n              @lastabusd := 0,\r\n              @RealABAccHelpUsd := 0,\r\n              @realrealusd := 0,\r\n              @lastrealusd := 0,\r\n              @netdepositcurr:= 0,\r\n              @netdepositcurracc:= 0,\r\n              @netdepositusd:= 0,\r\n              @netdepositusdacc:= 0,\r\n              @realpnlcurr:= 0,\r\n              @realpnlcurracc:= 0,\r\n              @lastrealpnlcurr:= 0,\r\n              @realpnlusd:= 0,\r\n              @realpnlusdacc:= 0,\r\n              @lastrealpnlusd:= 0,\r\n              @currentrate:= 0) v) aggCustomer\r\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\r\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\r\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\r\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\r\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\r\nleft join trader_account b on aggCustomer.id = b.trader_id\r\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c72b",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiXsMSYsuAL/CbGN4aqsTqQK37h2jvswX7OUxbO5ncsXT5ZAQx6xX8RhjlXWOBl+OUE=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d97a0a19-8869-463e-b17a-8e112137a756",
            "fullname": "MySql:e487fc6f-6aca-4d3e-8c13-fe8b190e6a6f",
            "type": "extract",
            "name": "e487fc6f-6aca-4d3e-8c13-fe8b190e6a6f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "abf651da-6603-4128-85c8-ad9066221a50",
                        "id": "tq_mHFheA4bu",
                        "name": "AshfordCapital_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "989b54f5-f519-4e8a-a158-10fd91c99994",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "452049c3-2f3a-4ea5-8774-c03eeb64fa1e",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07185e98-dbb5-4cdf-807b-8afb15dd66c9",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f921f5d-a9a3-456a-8360-5726d53362ed",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33e532a4-8e20-4bd1-a5b8-00a80ffa231d",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0466d4f3-f572-4a99-9e43-0d378c8b7567",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc37dbea-7dd0-4fd5-9b95-4596344817b0",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5dd3f47d-a134-4a8c-ae70-a9ad642bfdd6",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d45c362-6786-41d2-8aac-5297bd9288f9",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d46e69d-92ac-40e6-9196-c5e283ec3688",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58ff96fb-4ccc-43b1-8ea6-3cd1cdab528a",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "487cf4be-8a1e-4b32-a4ed-e4a6ffd7aca6",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f71edf0-9b29-44bd-8bdb-4ae8f05486c7",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2cf52873-9602-4421-8ed5-04153c93b2f5",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ace8aabe-88dc-4af5-9bb2-ab8a8dc403ca",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b26e5c6-ec1b-43e9-850c-e432276c2e94",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c68b0264-a22a-43ff-b347-fc566a5bcda4",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ec18464-3dfc-4471-b963-941f07d0b41d",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3277da4-831a-4a47-be3a-be09b6b22cc9",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "482a5176-5a27-4342-8749-474bb67b0a22",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d598e15f-27d3-4eeb-b66f-283111c42ed1",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b470f174-edac-4d31-b4bb-0ec70f51eb58",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ec2e8ff-67fa-4695-ba17-5afeaddb88c7",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c03413bb-7487-4595-aeed-c61ceb4e4ed9",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7cfc31c8-0d74-4a58-a230-906cc3cf62f9",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6828c04b-8c97-4513-8a2b-13ad2d897977",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "06d08f4f-b3e3-4a73-81e4-055ace6d5242",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "90fc7c99-3374-4624-aae2-b2a74f0078f7",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f88690e8-867e-4186-b939-93e549ce30c0",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a26aab6-9576-4b17-9b15-29ade2633b30",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5ca4bd0-11aa-49c3-a325-709cd8315e9e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2cab93ab-d6df-43e4-9001-ab3795c28fa5",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64b4a5c2-81f8-4148-84ff-fb511ff40e90",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "634fd80f-d115-4611-8d26-548f92e0c29c",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dabdada1-e283-4da3-9f8c-6135d3eb2593",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bcd13c37-aaba-4f29-8293-ba28232f5d68",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b36982b4-a353-4384-9a98-5dc1a05e1493",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98d28c59-9546-4746-9cba-042360371060",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "773ca1f2-e6b4-4a8f-b6be-4360a253e81b",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "517ecde2-29c5-47be-b55a-6e527a238628",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "feaf3cc6-75ab-4788-b8d1-2334b2e2329d",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07504423-0aa4-4514-ad01-ca67493b44eb",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c0f96d3-ef16-47ba-9942-3ccc7832fd6d",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2dab8e8e-df7b-46cc-b8ec-3b20fb148cf3",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35e7978b-3672-4e9d-90f8-05d8d2da8e34",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4aafefa2-9aae-43bf-a4c8-04cadf79ee06",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d95d9cb4-1ccd-45ef-afe3-6aa74694bcf4",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e36119e-f683-4305-b944-6f138a0c3696",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2200c41c-74ed-47d7-ad51-6e3ceb2c1d8a",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11337230-aba8-4c3c-9791-fc7d18f58f4b",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd6e9187-b750-441a-8f49-ac1449b84cbf",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ca553ae-faa5-42f2-a3f4-272e7f7a64e2",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbf96219-3c80-4589-8729-87ba4f769fb0",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "269c11f7-fccc-4168-a99f-8495ea593fd4",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed75534d-72f2-4865-b388-643ca4bc0af4",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "700dc9e4-f3ee-4ac9-86c9-76fa68c808fd",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4229ff9-2865-4eef-b759-4c1fd94b8a38",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26d65009-f380-4217-bd6e-e2a69ebd599f",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a26e5bd-ca9f-4866-ac03-d4a078cbc0d1",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4cd81be-e8f3-4ced-a963-268b2e99e08b",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7443f784-fa7d-4cd7-a79a-724bec601a6a",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "effdaf3f-672c-4ed1-ac1c-c7dd8dde697c",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "64b4a5c2-81f8-4148-84ff-fb511ff40e90",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "f3b081a0-74e8-4170-aad9-5e2af2514989",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id <> 24\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) <> 24\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619503796780f2002c37ecb0",
                "provider": "MySql",
                "parameters": "Oz2AfvRo3srlztUw24mN8xjULQgCsDxE8xdGvyNUDfDIDVlPEvzGPi9X1pOk7WkJorypT3vAhcaensqPr3DxJWq4DMDr4Ntq8hg/ST/QG/Ry+Mc5Itvb7ssjapRdR/f5pJGa1CgTA4+V9S7ZAeHlkIJ8fCivOQ1bPR1RbzXK2+kyaVjENBts5VNtP4yYjGtpqTycZGcbTdSdI98JCq+mp2IzDRzS7cexXuu83rKl7MG3hlCMfvhn4khms5onk7u7",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "d9da6d28-a053-44db-bb86-3bc83c5552de",
            "fullname": "MySql:4690bc4c-0289-406b-8e82-fdfefd3055bf",
            "type": "extract",
            "name": "4690bc4c-0289-406b-8e82-fdfefd3055bf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f6aa74bc-8ecf-48eb-beb6-2a6faedb3581",
                        "id": "tq_BnFdXiZPK",
                        "name": "Instrument",
                        "type": "base",
                        "schemaName": "md",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "78186718-d173-40c7-b9ee-e5c07b3942d6",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a760f989-6ce2-4f23-bd5a-5c657460573d",
                                "id": "instrument_name",
                                "name": "instrument_name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67b0bbe9-3d32-47c9-b928-11022ae8658b",
                                "id": "instryment_type",
                                "name": "instryment_type",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbb8ebfd-d6dc-4212-9048-5a8c51a579af",
                                "id": "base_currency",
                                "name": "base_currency",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eaca173e-867e-47c0-bd23-1995ecc37954",
                                "id": "qoute_currency",
                                "name": "qoute_currency",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d61f8dc5-9ef9-4ce5-a548-179508f4874b",
                                "id": "status",
                                "name": "status",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "04412163-7ff8-4d38-8361-17787f68907a",
                                "id": "feed_id",
                                "name": "feed_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "78186718-d173-40c7-b9ee-e5c07b3942d6",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "e81255c7-856c-4dad-8dcd-4de04011c364",
                        "configOptions": {
                            "importQuery": "select\nmd.instrument.id, \nmd.instrument.name as instrument_name, \nmd.instrument_category.name as instryment_type,\nmd.instrument.base_currency,\nmd.instrument.qoute_currency,\nmd.instrument.status,\nmd.instrument.feed_id\nfrom md.instrument inner join md.instrument_category on md.instrument.category_id = md.instrument_category.id\nunion\nselect -100,'null','null','null','null',0,0"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c72f",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE91TpTMBgsdqxijYyQsgl2Iw/ztXEsePuF6l9VfOOcs+aHwZwB09RIyGX6Hau00okvOT+9llozNyIAty78uKnqFwnduTqlolplWlDPDybgx6nc/sA/ch+dTMARvwtB3QZm3MDtuOKrVbMCiavKZG1sH0rmQwEe6BPWMAmQHzQ+AJtkK9wae9VqqJdJjqa23haP",
                "schema": "md",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "db289a6b-632c-4b2b-8769-d02b0908850c",
            "fullname": "MySql:ea1d0c87-b08c-4d36-9ced-fbdc089b00de",
            "type": "extract",
            "name": "ea1d0c87-b08c-4d36-9ced-fbdc089b00de",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1c62ae90-3d59-4d29-ac58-5c7b98471fff",
                        "id": "tq_ZRYeGln1C",
                        "name": "AussieTrust_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "a0544d30-df30-49db-b5c6-13a477803a75",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "69fd82f8-a89d-4ca7-a3aa-626615002041",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "554eba38-68f4-4a73-9ff3-2c0f1e937aa5",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "de6ea284-99b0-4f28-a3a8-63357bf7e2e5",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "917368bc-ea5d-413a-8d12-2bd6c4c65c1b",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ca48e819-3f37-46f5-b90f-d70631f8fffe",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8a88be2b-ff38-4ce5-b20d-da473fe8d58e",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01628d0f-c3cf-46d8-848c-e5de27cc667a",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "767c8aa7-3e33-4474-b450-a4da666917b3",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9880e361-8854-492f-91e1-55d751c62070",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8ada773b-0dc6-4054-b4d0-5fb95804abcf",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "78a73e79-c5cc-4fe5-8521-6decbff8c782",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1ed5aaa-cdaa-4144-bfcd-1cb52a7f9221",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7edd5eb-56cf-44a6-a6d9-c6d04e4e46ad",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14f0d11c-c407-4e03-8dc3-79f6fc3bcae4",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a668541-0721-4ae9-9b9b-e80831d332d3",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1941b25-4d1a-4f14-9904-c190ff204f45",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7fa4fef7-c0e0-4f87-b1e1-46ddeec8c24c",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7ea844ee-a576-4a15-9cb8-248bc84dd27c",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1ad245f3-d098-498e-8592-38b93f994bbd",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bbac2b39-812c-42b9-93ce-548cdaaac8b2",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "078c83c7-e777-4c10-b2d8-840e64f1dbd6",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbec4c99-ebe6-4f40-948e-2d0d6644af2e",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab9dc8e5-364f-4898-8917-1fb0ff4963c7",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5aaa4c27-b473-4156-8810-6502051ff0a6",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1ad5236b-6ca5-447c-badd-d5443bbe37b6",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87c3f257-c730-4cfc-b103-ba8413945d16",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1c4bb9ad-8ded-4f4d-abcc-358cae78fb2d",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "936c1020-71ca-48fc-88ac-b228f65486fd",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "062cfedd-4bc5-45cf-884b-868bcb5d9a22",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3923c31a-2deb-4ac6-9480-227e6c13bc6a",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10e6d565-2c07-486b-a266-cd37599c216c",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f79d5db8-8c08-4f94-81b3-d3bcb33508f3",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "529ee7cf-6e66-4b89-a4ab-37e18c6c4659",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c2465c5d-d861-41d9-b292-ca1a041c785e",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c9e4bbdb-eacd-49fc-9720-43880b1d1a62",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89a528ec-31ca-4cd2-919a-979561617adc",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "455419c7-9977-4086-a3ab-83c9ceea64c9",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f6881f6-561e-4bcb-95dd-75f66e649dfd",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0df45182-0f59-40a0-80a9-332b5caacaaa",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ad532e95-9aa7-41b1-959d-1ab4281bbfd9",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "62e3438c-b2b8-4189-8bbc-153c0bc44a05",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8fab0b3d-eaab-4994-a223-9c868d6b05c3",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4b69d1c-0941-4eb9-b252-7e3b1bf1be2b",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b92f02e-6c1f-4c55-bc48-e349732c96ae",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1e2c76aa-14c9-44b2-b6b4-9677008a58a6",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1329f22-6229-42ca-8bbb-ffc0a6a445d5",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44471490-47c6-46e0-9258-a57fe968de7c",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d346f86-47ca-4db7-bcf5-0718e9ff066c",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a0c163c-65b1-4589-9150-5f1f0a8ad345",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5dbbbe29-dfc0-4c20-a84f-766f6b58744e",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c44365ab-c4c5-4ec8-93ee-c9b0e7ccd318",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "314d0727-13b6-4c76-abbe-4806bc5f4f4a",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "28abb611-8385-4a91-af26-1a3c9b8649eb",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5a18018-0d8e-4be4-bcee-0ee392dae69f",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9352597f-43d1-4e2c-a6d4-74d2c17b2224",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "491f220d-846b-436e-bec5-7017a12e62f1",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e46b60a4-d685-415c-976c-cfb878663f2f",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "336cc2b3-8495-4a79-9c5d-abda4c8d49fd",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "53a14117-3a33-4549-9ff3-bdb8767131ab",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "04528600-94fd-4455-910f-45fcff69d7c9",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "734741be-53f7-4938-b6c6-0412d10f43e6",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "f79d5db8-8c08-4f94-81b3-d3bcb33508f3",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "5e2279e9-4545-4e64-8ba5-807ac3dd9029",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\telse trader_marketing_data.utm_sub_aff_id\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_redeposit_1k,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\ttransaction_deposit.payment_provider_id not in (24,32,67,75,138,146)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,67,75,138,146)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619503e36780f2002c37ecb2",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "dcb2d159-30a7-4f5d-a31f-9aff15ecb7b1",
            "fullname": "MySql:9911523a-0a18-4249-8cf0-79686aa3b614",
            "type": "extract",
            "name": "9911523a-0a18-4249-8cf0-79686aa3b614",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "e49d15d0-31f3-43bb-9b7c-2ff8bb6bce4a",
                        "id": "tq_gp9vKhF4U",
                        "name": "position_status",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "1f2565a1-5ac2-4662-8fe7-de50de786267",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d610ec4-841f-4773-85f3-3fb70df1285a",
                                "id": "status_name",
                                "name": "status_name",
                                "type": 18,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "1f2565a1-5ac2-4662-8fe7-de50de786267",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "8d616986-4f5b-4351-9d76-7b3495436080",
                        "configOptions": {
                            "importQuery": "select * from position_status\r\nunion all\r\nselect -100, 'N/A'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "615da549b48a9e002c4e01cf",
                "provider": "MySql",
                "parameters": "5mNCu1+ofkq0jXTrETmA2GCLZRQMR5lTs7Khy7XrLfySMPqPYDtrRlch/vLJc4vdrd/JrcAFXOWO83LKYJqdKiPldqy1FnyanGQNws7STazYO7sqyOenRvB3k8Yh2tTWh+ObQUSeC5Z1K+ABXCWQcm/9SYOW3BnV/y1ER7RLvI4cOnn48ASXLQJUrm44qp5lK6G7fV8oT7yA8OPNYSQh7A2qoIFcSLJEviCg2Kwk6XE0QEOgflKUu/piXLY16nP6",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "dd892d93-264d-4ef1-be10-715d62c3d92c",
            "fullname": "MySql:057493b0-e9e5-4830-8026-c0103ae70bb7",
            "type": "extract",
            "name": "057493b0-e9e5-4830-8026-c0103ae70bb7",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "732918f8-68fc-41de-ab19-3b3a32aa8b29",
                        "id": "tq_hVrYASI7k",
                        "name": "Bitfinity_OpenPnl",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8e92610b-51c4-4579-b5b7-a491bcf78a13",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "74569e62-e8e3-410c-b3a8-30aff10f1215",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63f6d69c-694b-41ea-b892-52971b16615a",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa002fb5-8bab-44cc-b494-0d39703b6e59",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8387b3c0-c82d-45b7-8a78-7456e64ffd39",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14ded47c-289d-4d14-b48c-dc73cc066b46",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33c7bf5e-4ff9-48be-b8c7-2636bd99c20b",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 27,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81eef64c-257f-4ffc-ab82-4e336b9adec7",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98da71bf-7923-45b1-9490-c3466645c506",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 47,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "7231c798-db30-42ec-aea3-c2689c81e250",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61964b413f1f2f002cf16c3f",
                "provider": "MySql",
                "parameters": "19x2eB8ph2aYc/juzRJhdXmHOGk/Q0LOo1mcPAZAkzQ0rOYfaoDxpFcxuWNBv7R5KV0O5tYU8i2V/PjWAUeDSLhONZ0UCFxUB12m91h1eHOHdzR+SB2d9VJoCcpD2m9S5HXy2q9B6RLuhWzexgEBZWWpbuLtRZNIioiIe+Aak0+UQZCbTaPF44h+UqblYtn0GbA9u96R0kzZhm8bt0OQY3NtWmYnwdwQiprKhRjTZlxlHYq4bo/AURRzeuo5J+ph",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "dd948f5a-c8ca-4f8a-a1ad-7f23f21ce31f",
            "fullname": "MySql:aff36206-c6dc-463b-8a46-3457238f2552",
            "type": "extract",
            "name": "aff36206-c6dc-463b-8a46-3457238f2552",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "edba8ede-b677-493d-add7-a55fa867dda8",
                        "id": "tq_dhjmsdXn1",
                        "name": "IvyTrusts_open_position",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e8a5306c-a5fe-427e-ad07-9e874df82758",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "295e51a3-b023-4ee4-bbd8-a607ad01c941",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "916d0628-22da-4959-9940-89e77dfd8264",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2793b086-da0b-4cd8-908e-413ec45d89c3",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "34159e38-994e-47fe-ad0f-b5989bb0b0af",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "94d2b993-8172-458f-8197-fc38f68bb1ab",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "efe67261-f1a9-4447-ba19-cd58a02ae4ab",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "15a1f38d-8655-4d85-8a8e-75c563666459",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e89c1b95-592f-45b4-ab72-eabed1dd6629",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "0f2ff912-77f8-46f8-ab05-c7c920fb04bf",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend) * (-1)\nas pnl_usd\nfrom\ntrader_account_position \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c733",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFA9JlqyFqZAeoogKne8sIUpkNMpEfeosVFHWt/W5yFiTD8p9Ffjn88IlJC5Q1xQ59qiXHtoy1GBjMIBIltk++fzbFEfPbsvpm0EnoyEAOYQ2",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "e695f8ca-1e24-45d4-995d-e9957a138261",
            "fullname": "MySql:da72a496-f9b3-40de-8c98-ab3db3a8cd85",
            "type": "extract",
            "name": "da72a496-f9b3-40de-8c98-ab3db3a8cd85",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "78d71d15-c9ca-471f-a075-a34581ede265",
                        "id": "tq_ojKAgizTy",
                        "name": "365TradingFX_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "eaf2e57d-7435-4a92-9265-c144e5d015d4",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99a60820-4717-44b0-bb54-29ddfa3829f1",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3b33868-4f25-44ca-bdf2-5c0601ae1773",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc432efa-a0b8-41b1-8990-d59f24c9887d",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e63a10d-c358-4d82-b83f-e22a05bdc128",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "83da5625-d7ec-4338-8bee-2bdf33198659",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5967f775-c267-4e79-b130-fb8599ea4293",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c0a87ba-0189-4ef9-9dcf-1d2cd25d61db",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bd7096e-4a70-4dda-9671-cceaa30321da",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67618482-c4ef-4a3f-855f-32948db28641",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "871b95ea-e98f-4005-9255-7ef7eeb46543",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13090dfa-0cab-423d-90ca-606e84a4c75a",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9bf21a8-70d3-45dc-993e-1659e3db84f7",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d3f0312-74f7-43d6-8b0c-3a0e141766f2",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92c04e0d-5def-4027-b4ce-4c3b896c9356",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d040f944-4718-4d9e-88d4-635474dc2582",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4eca547b-4d53-4787-8a87-2847786e3ba1",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87361a50-9bb1-4bf4-98ec-5a5ce3efbaaf",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67742d26-8993-4569-beed-718244d7df4d",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5afff613-c9ec-45e3-8616-d096a392e614",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a002a34-3cf2-49af-9825-306ada7b34d3",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39aba402-591b-4f07-b3ab-3d4ed05b05b9",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5eecd507-d544-4ca1-b768-b6d199b0b99b",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3eb152a4-da1c-42c2-89aa-e09b6c71482d",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "85534a09-f058-46e6-92f2-75bf4618c052",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2cfd96e8-1761-42e7-8ff4-abb86b06fa17",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4dc31978-4573-46da-919e-62c9c8e079b4",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3e7af03c-c5ab-4ae1-8bbe-32b192329383",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4ccbb06c-bc16-497e-a186-fb905772b631",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fec65b88-3901-4154-8772-04ab30d7ce81",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "053926b5-bf91-44ee-ae29-27b2c4bdd3b3",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a929e0f-fe3e-4eaf-9215-b0f8f16e6c00",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "36ba33d0-1c52-442b-bbce-aa09a6b697a6",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cf7be16c-0735-4b85-a6b3-80d3ab3c36c5",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "53eccad3-4683-41a8-8df9-aafb3cbf113a",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45ebbd5f-bd0f-4db6-8aa6-f62dc3826f0f",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f7c3b50-c7fe-4b4e-8850-76b8774904e8",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "957c050a-92c3-4ab5-bb06-f89b5d7775a6",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4de568bd-3e56-48a7-be15-e52c4272b6eb",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b3cc1cd-6a9a-46d6-89e5-0375d6a05f19",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccbb0311-e3e7-4f97-85fe-818bc59720b4",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2bb399bd-79b9-4981-82ce-eecd0b5e242f",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6cc96827-dc6d-4f63-8243-09e9ae4ddb2f",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "76bcd19f-0374-4434-a7f9-6377526900ce",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5b89384-9701-4868-ac9c-28f6a2f85183",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "67dd7fb1-3f3e-40b8-83e9-736a45011c5a",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "30c4b91b-9cb5-4227-ba00-00332582b7fa",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e5762e8-fbb8-49e9-8a0d-0d5530fd4f1d",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "980fd091-4e4e-4a30-be6c-32d8b36c0004",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b066e863-07c3-4b3f-9ad1-117bac2ec3d8",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e4ab23e-46e7-4d44-abe6-c5512fc7c060",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a67994f2-f092-4ec7-90d8-64d21206a98e",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f75d53c7-c14a-41a3-b3af-e35549142224",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f11fe05-4031-4877-bfe6-dac945bcdcb2",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cba91ea-266c-4574-a79f-970e9f81c17e",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a4e2c2e-d96a-4a99-9c8d-f3a3e6995367",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae44798c-49d4-4988-a262-066f10bb48b4",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a040e1ee-ce3a-48b2-9de9-f1453dcbd691",
                                "id": "is_1k_redepositor",
                                "name": "is_1k_redepositor",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "845ec4c8-0bd5-4801-99af-309eed7ce7fa",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c647379-a687-4029-8bcd-bdc576f12a63",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5380370b-6671-4cb1-8ec5-4f0635a4b846",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c2a9cf48-35df-4fac-bf25-36e7f8e0e171",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "36ba33d0-1c52-442b-bbce-aa09a6b697a6",
                                    "type": 22
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "92e27b30-82cd-4e1e-9a8d-d5ee89bf3909",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\n        trader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( 1000 + brand.id, 10000, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( 1000 + brand.id, 10000, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tCOALESCE(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend as FTDInd,\r\n\ttrader.email,\r\n\tcountry.name as country_name,\r\ncountry.code as country_code,\r\n\t'CySEC' as country_type,\r\n\tCOALESCE(\r\n\tcase\r\n\t\twhen trader.created_at < 20190923\r\n\t\tand trader_marketing_data.utm_aff_id = 53 then trader_marketing_data.utm_sub_aff_id\r\n\t\twhen trader.created_at >= 20190923\r\n\t\tand trader_marketing_data.utm_sub_aff_id is not null then trader_marketing_data.utm_sub_aff_id\r\n\t\telse trader_marketing_data.utm_campaign\r\n\tend,\r\n\t'N/A' ) as campaign_name,\r\n\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\ttrader_marketing_data.utm_source as marker,\r\n\tCOALESCE(kyc_status.name,\r\n\t'null') as verification,\r\n\tsale_status.name as sale_status,\r\n\tsale_status.name as ret_status,\r\n\tcurrency.code as currency,\r\n\tcase\r\n\t\twhen acc_group.name is null then 'BASIC'\r\n\t\telse acc_group.name\r\n\tend as account_type,\r\n\ttrader.lead_score,\r\n\tdates.last_deposit_date,\r\n\tdates.last_withdrawal_date,\r\n\tdates.last_position_date,\r\n\tdates.first_position_date,\r\n\tdates.days_from_last_position,\r\n\ttransaction_withdrawals.first_request_date,\r\n\tdates.last_call_date,\r\n\tdates.last_effective_call_date,\r\n\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_call_date) as days_from_last_call_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\tdatediff(current_date(),\r\n\tFTD.FirstDepositDate) as days_from_ftd,\r\n\tdatediff(current_date(),\r\n\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\tCOALESCE(employees.full_name,\r\n\t'null') as employee_incharge,\r\n\tCOALESCE(employees.team_name,\r\n\t'null') as team_incharge,\r\n\tCOALESCE(employees.department,\r\n\t'null') as department_incharge,\r\n\tCOALESCE(employees.group_name,\r\n\t'null') as group_incharge,\r\n\tassignments.assignment_date,\r\n\tDATEDIFF(CURRENT_DATE(),\r\n\tassignments.assignment_date) as days_from_first_assignment,\r\n\tDATEDIFF(assignments.assignment_date,\r\n\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\tCOALESCE(assignments.full_name_assign,\r\n\t'null') as full_name_assign,\r\n\tCOALESCE(assignments.team_name_assign,\r\n\t'null') as team_name_assign,\r\n\tCOALESCE(assignments.group_name_assign,\r\n\t'null') as group_name_assign,\r\n\tcase\r\n\t\twhen assignments.assignment_date is not null then 1\r\n\t\telse 0\r\n\tend as is_split,\r\n\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t0) as is_1k_redepositor,\r\n\ttrader.locale_id as locale_id,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 'Arabic'\r\n\t\telse 'English'\r\n\tend as locale_group,\r\n\tcase\r\n\t\twhen trader.locale_id in (100) then 2\r\n\t\twhen trader.locale_id in (1,\r\n\t\t10) then 3\r\n\t\telse 1\r\n\tend as locale_group_id,\r\n\ttrader.is_test as is_test\r\nfrom\r\n\ttrader\r\nleft join country on\r\n\ttrader.country_id = country.id\r\nleft join trader_marketing_data on\r\n\ttrader.id = trader_marketing_data.trader_id\r\ninner join brand on \r\n\ttrader.brand_id = brand.id\r\nleft join (\r\n\tselect\r\n\t\ttransaction_record.trader_account_id,\r\n\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\tfrom\r\n\t\ttransaction_record\r\n\tinner join transaction_deposit on\r\n\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\twhere\r\n\t\tCOALESCE(transaction_deposit.payment_provider_id,0) not in (24,32,68,76)\r\n\tgroup by\r\n\t\t1 ) FTD on\r\n\tFTD.trader_account_id = trader.default_account_id\r\nleft join (\r\n\tSELECT\r\n\t\ttrader.id as customer_id,\r\n\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\tfrom\r\n\t\ttrader\r\n\tinner join trader_account on\r\n\t\ttrader.id = trader_account.trader_id\r\n\tinner join transaction_record on\r\n\t\ttransaction_record.trader_account_id = trader_account.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ttrader_id,\r\n\t\t\tmin(open_at) as first_position_date,\r\n\t\t\tmax(open_at) as last_position_date\r\n\t\tfrom\r\n\t\t\ttrader_account_position\r\n\t\tgroup by\r\n\t\t\t1 ) positions on\r\n\t\tpositions.trader_id = trader.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\t`call`.trader_id,\r\n\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\tfrom\r\n\t\t\t`call`\r\n\t\tinner join `user` on\r\n\t\t\t`call`.employee_id = `user`.id\r\n\t\tleft join user_group on\r\n\t\t\tuser_group.user_id = `user`.id\r\n\t\tleft join `group` on\r\n\t\t\t`group`.id = user_group.group_id\r\n\t\twhere\r\n\t\t\tlink like '%voicespin%'\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1 ) calls on\r\n\t\tcalls.trader_id = trader.id\r\n\twhere\r\n\t\ttrader.is_test = 0\r\n\tgroup by\r\n\t\t1 ) dates on\r\n\tdates.customer_id = trader.id\r\nleft join kyc_status on\r\n\ttrader.kyc_status_id = kyc_status.id\r\nleft join sale_status on\r\n\ttrader.sale_status_id = sale_status.id\r\nleft join trader_account on\r\n\ttrader_account.id = trader.default_account_id\r\nleft join currency on\r\n\ttrader_account.currency_id = currency.id\r\nleft join (\r\n\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id ) employees on\r\n\temployees.employee_id = trader.user_id\r\nleft join (\r\n\tselect\r\n\t\tc.id as customer_id,\r\n\t\ta.user_id_new as employee_id,\r\n\t\ta.created_at as assignment_date,\r\n\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend as first_retention_agent,\r\n\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\te.name as team_name_assign,\r\n\t\tg.name as group_name_assign\r\n\tfrom\r\n\t\ttrader_assignment_history a\r\n\tleft join (\r\n\t\tselect\r\n\t\t\ta.trader_id,\r\n\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\tfrom\r\n\t\t\ttrader_assignment_history a\r\n\t\tinner join trader b on\r\n\t\t\ta.trader_id = b.id\r\n\t\tinner join `user` c on\r\n\t\t\ta.user_id_new = c.id\r\n\t\tleft join (\r\n\t\t\tselect\r\n\t\t\t\tuser_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) d on\r\n\t\t\tc.id = d.user_id\r\n\t\tleft join `group` e on\r\n\t\t\td.group_id = e.id\r\n\t\tleft join group_type f on\r\n\t\t\te.type_id = f.id\r\n\t\tinner join user_role g on\r\n\t\t\tc.id = g.user_id\r\n\t\tinner join `role` h on\r\n\t\t\tg.role_id = h.id\r\n\t\twhere\r\n\t\t\tb.is_test = 0\r\n\t\t\tand f.name = 'Retention'\r\n\t\t\tand e.name <> 'Retention Service'\r\n\t\t\tand h.name <> 'Retention Pool'\r\n\t\tgroup by\r\n\t\t\t1 ) fpei on\r\n\t\tfpei.trader_id = a.trader_id\r\n\t\tand fpei.FirstPoolEmpInd = a.id\r\n\tleft join `user` b on\r\n\t\ta.user_id_new = b.id\r\n\tleft join (\r\n\t\tselect\r\n\t\t\tuser_id,\r\n\t\t\tmin(group_id) as group_id\r\n\t\tfrom\r\n\t\t\tuser_group\r\n\t\tgroup by\r\n\t\t\t1) d on\r\n\t\tb.id = d.user_id\r\n\tleft join `group` e on\r\n\t\td.group_id = e.id\r\n\tleft join group_type f on\r\n\t\te.type_id = f.id\r\n\tleft join `group` g on\r\n\t\tg.id = e.parent_id\r\n\tinner join trader c on\r\n\t\ta.trader_id = c.id\r\n\tinner join trader_account on\r\n\t\ttrader_account.trader_id = c.id\r\n\twhere\r\n\t\t1 = 1\r\n\t\tand c.is_test = 0\r\n\t\tand\r\n\t\tcase\r\n\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\telse 1\r\n\t\tend = 1 ) assignments on\r\n\tassignments.customer_id = trader.id\r\nleft join (\r\n\tSELECT\r\n\t\tredeposit.id,\r\n\t\tcase\r\n\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\telse 0\r\n\t\tend as is_redeposit_1k\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader.id,\r\n\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t0) not in (24,32,68,76)\r\n\t\tgroup by\r\n\t\t\t1) redeposit\r\n\tinner join (\r\n\t\t\tselect trader.id,\r\n\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\tfrom\r\n\t\t\ttransaction_record\r\n\t\tinner join transaction_deposit on\r\n\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\tinner join trader on\r\n\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\tinner join `user` on\r\n\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\tinner join (\r\n\t\t\t\tselect user_id,\r\n\t\t\t\tmin(group_id) as group_id\r\n\t\t\tfrom\r\n\t\t\t\tuser_group\r\n\t\t\tgroup by\r\n\t\t\t\t1) user_groups on\r\n\t\t\t`user`.id = user_groups.user_id\r\n\t\tinner join `group` on\r\n\t\t\t`group`.id = user_groups.group_id\r\n\t\twhere\r\n\t\t\ttrader.is_test = 0\r\n\t\t\tand `group`.type_id = 6\r\n\t\tgroup by\r\n\t\t\t1,\r\n\t\t\t2) redeposit_1k on\r\n\t\tredeposit.id = redeposit_1k.id\r\n\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\tredepositor.id = trader.id\r\nleft join (\r\n\t\tselect trader_id,\r\n\t\tmin(created_at) as first_request_date\r\n\tfrom\r\n\t\ttransaction_withdraw\r\n\tgroup by\r\n\t\t1) transaction_withdrawals on\r\n\ttransaction_withdrawals.trader_id = trader.id\r\nleft join (\r\n\t\tselect trader_trade_configuration_group.trader_id,\r\n\t\tname\r\n\tfrom\r\n\t\t(\r\n\t\t\tselect trader_id,\r\n\t\t\tmax(id) as id\r\n\t\tfrom\r\n\t\t\ttrader_trade_configuration_group\r\n\t\tgroup by\r\n\t\t\t1) account_group\r\n\tinner join trader_trade_configuration_group on\r\n\t\taccount_group.id = trader_trade_configuration_group.id\r\n\tinner join trade_configuration_group on\r\n\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\tacc_group.trader_id = trader.id\r\nwhere\r\n\t(case\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1\r\n\tend) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619505ee6780f2002c37ecbb",
                "provider": "MySql",
                "parameters": "WpjwuHhqzfDIdAFVxxbzsI0YjwvC+DbfC5SOQEIG9Hv/ov90B4e996K5jgUO+RnMIymf8vUv4ZkKAz3a9ZjFWfFx0Vo47BjpHtnTXLtkifQRqyaZfd4D6O1eqmErosIKNYe9BaLz/Dcd/UP9mDlqVceymGdLGHoVvU8f/jie8mwEQUF6aAirIkBFxSa+GAc1y/33qpuBkVC0lkCPxLhwxjFEew4CVf7nWq1YJkAA++dxReSWYPaOBwUZ1W5/aDZr",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "e8fbc932-c412-437e-9fab-2abed368ac92",
            "fullname": "MySql:2bf7d494-8952-46fb-898c-04d2fb0ae2d3",
            "type": "extract",
            "name": "2bf7d494-8952-46fb-898c-04d2fb0ae2d3",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "528de922-71ab-4d32-b426-ffab7ec96b61",
                        "id": "tq_bj4Gy2XPN",
                        "name": "York_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "fe35c3e4-779a-4b44-871b-dd03c7a5cff7",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f920790-278e-4464-a5e8-283a494f5b6f",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16e79d93-a1f2-438e-b1f7-7a1cb857e31b",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a11ea554-e6ea-4c04-b074-028ae75faa1f",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22271d39-0b42-4196-bcad-f4ee54b518b1",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "d7f707e1-11ff-4a83-9770-d746de268307",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand, \r\ntrade_configuration_group.active \r\nfrom trade_configuration_group\r\ninner join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6171336f55f384002cf10201",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiXsMSYsuAL/CbGN4aqsTqQK37h2jvswX7OUxbO5ncsXT5ZAQx6xX8RhjlXWOBl+OUE=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "eb18471c-9e15-489e-b3a0-4e8265dae5f9",
            "fullname": "MySql:f18a268d-984f-4760-b2ec-26562ac63782",
            "type": "extract",
            "name": "f18a268d-984f-4760-b2ec-26562ac63782",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8eb2b713-ff3a-42b2-b5fc-16249b4b9dc0",
                        "id": "tq_RRYZqrPjF",
                        "name": "PrimeOT_Customers",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5cc486ba-493a-4d08-b861-6bf39fc7e4d2",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9ca5f378-496c-48f5-a092-b762491dcb34",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f05bf570-8097-46ec-ba64-ec9b37d30945",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ab3757c8-3779-4748-8058-0b4f4cf4de34",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fa8979a9-5172-4879-abdc-af6ea4d8b823",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "19b1388f-3a15-41a3-9fc1-da9aa482808e",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "317ffc47-f37f-4309-a0dc-6249ad2c308f",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "95fcf54c-3862-4f58-97ab-2e59faaa9502",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cdc98764-edd1-47bd-8d21-820c2972dc90",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccddba91-c4db-443b-9e74-4e14422d0395",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b6b8a032-9890-4288-973d-0f101ee9b8ef",
                                "id": "hash_id",
                                "name": "hash_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c823b5b1-6c5e-4470-a038-4c65cadf2d49",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 38,
                                "precision": 38,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b9d7038-e7ee-4eec-81c2-78c143bf3151",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48ee105d-f33c-445d-99b5-a465ba90afbf",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2435e412-3b83-455b-bb19-dcad7e561b2b",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c560f812-b6f4-4be7-9476-9284e61b2493",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 500,
                                "precision": 500,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "919af9a7-fc6c-4851-90b1-a7405aaa1ccd",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e3896c19-24c4-4b57-a8f8-9cdc0197270e",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d13ed78-f9b3-402e-8c05-ad1b5348462f",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "862c393a-d21b-4016-a32f-3fc9aaad6b45",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a7e7acab-f2cc-4398-b02a-42e16a227da0",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3042e9fd-158a-45d1-8541-1f097d6e2963",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "420f593a-6bfc-4f78-9d32-422674c49f10",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dfa2e32e-0de1-4d03-83bf-7f40dea65eb9",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "098c562e-31f3-4374-bda6-08ad89f511f9",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "14120548-0c41-4a09-a85e-afc738287297",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f7ab3ce9-137b-4cc0-bc8c-2feb4bc15a19",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 21845,
                                "precision": 21845,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05d5b727-b3bb-4c9e-8bac-20f61ba6329b",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d50b2617-75ff-4213-83e8-ccea9ca32e82",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7d63c1f9-18cf-4ca1-848e-9a3d582335a8",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c9e28f9-9dce-424a-a3ad-3e80646bf1b5",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ce6d1c6-1bed-42f5-b393-a5f938ab0151",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a9038d9-95aa-4380-a026-2ba7c32958aa",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 5,
                                "size": 10,
                                "precision": 10,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4386054-216b-48b0-8380-42c2bd4bea0b",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a964052-5636-4427-b7da-6eb82d9e496f",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ebcbd7cf-5706-4993-9eaa-567422c1c387",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0617b725-4937-43ab-a284-981dc42f7fe8",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cc3f3ce2-0e81-4796-977d-806811cb0098",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a44970b4-c043-460a-82cd-409571c0f1a6",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4ab97b1c-9289-4aee-9aa7-63d6f2f188ae",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dd64f0a7-bed7-41eb-b572-7b97feffd0d8",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a9e70fc7-0393-4237-a06a-cd1dc8d5f108",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c330d27a-2d27-4d1a-bb64-ada00c71e31f",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f22c328a-7d7b-4d50-a8f1-dd4740435f93",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee6430ee-ea53-46cb-b140-64472289dfae",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "93ed17a2-a22c-438f-adde-5612da961c14",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b6b85d3-58f2-4516-b017-d168fad13972",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55b58b79-c54b-45c7-bde7-d6ee66bdaf96",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e82ab81c-cb35-4e00-9c27-975b34635d27",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ac19eab-7f2f-4a57-ae90-05143ae8c92e",
                                "id": "group_incharge",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6134516b-dcf5-4a90-b1e4-02c85cbd3436",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c98a64ff-a50c-40be-863c-658d7c1d5ce5",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2ddcf89a-49fb-4646-8e0a-e408941ea056",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4fcd94a0-06df-407b-a7c2-cc5445d35005",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0acbc76b-8488-4731-98f2-503a5f0fa1f6",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3106b54d-136d-4ade-b474-6cc43135f199",
                                "id": "group_name_assign",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71c87c71-afe4-473d-85b8-50b341b69ee6",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92c18295-f01e-41f8-afa3-b5dbc85464f4",
                                "id": "is_redeposit_1k",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c028b8d9-999d-411e-a6e9-24da0ac31928",
                                "id": "locale_id",
                                "name": "locale_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bdabdf9f-2cab-491d-832f-2d3e253d6da4",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e029d787-443d-41c8-bfb1-8a5595d15295",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "344643cd-5a62-4dd5-9590-7fbee2c9e316",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 20,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "2a9038d9-95aa-4380-a026-2ba7c32958aa",
                                    "type": 18
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "cad84172-1355-41be-8884-b9c0cd714c94",
                        "configOptions": {
                            "importQuery": "select\r\n\tbrand.name as SiteName,\r\n\t1000 + brand.id as site_id,\r\n\ttrader.default_account_id,\r\n\ttrader_account.balance,\r\ntrader_account.equity as equity_crm,\r\n        trader_account.margin_used,\r\n        trader_account.pnl as open_pnl_crm,\r\n        trader_account.margin_available,\r\n\tconcat( coalesce(1000 + brand.id,1002), 10002, trader.id ) as customer_key,\r\n\ttrader.id as customer_id,\r\n\ttrader_account.id as hash_id,\r\n\tconcat( coalesce(1000 + brand.id,1002), 10002, COALESCE(trader.user_id, 0)) as employee_key_in_charge,\r\n\ttrader.first_name,\r\n\ttrader.last_name,\r\n\tconcat( trader.first_name, ' ', trader.last_name ) as full_name,\r\n\tcoalesce(trader_account.wallet_number,\r\n\t'N/A') as wallet_number,\r\n\ttrader.created_at as RegTime,\r\n\tyear(trader.created_at)* 10000 + month(trader.created_at)* 100 + day(trader.created_at) as reg_time_key,\r\n\tFTD.FirstDepositDate,\r\n\tcase\r\n\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\telse 1 end as FTDInd,\r\n\t\ttrader.email,\r\n\t\tcountry.name as country_name,\r\n\t\tcountry.code as country_code,\r\n\t\t'CySEC' as country_type,\r\n\t\tCOALESCE(\r\n\t\tcase\r\n\t\t\twhen trader_marketing_data.utm_sub_aff_id is null then trader_marketing_data.utm_campaign\r\n\t\t\telse trader_marketing_data.utm_sub_aff_id end,\r\n\t\t\t'N/A' ) as campaign_name,\r\n\t\ttrader_marketing_data.utm_sub_aff_id as campaign_sub_id,\r\n\t\ttrader_marketing_data.utm_source as marker,\r\n\t\tCOALESCE(kyc_status.name,\r\n\t\t'null') as verification,\r\n\t\tsale_status.name as sale_status,\r\n\t\tsale_status.name as ret_status,\r\n\t\tcurrency.code as currency,\r\n\t\tcase\r\n\t\t\twhen acc_group.name is null then 'BASIC'\r\n\t\t\telse acc_group.name end as account_type,\r\n\t\t\ttrader.lead_score,\r\n\t\t\tdates.last_deposit_date,\r\n\t\t\tdates.last_withdrawal_date,\r\n\t\t\tdates.last_position_date,\r\n\t\t\tdates.first_position_date,\r\n\t\t\tdates.days_from_last_position,\r\n\t\t\ttransaction_withdrawals.first_request_date,\r\n\t\t\tdates.last_call_date,\r\n\t\t\tdates.last_effective_call_date,\r\n\t\t\tDATEDIFF(transaction_withdrawals.first_request_date,\r\n\t\t\tFTD.FirstDepositDate) AS days_from_first_request,\r\n\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\tdates.last_call_date) as days_from_last_call_date,\r\n\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\tdates.last_effective_call_date) as days_from_last_effective_call_date,\r\n\t\t\tdatediff(current_date(),\r\n\t\t\tFTD.FirstDepositDate) as days_from_ftd,\r\n\t\t\tdatediff(current_date(),\r\n\t\t\ttransaction_withdrawals.first_request_date) as days_from_first_request_till_today,\r\n\t\t\tCOALESCE(employees.full_name,\r\n\t\t\t'null') as employee_incharge,\r\n\t\t\tCOALESCE(employees.team_name,\r\n\t\t\t'null') as team_incharge,\r\n\t\t\tCOALESCE(employees.department,\r\n\t\t\t'null') as department_incharge,\r\n\t\t\tCOALESCE(employees.group_name,\r\n\t\t\t'null') as group_incharge,\r\n\t\t\tassignments.assignment_date,\r\n\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\tassignments.assignment_date) as days_from_first_assignment,\r\n\t\t\tDATEDIFF(assignments.assignment_date,\r\n\t\t\tFTD.FirstDepositDate) AS days_from_ftd_to_first_assignemnt,\r\n\t\t\tCOALESCE(assignments.full_name_assign,\r\n\t\t\t'null') as full_name_assign,\r\n\t\t\tCOALESCE(assignments.team_name_assign,\r\n\t\t\t'null') as team_name_assign,\r\n\t\t\tCOALESCE(assignments.group_name_assign,\r\n\t\t\t'null') as group_name_assign,\r\n\t\t\tcase\r\n\t\t\t\twhen assignments.assignment_date is not null then 1\r\n\t\t\t\telse 0 end as is_split,\r\n\t\t\t\tCOALESCE(redepositor.is_redeposit_1k,\r\n\t\t\t\t0) as is_redeposit_1k,\r\n\t\t\t\ttrader.locale_id as locale_id,\r\n\t\t\t\tcase\r\n\t\t\t\t\twhen trader.locale_id in (100) then 'Germany'\r\n\t\t\t\t\twhen trader.locale_id in (1,\r\n\t\t\t\t\t10) then 'Arabic'\r\n\t\t\t\t\telse 'English' end as locale_group,\r\n\t\t\t\t\tcase\r\n\t\t\t\t\t\twhen trader.locale_id in (100) then 2\r\n\t\t\t\t\t\twhen trader.locale_id in (1,\r\n\t\t\t\t\t\t10) then 3\r\n\t\t\t\t\t\telse 1 end as locale_group_id,\r\n\t\t\t\t\t\ttrader.is_test as is_test\r\n\t\t\t\t\tfrom\r\n\t\t\t\t\t\ttrader\r\n\t\t\t\t\tleft join country on\r\n\t\t\t\t\t\ttrader.country_id = country.id\r\n\t\t\t\t\tleft join trader_marketing_data on\r\n\t\t\t\t\t\ttrader.id = trader_marketing_data.trader_id\r\n\t\t\t\t\tinner join brand on trader.brand_id = brand.id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\ttransaction_record.trader_account_id,\r\n\t\t\t\t\t\t\tmin(transaction_record.created_at) as FirstDepositDate\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttransaction_deposit.payment_provider_id not in (24,29,45,62,107)\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1 ) FTD on\r\n\t\t\t\t\t\tFTD.trader_account_id = trader.default_account_id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\ttrader.id as customer_id,\r\n\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 1 then transaction_record.created_at end) as last_deposit_date,\r\n\t\t\t\t\t\t\tmax(case when transaction_record.origin_type = 2 then transaction_record.created_at end) as last_withdrawal_date,\r\n\t\t\t\t\t\t\tmax(positions.last_position_date) as last_position_date,\r\n\t\t\t\t\t\t\tmin(positions.first_position_date) as first_position_date,\r\n\t\t\t\t\t\t\tDATEDIFF(CURRENT_DATE(),\r\n\t\t\t\t\t\t\tmax(positions.last_position_date)) as days_from_last_position,\r\n\t\t\t\t\t\t\tmax(calls.last_call_date) as last_call_date,\r\n\t\t\t\t\t\t\tmax(calls.last_effective_call_date) as last_effective_call_date\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttrader\r\n\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\ttrader.id = trader_account.trader_id\r\n\t\t\t\t\t\tinner join transaction_record on\r\n\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader_account.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmin(open_at) as first_position_date,\r\n\t\t\t\t\t\t\t\tmax(open_at) as last_position_date\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader_account_position\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) positions on\r\n\t\t\t\t\t\t\tpositions.trader_id = trader.id\r\n\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`call`.trader_id,\r\n\t\t\t\t\t\t\t\tmin(`call`.created_at) as first_call_date,\r\n\t\t\t\t\t\t\t\tmin(case when duration >= 180 then `call`.created_at end) as first_effective_call_date,\r\n\t\t\t\t\t\t\t\tmin(case when duration >= 1800 then `call`.created_at end) as first_effective_30_min,\r\n\t\t\t\t\t\t\t\tmax(`call`.created_at) as last_call_date,\r\n\t\t\t\t\t\t\t\tmax(case when duration >= 180 then `call`.created_at end) as last_effective_call_date,\r\n\t\t\t\t\t\t\t\tmax(case when duration >= 1800 then `call`.created_at end) as last_effective_30_min\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t`call`\r\n\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t`call`.employee_id = `user`.id\r\n\t\t\t\t\t\t\tleft join user_group on\r\n\t\t\t\t\t\t\t\tuser_group.user_id = `user`.id\r\n\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t`group`.id = user_group.group_id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\tlink like '%voicespin%'\r\n\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1 ) calls on\r\n\t\t\t\t\t\t\tcalls.trader_id = trader.id\r\n\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1 ) dates on\r\n\t\t\t\t\t\tdates.customer_id = trader.id\r\n\t\t\t\t\tleft join kyc_status on\r\n\t\t\t\t\t\ttrader.kyc_status_id = kyc_status.id\r\n\t\t\t\t\tleft join sale_status on\r\n\t\t\t\t\t\ttrader.sale_status_id = sale_status.id\r\n\t\t\t\t\tleft join trader_account on\r\n\t\t\t\t\t\ttrader_account.id = trader.default_account_id\r\n\t\t\t\t\tleft join currency on\r\n\t\t\t\t\t\ttrader_account.currency_id = currency.id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t`user`.id as employee_id,\r\n\t\t\t\t\t\t\t\tconcat( 100, 10000, `user`.id ) as employee_key,\r\n\t\t\t\t\t\t\t\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\t\t\t\t\t\t\t\t`group`.name as team_name,\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch'\r\n\t\t\t\t\t\t\t\t\tand `group`.name = 'Serbia Con' then 'Conversion'\r\n\t\t\t\t\t\t\t\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\t\t\t\t\t\t\t\telse group_type.name end as department,\r\n\t\t\t\t\t\t\t\t\tgroup_group.name as group_name\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t`user`\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(c.id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\tb.group_id = c.id\r\n\t\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\t\tc.parent_id is not null\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\tunion\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\temp.id,\r\n\t\t\t\t\t\t\t\t\t\tmin(user_group.group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\tproba.id,\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch)\r\n\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\t\t\ta.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twhen c.parent_id is not null then 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse 0 end as ch\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`user` a\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join user_group b on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ta.id = b.user_id\r\n\t\t\t\t\t\t\t\t\t\t\t\tinner join `group` c on\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb.group_id = c.id)proba\r\n\t\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\thaving\r\n\t\t\t\t\t\t\t\t\t\t\tsum(ch) = 0) emp\r\n\t\t\t\t\t\t\t\t\tinner join user_group on\r\n\t\t\t\t\t\t\t\t\t\temp.id = user_group.user_id\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\tuser_groups.id = `user`.id\r\n\t\t\t\t\t\t\t\tleft join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\tleft join group_type on\r\n\t\t\t\t\t\t\t\t\tgroup_type.id = `group`.type_id\r\n\t\t\t\t\t\t\t\tleft join `group` group_group on\r\n\t\t\t\t\t\t\t\t\tgroup_group.id = `group`.parent_id ) employees on\r\n\t\t\t\t\t\temployees.employee_id = trader.user_id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\tc.id as customer_id,\r\n\t\t\t\t\t\t\ta.user_id_new as employee_id,\r\n\t\t\t\t\t\t\ta.created_at as assignment_date,\r\n\t\t\t\t\t\t\tyear(a.created_at)* 10000 + month(a.created_at)* 100 + day(a.created_at) as assignment_date_key,\r\n\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\telse 1 end as first_retention_agent,\r\n\t\t\t\t\t\t\t\tCONCAT(b.first_name, ' ', b.last_name) as full_name_assign,\r\n\t\t\t\t\t\t\t\te.name as team_name_assign,\r\n\t\t\t\t\t\t\t\tg.name as group_name_assign\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ta.trader_id,\r\n\t\t\t\t\t\t\t\t\tmin(a.id) as FirstPoolEmpInd\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttrader_assignment_history a\r\n\t\t\t\t\t\t\t\tinner join trader b on\r\n\t\t\t\t\t\t\t\t\ta.trader_id = b.id\r\n\t\t\t\t\t\t\t\tinner join `user` c on\r\n\t\t\t\t\t\t\t\t\ta.user_id_new = c.id\r\n\t\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\t\tc.id = d.user_id\r\n\t\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\t\tinner join user_role g on\r\n\t\t\t\t\t\t\t\t\tc.id = g.user_id\r\n\t\t\t\t\t\t\t\tinner join `role` h on\r\n\t\t\t\t\t\t\t\t\tg.role_id = h.id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\tb.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand f.name = 'Retention'\r\n\t\t\t\t\t\t\t\t\tand e.name <> 'Retention Service'\r\n\t\t\t\t\t\t\t\t\tand h.name <> 'Retention Pool'\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1 ) fpei on\r\n\t\t\t\t\t\t\t\tfpei.trader_id = a.trader_id\r\n\t\t\t\t\t\t\t\tand fpei.FirstPoolEmpInd = a.id\r\n\t\t\t\t\t\t\tleft join `user` b on\r\n\t\t\t\t\t\t\t\ta.user_id_new = b.id\r\n\t\t\t\t\t\t\tleft join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1) d on\r\n\t\t\t\t\t\t\t\tb.id = d.user_id\r\n\t\t\t\t\t\t\tleft join `group` e on\r\n\t\t\t\t\t\t\t\td.group_id = e.id\r\n\t\t\t\t\t\t\tleft join group_type f on\r\n\t\t\t\t\t\t\t\te.type_id = f.id\r\n\t\t\t\t\t\t\tleft join `group` g on\r\n\t\t\t\t\t\t\t\tg.id = e.parent_id\r\n\t\t\t\t\t\t\tinner join trader c on\r\n\t\t\t\t\t\t\t\ta.trader_id = c.id\r\n\t\t\t\t\t\t\tinner join trader_account on\r\n\t\t\t\t\t\t\t\ttrader_account.trader_id = c.id\r\n\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t1 = 1\r\n\t\t\t\t\t\t\t\tand c.is_test = 0\r\n\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\t\twhen fpei.FirstPoolEmpInd is null then 0\r\n\t\t\t\t\t\t\t\t\telse 1 end = 1 ) assignments on\r\n\t\t\t\t\t\tassignments.customer_id = trader.id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tSELECT\r\n\t\t\t\t\t\t\tredeposit.id,\r\n\t\t\t\t\t\t\tcase\r\n\t\t\t\t\t\t\t\twhen redeposit_1k.total_retention_deposit >= 950 then 1\r\n\t\t\t\t\t\t\t\telse 0 end as is_redeposit_1k\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\tmin(transaction_record.id) as redeposit_id,\r\n\t\t\t\t\t\t\t\t\tmin(transaction_record.created_at) as redeposit_date\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t`user`.id = user_groups.user_id\r\n\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\t\tand coalesce(transaction_deposit.payment_provider_id,\r\n\t\t\t\t\t\t\t\t\t0) not in (24,29,45,62,107)\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1) redeposit\r\n\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\ttrader.id,\r\n\t\t\t\t\t\t\t\t\tdate_format(transaction_record.created_at, '%Y-%m') as 'year_month',\r\n\t\t\t\t\t\t\t\t\tsum(transaction_record.wide_currency_amount) as total_retention_deposit\r\n\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\ttransaction_record\r\n\t\t\t\t\t\t\t\tinner join transaction_deposit on\r\n\t\t\t\t\t\t\t\t\ttransaction_record.id = transaction_deposit.ftr_id\r\n\t\t\t\t\t\t\t\tinner join trader on\r\n\t\t\t\t\t\t\t\t\ttransaction_record.trader_account_id = trader.default_account_id\r\n\t\t\t\t\t\t\t\tinner join `user` on\r\n\t\t\t\t\t\t\t\t\ttransaction_deposit.owner_id = `user`.id\r\n\t\t\t\t\t\t\t\tinner join (\r\n\t\t\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\t\t\tuser_id,\r\n\t\t\t\t\t\t\t\t\t\tmin(group_id) as group_id\r\n\t\t\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\t\t\tuser_group\r\n\t\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t\t1) user_groups on\r\n\t\t\t\t\t\t\t\t\t`user`.id = user_groups.user_id\r\n\t\t\t\t\t\t\t\tinner join `group` on\r\n\t\t\t\t\t\t\t\t\t`group`.id = user_groups.group_id\r\n\t\t\t\t\t\t\t\twhere\r\n\t\t\t\t\t\t\t\t\ttrader.is_test = 0\r\n\t\t\t\t\t\t\t\t\tand `group`.type_id = 6\r\n\t\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t\t\t2) redeposit_1k on\r\n\t\t\t\t\t\t\t\tredeposit.id = redeposit_1k.id\r\n\t\t\t\t\t\t\t\tand date_format(redeposit.redeposit_date, '%Y-%m') = redeposit_1k.`year_month` )redepositor on\r\n\t\t\t\t\t\tredepositor.id = trader.id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\tmin(created_at) as first_request_date\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\ttransaction_withdraw\r\n\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t1) transaction_withdrawals on\r\n\t\t\t\t\t\ttransaction_withdrawals.trader_id = trader.id\r\n\t\t\t\t\tleft join (\r\n\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\ttrader_trade_configuration_group.trader_id,\r\n\t\t\t\t\t\t\tname\r\n\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\tselect\r\n\t\t\t\t\t\t\t\ttrader_id,\r\n\t\t\t\t\t\t\t\tmax(id) as id\r\n\t\t\t\t\t\t\tfrom\r\n\t\t\t\t\t\t\t\ttrader_trade_configuration_group\r\n\t\t\t\t\t\t\tgroup by\r\n\t\t\t\t\t\t\t\t1) account_group\r\n\t\t\t\t\t\tinner join trader_trade_configuration_group on\r\n\t\t\t\t\t\t\taccount_group.id = trader_trade_configuration_group.id\r\n\t\t\t\t\t\tinner join trade_configuration_group on\r\n\t\t\t\t\t\t\ttrader_trade_configuration_group.trade_configuration_group_id = trade_configuration_group.id) acc_group on\r\n\t\t\t\t\t\tacc_group.trader_id = trader.id\r\n\t\t\t\t\twhere\r\n\t\t\t\t\t\t(case\r\n\t\t\t\t\t\t\twhen FTD.FirstDepositDate is null then 0\r\n\t\t\t\t\t\t\telse 1 end) = 1"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6195023f6780f2002c37eca8",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CLQO1pn40szcYNg2rZoiX1Vg29Vp5lwLqTDoBiPX74Z7tq4A1c99blLl+UTfHxXxv3fHMdNaD6ZQ0AYwLSELF3A=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ec878bef-0cb1-4a22-9f5d-a8d2b2192194",
            "fullname": "c801850d-8313-40a6-9fe9-a45688f99bdc",
            "type": "custom",
            "name": "c801850d-8313-40a6-9fe9-a45688f99bdc",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f751a92e-17cb-49e6-8662-e4dc5cfe1437",
                        "id": "New Custom Table",
                        "name": "Customers",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "b314b467-d8fa-45c8-969e-bbb2e8d7df93",
                            "expression": "select\r\n\tcustomers.*,\r\n\tcase \r\n\t\twhen isnull(customers.[balance] - open_pnl_customer.[open_pnl]) then customers.[balance]\r\n\t\telse customers.[balance] - open_pnl_customer.[open_pnl] \r\n\tend as equity \r\nfrom\r\n(\r\n\tselect YorkCustomers.* from [YorkCustomers]\r\nunion all\r\n\tselect IvyTrustCustomers.* from [IvyTrustCustomers]\r\nunion all\r\n\tselect MarketCGCustomers.* from [MarketCGCustomers]\r\nunion all\r\n\tselect PrimeOT_Customers.* from [PrimeOT_Customers]\r\nunion all\r\n\tselect [TheWealthCore_Customers].* from [TheWealthCore_Customers]\r\nunion all\r\n\tselect [Arrowteks_Customers].* from [Arrowteks_Customers]\r\nunion all\r\n\tselect [AussieTrust_Customers].* from [AussieTrust_Customers]\r\nunion all \r\n    select InfinityCapitalg_Customers.* from InfinityCapitalg_Customers\r\nunion all \r\n    select [365TradingFX_Customers].* from [365TradingFX_Customers]\r\nunion all\r\n    select * from TradetHeBit_customers\r\nunion all\r\n    select * from NostraCapital_Customers\r\nunion all\r\n    select * from TheBPCA_Customers\r\nunion all\r\n    select * from GeniusIG_Customers\r\nunion all\r\n    select * from Chelsea_Customers\r\nunion all\r\n    select * from AshfordCapital_Customers\r\nunion all\r\n    select * from WinGroup_Customers\r\nunion all\r\n    select * from BendigoCoins_Customers\r\nunion all \r\n    select * from Bitfinity_Customers\r\n) customers\r\nleft join [open_pnl_customer] on open_pnl_customer.[account_id] = customers.[default_account_id]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "ba7cdda7-8181-4e14-8edd-d46147c261f2",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77f86db3-c28a-4eaf-9be1-c08c114a1a24",
                                "id": "48c627fd-b035-42bf-b5f6-a7aaec6b0979",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba551f79-9ac3-435a-8b33-35d5a7508b88",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7eca2b9e-3c63-46f2-b683-9d7d43e9ca5d",
                                "id": "balance",
                                "name": "balance",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "926ee445-a8d6-403e-afc1-b7a50c701889",
                                "id": "equity_crm",
                                "name": "equity_crm",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2d750382-4810-42ed-afbd-da1f02d9dde6",
                                "id": "margin_used",
                                "name": "margin_used",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0485b025-38da-4742-a84e-14a09ef5fdb6",
                                "id": "open_pnl_crm",
                                "name": "open_pnl_crm",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c9966427-2749-4bb9-a908-236020caf5de",
                                "id": "margin_available",
                                "name": "margin_available",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "23b81b6b-c119-464d-b233-174267a385e4",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01361e8e-e426-46cd-b3dd-94826dd0cbd6",
                                "id": "fbb604ba-0b6d-49fe-9105-0877e941faf0",
                                "name": "customer_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cff52611-0e36-48a0-9213-91714efd4ee6",
                                "id": "6c27ab2d-7af3-4a97-957f-1d1ab7db6c5c",
                                "name": "hash_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca081f4e-e999-49ac-8a2d-01e84c998707",
                                "id": "employee_key_in_charge",
                                "name": "employee_key_in_charge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da3a2d03-ce49-4af4-b947-08f0570e00c8",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "185d7c1d-5885-4941-8879-a544b05f8c91",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bd55de8-9854-45d2-909e-465959945179",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e65482f-1579-41a3-9829-72cce6ff150d",
                                "id": "wallet_number",
                                "name": "wallet_number",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "964733c9-bb17-453a-893f-40fa2a8be138",
                                "id": "RegTime",
                                "name": "RegTime",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e05de19b-a57a-4f1f-a4bf-51a920c7e0ff",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ea0e6744-ca12-4431-ae82-51c96979873d",
                                "id": "FirstDepositDate",
                                "name": "FirstDepositDate",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f93b855a-9ebb-4afa-be3c-7f9b268d780c",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "49098305-9f1f-4d4e-bddc-45afa7b2271f",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "034c1938-3d86-4b0b-aa01-07929160a9c6",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a597f12d-5f08-4385-8429-44796df070d4",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2db56362-3ee6-4c43-b6c8-863d268ff7ee",
                                "id": "country_type",
                                "name": "country_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b0eef23-9a7e-49b6-89a9-668e6d5e3aa2",
                                "id": "campaign_name",
                                "name": "campaign_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffd0261e-9a99-403b-addf-54b32bcc966b",
                                "id": "campaign_sub_id",
                                "name": "campaign_sub_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f6c64c6-9856-42c1-b84f-5c7a07a88854",
                                "id": "marker",
                                "name": "marker",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44bd350f-f175-446b-b3f8-2a7ba55f8857",
                                "id": "verification",
                                "name": "verification",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ddf0b035-7103-4e97-88a5-bd36ff6f139c",
                                "id": "sale_status",
                                "name": "sale_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5913e8fd-5152-4c7e-af83-b377c0fa735a",
                                "id": "ret_status",
                                "name": "ret_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf3773b7-4ef8-4a73-ad90-f59553218da7",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e08259b-e01e-479a-8234-8dd8494e7eb6",
                                "id": "account_type",
                                "name": "account_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d65ab6a4-45c9-4870-8a0e-acbda4cf6d4b",
                                "id": "lead_score",
                                "name": "lead_score",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c130a390-51a6-4594-b4f4-5b0ba16fae6a",
                                "id": "last_deposit_date",
                                "name": "last_deposit_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b14a9c3e-7a27-47d2-a69f-281d5d382016",
                                "id": "last_withdrawal_date",
                                "name": "last_withdrawal_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f5938eac-7a46-440f-891a-de24fa60ed12",
                                "id": "last_position_date",
                                "name": "last_position_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b2ddefb-7e92-48ae-98ff-28dff0e14600",
                                "id": "first_position_date",
                                "name": "first_position_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fc3cb85e-8480-44c9-a4f0-c84858702999",
                                "id": "days_from_last_position",
                                "name": "days_from_last_position",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a6ec96a3-0440-4a51-a91b-c596add0c2c6",
                                "id": "first_request_date",
                                "name": "first_request_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d388f02a-1999-4d43-8acf-8f1e635f5df2",
                                "id": "last_call_date",
                                "name": "last_call_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a0d6addf-b0dc-4d66-9ff9-37976635f24d",
                                "id": "last_effective_call_date",
                                "name": "last_effective_call_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0cee2aa9-9268-4b7c-92b1-6cf61b2c41cc",
                                "id": "days_from_first_request",
                                "name": "days_from_first_request",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e9fb07f8-30a2-42d5-8b99-80766f01db75",
                                "id": "days_from_last_call_date",
                                "name": "days_from_last_call_date",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d0f558d8-97f1-4008-a32a-cfa11e74bd2b",
                                "id": "days_from_last_effective_call_date",
                                "name": "days_from_last_effective_call_date",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b120529d-f593-4f17-bd16-3f7fe30756b4",
                                "id": "days_from_ftd",
                                "name": "days_from_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "83ca4887-947b-4df6-94a5-f4a8a0f17f79",
                                "id": "days_from_first_request_till_today",
                                "name": "days_from_first_request_till_today",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c9d0d96e-2358-4243-8e7e-a3c7638de6fe",
                                "id": "employee_incharge",
                                "name": "employee_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "393a6ba6-390e-4d99-b107-71c8aaf6f3c6",
                                "id": "team_incharge",
                                "name": "team_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c84e9fe9-b223-4601-98ea-940b0563e580",
                                "id": "department_incharge",
                                "name": "department_incharge",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "efd01abe-84a6-4313-bf1c-6419ccb85730",
                                "id": "6b3f11cb-e16a-4161-8723-5d31a0a31859",
                                "name": "group_incharge",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d673a1c9-c43a-4013-b3fc-74a48cd0b612",
                                "id": "assignment_date",
                                "name": "assignment_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "673d2cc4-9d88-4ee0-990d-a63bf5094cef",
                                "id": "days_from_first_assignment",
                                "name": "days_from_first_assignment",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6af24a23-5871-43d2-81a8-561dbe78e862",
                                "id": "days_from_ftd_to_first_assignemnt",
                                "name": "days_from_ftd_to_first_assignemnt",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b760e081-130b-4640-a455-7fc32ef07d47",
                                "id": "full_name_assign",
                                "name": "full_name_assign",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3eb7717d-07f9-44ca-85ec-bc30022d6882",
                                "id": "team_name_assign",
                                "name": "team_name_assign",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02960555-8cd1-4a18-9f7b-7a2fd7f548fc",
                                "id": "c4b03f24-0156-4535-a52b-fc9ead98c81d",
                                "name": "group_name_assign",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc9bfed4-be44-4d82-a312-ef44a1ec1757",
                                "id": "is_split",
                                "name": "is_split",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2fedacb7-6964-4275-a83d-f59b39d7eace",
                                "id": "785e3c12-d1c6-4799-8131-c987884e5e23",
                                "name": "is_redeposit_1k",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2486422-272b-4c68-9a77-4903eef03fa0",
                                "id": "07de5e3b-e7de-432c-8726-8cb0877387e7",
                                "name": "locale_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bde68245-5fa2-44c6-b36c-6d806498a636",
                                "id": "locale_group",
                                "name": "locale_group",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73b9660b-2d14-4243-b711-9fbfbca4c809",
                                "id": "locale_group_id",
                                "name": "locale_group_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f17ac60-ac77-4690-a28d-2185302356c9",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3d65aca6-f6d4-4316-8261-4c2d40669a86",
                                "id": "equity",
                                "name": "equity",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "26adc93b-82a3-4ee2-96bc-4f6b498ed99f",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "f1be531a-d5a0-43ed-a88b-fb23e39fe385",
            "fullname": "MySql:f48c3f4a-67e8-4801-bc1b-04fb6b30df90",
            "type": "extract",
            "name": "f48c3f4a-67e8-4801-bc1b-04fb6b30df90",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "95b10a75-cf74-441f-911e-f3e953b27285",
                        "id": "tq_YWljeng0d",
                        "name": "BigBitMarket_OpenPositions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5b4874d6-3aa1-4935-87d8-a46c16de785b",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1060567-976d-4643-9fde-34d0b2527fc1",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c7c280d9-6570-4c9a-8aaa-3e6134994a45",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c547805-1623-4da1-a7a6-807c65e0f811",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a44195e-569d-488f-9ece-a3179dde0c5f",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f694e28-9730-4dc0-b50b-55789e6ae21a",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "156185de-aae9-4a3e-a86e-d5c78802e671",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 27,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc79da8d-9c3a-4693-95d8-c6b4ea1b2754",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9f7aa22-0a2b-48af-b965-10a1e29f58ce",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 47,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "bdf819d0-e1f2-43ec-b385-16870ada413d",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0e863b43ad1002c7a758f",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f210c86d-1891-40a2-b120-3bfa9054a29a",
            "fullname": "MySql:324cb4ad-f23e-41b5-b26a-743bf23312c9",
            "type": "extract",
            "name": "324cb4ad-f23e-41b5-b26a-743bf23312c9",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5368a56da002c36c740",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8OSfPYhJH5R3HPnPvPUq9ufFEejHbQ5noMM+s2I3j9hfV4ghZOttugRuXVbNWlMq51sPWEQ79B4SIfJgGwbgIEwugkCtRlhGLq4p5Jfb15dVDFMoI69c+dcUuN1SDyQ57I=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f219d10c-8e07-441c-90bb-026b3e2406f3",
            "fullname": "MySql:c1db5c12-bc6b-4cd8-907b-11d8ebef9a6f",
            "type": "extract",
            "name": "c1db5c12-bc6b-4cd8-907b-11d8ebef9a6f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "71ac71de-f1e0-4323-bb9a-70de513046ad",
                        "id": "tq_xXfX481y4",
                        "name": "WinGroup_OpenPositions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "50f95f9c-88c4-405a-ab8e-9a7e1aff30ee",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06f9583d-1e1b-482c-bcea-bc67cb7f69e0",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d6a47c3-dedf-42fd-8a4c-bb1c085cc5d7",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4cacb8ca-2747-459e-9235-2466509b1d27",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6aff1eda-f255-4314-bcd8-616f3966c26c",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4db25c80-4791-4526-be94-e6bba97eb1c4",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e5e291b-c45e-4260-a7d7-069673b1dd7f",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33d8b13a-08bc-43b5-8720-d5ce070fcb08",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f7968de-0cbd-48e0-a854-070691a8bc0b",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "2aa8607e-545f-49d3-9404-fac28dbe24ab",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c742",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oISZYo/jnBBiedN+eL7iEVmicVz5zdJvnkTnDpGXX+jM3jkWwQH1GDq4EovBiX29q5VS6x+Z07G9BXJJzwZT+nGfZWcVbeOv81/ipF/iAkEydLA1qCoilSMT7qJlQub6SW5eExTvv+75JqKLkCs/jkkYjDgSKl1b0MSB6ZMr8WT",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f26757f2-c527-4201-a7f2-d668f88631e7",
            "fullname": "MySql:9a368ec4-5aca-42ad-91d1-058c3cda6c47",
            "type": "extract",
            "name": "9a368ec4-5aca-42ad-91d1-058c3cda6c47",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4bf7e1dd-1471-4517-abe0-a117c1edb761",
                        "id": "tq_xizEmuVGd",
                        "name": "AussieTrust_Employees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "9542e684-ee3d-40ac-a220-cbd7b817d4e8",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4098d7c-e582-49ac-9a71-f0e489a7cefb",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6f60a9d3-edfd-4279-b588-418884d3a992",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7bd299f-f2d4-42af-abda-380c1efbb260",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3c43b74-90f7-4cff-a025-ada9a8a6bff4",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12f15a7b-6797-4fbe-91fb-2c84cd3273fc",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a2c338d-8798-4df5-9fb0-c61755a1ffd9",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cf21b38-585b-4ce1-900b-534aab1aa1a4",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c223c22f-5ee3-4f58-b16c-91b0ef4ffc8f",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c4734d8-90bb-43fa-b99d-3f7d339fbc00",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "334fed04-b7c2-4f70-bd74-e94a7f5b5fda",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tbrand.id + 1000 as site_id,\r\n\tconcat( brand.id + 1000, 10002, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\nleft join brand on 1=1 \r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506a46780f2002c37eccc",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f6cb845f-826f-4128-a929-249113e6559f",
            "fullname": "MySql:f19dd6c7-360b-4a5c-a4ce-ed4afba8cd96",
            "type": "extract",
            "name": "f19dd6c7-360b-4a5c-a4ce-ed4afba8cd96",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0a8ffa7d-4509-41fa-a0ea-0d2bcb46a393",
                        "id": "tq_nXEbdq0Ao",
                        "name": "Chelsea_Open_Positions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "91961c61-9fed-4303-9e15-dcd0216341c1",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9204852-b2fc-4186-80a9-a7818baa094b",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6163d06-0ac1-4e88-981c-15a213c7e1de",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "963e8332-6fc2-466d-9f0e-531f492d9f0e",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0a97e63-d33d-49ca-9686-68deeccd59ee",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e839a00-f7ab-422d-9596-8de6b8d9b4d6",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50f505ab-26ae-4588-a896-9854b5cfa3dc",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3de07ca7-7213-48d8-a293-82955bbb5fb3",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ad05a8b-fe3c-4883-828d-0ea5014bf20a",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "cf876893-1916-4ff7-a5d5-c5068cb19d0b",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend)*(-1)\nas pnl_usd\nfrom\ntrader_account_position  \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c744",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6lmoVQsTevINebgL5jFjt37tZHVE1yfCNBl6wIlYq6wI7NUggy3EK86zDSbM4Fw27FcQ7WJjO+t052mJVx7AZ+Z6gWRvGvZ4n1PPPLo5KaSvMstq72ErNzPegcuzwKce1NBllSBZUAXHjSilY0GlglY61i6z48l5MvN5HzcxxLj8",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f79ece7c-990d-499a-bf18-dcf8e8ebcf95",
            "fullname": "MySql:08629ecc-6fd7-478c-814f-e92bc32378c2",
            "type": "extract",
            "name": "08629ecc-6fd7-478c-814f-e92bc32378c2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "08bcb8e0-3d3e-4257-a30c-bbee13f3ac38",
                        "id": "tq_W8i2azELk",
                        "name": "YorkEmployees",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "321074b5-0273-40e6-b371-32b3d489b163",
                                "id": "employee_id",
                                "name": "employee_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0dbac577-5775-4778-b94c-415cf33f8d47",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8e149f49-927d-4466-a502-08d4faa28fba",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4123d15a-8cf9-4313-97ab-39bdce74b9ed",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4f8a7c1-a991-4acd-8011-95208d6836c6",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48d5b814-aecd-47ae-b48f-24d835d69afc",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "248a1d48-30f4-4776-a4b2-b3dfd5ef35a8",
                                "id": "full_name_duplicate",
                                "name": "full_name_duplicate",
                                "type": 18,
                                "size": 383,
                                "precision": 383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "299b4311-d160-4e91-ae7d-761a1b75572e",
                                "id": "team_name",
                                "name": "team_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21bf6c58-e15a-46ad-b86b-5c4c9ce7318b",
                                "id": "department",
                                "name": "department",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "86d8836d-7605-436c-bea2-8d853069e867",
                                "id": "group_name",
                                "name": "group_name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "6078d975-2311-471b-a795-2a6ddd3c6443",
                        "configOptions": {
                            "importQuery": "select\r\n\t`user`.id as employee_id,\r\n\tCOALESCE( 1000 + brand.id,1001) as site_id,\r\n\tconcat( COALESCE(1000 + brand.id, 1001), 10000, `user`.id ) as employee_key,\r\n\t`user`.first_name,\r\n\t`user`.last_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name ) as full_name,\r\n\tCOALESCE(`user`.real_name,\r\n\tCONCAT( `user`.first_name, ' ', `user`.last_name )) as full_name_duplicate,\r\n\t`group`.name as team_name,\r\n\tcase\r\n\t\twhen group_type.name = 'Branch' then 'Retention'\r\n\t\telse group_type.name end as department,\r\n\t\tgroup_group.name as group_name\r\n\tfrom\r\n\t\t`user`\r\n\tleft join (\r\n\t\tselect a.id as user_id, min(c.id) as group_id\r\n       from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id\r\n       where c.parent_id is not null\r\n       group by 1\r\n       union\r\n       select emp.id, min(user_group.group_id) as group_id \r\n       from \r\n       (select proba.id, sum(ch)\r\n       from\r\n       (select a.id, case when c.parent_id is not null then 1 else 0 end as ch from `user` a\r\n       inner join user_group b on a.id = b.user_id\r\n       inner join `group` c on b.group_id = c.id)proba\r\n       group by 1 having sum(ch) = 0) emp\r\n       inner join user_group on emp.id = user_group.user_id\r\n       group by 1 ) user_groups on\r\n\t\tuser_groups.user_id = `user`.id\r\n\tleft join `group` on\r\n\t\t`group`.id = user_groups.group_id\r\n\tleft join group_type on\r\n\t\tgroup_type.id = `group`.type_id\r\n\tleft join `group` group_group on\r\n\t\tgroup_group.id =\r\n\t\t(case\r\n\t\t\twhen `group`.parent_id is null then `group`.id\r\n\t\t\telse `group`.parent_id end)\r\nleft join brand on 1=1 "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "619506406780f2002c37ecbe",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiXsMSYsuAL/CbGN4aqsTqQK37h2jvswX7OUxbO5ncsXT5ZAQx6xX8RhjlXWOBl+OUE=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f8834faf-491f-48b0-b871-0ec6f7b8078a",
            "fullname": "MySql:46966750-1f2b-4805-860f-a78bc23c1b37",
            "type": "extract",
            "name": "46966750-1f2b-4805-860f-a78bc23c1b37",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "2ba80736-5135-4a31-b68a-1b6c3ac4bf6a",
                        "id": "tq_2wAuVW08h",
                        "name": "IvyTrusts_acc_types",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f8ade356-9505-4898-8cdd-b8348e32d708",
                                "id": "id",
                                "name": "id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3b8c1f10-d339-4094-9cac-086e36a9c85a",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 300,
                                "precision": 300,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c41169b7-aa1c-4412-9ff1-5d0294b4e8e9",
                                "id": "brand_id",
                                "name": "brand_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e63be1ac-6855-4e51-a3b1-13c2bf6d32b9",
                                "id": "group_brand",
                                "name": "group_brand",
                                "type": 18,
                                "size": 21,
                                "precision": 21,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1652b17-acd1-4160-a24d-438ec5a333f7",
                                "id": "active",
                                "name": "active",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "9b3bfa66-5cd2-4a70-bf2f-fb9586f3247e",
                        "configOptions": {
                            "importQuery": "select trade_configuration_group.id, trade_configuration_group.name, brand.id as brand_id, concat(trade_configuration_group.id,'_',brand.id) as group_brand \r\n,trade_configuration_group.active\r\nfrom trade_configuration_group\r\ninner join brand on 1=1 \r\n"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617133cf55f384002cf10205",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiAoP3g27zBsTBhENM+dBsf62FQyEzHEvyCyA1AFqG0Wq82nAt5YxcjG5bUujZ6mLgw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "f9746e8a-15c9-4503-b927-3d0f83bb0258",
            "fullname": "MySql:cb006060-58cb-43e0-8d2d-83092ac52a25",
            "type": "extract",
            "name": "cb006060-58cb-43e0-8d2d-83092ac52a25",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "a663ddd8-3dd3-405c-bb47-fb1c5518c10d",
                        "id": "tq_qLwIUqQxa",
                        "name": "365TradingFX_Open_Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "65470e70-7472-4b67-80d0-10aaf4c769ee",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d58cda14-7794-4565-a46d-5924702b853e",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b86647f7-2165-4aa2-9063-691382d3af0c",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "361587ab-09ef-482a-a962-e1b117d8bab0",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8eb767d1-b2d1-415b-b703-18f6674d47d9",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3dea39c5-28ec-4728-82e4-b0c5fa2ced69",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6419ee40-b13f-49de-a13f-b4bcd843acce",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d21befb8-7eb0-42cc-963e-91516a49dc88",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3beebe03-0924-4712-bbe1-cb0d2e0b374c",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "60fe70d0-670c-4f36-bf98-0990d3d4473d",
                        "configOptions": {
                            "importQuery": "select \r\ntrader_account_position.id,\r\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\r\ntrader.default_account_id as trader_account_id,\r\ncurrency.name as currency,\r\nuser_currency_vol,\r\nsystem_currency_vol,\r\nsystem_currency_vol/user_currency_vol as exchange_rate,\r\n(trader_account_position.pnl)*(-1) as pnl_curr,\r\n(case \r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \r\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\r\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\r\nend)*(-1)\r\nas pnl_usd\r\nfrom\r\ntrader_account_position  \r\ninner join trader on trader.id = trader_account_position.trader_id\r\ninner join trader_account on trader_account.trader_id = trader.id \r\ninner join currency on currency.id = trader_account.currency_id\r\ninner join brand on trader.brand_id = brand.id\r\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c748",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6h2kEQfj06tSGpyh+xEzmk6Iq8paTu3ip6/rB+N1MFIYN59/xJKyq6s2pJ06bUpzhAANrOSGSl8zpPlUO8IwiG8A7d+Vz+KCoZhjqP9L+KHT5GfaypnOnu+badv06TGAXIJlaegbboPbyBtw46kZTRfJ2bJyakx/q48snRhZp8Cm",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fa245316-9fd0-4f0e-88ff-654e4daeed34",
            "fullname": "MySql:1adf6d58-e0b6-43c8-9e9d-f494da8dedbb",
            "type": "extract",
            "name": "1adf6d58-e0b6-43c8-9e9d-f494da8dedbb",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c9e89f70-fc4c-4238-8a43-7b47f2bc152f",
                        "id": "tq_vc1CeWkDl",
                        "name": "DW_DimDate",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "af43c4f3-1b41-4da3-84ec-32d06a727923",
                                "id": "DateKey",
                                "name": "DateKey",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "988b9cfa-f91f-430a-a1a2-357f2d9f9c29",
                                "id": "Full_Date",
                                "name": "Full_Date",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7543fcd4-b336-425c-80c9-f9c5eb25049f",
                                "id": "FullDateTime",
                                "name": "FullDateTime",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dc1988ee-d4b4-4e9d-9425-323d6c32410a",
                                "id": "Calendar_Year_Month",
                                "name": "Calendar_Year_Month",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb7d0f10-2243-4abc-bc18-5c90309f0871",
                                "id": "dates_join",
                                "name": "dates_join",
                                "type": 0,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "be1d2e96-937f-4718-9580-ed7723b66279",
                                "id": "Weekday_Weekend",
                                "name": "Weekday_Weekend",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae483cc8-5f97-4c6c-bce8-37438dc7fa2b",
                                "id": "Day_Name_Of_Week",
                                "name": "Day_Name_Of_Week",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "bb49b7dc-681a-4a9a-9c4c-597eaba46a98",
                        "configOptions": {
                            "importQuery": "select \n\tdim_date.DateKey,\n\tdim_date.Full_Date,\n\tdim_date.FullDateTime,\n\tdim_date.Calendar_Year_Month,\n\t0 as dates_join,\n\tdim_date.Weekday_Weekend,\n\tdim_date.Day_Name_Of_Week\nfrom dim_date\nleft join v_working_days on\n\tv_working_days.Calendar_Date_Key = dim_date.DateKey\nWHERE\n\tDateKey > 20140101"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c74a",
                "provider": "MySql",
                "parameters": "vbzYfS4H8zKaaa63Q8eVyx36cxK7oYg+4Q5WunfT3zgdww2iSGhTLrUnq7V9U0erIOY0jNYmKt9GMi/AOy4uJor53Wy5pKADZZQU4IywmnjHaGH4fezFLpM4Qgb/nP5Qo2z3T75JjWg0asinZRH4nPIpWIWzjBZUhPLin/PXCjhJiUvrOtcx64Deeph0+EQDy1nQEeRpJE9+RWm+KH4ERg==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fab5e407-aa95-4aa9-b73e-3a49d46992f3",
            "fullname": "MySql:634c9c3a-3a2a-458a-a9b8-b586ed856d2f",
            "type": "extract",
            "name": "634c9c3a-3a2a-458a-a9b8-b586ed856d2f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "c88422ea-10e0-4672-9014-63a2697f6fbd",
                        "id": "tq_BAq8lzrlp",
                        "name": "TheBPCA_RealAB",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "19411362-9495-4e2d-ae00-75ed1b57df8d",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87e1af75-a2fa-4998-9f69-c278df6eee2b",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "baf681dc-fee2-4ccd-b586-9b58dc2209e7",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2cb8899-30e6-44ce-8496-71890be2e489",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84998366-c7a1-4d4e-a359-28a868364c23",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6b52ada-63f9-47c5-a238-23652bc4416e",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4eab28cf-0cf1-487d-be1c-2fdedfd4bc3c",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68e66662-a7de-4f02-8457-9a704b64b8e1",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea058b70-c847-4d50-928d-7b2d8f77ec34",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47d7abb5-dbec-4e9e-a7c9-3fbc2429940e",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cfa05ec4-1c97-4bca-99b0-318651665ea1",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "209be09e-9c81-4c58-9832-a4cf1468f272",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3944dab2-15a8-446c-a6a8-c923e05ba81b",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d23071f5-342f-41de-b2e4-a53adb76e97a",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "16d67664-5e1d-49e5-a927-9bea72962037",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e288cd3-7f9c-4407-863c-6462951b3966",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18ef6400-b41c-4d6c-a10d-b966a8e87d2e",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "596cf722-8cc0-4be5-bf3e-cb8eef922da1",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97e2887a-2465-49fe-8d55-07b177a6a831",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "db373993-9f15-4bec-866d-3614596996c4",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "617d9d98-7c00-4be6-a337-2723e43ec0f2",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00e70342-48cc-474a-a6c3-630a72baedae",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06d1a5b2-fbf6-4ab0-ae9a-40e4bccb4c15",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aac47445-93cd-4b2b-8db9-dc07ebde4ec7",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb45616c-4573-4a80-91a9-0d2bdce96690",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0def744a-c6ea-4155-8541-26576b95d52b",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0a79d7c-e750-447d-a49c-b3b6b04964ce",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf536ab7-e964-469b-9fe8-37a2ceeabe54",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f77354aa-f69f-44e2-8d12-7eb0d923be38",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18ed57b1-35d0-4c18-9b1d-e05c0eca0535",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97a99464-b1d0-41a3-8928-c720539356bc",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f736280a-0718-4923-8f90-617506a8f2d9",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3d4b09b-eb3e-4208-a28a-311fa416c2fc",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf1fd2b5-246b-42bc-a938-860fb6df8790",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7cd8ab44-6433-498b-a2ad-b0ca40552bcf",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc248c3a-e70c-4435-97d8-cb725ce7590f",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b508747-0381-4a59-8496-ce6d78a029be",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d98c1a8-a035-46c3-bc02-751d97846353",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d60d7ee7-0eeb-4933-89a3-c1d32672d846",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6233fa37-5340-4ae7-8457-e7a62087a0a1",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e561fb3e-aa1a-4893-a698-4559913b4e64",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c03d6bcb-4ef0-4f68-ad95-8b63617b3c45",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66f6eabb-29b6-4398-9d43-0be6b81c2468",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71aea03b-0052-4068-af2b-5d85dfd70e52",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f0c2ed7-ccd0-4482-b7a9-be67aa09776c",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e55efe9f-0d3e-4779-916c-61b7aaf7657c",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c00e39a8-06ed-4198-ae72-e9f5717cd661",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2685f4ee-f910-457e-8c74-02bedb6808f5",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "658d6a5a-394a-4276-b604-ff69bf47784c",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3259473-b674-4e82-a484-5917cfb182db",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "145a2eba-9cf5-4e97-9fac-5bd4745c8a93",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7258649-389f-4c8a-b4ef-fe7c0d2c0d68",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7c7504d-5838-4e16-876b-83b376594a17",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5015bbf3-e882-45e8-82a9-087f8ba6f4b0",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f1154b5d-6587-4f6b-8f80-5af8570db1d2",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "713c8b55-1fa5-4b8c-8ba8-86de80616781",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10673d29-a430-46a8-8458-a44fdd5e3751",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "778fa07b-7841-4cf5-babf-818606496dfc",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "caa92929-71bf-4124-8490-832289a612d5",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97d769aa-7ef2-4ed6-9053-d2b670299433",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "118f0152-37bc-4dd6-be2a-1eeb76d24bef",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7efc5aa0-5821-414f-852b-e2658511e81d",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd73fa84-3d8b-419a-af1e-f367185e5e6d",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d7bdecde-301c-4dd2-8f73-851c3a7eecd2",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8e2af38-253c-4d00-8001-a7c0c6dfa952",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd5f2b71-8b12-4bda-a115-a9738ff4dd56",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dd635969-4fb7-4c01-8208-991235918c3f",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3f9ba65d-c507-4581-9288-fa4ddb9d57ae",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "22132051-618e-4262-94af-c87dccf69496",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "47d7abb5-dbec-4e9e-a7c9-3fbc2429940e",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "61bb6370-ca42-4f05-a5f3-392aeec95ee9",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\n       aggCustomer.default_account_id,\n       aggCustomer.name as site_name,\n       (1000 + site_id) as site_id,\n       concat((1000 + site_id),'10000',aggCustomer.id) as customer_key,\naggCustomer.customer_fullname,\nco.name,\naggCustomer.currency,\naggCustomer.created_at,\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\naggCustomer.date,\naggCustomer.YearMonth,\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\nend as rate,\nMaxDep.LastDepDate,\nMaxInv.LastTimeInvestment,\naggCustomer.tr_id,\naggCustomer.origin_type,\nMinDep.FTDDate,\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\naggCustomer.user_id,\nconcat((1000 + site_id),'10000',coalesce(aggCustomer.user_id,0)) as employee_key,\naggCustomer.deposit_curr,\naggCustomer.deposit_usd,\naggCustomer.cashback_curr,\naggCustomer.cashback_usd,\naggCustomer.withdrawal_curr,\naggCustomer.withdrawal_usd,\naggCustomer.withdrawal_curr_new,\naggCustomer.withdrawal_usd_new,\naggCustomer.cashback_withdrawal_curr,\naggCustomer.cashback_withdrawal_usd,\naggCustomer.withdrawal_fee_curr,\naggCustomer.withdrawal_fee_usd,\naggCustomer.chb_curr,\naggCustomer.chb_usd,\naggCustomer.inactivity_fee_curr,\naggCustomer.inactivity_fee_usd,\naggCustomer.overnight_fee_curr,\naggCustomer.overnight_fee_usd,\naggCustomer.fees_curr,\naggCustomer.fees_usd,\naggCustomer.pnl_curr,\naggCustomer.pnl_usd,\naggCustomer.swap_curr,\naggCustomer.swap_usd,\naggCustomer.contract_usd,\naggCustomer.rbonus_curr,\naggCustomer.rbonus_usd,\naggCustomer.cancelled_bonus_curr,\naggCustomer.cancelled_bonus_usd,\naggCustomer.pending_bonus_curr,\naggCustomer.pending_bonus_usd,\naggCustomer.fixed_balance,\naggCustomer.fixed_balance_usd,\naggCustomer.negative_balance_fix_curr,\naggCustomer.negative_balance_fix_usd,\naggCustomer.NetdepCurr as NetDepCurr,\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\naggCustomer.NetDepUsd as NetDepUsd,\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\nb.balance as CurrencyBalance\nfrom\n(select\n\tt.*,\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastab < 0\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\telse @RealABAccHelp := @RealAB\n\tend as RealABAccHelp,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastabusd < 0\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\telse @RealABAccHelpUsd := @RealABUsd\n\tend as RealABAccHelpUsd,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\twhen @lastId = t.id\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\telse @realreal := @RealAB\n\tend as RealAccountBalanceAccumulatedCurrency,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\twhen @lastId = t.id\n\t\tand @RealABUsd + @lastabusd > 0\n\t\tthen @realrealusd:= @RealABAccHelpUsd\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\telse @realrealusd := @RealABUsd\n\tend as RealAccountBalanceAccumulatedUsd,\n\tcase\n\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\telse @RealAB\n\tend as RealABDiffCurrency,\n\tcase\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\telse @RealABUsd\n\tend as RealABDiffUsd,\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\n\t@lastreal := @realreal,\n\t@lastrealusd := @realrealusd,\n\t@lastab := @RealABAccHelp,\n\t@lastabusd := @RealABAccHelpUsd,\n\t@lastId := t.id,\n\t@lastrealpnlcurr:= @realpnlcurracc,\n\t@lastrealpnlusd:= @realpnlusdacc\nfrom\n\t(\n\t\tselect b.id,\n              b.default_account_id,\n              b.brand_id as site_id,\n              brand.name,\n              a.id as tr_id,\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\n\t\tb.user_id,\n\t\td.code as currency,\n\t\ta.origin_type,\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\n\t\tcase when d.code = 'USD' then rates.USD\n\t\twhen d.code = 'EUR' then rates.EUR\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\n\tfrom\n\t\ttransaction_record a\n\tleft join (\n\t\t\tselect b.id,\n\t\t\tb.amount,\n\t\t\tb.wide_currency_amount,\n\t\t\ta.realized_at\n\t\tfrom\n\t\t\ttransaction_bonus a\n\t\tinner join transaction_record b on\n\t\t\ta.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 1) rbonus on\n\t\trbonus.id = a.id\n\tleft join (select b.id,\n\t\t\t   b.amount,\n\t\t\t   b.wide_currency_amount\n\t\tfrom\n\t\t       transaction_bonus a\n\tinner join transaction_record b on\n\t\t    a.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n       left join brand on brand.id = b.brand_id\n\tinner join trader_account c on b.id = c.trader_id\n\tinner join currency d on c.currency_id = d.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32)) withdrawals on withdrawals.id = a.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32)) withdrawals_cashback on withdrawals_cashback.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32) and b.status = 'completed') deposits on deposits.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32) and b.status = 'completed') cashbacks on cashbacks.id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 5 and a.created_at < 20190923) withdrawal_fees on withdrawal_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\n\tleft join (select 1.1448 as EUR,\n1 as USD,\n1.3108 as GBP,\n'2019-01' as ym\nunion\nselect 1.1376 as EUR,\n1 as USD,\n1.3263 as GBP,\n'2019-02' as ym\nunion\nselect 1.1224 as EUR,\n1 as USD,\n1.3021 as GBP,\n'2019-03' as ym\nunion\nselect 1.1214 as EUR,\n1 as USD,\n1.3038 as GBP,\n'2019-04' as ym\nunion\nselect 1.1197 as EUR,\n1 as USD,\n1.2637 as GBP,\n'2019-05' as ym\nunion\nselect 1.136 as EUR,\n1 as USD,\n1.2691 as GBP,\n'2019-06' as ym\nunion\nselect 1.1071 as EUR,\n1 as USD,\n1.2152 as GBP,\n'2019-07' as ym\nunion\nselect 1.1009 as EUR,\n1 as USD,\n1.2157 as GBP,\n'2019-08' as ym\nunion\nselect 1.0899 as EUR,\n1 as USD,\n1.2287 as GBP,\n'2019-09' as ym\nunion\nselect 1.1157 as EUR,\n1 as USD,\n1.2937 as GBP,\n'2019-10'as ym\nunion \nselect 1.1019 as EUR,\n1 as USD,\n1.2928 as GBP,\n'2019-11' as ym\nunion\nselect 1.1124 as EUR,\n1 as USD,\n1.3351 as GBP,\n'2019-12' as ym\nunion\nselect 1.1095 as EUR,\n1 as USD,\n1.3205 as GBP,\n'2020-01' as ym\nunion\nselect 1.1089 as EUR,\n1 as USD,\n1.3181 as GBP,\n'2020-02' as ym\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\nleft join (select ftr_id, system_currency_vol, swap from trader_account_position) contract on contract.ftr_id = a.id\n\twhere\n\t\tb.is_test = 0\n\t\tand a.id not in (select ftr_id from transaction_bonus where status = 'expired')\n\tgroup by\n\t\t1,\n\t\t3,\n\t\t2,\n\t\t4,\n\t\t5,\n\t\t6,\n\t\t7,\n\t\t8,\n\t\t9,\n\t\t10,\n\t\t11,\n\t\t12\n\torder by\n\t\t1,\n\t\t6,\n\t\t5\n\t\tasc) t\ninner join (\n\t\tselect @lastab := 0,\n\t\t@RealABAccHelp := 0,\n\t\t@lastRealABAaccHelp := 0,\n\t\t@lastId := 0,\n\t\t@realreal := 0,\n\t\t@lastreal := 0,\n\t\t@RealABUsd := 0,\n\t\t@lastabusd := 0,\n\t\t@RealABAccHelpUsd := 0,\n\t\t@realrealusd := 0,\n\t\t@lastrealusd := 0,\n\t\t@netdepositcurr:= 0,\n\t\t@netdepositcurracc:= 0,\n\t\t@netdepositusd:= 0,\n\t\t@netdepositusdacc:= 0,\n\t\t@realpnlcurr:= 0,\n\t\t@realpnlcurracc:= 0,\n\t\t@lastrealpnlcurr:= 0,\n\t\t@realpnlusd:= 0,\n\t\t@realpnlusdacc:= 0,\n\t\t@lastrealpnlusd:= 0,\n\t\t@currentrate:= 0) v) aggCustomer\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\nleft join trader_account b on aggCustomer.id = b.trader_id\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c74c",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE92bQZF/SweFFR70UpfB+z6oSBHqROSJqfbavRql9qKiSLEmwl7IhJ9c6fsHLIM0OwCRHrJNGuAkZHFejMZg4JRw0O3fODsXnYpi2hUBhBsbmkJv6Fp6AFNzUCzYUMwbHmTHLlXM9s4v79bGMK/5v8OLM1d6GkztCEoQnoKHxxgdL5bqbfcU8jEEZ4JlNgR8Mv",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fb0486bb-fb2d-41f6-b0fb-3c6312017e5a",
            "fullname": "MySql:4348e0da-afbf-4605-91ae-0756f914d9a4",
            "type": "extract",
            "name": "4348e0da-afbf-4605-91ae-0756f914d9a4",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "08a38a37-54df-4ac2-80ef-8eb34ed1f3f8",
                        "id": "tq_Mp4aae31L",
                        "name": "Arrowteks_RealAB",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5c32b79c-964b-459e-844f-ee5ea88e479c",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f8e20132-1296-4050-b72c-b914dc754750",
                                "id": "default_account_id",
                                "name": "default_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "45e564f9-a430-4748-8533-2b2f91480e4a",
                                "id": "site_name",
                                "name": "site_name",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7184e035-d291-4eb0-b367-32d69e5e95d0",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5029ef2-3295-4154-a82b-8853037f29e2",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 36,
                                "precision": 36,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f77c97f-cba7-4489-9f6f-bc86d3dc2a6f",
                                "id": "customer_fullname",
                                "name": "customer_fullname",
                                "type": 18,
                                "size": 101,
                                "precision": 101,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dc0b20ba-ed0e-4401-9eb1-3986f185b0a1",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5356ff1-dfa9-456f-adda-1bfff7f93b85",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9df56f5-3919-4920-9d50-eb532f5cd941",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "12b7c886-5589-4f88-a1a2-1991fadf5b34",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e2633e95-fda0-4da1-b81b-8b1b827ef72c",
                                "id": "date",
                                "name": "date",
                                "type": 31,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8e1e3196-b656-435f-a1d3-368dde5c2724",
                                "id": "YearMonth",
                                "name": "YearMonth",
                                "type": 18,
                                "size": 7,
                                "precision": 7,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f379a75-2466-4fb8-bf27-91d9251d570e",
                                "id": "rate",
                                "name": "rate",
                                "type": 5,
                                "size": 25,
                                "precision": 23,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a041c3ec-90f9-4538-ada5-07f30be38281",
                                "id": "LastDepDate",
                                "name": "LastDepDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "907bbf5a-2314-4675-ad19-94603b07e5af",
                                "id": "LastTimeInvestment",
                                "name": "LastTimeInvestment",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d3ae998b-2fe1-4300-a042-315e86d1d4c3",
                                "id": "tr_id",
                                "name": "tr_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "970542c9-589c-40c1-b470-3c28c626fa35",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "121b243a-448d-46c8-8693-cf37d4bebb8b",
                                "id": "FTDDate",
                                "name": "FTDDate",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "21cd405b-71bd-4a29-b181-694437712472",
                                "id": "FTDInd",
                                "name": "FTDInd",
                                "type": 8,
                                "size": 1,
                                "precision": 1,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "094c5e4d-b80c-4bdc-8ae6-9d6cdfd90835",
                                "id": "user_id",
                                "name": "user_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5d146fb7-5702-4957-9214-e24d8fe671e7",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b7f5ac6-e869-4d5a-978a-075544a1f932",
                                "id": "deposit_curr",
                                "name": "deposit_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71ba076b-69ea-48a1-bb31-6e5d00977277",
                                "id": "deposit_usd",
                                "name": "deposit_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf7d4257-53a7-4a80-95bb-fad5c669d0e2",
                                "id": "cashback_curr",
                                "name": "cashback_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b98dd1bf-0ab8-4c51-90a6-91263f78c0ff",
                                "id": "cashback_usd",
                                "name": "cashback_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "afdb6988-167a-4e77-9708-4e6194062a36",
                                "id": "withdrawal_curr",
                                "name": "withdrawal_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f2ef187-5269-4637-8f30-f2101e36db03",
                                "id": "withdrawal_usd",
                                "name": "withdrawal_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "57aacad1-cca5-47c8-a14a-37ca298c0643",
                                "id": "withdrawal_curr_new",
                                "name": "withdrawal_curr_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f9a9fa0-7ae9-4221-845a-a1784a05037a",
                                "id": "withdrawal_usd_new",
                                "name": "withdrawal_usd_new",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5645c85a-bccc-49dd-a458-49ddd260dc68",
                                "id": "cashback_withdrawal_curr",
                                "name": "cashback_withdrawal_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "876ec395-99e1-4561-903b-34a3f5283215",
                                "id": "cashback_withdrawal_usd",
                                "name": "cashback_withdrawal_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1841a579-fd39-4cdc-8f74-1c6f5d2bd633",
                                "id": "withdrawal_fee_curr",
                                "name": "withdrawal_fee_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4fae8613-94f1-4d8a-9ffb-f0a6155d5bb9",
                                "id": "withdrawal_fee_usd",
                                "name": "withdrawal_fee_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd8632aa-62f1-4f17-ab6d-b0e20c91a5a8",
                                "id": "chb_curr",
                                "name": "chb_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3ec8e58b-2b6e-4152-bd84-f2491c5aeea1",
                                "id": "chb_usd",
                                "name": "chb_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d10b923c-0768-4a99-8cbd-38759a07ae87",
                                "id": "inactivity_fee_curr",
                                "name": "inactivity_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c269a5ec-4bca-429d-9e18-30f977a68d31",
                                "id": "inactivity_fee_usd",
                                "name": "inactivity_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1b05900-ff2a-4049-9aa9-3bf38721e2ca",
                                "id": "overnight_fee_curr",
                                "name": "overnight_fee_curr",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b1f8a7b3-3440-47cf-b52e-c965721e4321",
                                "id": "overnight_fee_usd",
                                "name": "overnight_fee_usd",
                                "type": 5,
                                "size": 44,
                                "precision": 42,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "68b2a3b1-dda4-4bf5-9b9b-958b41b8685f",
                                "id": "fees_curr",
                                "name": "fees_curr",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e456ca5e-8c13-40c3-ac6d-40396452b935",
                                "id": "fees_usd",
                                "name": "fees_usd",
                                "type": 6,
                                "size": 23,
                                "precision": 23,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "50235e13-fed7-4534-b976-2a3863e2bd56",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9612b066-bb15-4931-9881-b715ef1d0506",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "921dcaa6-8ec2-4e33-a071-9963c1db3e27",
                                "id": "swap_curr",
                                "name": "swap_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1769e1a3-fc18-4b2f-a88f-2e484c8d191c",
                                "id": "swap_usd",
                                "name": "swap_usd",
                                "type": 5,
                                "size": 67,
                                "precision": 65,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eb2eb37c-b01d-4fe0-8ee6-353352dd47c5",
                                "id": "contract_usd",
                                "name": "contract_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c03ee155-3398-4fe2-bd78-bb83abb469a0",
                                "id": "rbonus_curr",
                                "name": "rbonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cd6dbe54-79ed-48f7-9108-a825cba3d500",
                                "id": "rbonus_usd",
                                "name": "rbonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "16a23aad-32b8-4f1e-a6a5-190266e771f9",
                                "id": "cancelled_bonus_curr",
                                "name": "cancelled_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a798f28c-a0a3-4bec-9b4c-9fdaa5e44b84",
                                "id": "cancelled_bonus_usd",
                                "name": "cancelled_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb584509-7381-490d-a5a2-ee0d9e9a38b3",
                                "id": "pending_bonus_curr",
                                "name": "pending_bonus_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "38af8e3a-5d7f-4d96-91b7-d96747a678df",
                                "id": "pending_bonus_usd",
                                "name": "pending_bonus_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "376d1bb9-7a28-41bc-a43b-13923063fc20",
                                "id": "fixed_balance",
                                "name": "fixed_balance",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1b07a4dd-977a-45ff-b9a0-57b25058f92e",
                                "id": "fixed_balance_usd",
                                "name": "fixed_balance_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2ad3b044-446c-4c93-82c4-d74b3863ce7d",
                                "id": "negative_balance_fix_curr",
                                "name": "negative_balance_fix_curr",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1e38102c-8b31-4448-b320-e0a7be62f87a",
                                "id": "negative_balance_fix_usd",
                                "name": "negative_balance_fix_usd",
                                "type": 5,
                                "size": 43,
                                "precision": 41,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2cb11e17-33e9-4afb-a2e5-c66ea7eb6d7a",
                                "id": "NetDepCurr",
                                "name": "NetDepCurr",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "abf8b9cf-e3e3-47ae-bbca-535bca10dda3",
                                "id": "NetDepCurrAcc",
                                "name": "NetDepCurrAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fb7eff65-1700-4e8a-9367-f1bef9048e4e",
                                "id": "NetDepUsd",
                                "name": "NetDepUsd",
                                "type": 6,
                                "size": 69,
                                "precision": 69,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cf305d5a-ae40-407d-a346-e1bb54a626b1",
                                "id": "NetDepUsdAcc",
                                "name": "NetDepUsdAcc",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5e2fed25-35c7-4c03-b384-22cae367ee35",
                                "id": "RealABAccCurr",
                                "name": "RealABAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f616f4b1-d911-46a2-a84e-650c99bdb9c5",
                                "id": "RealABAccUsd",
                                "name": "RealABAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "33bbd41d-df9f-4f18-baa1-e13b39e44166",
                                "id": "RealABDiffCurrency",
                                "name": "RealABDiffCurrency",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b3855f93-ebb6-4bda-abcf-faba187e4bab",
                                "id": "RealABDiffUsd",
                                "name": "RealABDiffUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0dd42a72-6be4-4d50-93b4-c277219a6798",
                                "id": "RealPnLAccCurr",
                                "name": "RealPnLAccCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0a73185d-032e-47d4-a88b-67ac05559d78",
                                "id": "RealPnLCurr",
                                "name": "RealPnLCurr",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dc4eeb04-77f4-4d30-9ab8-fd537b5cb835",
                                "id": "RealPnLAccUsd",
                                "name": "RealPnLAccUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ff4e85e5-453f-4434-9af9-cf53928aebea",
                                "id": "RealPnLUsd",
                                "name": "RealPnLUsd",
                                "type": 6,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "88a02e53-e6dd-4be1-8f1a-3a656e9dfe09",
                                "id": "CurrencyBalance",
                                "name": "CurrencyBalance",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "f8e20132-1296-4050-b72c-b914dc754750",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "12b7c886-5589-4f88-a1a2-1991fadf5b34",
                                    "type": 8
                                },
                                "type": "change-data-type"
                            },
                            {
                                "arguments": {
                                    "column": "7184e035-d291-4eb0-b367-32d69e5e95d0",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": true,
                        "vTag": "14084c81-7a04-4f68-a423-35e3614e8038",
                        "configOptions": {
                            "importQuery": "SELECT aggCustomer.id,\naggCustomer.default_account_id,\naggCustomer.site_name as site_name,\naggCustomer.site_id as site_id,\nconcat(aggCustomer.site_id,'10010',aggCustomer.id) as customer_key,\naggCustomer.customer_fullname,\nco.name,\naggCustomer.currency,\naggCustomer.created_at,\nyear(aggCustomer.created_at) * 10000 + month(aggCustomer.created_at) * 100 + day(aggCustomer.created_at) as created_at_key,\naggCustomer.date,\naggCustomer.YearMonth,\ncase when aggCustomer.rate is null and aggCustomer.currency = 'GBP' then 1.3\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'GBP' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'EUR' then 1.1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'EUR' then aggCustomer.rate\nwhen aggCustomer.rate is null and aggCustomer.currency = 'USD' then 1\nwhen aggCustomer.rate is not null and aggCustomer.currency = 'USD' then aggCustomer.rate\nend as rate,\nMaxDep.LastDepDate,\nMaxInv.LastTimeInvestment,\naggCustomer.tr_id,\naggCustomer.origin_type,\nMinDep.FTDDate,\ncase when FTD.FTDind is null then 0 else 1 end as FTDInd,\naggCustomer.user_id,\nconcat(aggCustomer.site_id,'10010',COALESCE(aggCustomer.user_id,0)) as employee_key,\naggCustomer.deposit_curr,\naggCustomer.deposit_usd,\naggCustomer.cashback_curr,\naggCustomer.cashback_usd,\naggCustomer.withdrawal_curr,\naggCustomer.withdrawal_usd,\naggCustomer.withdrawal_curr_new,\naggCustomer.withdrawal_usd_new,\naggCustomer.cashback_withdrawal_curr,\naggCustomer.cashback_withdrawal_usd,\naggCustomer.withdrawal_fee_curr,\naggCustomer.withdrawal_fee_usd,\naggCustomer.chb_curr,\naggCustomer.chb_usd,\naggCustomer.inactivity_fee_curr,\naggCustomer.inactivity_fee_usd,\naggCustomer.overnight_fee_curr,\naggCustomer.overnight_fee_usd,\naggCustomer.fees_curr,\naggCustomer.fees_usd,\naggCustomer.pnl_curr,\naggCustomer.pnl_usd,\naggCustomer.swap_curr,\naggCustomer.swap_usd,\naggCustomer.contract_usd,\naggCustomer.rbonus_curr,\naggCustomer.rbonus_usd,\naggCustomer.cancelled_bonus_curr,\naggCustomer.cancelled_bonus_usd,\naggCustomer.pending_bonus_curr,\naggCustomer.pending_bonus_usd,\naggCustomer.fixed_balance,\naggCustomer.fixed_balance_usd,\naggCustomer.negative_balance_fix_curr,\naggCustomer.negative_balance_fix_usd,\naggCustomer.NetdepCurr as NetDepCurr,\nround(aggCustomer.NetDepCurrAcc,2) as NetDepCurrAcc,\naggCustomer.NetDepUsd as NetDepUsd,\nround(aggCustomer.NetDepUsdAcc,2) as NetDepUsdAcc,\nround(aggCustomer.RealAccountBalanceAccumulatedCurrency,2) as RealABAccCurr,\nround(aggCustomer.RealAccountBalanceAccumulatedUsd,2) as RealABAccUsd,\nround(aggCustomer.RealABDiffCurrency,2) as RealABDiffCurrency,\nround(aggCustomer.RealABDiffUsd,2) as RealABDiffUsd,\nround(aggCustomer.RealPnLCurrAcc,2) as RealPnLAccCurr,\nround(aggCustomer.RealPnLCurr,2) as RealPnLCurr,\nround(aggCustomer.RealPnLUsdAcc,2) as RealPnLAccUsd,\nround(aggCustomer.RealPnLUsd,2) as RealPnLUsd,\nb.balance as CurrencyBalance\nfrom\n(select\n\tt.*,\n\t@netdepositcurr:= t.deposit_curr - t.withdrawal_curr_new - t.chb_curr as NetdepCurr,\n\tcase when @lastId = t.id then @netdepositcurracc:= @netdepositcurracc + @netdepositcurr else @netdepositcurracc:= @netdepositcurr end as NetDepCurrAcc,\n\t@netdepositusd:= t.deposit_usd - t.withdrawal_usd_new - t.chb_usd as NetdepUsd,\n\tcase when @lastId = t.id then @netdepositusdacc:= @netdepositusdacc + @netdepositusd else @netdepositusdacc:= @netdepositusd end as NetDepUsdAcc,\n\t@RealAB := round(t.deposit_curr + t.cashback_curr - t.withdrawal_curr_new - t.cashback_withdrawal_curr - t.chb_curr - t.fees_curr + t.pnl_curr + t.rbonus_curr + t.fixed_balance + t.negative_balance_fix_curr, 2) as RealABCurr,\n\t@RealABUsd := round(t.deposit_usd + t.cashback_usd - t.withdrawal_usd_new - t.cashback_withdrawal_usd - t.chb_usd - t.fees_usd + t.pnl_usd + t.rbonus_usd + t.fixed_balance_usd + t.negative_balance_fix_usd, 2) as RealABUsd,\n\t@currentrate:= @RealABUsd / @RealAB as currentRate,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastab < 0\n\t\tand t.deposit_curr > 0 then @RealABAccHelp := @RealAB\n\t\twhen @lastId = t.id then @RealABAccHelp := @RealABACCHelp + @RealAB\n\t\telse @RealABAccHelp := @RealAB\n\tend as RealABAccHelp,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @lastabusd < 0\n\t\tand t.deposit_usd > 0 then @RealABAccHelpUsd := @RealABUsd\n\t\twhen @lastId = t.id then @RealABAccHelpUsd := @RealABACCHelpUsd + @RealABUsd\n\t\telse @RealABAccHelpUsd := @RealABUsd\n\tend as RealABAccHelpUsd,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0\n\t\tand t.deposit_curr > 0 then @realreal := @RealAB + @lastreal\n\t\twhen @lastId = t.id\n\t\tand @RealAB + @lastab > 0 then @realreal:= @RealABAccHelp\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelp < 0 then @realreal := 0\n\t\twhen @lastId = t.id then @realreal := @RealAB + @lastreal\n\t\telse @realreal := @RealAB\n\tend as RealAccountBalanceAccumulatedCurrency,\n\tcase\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0\n\t\tand t.deposit_usd > 0 then @realrealusd := @RealABUsd + @lastrealusd\n\t\twhen @lastId = t.id\n\t\tand @RealABUsd + @lastabusd > 0\n\t\tthen @realrealusd:= @RealABAccHelpUsd\n\t\twhen @lastId = t.id\n\t\tand @RealABAccHelpUsd < 0 then @realrealusd := 0\n\t\twhen @lastId = t.id then @realrealusd := @RealABUsd + @lastrealusd\n\t\telse @realrealusd := @RealABUsd\n\tend as RealAccountBalanceAccumulatedUsd,\n\tcase\n\t\twhen @lastId = t.id then @realreal - @lastreal\n\t\telse @RealAB\n\tend as RealABDiffCurrency,\n\tcase\n\t\twhen @lastId = t.id then @realrealusd - @lastrealusd\n\t\telse @RealABUsd\n\tend as RealABDiffUsd,\n\t@realpnlcurracc:= @netdepositcurracc - @realreal as RealPnLCurrAcc,\n\tcase when @lastId = t.id then @realpnlcurr:= @realpnlcurracc - @lastrealpnlcurr else @realpnlcurr:= @realpnlcurracc end as RealPnLCurr,\n\t@realpnlusdacc:= @netdepositusdacc - @realrealusd as RealPnLUsdAcc,\n\tcase when @lastId = t.id then @realpnlusd:= @realpnlusdacc - @lastrealpnlusd else @realpnlusd:= @realpnlusdacc end as RealPnLUsd,\n\t@lastreal := @realreal,\n\t@lastrealusd := @realrealusd,\n\t@lastab := @RealABAccHelp,\n\t@lastabusd := @RealABAccHelpUsd,\n\t@lastId := t.id,\n\t@lastrealpnlcurr:= @realpnlcurracc,\n\t@lastrealpnlusd:= @realpnlusdacc\nfrom\n\t(\n\t\tselect\n\t\tbrand.name as site_name,\n\t\tcast(brand.id + 1000 as char) as site_id,\n\t\tb.id,\n        b.default_account_id,\n\t\ta.id as tr_id,\n\t\tcase when rbonus.realized_at > 0 then rbonus.realized_at else a.created_at end as created_at,\n\t\tcase when rbonus.realized_at > 0 then date(rbonus.realized_at) else date(a.created_at) end as 'date',\n\t\tb.user_id,\n\t\td.code as currency,\n\t\ta.origin_type,\n\t\tcase when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end as YearMonth,\t\t\n\t\tcase when d.code = 'USD' then rates.USD\n\t\twhen d.code = 'EUR' then rates.EUR\n\t\twhen d.code = 'GBP' then rates.GBP end as rate,\n\t\tconcat(b.first_name,' ',b.last_name) as customer_fullname,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.amount else 0 end),0) as deposit_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then deposits.wide_currency_amount else 0 end),0) as deposit_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.amount else 0 end),0) as cashback_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 1 then cashbacks.wide_currency_amount else 0 end),0) as cashback_usd,\n\t\tsum(case when a.origin_type = 2 then a.amount * -1 else 0 end) as withdrawal_curr,\n\t\tsum(case when a.origin_type = 2 then a.wide_currency_amount * -1 else 0 end) as withdrawal_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_curr else 0 end),0) as withdrawal_curr_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals.amount_usd else 0 end),0) as withdrawal_usd_new,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.amount_curr else 0 end ),0) as cashback_withdrawal_usd,\n\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.amount > 0 then withdrawal_fees.amount else 0 end) as withdrawal_fee_curr,\n\t\tsum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) + sum(case when a.origin_type = 4 and withdrawal_fees.wide_currency_amount > 0 then withdrawal_fees.wide_currency_amount else 0 end) as withdrawal_fee_usd,\n\t\tsum(case when a.origin_type = 3 then a.amount * -1 else 0 end) as chb_curr,\n\t\tsum(case when a.origin_type = 3 then a.wide_currency_amount * -1 else 0 end) as chb_usd,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.amount > 0 then overnight_fees.amount else 0 end) as overnight_fee_curr,\n\t\tsum(case when a.origin_type = 4 and overnight_fees.wide_currency_amount > 0 then overnight_fees.wide_currency_amount else 0 end) as overnight_fee_usd,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.amount <> 0 then inactivity_fees.amount else 0 end) as inactivity_fee_curr,\n\t\tsum(case when a.origin_type = 4 and inactivity_fees.wide_currency_amount <> 0 then inactivity_fees.wide_currency_amount else 0 end) as inactivity_fee_usd,\n\t\tsum(case when a.origin_type = 4 then a.amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_curr else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_curr else 0 end),0) as fees_curr,\n\t\tsum(case when a.origin_type = 4 then a.wide_currency_amount * -1 else 0 end) + COALESCE(sum(case when a.origin_type = 2 then withdrawals.fee_amount_usd else 0 end),0) + COALESCE(sum(case when a.origin_type = 2 then withdrawals_cashback.fee_amount_usd else 0 end),0) as fees_usd,\n\t\tsum(case when a.origin_type = 5 then a.amount else 0 end) as pnl_curr,\n\t\tsum(case when a.origin_type = 5 then a.wide_currency_amount else 0 end) as pnl_usd,\n\t\tsum(case when rbonus.amount > 0 then rbonus.amount else 0 end) as rbonus_curr,\n\t\tsum(case when rbonus.wide_currency_amount > 0 then rbonus.wide_currency_amount else 0 end) as rbonus_usd,\n\t\tsum(case when a.origin_type = 11 then a.amount else 0 end) as fixed_balance,\n\t\tsum(case when a.origin_type = 11 then a.wide_currency_amount else 0 end) as fixed_balance_usd,\n\t\tsum(case when a.origin_type = 12 then a.amount else 0 end) as negative_balance_fix_curr,\n\t\tsum(case when a.origin_type = 12 then a.wide_currency_amount else 0 end) as negative_balance_fix_usd,\n\t\tsum(case when a.origin_type = 8 then a.amount else 0 end) as cancelled_bonus_curr,\n\t\tsum(case when a.origin_type = 8 then a.wide_currency_amount else 0 end) as cancelled_bonus_usd,\n\t\tsum(case when pbonus.amount > 0 then pbonus.amount else 0 end) as pending_bonus_curr,\n\t\tsum(case when pbonus.wide_currency_amount > 0 then pbonus.wide_currency_amount else 0 end) as pending_bonus_usd,\n\t\tsum(case when a.origin_type = 5 then contract.system_currency_vol else 0 end) as contract_usd,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swaps_curr else 0 end)) as swap_curr,\n\t\tCOALESCE(sum(case when a.origin_type = 5 then swaps.swap_usd else 0 end)) as swap_usd\n\tfrom\n\t\ttransaction_record a\n\tleft join (\n\t\t\tselect b.id,\n\t\t\tb.amount,\n\t\t\tb.wide_currency_amount,\n\t\t\ta.realized_at\n\t\tfrom\n\t\t\ttransaction_bonus a\n\t\tinner join transaction_record b on\n\t\t\ta.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 1) rbonus on\n\t\trbonus.id = a.id\n\tleft join (select b.id,\n\t\t\t   b.amount,\n\t\t\t   b.wide_currency_amount\n\t\tfrom\n\t\t       transaction_bonus a\n\tinner join transaction_record b on\n\t\t    a.ftr_id = b.id\n\t\twhere\n\t\t\ta.is_realized = 0 and a.status = 'approved') pbonus on pbonus.id = a.id\n\tinner join trader b on\n\t\ta.trader_account_id = b.default_account_id\n\tinner join brand on b.brand_id = brand.id\n\tinner join trader_account c on b.id = c.trader_id\n\tinner join currency d on c.currency_id = d.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,65,73,107,115)) withdrawals on withdrawals.id = a.id\n\tleft join (select a.id, b.amount - COALESCE(b.fee_amount,0) as amount_curr, \n\t\t\t\tCOALESCE(b.fee_amount,0) fee_amount_curr, \n\t\t\t\t((b.amount - COALESCE(b.fee_amount,0)) * (a.wide_currency_amount/a.amount)) as amount_usd,\n\t\t\t\tCOALESCE(b.fee_amount,0) * (a.wide_currency_amount/a.amount) as fee_amount_usd\n\t\t\t   from transaction_record a \n\t\t\t   inner join transaction_withdraw b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,65,73,107,115)) withdrawals_cashback on withdrawals_cashback.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) not in (24,32,65,73,107,115) and b.status = 'completed') deposits on deposits.id = a.id\n\tleft join (select a.id, a.wide_currency_amount, a.amount from transaction_record a \n\t\t\t   inner join transaction_deposit b on a.id = b.ftr_id\n\t\t\t   where COALESCE(b.payment_provider_id,0) in (24,32,65,73,107,115) and b.status = 'completed') cashbacks on cashbacks.id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 5) withdrawal_fees on withdrawal_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 8 or transaction_sub_type_id is null) overnight_fees on overnight_fees.ftr_id = a.id\n\tleft join (select a.ftr_id, b.amount * -1 as amount, b.wide_currency_amount * -1 as wide_currency_amount from transaction_commission a inner join transaction_record b on a.ftr_id = b.id\n\t\t\t   where a.transaction_sub_type_id = 7) inactivity_fees on inactivity_fees.ftr_id = a.id\n\tleft join (select ftr_id, swap as swaps_curr, swap * (b.wide_currency_amount / b.amount) as swap_usd from trader_account_position a inner join transaction_record b on a.ftr_id = b.id) swaps on a.id = swaps.ftr_id\n\tleft join (select 1.1448 as EUR,\n1 as USD,\n1.3108 as GBP,\n'2019-01' as ym\nunion\nselect 1.1376 as EUR,\n1 as USD,\n1.3263 as GBP,\n'2019-02' as ym\nunion\nselect 1.1224 as EUR,\n1 as USD,\n1.3021 as GBP,\n'2019-03' as ym\nunion\nselect 1.1214 as EUR,\n1 as USD,\n1.3038 as GBP,\n'2019-04' as ym\nunion\nselect 1.1197 as EUR,\n1 as USD,\n1.2637 as GBP,\n'2019-05' as ym\nunion\nselect 1.136 as EUR,\n1 as USD,\n1.2691 as GBP,\n'2019-06' as ym\nunion\nselect 1.1071 as EUR,\n1 as USD,\n1.2152 as GBP,\n'2019-07' as ym\nunion\nselect 1.1009 as EUR,\n1 as USD,\n1.2157 as GBP,\n'2019-08' as ym\nunion\nselect 1.0899 as EUR,\n1 as USD,\n1.2287 as GBP,\n'2019-09' as ym\nunion\nselect 1.1157 as EUR,\n1 as USD,\n1.2937 as GBP,\n'2019-10'as ym\nunion \nselect 1.1019 as EUR,\n1 as USD,\n1.2928 as GBP,\n'2019-11' as ym\nunion\nselect 1.1124 as EUR,\n1 as USD,\n1.3351 as GBP,\n'2019-12' as ym\nunion\nselect 1.1095 as EUR,\n1 as USD,\n1.3205 as GBP,\n'2020-01' as ym\nunion\nselect 1.1089 as EUR,\n1 as USD,\n1.3181 as GBP,\n'2020-02' as ym\n) rates on rates.ym = case when rbonus.realized_at > 0 then date_format(rbonus.realized_at,'%Y-%m') else date_format(a.created_at,'%Y-%m') end\nleft join (select ftr_id, system_currency_vol from trader_account_position) contract on contract.ftr_id = a.id\n\twhere\n\t\tb.is_test = 0\n\tgroup by\n\t\t1,\n\t\t3,\n\t\t2,\n\t\t4,\n\t\t5,\n\t\t6,\n\t\t7,\n\t\t8,\n\t\t9,\n\t\t10,\n\t\t11,\n\t\t12\n\torder by\n\t\t3,\n\t\t6,\n\t\t5\n\t\tasc) t\ninner join (\n\t\tselect @lastab := 0,\n\t\t@RealABAccHelp := 0,\n\t\t@lastRealABAaccHelp := 0,\n\t\t@lastId := 0,\n\t\t@realreal := 0,\n\t\t@lastreal := 0,\n\t\t@RealABUsd := 0,\n\t\t@lastabusd := 0,\n\t\t@RealABAccHelpUsd := 0,\n\t\t@realrealusd := 0,\n\t\t@lastrealusd := 0,\n\t\t@netdepositcurr:= 0,\n\t\t@netdepositcurracc:= 0,\n\t\t@netdepositusd:= 0,\n\t\t@netdepositusdacc:= 0,\n\t\t@realpnlcurr:= 0,\n\t\t@realpnlcurracc:= 0,\n\t\t@lastrealpnlcurr:= 0,\n\t\t@realpnlusd:= 0,\n\t\t@realpnlusdacc:= 0,\n\t\t@lastrealpnlusd:= 0,\n\t\t@currentrate:= 0) v) aggCustomer\ninner join (select a.id, b.name from trader a inner join country b on a.country_id = b.id) co on co.id = aggCustomer.id\nleft join (select b.id, min(a.id) as FTDInd from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) FTD on FTD.id = aggCustomer.id and FTD.FTDInd = aggCustomer.tr_id\nleft join (select b.id, max(a.created_at) as LastDepDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MaxDep on MaxDep.id = aggCustomer.id\nleft join (select b.id, max(a.open_at) as LastTimeInvestment from trader_account_position a inner join trader b on a.trader_account_id = b.default_account_id where b.is_test = 0 group by 1) MaxInv on MaxInv.id = aggCustomer.id\nleft join (select b.id, min(a.created_at) as FTDDate from transaction_record a inner join trader b on a.trader_account_id = b.default_account_id where a.origin_type = 1 and b.is_test = 0 group by 1) MinDep on MinDep.id = aggCustomer.id\nleft join trader_account b on aggCustomer.id = b.trader_id\norder by 1,4"
                        },
                        "description": null,
                        "tags": null
                    },
                    {
                        "oid": "206e063b-0436-4930-b8e4-360710d1f6a3",
                        "id": "tq_SVyC13Z5Y",
                        "name": "Arrowteks_open_positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c61ae8f5-5340-4398-873f-5d2b6fedaeb1",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "17ba784a-8d3b-4513-a469-58d1470ba2ba",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a4bf094-cb47-4b6a-a330-21833b693294",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "203d5b93-23f1-4063-957c-03bd086e4384",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "45ad4e92-4ba2-4912-959d-929a3500b73c",
                                "id": "user_currency_vol",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5796ebe6-9ae8-48d4-ad82-1fd149f5482b",
                                "id": "system_currency_vol",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9029123-7fbf-4d45-9b24-abe54166d9ce",
                                "id": "exchange_rate",
                                "name": "exchange_rate",
                                "type": 5,
                                "size": 29,
                                "precision": 27,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "908f53ed-fd62-471f-b627-e1673e35289d",
                                "id": "pnl_curr",
                                "name": "pnl_curr",
                                "type": 5,
                                "size": 22,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "671390f4-d2e9-49e2-bc10-884a448cb828",
                                "id": "pnl_usd",
                                "name": "pnl_usd",
                                "type": 5,
                                "size": 49,
                                "precision": 47,
                                "scale": 12,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3444ec1f-231e-461c-90de-28d36f69e0b1",
                        "configOptions": {
                            "importQuery": "select \ntrader_account_position.id,\nconcat(brand.id,'_',trader_account_position.id) as unique_id,\ntrader.default_account_id as trader_account_id,\ncurrency.name as currency,\nuser_currency_vol,\nsystem_currency_vol,\nsystem_currency_vol/user_currency_vol as exchange_rate,\n(trader_account_position.pnl)*(-1) as pnl_curr,\n(case \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'US Dollar' then trader_account_position.pnl\nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Pound Sterling' then trader_account_position.pnl * 1.31 \nwhen user_currency_vol is null or user_currency_vol = 0 and currency.name = 'Euro' then trader_account_position.pnl * 1.11\nelse trader_account_position.pnl * (system_currency_vol/user_currency_vol)\nend) * (-1)\nas pnl_usd\nfrom\ntrader_account_position \ninner join trader on trader.id = trader_account_position.trader_id\ninner join trader_account on trader_account.trader_id = trader.id \ninner join currency on currency.id = trader_account.currency_id\ninner join brand on trader.brand_id = brand.id\nwhere trader_account_position.status = 'open'"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c74e",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFMaz+izJFwQ7HgJUHVXggmldBM8T/h1mY0r2y8zpsHvKmwzD6I8ssX+l0X+TuIP5Ql2SkezEu+zKlhGGjozXGuYOz5g3alToOKLh+ovnOTKLddCPNh4ut0H9WpKzkvNXxw==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fbea873a-754c-4870-81ba-a67fd501f608",
            "fullname": "MySql:f090bd9f-3c61-4ccf-92de-c193c5e57d45",
            "type": "extract",
            "name": "f090bd9f-3c61-4ccf-92de-c193c5e57d45",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "965e182e-3194-4458-828b-a7a7a6b6c176",
                        "id": "tq_F9hK0BYhE",
                        "name": "TheWealthCore_Positions",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c0acee80-3d1e-4160-bbef-d61cbc0cf205",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01981ef1-b5c8-451c-b6b8-1c7e06a8c8be",
                                "id": "unique_id",
                                "name": "unique_id",
                                "type": 18,
                                "size": 31,
                                "precision": 31,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44b8554a-d362-4afb-af06-add4bcb13486",
                                "id": "employee_key",
                                "name": "employee_key",
                                "type": 18,
                                "size": 37,
                                "precision": 37,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8545ac9d-4547-40ae-a6dd-815dc78083f4",
                                "id": "wide_currency_amount",
                                "name": "wide_currency_amount",
                                "type": 5,
                                "size": 21,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "21930f5d-a872-4694-bcdd-cc8a7e19d8c6",
                                "id": "order_type",
                                "name": "order_type",
                                "type": 18,
                                "size": 6,
                                "precision": 6,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "00e1a33a-880f-4d7b-8dc3-066afa4dda63",
                        "configOptions": {
                            "importQuery": "select\n\ttrader_account_position.id,\n\tconcat(brand.id, '_', trader_account_position.id) as unique_id,\n\tconcat(COALESCE(1000 + brand.id,1001), 10000, trader_account_position.owner_id) as employee_key,\n\ttransaction_record.wide_currency_amount,\n\ttrader_account_position.`type` as order_type\nfrom\n\ttrader_account_position\nleft join transaction_record on\n\ttrader_account_position.id = transaction_record.origin_id and transaction_record.origin_type = 5\nleft join trader on\n\ttrader.default_account_id = trader_account_position.trader_account_id\ninner join brand on\n\tbrand.id = trader.brand_id\nwhere\n\topen_at >= 20190923\n\tor close_at >= 20190923"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6119a5368a56da002c36c750",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fdc8925d-86c6-4c34-9567-6ec60e9f19ef",
            "fullname": "MySql:f8433cb6-1261-440f-8bad-5430ac3d4f1b",
            "type": "extract",
            "name": "f8433cb6-1261-440f-8bad-5430ac3d4f1b",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5368a56da002c36c752",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoheAP1kZvNi+4VpN1pRRv3kaD/RL2IIGntCq0mo/lZJkYw5sZYML0+enaqd6ElULbA=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fe258831-3d9f-487c-8e1e-0347c547d934",
            "fullname": "MySql:694313ef-88ba-4967-8bf1-32606f49c77d",
            "type": "extract",
            "name": "694313ef-88ba-4967-8bf1-32606f49c77d",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "6119a5368a56da002c36c754",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoheAP1kZvNi+4VpN1pRRv3kaD/RL2IIGntCq0mo/lZJkYw5sZYML0+enaqd6ElULbA=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ff6a4d91-e41b-4fdd-91c5-310841e1f9ff",
            "fullname": "a857ae24-e2b2-405f-97c7-992bc70a8c59",
            "type": "custom",
            "name": "a857ae24-e2b2-405f-97c7-992bc70a8c59",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "bfefee73-3a98-45c3-9c54-74967cc3b08d",
                        "id": "PositionsOpen",
                        "name": "PositionsOpen",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "1e80d340-ea1e-4707-aa8c-d12709ce3cb4",
                            "expression": "select\r\n\t[positions_tp].*,\r\n\t(\r\n\t\tcase\r\n\t\t\twhen [Positions_crm_union].wide_currency_amount <> 0 then [Positions_crm_union].wide_currency_amount\r\n\t\tend\r\n\t) * (\r\n\t\t- 1\r\n\t) as close_pnl_usd,\r\n\tcase when positions_tp.[close_pnl_curr] > 0 or [open_positions].pnl_curr > 0 then 'losing'\r\n\twhen positions_tp.[close_pnl_curr] < 0 or [open_positions].pnl_curr < 0 then 'winning'\r\n\tend as trade_status, \r\n\tgetyear(\r\n\t\tpositions_tp.[open_time]\r\n\t) * 10000 + getmonth(\r\n\t\tpositions_tp.[open_time]\r\n\t) * 100 + getday(\r\n\t\tpositions_tp.[open_time]\r\n\t) as open_time_key,\r\n\tcoalesce([Positions_crm_union].employee_key,'-100') as employee_key,\r\n\t[open_positions].pnl_curr as open_curr_pnl,\r\n\t[open_positions].pnl_usd as open_pnl_usd,\r\n\tleft(tostring([positions_tp].open_time),length(toString([positions_tp].open_time))-7) as open_time_str,\r\n\tleft(tostring([positions_tp].close_time),length(toString([positions_tp].close_time))-7) as close_time_str,\r\n\tleft(tostring([positions_tp].[client_open_time]),length(toString([positions_tp].[client_open_time]))-7) as client_open_time_str,\r\n\tleft(tostring([positions_tp].[client_close_time]),length(toString([positions_tp].[client_close_time]))-7) as client_close_time_str,\r\n\tSecondDiff([positions_tp].close_time,[positions_tp].open_time)  as sec_diff_from_close_to_open,\r\n\trate_open * qty as weighted_avg_help,\r\n\tpositions_tp.[system_currency_vol] * positions_tp.[margin_initial] as initial_margin_usd,\r\n\tpositions_tp.[system_currency_vol] * positions_tp.[margin_maintenance] as maintenance_margin_usd,\r\n\tpositions_tp.[user_currency_vol] * positions_tp.[margin_initial] as initial_margin_curr,\r\n\tpositions_tp.[user_currency_vol] * positions_tp.[margin_maintenance] as maintenance_margin_curr,\r\n\tcase when isnull([positions_tp].close_time) then MinuteDiff(CurrentTimestamp(),[positions_tp].open_time) else MinuteDiff([positions_tp].close_time,[positions_tp].open_time) end as duration,\r\n\tcase\r\n\t\t\twhen not isnull([Positions_crm_union].unique_id) then [Positions_crm_union].order_type\r\n\t\tend as order_type,\r\n\t[sites].site_name\r\nfrom\r\n\t[positions_tp]\r\nleft join [open_positions] on \r\n    [positions_tp].unique_id = [open_positions].unique_id\r\nleft join [Positions_crm_union] on \r\n\t[positions_tp].unique_id = [Positions_crm_union].unique_id\r\nleft join [sites] on \r\n\t[sites].site_id = [positions_tp].brand_id"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "5fd61233-c9c1-4980-9946-d0f58f5e6867",
                                "id": "1a66d3b0-30cb-4800-858a-d3ecc980c6eb",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "71e81f74-bde5-49cf-9c8e-abaf5a187345",
                                "id": "abbf3657-a99b-444e-a4fb-21541d9f1d36",
                                "name": "ref",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc357300-b2b4-49f3-9eef-bbdebfc634e4",
                                "id": "7306a39f-1c9f-48b5-baa7-0e81ecd57cdf",
                                "name": "type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f1bed3c-293f-4c49-8814-2b1b37d1012f",
                                "id": "331aaeec-1e33-402b-821b-a6c18e4921de",
                                "name": "type_desc",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "754dda3a-77a8-486e-a69a-21f9072b1637",
                                "id": "ac000c59-2164-4b0f-b508-ee069ebd1338",
                                "name": "open_by_device",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb900b76-47b5-495f-ab52-28f20a823b91",
                                "id": "739ac283-d940-4282-90f2-3997970168e9",
                                "name": "status",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2f7eb981-a6c7-46c8-a7fa-28dd5dc6f438",
                                "id": "e97e6551-67b0-4ad4-a634-f7c3863cd150",
                                "name": "account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c200ae72-65ad-4bf3-a5a7-c12b09afb1d8",
                                "id": "d1258e20-7625-4dd6-b9e3-21522fa4a70f",
                                "name": "direction",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a1e9ab7-57ef-4731-b4e4-91b0e2799734",
                                "id": "a329746a-f565-4e08-841a-3b5b75af0a02",
                                "name": "order_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c17fa077-cd67-4f59-a107-aa95ab3a8fd7",
                                "id": "54916f67-1c36-41a4-8f33-c296e92ec367",
                                "name": "open_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1c1a4ff-100a-447d-aadd-89f8b9556f8e",
                                "id": "053fe6e5-39e2-4527-8d84-bbcb7f77e6fe",
                                "name": "client_open_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0593d6d5-eb8c-4da1-a7a2-aeb8228b2f51",
                                "id": "6fef06b7-ec76-4444-ac4d-73d933fd1224",
                                "name": "close_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "04ccf509-2935-451e-9e9b-92940134390d",
                                "id": "75dca881-e9e5-4c99-b4db-a0884987eb95",
                                "name": "client_close_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f40c86ff-4698-42b3-8e43-b6ae41565c86",
                                "id": "da00fb87-11ee-4375-9758-dc132b1f9127",
                                "name": "expire_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6aba0c8b-aad0-4342-b161-6c35a53f3c83",
                                "id": "90222aa2-4ba4-4ab8-9484-5c3d7c179467",
                                "name": "trade_configuration_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "849864ac-ced2-46eb-89c8-e26aa02136a7",
                                "id": "320f1712-2b9d-4c25-bc5f-0aa77bc170b8",
                                "name": "qty",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a53bc25-ef60-4200-8964-21ccc0f9c4c1",
                                "id": "73142b7d-e20b-40bb-8706-c508f6f40f4d",
                                "name": "margin_initial",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9bbdf41-7f86-4ca1-b17c-2c53ebb3f601",
                                "id": "7dda75ca-ac3c-4162-8e30-863aaa6c910a",
                                "name": "margin_maintenance",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28677296-0d7d-40e7-9a84-f6739d23e69d",
                                "id": "c6b5053a-faa0-4ae7-8530-389ff3c677a7",
                                "name": "rate_order",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "148e65ef-c082-40a1-8a9b-cca42fa10d03",
                                "id": "414c30bb-988d-4df5-a077-9a9e090854df",
                                "name": "rate_open",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abdcafe5-1c66-42bf-b5ad-d12e2d1dd2be",
                                "id": "e79f7323-9c6a-4667-bd49-69e79597e9cb",
                                "name": "client_rate_open",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5a5cbe5-1213-46a2-b453-d71f232d39aa",
                                "id": "750476e7-3761-4a0d-b3e6-0a2ef4e058ef",
                                "name": "rate_close",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58d09387-854c-48f2-9a7b-df1517381bec",
                                "id": "36d81abf-b9be-4aca-9ee9-1cd9f3de74b4",
                                "name": "client_rate_close",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4cd95ca-9bdd-48b4-bed1-98c825952d17",
                                "id": "bbb7efc2-060d-4c76-b1ba-82eb00e3e101",
                                "name": "stop_lost_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7d831be-bbad-41be-b2ca-3fa727968d23",
                                "id": "7f852bfd-33b9-4aba-a5b1-1ede69d5a9f9",
                                "name": "stop_lost_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8548c5a-ca0a-4e46-89c7-4320e8a13a63",
                                "id": "a9a6f4fd-ec93-40d3-99f0-5f4417320289",
                                "name": "take_profit_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4fbc8790-eb5b-44ee-a0a1-8a65eba8fb0a",
                                "id": "f0f8d0c6-b508-4c66-ab99-d71aee5e4b67",
                                "name": "take_profit_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f71f8bfa-a48b-479e-8d1a-d84f4dab4aef",
                                "id": "ab517b82-4936-4354-be61-c24f6178b9f1",
                                "name": "overnight_commission",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6763398c-da58-4c3b-95e5-a1389e4e3bab",
                                "id": "9c66d955-2d83-4a45-8451-d94737fede54",
                                "name": "close_pnl_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0d5668fe-f859-480e-8fd6-d01ab5aec528",
                                "id": "80644399-81c5-4509-a4ce-2b5fdb392e7e",
                                "name": "close_by_crm_user_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52363686-ab6d-42d3-8e4f-f49a1f1bdc41",
                                "id": "f63df235-688e-4204-b133-a4ad29d2c4fc",
                                "name": "close_reason_type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be60b744-0eae-4804-aa53-9cbb87aca667",
                                "id": "b7ea9730-30cb-47b6-8f36-494dbdd27297",
                                "name": "close_reason_desc",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19150748-6985-4ec5-8f58-504287af1735",
                                "id": "19a98afe-7891-44e5-a0d3-0910f5fbf3cc",
                                "name": "last_edit_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13242775-d2ab-4b51-9ecb-cd95f1893a1d",
                                "id": "eb4456c4-fb31-4539-a744-2d367bbf3888",
                                "name": "latency_open",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08a59028-8fa0-4014-ac5a-ce83b8be715b",
                                "id": "2d3388e9-eccc-45d0-864b-238d635d9225",
                                "name": "latency_close",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39c7eb52-0cf1-4796-aadd-c4d386095a2f",
                                "id": "723e14d4-18cf-4de3-a916-434b72429bda",
                                "name": "reject_err_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2963217e-7b93-4836-80b7-4501c670b44c",
                                "id": "3eaf03b6-f958-41a8-a9cf-332f02a296aa",
                                "name": "reject_err_desc",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18450668-6f6c-40ed-ba13-4b728a031f7d",
                                "id": "23bda98b-273a-4ac5-90e1-b02d2eca9cb0",
                                "name": "user_currency_vol",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ee695ce-7ddf-4f66-8486-565d0a121050",
                                "id": "5c83fda8-4950-4070-8527-1ff3c801edcc",
                                "name": "brand_currency_vol",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5fcfbf6-9252-4356-a12d-0cab54069ca4",
                                "id": "19dac6cc-7a67-4175-9f2c-feeaef5eb46d",
                                "name": "system_currency_vol",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41505ee6-be21-4344-85da-b3f05e6c003a",
                                "id": "baae4ed6-6090-4822-9738-a576886569f8",
                                "name": "instrument_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "435df00d-8d8c-4800-8abd-36d2644eaf27",
                                "id": "d918b6b3-87ea-477b-9080-a1fc82c8dae8",
                                "name": "display_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce59f2c1-da37-44cf-b4c5-60b7f651d2da",
                                "id": "0c667f75-c7aa-4f4c-ad31-4eec6cf488f9",
                                "name": "unit_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7df7d625-ecc7-4cb5-b737-1848177f58d9",
                                "id": "25d3de04-0b1b-4807-8d1f-34a67c1c7429",
                                "name": "qty_min",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c0291d9-8b7d-4d0b-a19d-caae4aa99f04",
                                "id": "13d25586-55c9-48b3-a013-e76e98b8b792",
                                "name": "qty_max",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4e75d71-8821-4d55-9545-b14eaa05e85b",
                                "id": "c83d0e96-a833-47ed-86cb-fd50fa32d006",
                                "name": "qty_steps",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f5b850e5-30a8-48b8-b732-a45d71adc91e",
                                "id": "37de3cd7-a4c8-4e2c-83fb-84f7793851a1",
                                "name": "sell_overnight_commision",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef02600f-77a9-4d4e-95d3-f07122f54c6d",
                                "id": "1f451c32-4d45-472e-8603-9b95955a781b",
                                "name": "buy_overnight_commision",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd4f3b61-2853-4e73-8ca3-456f69536f90",
                                "id": "308a59ba-4754-4da4-a70e-9eabf96d3dad",
                                "name": "ask_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5fddba12-fd0d-4691-9cab-33e78a7a63a4",
                                "id": "31244f25-e5d3-46d9-9c44-33b23c4fbd08",
                                "name": "ask_val",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01db3775-059e-4bd7-96d4-490b50948bbd",
                                "id": "fb6df260-578a-407d-bf38-4c19e596d40e",
                                "name": "bid_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aea1e4ad-45fc-46c1-bbcd-6f8107b8ff11",
                                "id": "a556835f-48f4-469b-b5a2-ff991649b300",
                                "name": "bid_val",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c2b4b09f-9998-4ceb-a259-28e5a34def7d",
                                "id": "822f9f8e-c563-4c7a-ac40-0f75c6523538",
                                "name": "liquidity_provider",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "472ed3ca-cdbc-4a62-90cc-1a4bfa82d3c2",
                                "id": "28a85c9f-b4f7-408c-b0e4-46bdda35bee7",
                                "name": "swap",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a4500fed-6c88-48d1-975d-27fbc4e00dc4",
                                "id": "1deaa635-0376-4461-932a-0a24de051072",
                                "name": "brand_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1b933b0-3840-4b97-9124-ca2c0005352f",
                                "id": "a29092ad-4c58-40b2-96f0-fc6b3008003f",
                                "name": "unique_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "405014a5-4258-4a58-a28c-5ee8bed23a1c",
                                "id": "7428219e-259b-4aa7-90df-d7ca4a8c33e6",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d92b6ba-0a08-40ba-a5ae-426e3b353603",
                                "id": "6b4084ed-fc70-4ae1-bbc8-970065e2deb2",
                                "name": "Direction_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca9d1f52-4a42-4cca-aa0c-de3778538088",
                                "id": "5a306af4-eed5-4596-a06f-258874400193",
                                "name": "status_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02a91203-2c94-464e-b2d7-0733cc7d4d0d",
                                "id": "4ac01eb4-7973-40f0-8b70-1aebb77ad840",
                                "name": "tp_current_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0a23244-7e30-416f-b9a5-2fe2483547cb",
                                "id": "810ec6ea-7adb-4d70-bc1b-2dabe3840793",
                                "name": "tp_order_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "47074f04-c31a-4951-b6e0-acdecd7cc133",
                                "id": "8c6a39f3-761e-4a5d-bca3-6d66d3f8d91c",
                                "name": "tp_order_time_str",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae74ef24-c564-42e4-809f-6cfb2fe440a2",
                                "id": "f65461b8-9498-4996-aa7e-879475a149d8",
                                "name": "sl_current_rate",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33ec011e-7870-43e1-bbea-6e4b15c9755f",
                                "id": "967291f4-76ec-4bba-9167-8197b9094407",
                                "name": "sl_order_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "576c9713-2f1e-4e9d-8308-7cabb03e6562",
                                "id": "d48699fe-3d0e-4b7d-bca2-13a703cdd260",
                                "name": "sl_order_time_str",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "008253d8-afc0-420e-86d4-7ec9472ff2b6",
                                "id": "7bbead98-e551-4d9c-84f2-eb2675a178bc",
                                "name": "direction_fixed",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ac2d30ea-4644-4b00-8a7e-7406aa465c6c",
                                "id": "745a3e11-126d-438e-acb4-1948d79cac10",
                                "name": "close_pnl_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bc4fb2b-867b-4861-91cc-6e2e81f50926",
                                "id": "2c737632-3dc9-420d-a46a-cd7f008b0c54",
                                "name": "trade_status",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9f58912-7e3c-42b4-9bf1-1006e82ffc69",
                                "id": "229d558f-f517-43b5-a17a-b1e82f4e06b2",
                                "name": "open_time_key",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "81d1a99e-c5c7-4b42-845c-82024f04f5bb",
                                "id": "accdafd5-42c3-4578-8c91-abcdd424ead5",
                                "name": "employee_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "776c557c-1e93-4186-82b4-314b068f2ebe",
                                "id": "bf6d1a0f-11aa-4279-a2bb-638ea0ff6177",
                                "name": "open_curr_pnl",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d0bd20c-82fd-4e20-8277-c5cc3d37a721",
                                "id": "1e7edcbe-de32-4957-8a1a-82a03c8a0ca4",
                                "name": "open_pnl_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bfe05cc5-fb82-4637-94be-b09bafb566ee",
                                "id": "9389c17d-a6de-4f63-b458-1c68aa658201",
                                "name": "open_time_str",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "136c0c91-b45a-45b5-995d-d95cc6129cd9",
                                "id": "0412e4a4-0eeb-4612-b0ee-759e16bfd411",
                                "name": "close_time_str",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06baf08a-0422-40ab-be8d-2f53a3eb216d",
                                "id": "ddc3fda3-f2e7-4bb1-bcfa-3e821e49ceda",
                                "name": "client_open_time_str",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10ba4a30-ea4c-4bca-b029-00bd8f7ea0a7",
                                "id": "3329a80c-dd5b-4413-88e3-72998c958094",
                                "name": "client_close_time_str",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7be93a8c-19bd-4c36-8e69-8d870e33ea3e",
                                "id": "50375468-2039-4c2a-9fc5-77649554d80a",
                                "name": "sec_diff_from_close_to_open",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0da64dd7-d760-49d3-a856-35c1ee13fd24",
                                "id": "c3d07110-fd8f-4284-9c1c-0f4dc304827c",
                                "name": "weighted_avg_help",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e9b2940-74d9-4e54-a39a-8b1c0dd668a6",
                                "id": "1e93be30-7fe3-4a71-9838-6d0b04da36a7",
                                "name": "initial_margin_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0b0a4318-1bc5-4649-8771-37c732f96081",
                                "id": "88c3043f-b8b2-440d-b9d9-500dccfdc5e9",
                                "name": "maintenance_margin_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48899e61-57dc-4403-8577-f61ec6b57280",
                                "id": "621c7cbb-eddc-47b7-b5fa-49ec5e9bd252",
                                "name": "initial_margin_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06cbf853-34f4-4784-b963-8ce7fa58dd59",
                                "id": "a56459fd-0e69-4dd4-b5ca-891391a91619",
                                "name": "maintenance_margin_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "edcfdafc-0d04-4a02-acf9-4c978eb47050",
                                "id": "e42642aa-41fd-46bd-9655-00794f1a49d3",
                                "name": "duration",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "584a64a9-c9ee-4a82-b81c-d8b4fe1a9100",
                                "id": "f5801893-a2b8-452f-8933-d04242a0f113",
                                "name": "order_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ef635e5f-f76a-45f0-bd06-919b293bc7ef",
                                "id": "a54e8786-7636-4f35-9834-932f45c4813d",
                                "name": "site_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "0b131517-e282-4b2f-b69b-084214677eff",
                        "configOptions": null,
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        }
    ]
}