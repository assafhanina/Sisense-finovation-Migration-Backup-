{
    "title": "External Payments Solutions - Test with CRM",
    "type": "extract",
    "buildDestination": {
        "destination": "elasticube"
    },
    "fiscal": "system",
    "relations": [
        {
            "type": null,
            "columns": [
                {
                    "dataset": "0627d8fe-de65-496a-9e58-e77134bed03f",
                    "table": "8c558793-1f3a-48f2-9dd7-4a94efcd22d6",
                    "column": "53798ee8-5879-40e4-ab28-74c571896112"
                },
                {
                    "dataset": "b950838e-9202-49a8-885a-e342d25ee9d2",
                    "table": "772ceceb-c29e-4695-89aa-8c9a38eb1a67",
                    "column": "6276ba78-aba8-43da-9375-9ed7ba7df4e7"
                }
            ]
        },
        {
            "type": null,
            "columns": [
                {
                    "dataset": "b950838e-9202-49a8-885a-e342d25ee9d2",
                    "table": "772ceceb-c29e-4695-89aa-8c9a38eb1a67",
                    "column": "c85f1f7c-250f-4d85-b5bc-0825edc0c4d3"
                },
                {
                    "dataset": "3a57f3d1-03ca-4e9c-a5e0-47850644ebef",
                    "table": "49617e6f-73e0-4ddb-94e0-e9c43b3abfe5",
                    "column": "c9d28503-a89b-441e-83b7-4aa2c53d0d1d"
                }
            ]
        }
    ],
    "datasets": [
        {
            "oid": "0627d8fe-de65-496a-9e58-e77134bed03f",
            "fullname": "MySql:MySql-0627d8fe-de65-496a-9e58-e77134bed03f",
            "type": "extract",
            "name": "MySql-0627d8fe-de65-496a-9e58-e77134bed03f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8c558793-1f3a-48f2-9dd7-4a94efcd22d6",
                        "id": "tq_Ent8fj26b",
                        "name": "DW_DimDate",
                        "type": "base",
                        "schemaName": "",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "53798ee8-5879-40e4-ab28-74c571896112",
                                "id": "DateKey",
                                "name": "DateKey",
                                "type": 8,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0530e2c9-72f0-4497-b0eb-320a94f864b3",
                                "id": "Full_Date",
                                "name": "Full_Date",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d7a49261-a69f-406b-939b-64ea374776dd",
                                "id": "Day_Name_Of_Week",
                                "name": "Day_Name_Of_Week",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "238b5d6a-24bb-4226-95d9-6aa495513f35",
                                "id": "FullDateTime",
                                "name": "FullDateTime",
                                "type": 19,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7254e39c-c0c6-438d-96a2-eeee7ba1915e",
                                "id": "Weekday_Weekend",
                                "name": "Weekday_Weekend",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "53798ee8-5879-40e4-ab28-74c571896112",
                                    "type": 0
                                },
                                "type": "change-data-type"
                            }
                        ],
                        "hidden": false,
                        "vTag": "7a7e62e7-5014-4d10-b7e5-a843f3b5b5a7",
                        "configOptions": {
                            "importQuery": "SELECT\nDateKey,\nFull_Date,\nDay_Name_Of_Week,\nFullDateTime,\nWeekday_Weekend\nfrom dim_date\nwhere datekey >= 20130101"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "611875c18a56da002c364c11",
                "provider": "MySql",
                "parameters": "vbzYfS4H8zKaaa63Q8eVyx36cxK7oYg+4Q5WunfT3zgdww2iSGhTLrUnq7V9U0erIOY0jNYmKt9GMi/AOy4uJor53Wy5pKADZZQU4IywmnjHaGH4fezFLpM4Qgb/nP5Qo2z3T75JjWg0asinZRH4nPIpWIWzjBZUhPLin/PXCjhJiUvrOtcx64Deeph0+EQDy1nQEeRpJE9+RWm+KH4ERg==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0bc7ed27-2c06-4300-b816-963bf4786d32",
            "fullname": "MySql:MySql-0bc7ed27-2c06-4300-b816-963bf4786d32",
            "type": "extract",
            "name": "MySql-0bc7ed27-2c06-4300-b816-963bf4786d32",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "30d080cc-f01e-4fbd-b749-43c7a01fbcf5",
                        "id": "tq_YjuCFqBMM",
                        "name": "Wealth_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "be8fb0f3-afcd-491b-ad46-469f60358f83",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bab36aed-2c50-4683-b819-72041655d63b",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b5f89aa-28cd-41d4-be19-ee2b585fb1a5",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "481da68a-2fe4-465b-a303-6670a6792c7e",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "076fa2c7-a604-42d3-aac4-6e9dec4c3797",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "76f02f5f-9a6f-42fc-8630-60152490d6b8",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e4cb39e4-a183-4ae6-9c76-e2b4f57ac145",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e0c4d138-3d55-4a2c-9f37-468c2d74cfd3",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e9975ca-0bf5-4971-9d89-fbdddc06a9f7",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a230e186-1abb-4ea1-b8ec-a3719240128d",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f66c81bf-e88d-4b8c-abbc-2a6fb2150f2f",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d093dce1-6447-49bf-a745-57e7108091cb",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da9ad41b-4517-469f-ae32-fb01fe7b4e46",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d75de1e5-583d-4858-b87d-908a32a6cd5a",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fb2e9f8f-0533-4ed1-815b-739f71641bdd",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d608872c-7c69-45f7-8c64-65e77e39ac72",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "283dc62d-755f-4a99-8e26-60c423ecab45",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9ff6314d-11cf-45bb-a09d-cf2eb16f7c88",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5783d3a8-f1e9-4866-9ab7-b005c6f345f9",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe538d79-babd-4760-91c5-d86e08c7a6d6",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2c584b3-5dd5-4c83-95cc-e924e44f7193",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f17c6558-16fc-4109-a204-ec15e31d82f3",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da690dc7-c1d1-4d8e-b4f2-f40225bbe057",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bda80ee3-8348-4e07-bfa7-e60e854ff793",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8da4c955-6561-466c-8b2f-c82277cf9dd9",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f47301d3-180b-4253-913e-4127169f26db",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7a8458b4-b165-4fa6-9ed9-fa1f38ba4b8d",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ecea2918-fd4d-480f-8268-16fca4e25fa9",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "8e0c9b0e-2350-4df5-87ce-4cd7eecc61de",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,\n       brand.name as SiteName,\n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32,68,76) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32,68,76) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32,68,76) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32,68,76) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32,68,76)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32,68,76)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32,68,76) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32,68,76) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32,68,76) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32,68,76) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id not in (24,32,68,76)\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id not in (24,32,68,76)\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6179139bd34347002cd7f528",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Myh9H79F1tEjqehTSO4S+8XFaeYD2i+eiyJXl+Wpg/5l1Wy0f2btLzz8zBBn79zfbMTOuwJEPfYSApHU2kc7K17uP7Pnj+OzD5z8l5amqYAmGQqhASbXFK2E4d3rMBNbU=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "0caae31c-f3be-4bb3-b1de-b12123c545bf",
            "fullname": "custom-0caae31c-f3be-4bb3-b1de-b12123c545bf",
            "type": "custom",
            "name": "custom-0caae31c-f3be-4bb3-b1de-b12123c545bf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ed7da494-06b9-476b-a7d1-98ec6c41a85b",
                        "id": "New Custom Table",
                        "name": "Transactions_CRM",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "f39266a8-f4e3-4f6e-bb16-cc1634b1480f",
                            "expression": "select * from [MarketsCG_Transactions]\r\nunion all\r\nselect * from [York_transactions]\r\nunion all\r\nselect * from [PrimeOT_Transactions]\r\nunion all\r\nselect * from [Ivy_Transactions]\r\nunion all\r\nselect * from [Wealth_Transactions]\r\nunion all\r\nselect * from [Arrowteks_Transactions]\r\nunion all\r\nselect * from [Aussie_Transactions]\r\nunion all\r\nselect * from [InfinityCapitalg_Transactions]\r\nunion all\r\nselect * from [365TradingFX_Transactions]\r\nunion all\r\nselect * from [TradeTheBit_Transactions]\r\nunion all\r\nselect * from [NostraCapital_Transactions]\r\nunion all\r\nselect * from [TheBPCA_Transactions]\r\nunion all\r\nselect * from [GeniusIG_Transactions]\r\nunion all\r\nselect * from [Chelsea_Transactions]\r\nunion all\r\nselect * from [AshfordCapitalInv_Transacitons]\r\nunion all\r\nselect * from [WinGroup_Transactions]\r\nunion all\r\nselect * from [BendigoCoins_Transactions]\r\nunion all\r\nselect * from [BigBitMarket_Transactions]\r\nunion all\r\nselect * from [BitfinityFX_Transactions]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "06782806-7b5d-4ffe-96a6-0ffb5d064d50",
                                "id": "9b8ddd29-09ef-49b9-8c6f-4ae4b7fe3381",
                                "name": "Email",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f7b59264-5dd8-4dcc-a604-b4fb43228141",
                                "id": "e55a7442-7c5d-4f9a-8084-aabc2af511a9",
                                "name": "SiteName",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97ed04bd-279a-4a26-8d14-0942358ef4ba",
                                "id": "7f965908-f70b-4146-9391-8d50c57195d3",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4dabed8a-7a2a-4d84-bd9b-2aef6c163f8b",
                                "id": "5b5f4f82-03cb-4172-91a5-029b9798f1c0",
                                "name": "customer_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b90aae0d-32e6-4541-a304-d6747c8048d3",
                                "id": "1dd20363-f092-4ccb-9604-5dacc2f41852",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8d0a7df-7846-4fca-8fcf-b6a45cf489b8",
                                "id": "4fcd9df3-847a-4b33-8d1a-99b982c09663",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "90d5212d-647e-494d-804e-e13e952b1c1a",
                                "id": "dc74c3ae-1311-4269-adef-4ae4c3c9ef43",
                                "name": "origin_type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d4c3263-7dd1-415c-bf94-880860791176",
                                "id": "aa3f3e3d-b489-41c8-b914-7d439c99c5ef",
                                "name": "name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c47cb03e-7625-437f-9877-e489695a5f53",
                                "id": "7bf53fd2-ca4e-40e1-b906-04ff6f0953e8",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bcf226ab-f5b5-4328-bc3e-e0d718f45ede",
                                "id": "7ed150c5-1b22-4d89-9e80-5773e9e6b338",
                                "name": "amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc1b78b8-445c-4d8f-80e1-8a7a39a577d9",
                                "id": "cabe195b-1fac-413c-bebb-e6fa5505d974",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cf0a7b8-d7ec-4c2c-bbe9-6c65fb2c6a78",
                                "id": "a858f48a-103f-4b2a-96e7-43d778d996aa",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1e367d0-2d03-4aca-9c37-9aa0721c074b",
                                "id": "1511ea11-e6c7-4596-accd-69cd85b0007c",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32ca0ae0-517a-433a-bd57-323d5d601917",
                                "id": "c6f84682-0bfc-4c54-8f82-1b07425600f4",
                                "name": "withdrawal_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ac1a53c-1f50-4ace-a4f4-869c7491fbec",
                                "id": "9e40db87-4189-4e1f-a716-26fea02f16bf",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ffa0ad0e-44c1-4f9b-961f-91b55876c991",
                                "id": "c9ff858c-1f3e-437d-8941-29596f9d17cf",
                                "name": "net_deposit_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5737d48d-473b-4888-b814-b0a302b4716d",
                                "id": "91178482-9c95-4d0d-82c0-4524f603f69a",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb13d83b-3eb7-4922-bcd0-606743e956ea",
                                "id": "c729ab39-2f5a-4285-acff-38ee26d02562",
                                "name": "is_tech",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8815ccd8-0ec9-4914-a023-533ad46bce69",
                                "id": "b2ceaf48-1d02-4f23-b17e-6dbc025122ef",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "900a7a94-b0a2-4446-97c0-9cf29c5793d1",
                                "id": "c9994708-9f0f-4324-ad9b-5cbc6d5422b7",
                                "name": "payment_method",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ff326c81-5cc6-443a-90b3-8befd733a02f",
                                "id": "2ff82fb2-84ea-4545-9a76-adc3c7a58927",
                                "name": "created_at_crm",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0591a952-71a9-42f7-a986-4349c25a043a",
                                "id": "e44328b0-42b3-4d14-b164-d86a1f46e23f",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44d2c457-e6eb-4bcd-82cd-728594b73dbb",
                                "id": "3b644c98-78fe-47f8-ba13-2757b319a4ff",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41dbec70-3d8a-42ae-bdaf-8ef6125ad973",
                                "id": "25088f1d-e11f-4af9-8ee3-29664575bf56",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc3b2595-5e1e-4c39-98f1-39a52fda552c",
                                "id": "78ddff9c-2675-4b8a-9ddc-fc0a73d6c052",
                                "name": "withdrawal_amount_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97d28398-978a-43d5-8c85-bb5453b0d43d",
                                "id": "5073e449-6bfc-4294-9472-5b2d1ae02d94",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33223411-d0ef-4100-8d2d-c42af6dee71f",
                                "id": "e03ae51b-e06f-4e9e-ae45-2565650c1f42",
                                "name": "net_deposit_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e13827c3-2063-4b3c-99d0-b5d1aa4d35e7",
                                "id": "7aa95664-66c0-4e1b-9e21-84b5925fa321",
                                "name": "code",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "f16bd1ec-4a54-443b-8966-4c436ee1bfcb",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "0d7dcf85-163a-417b-b7b0-df5acdc1ee8f",
            "fullname": "MySql:d49e0647-2e2f-4682-8be5-426c2ac38a2e",
            "type": "extract",
            "name": "d49e0647-2e2f-4682-8be5-426c2ac38a2e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "6d45dce7-3ab6-43c6-8c53-f711a6cb6a8c",
                        "id": "tq_b7qWlwwAZ",
                        "name": "BitfinityFX_Transactions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "07bd5fe1-8819-4746-9670-8d0358ed2b4a",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fdc4773-bda1-4d8d-ba04-941d30ec3888",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "10491a65-9ccd-4bb9-9c3a-b7d5c64dc64d",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ef4b500-48ec-482a-8d2c-098ca083d4c1",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "967c9327-34fe-4a66-8dce-14177429dbe0",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1c86fb4-9734-4853-bef4-66e8ca631568",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "084a4242-8864-4b1a-84aa-887a0d8df2b1",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "798bd9d9-7032-4f83-b77a-37193cbbc8d9",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4bea5f9a-1481-4583-b3fc-558ad67b9c38",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9502e08d-5ba8-4fed-99dc-7a71331dd766",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49076d34-63d3-4ce5-8cde-ba4d69cf58f0",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08e5a228-722c-42f3-a8f7-8badb06163d7",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96277f4a-7273-4737-b0a6-d380922581e5",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61569a4f-3278-42c6-8452-09992007372b",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66aa199a-74be-442b-b7c4-011cffed51d9",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5d6e17e-a8d9-4ba7-ba54-04bcf9bf3bcf",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cdd2944-24a4-4295-aecc-f06ac60ddbd0",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2df1d565-24b4-4aba-8583-90d20b2d1aef",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6d1992a-0b0e-4fb7-9984-89d66c955c31",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05cd94e5-e2db-4d48-b74c-a96cb5bf72a1",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2133f2a4-c666-4875-a5d5-f3115803195b",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d52ee6d8-24a7-4ccb-bc63-312a87f4a24f",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d10dce44-bf8d-4056-8eb2-cde82ecc1157",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf39eaa9-1217-4470-87f0-94876bfcf7dd",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a144138-e25a-4435-ae7e-9393c740d0a6",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be6ddcdb-7332-49a9-974b-497584688126",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f4487b8-3e25-4ece-903c-eb6845ec6a79",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b01f7316-5a40-4c2b-bf83-771e9b8afd87",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "f987ddc0-67d8-481d-927d-e891c5a1f143",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName, \r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,32)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,32)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0edbfb43ad1002c7a759d",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8C2q0mVY+o2WF4+UVAyIhGiWhSY3+Y93kyI+zrKj2Bg5HiBiNB45Ta2GGPAsEoYp8/7dK0B1NeCzhErO6Xxg3c338i0MevnkC9Yi9QGlRnh1xn5Kjp5TuCxX28iusyU+paJ5wPXzkAPGHPDNhGasnoxvMsxipUWeTclTSatITjv9eQNNH4tFpXr1gskkcrIfglENUveS4Og+oLFLIuz1xQ",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "121751aa-d6bf-4d66-881a-19510ac5cc0c",
            "fullname": "MySql:b2a04364-927b-4b22-b99b-bce03b0385d6",
            "type": "extract",
            "name": "b2a04364-927b-4b22-b99b-bce03b0385d6",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f483931a-e5cc-4664-80ab-47880011fd88",
                        "id": "tq_swM4Tk2ko",
                        "name": "BigBitMarket_Transactions",
                        "type": "base",
                        "schemaName": "TempTableQuerySchema",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "603963cd-bc24-4c7b-b5f2-22d1c33cbf81",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d675e412-5449-44ea-9565-09e324f8cb3f",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1ed4186-2b61-45b3-be13-2dd3405cfdc2",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e02a815d-e6bc-45c3-989e-82f894273b56",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a18a6851-2f4d-409c-91f7-cfe5fd338662",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "84f91436-68ac-4035-9230-2c4626f70e6a",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38d7e7fd-692a-448a-80c6-c0314d165cf3",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "658d7c70-644b-47a9-a9e1-43b3f3dec6cc",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "630c56a0-4a9c-4fa1-aedc-29ba24f6321a",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c918b68a-de5f-4a12-a650-a5737df4d91c",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a644fc2-0372-463e-845f-1ecc289dcd9a",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79718820-9be9-4973-846a-dcdcba9d30f0",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c10bfc01-2e3d-431f-9b6b-6bebd2250e10",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "307eee56-938a-49d2-a9dd-c710edbbabae",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11f6d3ac-7370-47b9-9a81-92b5e0581a0e",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c79ba354-cb8e-446f-937f-0c9bb0e9c50f",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f0959ed-3e2a-477a-b1f2-d1ea4b7d05d1",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e17df6e3-de03-419b-9eda-7c43f3440de1",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e07f57ad-1558-410d-8125-2fb96ebb4f3b",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "038e049e-314c-492a-9fd0-10984152486b",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "097deb46-5482-4cf6-85fd-c0cee230e451",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8f529f77-adac-42b8-9172-46d73e7d57e0",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7fe015de-152f-443c-bcd2-bbd7896c88c4",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fea8b550-f3be-4c74-9dcb-db3be4200d77",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09209062-7898-4bed-b184-8b999e8035d8",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "537c3a73-86eb-4736-8b11-bac69d6e132c",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abd04d81-acd3-46c4-8b62-86967f0872a8",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cfcc5614-f761-4958-a257-316c3709225d",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "f06b4c98-3292-4626-9423-6d38dc4eb8f5",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName, \r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,32)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,32)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a0ed7cb43ad1002c7a759b",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLQ6Dekj35RXaKmn0BE6R8W8bD2o5v9Ba4+g0VPyAFJ6qZPhFDkqs6qOpjxeB5URywYEM0Y5IWwTSfZgbHJLTtMzmzZSgbdgfJ0BlhJPRwoVm2bPMUaC9jYJJtYke3DmatdxFtSnXXXLw5NXPgQglQhswHkoMqicV1JanOG1lc6a5MnFcIEytgdU8Viotqx38I6PhGbwtchlZdferbuWbdmgL+URhY3tF5aP1AXAJ05Dq",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "2afcb74c-3404-405b-bace-f02445ae4cce",
            "fullname": "MySql:5632c65f-7e16-414e-b05e-8fb74db9a6ef",
            "type": "extract",
            "name": "5632c65f-7e16-414e-b05e-8fb74db9a6ef",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ba9c6f10-821b-4431-95c9-c5c3ef5568be",
                        "id": "tq_vawa33OGA",
                        "name": "AshfordCapitalInv_Transacitons",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "6c8f189e-4b38-410f-900a-0f89c4078dea",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6dbcb5d-9a62-40b4-8d11-0c1c8334ed57",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "55a2a01f-ce7d-48dc-8586-27c37cc29d46",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2c51d0d-5ba2-4896-8166-132940f659fe",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24881df2-f2d4-4af6-b8ec-45b699d950dc",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c7306023-2955-4f8c-894d-979aafca78a1",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "144290fb-422c-4cb7-8bb6-db26508ffb0e",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0c1efe36-2e59-4bde-99e1-e3ffefc2fbf3",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bb46704e-8368-4a38-83e5-d693e2b4fd71",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c88483a-5abb-42e9-b95b-b5df1905ef58",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "21962e37-58da-4899-b73c-ae38da93dc69",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6aca5907-3d85-4985-b819-8cab39626f19",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a25e45b-88fd-4c1c-b89f-d22eaaf9f3d8",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1fbd767f-5cde-46bc-b4eb-521595a9a10c",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3784152a-a5de-4577-bcf8-9a9c0d05b9c7",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f69a3bf0-fcc3-4f1c-b6e7-4100bd1f8613",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d16adbba-bcbb-405c-afb6-872d4a993966",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "794a9750-f208-48c8-a047-503db703fb88",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27c17033-cc92-4de6-9aa5-c0d32f42ceb8",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1af331c7-5ee0-419d-8b5b-e0f597bd5805",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a6274ef-77b3-41a9-843c-2a245d9a68a9",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c385979c-0873-42b9-b599-2c8949832e3b",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8ef65aed-b90f-481c-8446-6da8a8cd7c6a",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e52695c-72aa-4279-b6af-8104e6261b30",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ffdd6cb-8e52-427d-8d36-394e2ae96f62",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb3a6ea0-93fb-41b0-a113-90424cedf89d",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44fc5f16-aebf-4cc3-a4f1-c5e1231652a2",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "05f15cc5-447e-4b7a-88a4-247422ffef81",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3654593a-b599-4c25-b092-9f7726979a89",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName, \r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,32)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,32)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6179132cd34347002cd7f51b",
                "provider": "MySql",
                "parameters": "Oz2AfvRo3srlztUw24mN8xjULQgCsDxE8xdGvyNUDfDIDVlPEvzGPi9X1pOk7WkJorypT3vAhcaensqPr3DxJWq4DMDr4Ntq8hg/ST/QG/Ry+Mc5Itvb7ssjapRdR/f5pJGa1CgTA4+V9S7ZAeHlkIJ8fCivOQ1bPR1RbzXK2+kyaVjENBts5VNtP4yYjGtpqTycZGcbTdSdI98JCq+mp2IzDRzS7cexXuu83rKl7MG3hlCMfvhn4khms5onk7u7",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "3a57f3d1-03ca-4e9c-a5e0-47850644ebef",
            "fullname": "custom-3a57f3d1-03ca-4e9c-a5e0-47850644ebef",
            "type": "custom",
            "name": "custom-3a57f3d1-03ca-4e9c-a5e0-47850644ebef",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "49617e6f-73e0-4ddb-94e0-e9c43b3abfe5",
                        "id": "Customers",
                        "name": "Customers",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "93cc199f-3855-4f5e-96b2-f77eddcaab3e",
                            "expression": "select customers.*\r\nfrom\r\n(\r\nselect [Wondercoins_customers].*\r\nfrom [Wondercoins_customers]\r\n) customers\r\n"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "3e5913b6-7d1a-42c3-a205-6b8eafccd291",
                                "id": "payment_solution",
                                "name": "payment_solution",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "28228c0b-7328-42d4-9787-32f16bf1877c",
                                "id": "8159c9d8-bd21-4b62-b301-2c7656f2129c",
                                "name": "customer_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c9d28503-a89b-441e-83b7-4aa2c53d0d1d",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c27dd362-d10e-44ab-9064-b60ee621f44c",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1bc0752-9d10-4d13-8696-471f7d810f42",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3eb9aed-48aa-4090-9bf0-80ebb005bed9",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33fb9fbb-827f-417e-a287-b20926cba8f1",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "058b6b3e-1b18-421c-85f2-0099ae02e493",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2864a2f1-078c-4017-953a-9a57c1226c9c",
                                "id": "verification_status",
                                "name": "verification_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "599b1d42-c87d-4767-92b5-fc1e3de8b492",
                                "id": "comment",
                                "name": "comment",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e8942374-d332-4471-8a89-ed150a5d5ec0",
                                "id": "locale",
                                "name": "locale",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e4e4e8b-ef4e-4ca7-9c79-f73b95835999",
                                "id": "label",
                                "name": "label",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3cae1c3-b1a0-4c16-bfc0-c74d52c0e079",
                                "id": "trader",
                                "name": "trader",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ab798d6-b5a1-45f2-996c-33c907bec199",
                                "id": "reg_time",
                                "name": "reg_time",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fa056cf0-5dfb-4d14-8aff-c92443fa4612",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f1f20a33-bfe9-4ec4-af6d-8a0aeb580293",
                                "id": "updated_at",
                                "name": "updated_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "43ed1aad-fa1a-47b1-9bfb-bdda67d27ea4",
                                "id": "first_deposit_date",
                                "name": "first_deposit_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "201b468c-df0d-49b0-9d4d-94514e2e9a6e",
                                "id": "ftd_ind",
                                "name": "ftd_ind",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "82e033ac-14f3-4c90-8455-5a0943e376d1",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e7b02d33-3193-4d81-ac2c-8b76ba7a0115",
                                "id": "customer_risk",
                                "name": "customer_risk",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "110f98bc-37a8-47a9-833f-3f9267d2d5d3",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6eb83293-ca98-4377-998f-c6f7e283238d",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "95b8217e-a1a9-44d1-831e-fc1493c5173d",
                                "id": "counter",
                                "name": "counter",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4bdf0cde-207f-4cf4-be3a-63bc10834473",
                                "id": "left_join",
                                "name": "left_join",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "17c52b8d-2c73-4d39-9dbc-62eb559ab29e",
                                "id": "verification_required",
                                "name": "verification_required",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aee34cbf-6215-4434-a3cc-d92b0b8f81f2",
                                "id": "verification_match",
                                "name": "verification_match",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba4541b4-ea78-47a2-97d4-d4f8d6744e2b",
                                "id": "verification_match_edited",
                                "name": "verification_match_edited",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "79eb0b53-64dd-4495-ae3e-cf13c2399e28",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "485b9b4e-7cdb-4379-8c0e-71d452250cf5",
            "fullname": "custom-485b9b4e-7cdb-4379-8c0e-71d452250cf5",
            "type": "custom",
            "name": "custom-485b9b4e-7cdb-4379-8c0e-71d452250cf5",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "13136b19-0e93-40f5-8cb1-6f4e50dd31eb",
                        "id": "New Custom Table",
                        "name": "Transactions_Total",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "dbb7f85d-f9dd-4c89-993e-ef80a6b8c560",
                            "expression": "select *,\r\nbuy_amount_usd_no_fees - total_deposit_amount_usd as deposit_diff_usd,\r\nsell_amount_usd_no_fees - withdrawal_amount_usd as withdrawal_diff_usd,\r\ncase when (buy_amount_usd_no_fees - total_deposit_amount_usd) > 10 then 1\r\n     when (buy_amount_usd_no_fees - total_deposit_amount_usd) < -10 then 1\r\n     else 0 end as is_check_deposit,\r\ncase when (sell_amount_usd_no_fees - withdrawal_amount_usd) > 10 then 1\r\n     when (sell_amount_usd_no_fees - withdrawal_amount_usd) < -10 then 1\r\n     else 0 end as is_check_withdrawal\r\nfrom Transactions_Total_calculation"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "74b9fa5e-da16-4b2d-b088-996fa22bec99",
                                "id": "d37249b8-0ff8-4a4f-aafa-badf3baf152e",
                                "name": "Email",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3e099f7-afba-431e-b0c6-49b8c850f914",
                                "id": "9c862eab-572e-479d-8f58-9291c62dbf52",
                                "name": "SiteName",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df324dfb-0d7d-400c-838d-7ffa3a616049",
                                "id": "757295db-4970-4424-bda4-a2a79d6acda1",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ef9bfcc-2817-43ba-ab92-2799357b131f",
                                "id": "e311d409-4e90-4a66-a5a2-e453c6b8a879",
                                "name": "customer_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fa7c9aa7-85ed-4926-a440-985eee57e26e",
                                "id": "e731f532-325b-454f-aaf4-cf4be9df7d00",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c157f7ed-ff7b-44b9-a6d4-33181b02785d",
                                "id": "3be2072b-e3f3-4361-807f-fbafc62f6aa3",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9bc8eab-058d-47e9-8729-ed55028fd6a4",
                                "id": "4fdf032f-c26b-487e-aab8-9183f6deeb9f",
                                "name": "origin_type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9e99505-44af-4c91-a0f8-e287466b8761",
                                "id": "6d00b412-249b-4abb-8a49-ccfd6a7c83f7",
                                "name": "name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6916d6d-2a63-416e-8d1c-2e5898b46c3a",
                                "id": "6e9ee786-6105-4272-93d0-bc14b5354595",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f7533cb2-0cfd-4d12-881f-09a272e041f2",
                                "id": "085c5c16-5b5e-4cae-bfae-802f974172c4",
                                "name": "amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de6885b1-74f2-4f18-a717-abb2e3873ee3",
                                "id": "875e6651-be9b-4ac6-a3b6-6a23d0f454a4",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3ad1a811-6b98-4659-a33a-2d9e5522ed9d",
                                "id": "7868f07e-2a89-4903-846c-a2f9f90262c1",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "285991ec-fa15-48fb-88ac-5d4b1c7416dc",
                                "id": "2fd0ede7-2095-427f-b79d-5494274822fb",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e691ea8-8e78-466a-9731-261615374038",
                                "id": "a5d50c35-fff1-4798-8d78-0bfbdcb28564",
                                "name": "withdrawal_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "65030079-52b3-4d45-b8f7-ce60f1afe7a8",
                                "id": "2385033f-8975-47ba-aafd-cf94ec2b2327",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20b74da5-16ba-4e89-b772-8e6032e865a9",
                                "id": "922a5a0b-60f4-41db-af59-35d3ae0807a6",
                                "name": "net_deposit_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c74045a9-32d1-4796-bc93-53b3c8e05051",
                                "id": "3bb6cb12-ad86-41a1-91f2-6cc49d449cfa",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "acb9cec5-46e9-4d4f-8ace-66ce2fdd1186",
                                "id": "4f7ae338-0ec8-4798-a827-f168c4b22f12",
                                "name": "is_tech",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0bf68f99-9749-4c25-8399-299fafc53940",
                                "id": "52daf815-b05c-45e8-9d1a-9675b724b5cd",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6c17dee-9b9d-4cb1-8d9c-da11424205b7",
                                "id": "52e522ce-203f-483a-b150-ed4aad9cad86",
                                "name": "payment_method",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bdfd4fd4-41fc-4827-ad3c-a4a05a9cd9f5",
                                "id": "307bc349-5087-489a-ba54-2d22836d4e7b",
                                "name": "created_at_crm",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e111580-34fc-442b-afb9-8890ea8c607f",
                                "id": "3e267aa4-57be-4d8d-b312-0b1320f45016",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8c62852-f16f-4adf-81ed-6e72f48f402c",
                                "id": "e9439083-2480-4786-bd72-901a27e81786",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7308334c-6afc-4895-9dd9-2c5e507c965d",
                                "id": "1d797349-a18e-42d0-ba23-a1c382b949d8",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2de8036-6619-4186-addc-d131cf8898d9",
                                "id": "431a4547-e36a-4eb2-acd3-60950c401df6",
                                "name": "withdrawal_amount_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ccc8184e-c00b-434b-85e1-67a8ce67ed27",
                                "id": "73431de3-60c6-4400-803d-756a3080fdf4",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "274cb110-499a-4475-84e7-eea5269e1f44",
                                "id": "afc0771e-ecf6-499f-a9a7-1d5a86602ef7",
                                "name": "net_deposit_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3fc26230-8e2a-4495-84fc-40db50465c14",
                                "id": "cdc9530b-a346-45bb-862e-688d4929fb65",
                                "name": "code",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ebe01ba-8e2f-47eb-95b4-d992c0a36bf5",
                                "id": "23b6598a-ee2b-42ca-a791-590db7d27df5",
                                "name": "Order_number",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3370e4d0-e7d1-4f4b-9d43-19fe6fe1cee8",
                                "id": "45443fe6-a76e-462d-9ab1-7cbeb82dfd7c",
                                "name": "payment_solution",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a80108d-d80a-4e75-897f-96eced58b0ec",
                                "id": "4de09329-f744-4965-9812-6310561bcb6f",
                                "name": "transaction_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4bbd0e80-c1bc-422b-a7f8-3a274ac7a598",
                                "id": "25f66b86-1d62-44cb-ac6b-b089458352ad",
                                "name": "currency",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fbdf9ab3-e7e3-4886-9ea4-3c674d9f19ed",
                                "id": "414404d1-8063-43af-9ec7-c508b4f1500e",
                                "name": "amount_usd1",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8aa8b9d5-2024-444e-9b37-a2b7b738ad12",
                                "id": "8b14fef7-2527-4b35-8e06-0848e413a7ad",
                                "name": "crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01c0bd67-8e38-47be-a408-422a5c9b3fa5",
                                "id": "4bb490a8-15e6-4805-b2d2-6cddc4eac866",
                                "name": "transaction_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba389d06-fa07-4e2b-ba0d-000c8ad4d442",
                                "id": "604212b2-984a-4b53-950c-4a741a08d75b",
                                "name": "transaction_status",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5235676-da4e-476c-86ea-2cb489322965",
                                "id": "772b3ab0-6490-45ae-916f-ebbc07e36ed1",
                                "name": "payment_method1",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09968cfd-48d4-4b2a-9e1c-77432172edc5",
                                "id": "3e43142a-4dae-4c65-9c72-8457cad5ecd9",
                                "name": "cleared_by1",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6aabe989-0daa-4bf0-9e65-7503c39cfaba",
                                "id": "d918b292-8d34-4323-9d8c-5e66dabe9a5b",
                                "name": "created_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2478b834-e020-4bca-8dc1-0b05e9fcaef7",
                                "id": "5b3e4659-1737-4d7b-8a10-68973cb475cb",
                                "name": "paid_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a63660d2-68f9-411e-a92b-967f20ef45b3",
                                "id": "e0aba0fc-64a1-4051-9796-bfce71179d47",
                                "name": "buy_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0be2b998-2b87-4a8d-9179-dbe2ff32578f",
                                "id": "047876e1-2fbd-4ace-ab44-e3a0b7a6ce69",
                                "name": "buy_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "565f2df9-e118-4557-a7b2-7ba9927968ac",
                                "id": "47cddfa2-6713-4bdd-9371-979adda6d818",
                                "name": "buy_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "15f6bd4a-46f0-4508-b94d-35d2a5c86ca2",
                                "id": "10c8d3a0-4d7b-4807-85c3-d4240ac68784",
                                "name": "buy_fee_amount_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7559464-ebbf-49bd-9f22-7fc4eac17ab4",
                                "id": "cf1930f8-a976-4734-980e-06f143e28c6d",
                                "name": "sell_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0142d7f4-f2bf-4894-91b8-d43792678d89",
                                "id": "976940cf-7fac-473f-a171-7d195bd6ab3e",
                                "name": "sell_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "042ff667-8278-45bc-a17a-d9eaaf878790",
                                "id": "b3b96059-d2bb-4343-abd3-844330fafba7",
                                "name": "sell_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e705b0fb-75ba-4578-b0a9-ea86e943b3e2",
                                "id": "9b37481f-c079-4aa0-a135-8ece6d471e12",
                                "name": "sell_fee_amount_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0a04883-2161-453c-b738-510f4a3be62f",
                                "id": "8f7ff728-b118-4ad4-b5d5-5ad124f6f9ae",
                                "name": "buy_amount_usd_no_fees",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a2124ec-1d5d-4b7d-80f7-1dfb636a7832",
                                "id": "f58ee7df-9709-49f2-9f11-8e88536b0d11",
                                "name": "sell_amount_usd_no_fees",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0302bdc8-a384-43ae-86aa-f4f30beb5e36",
                                "id": "2d082b0c-bb8b-41aa-af99-f786a985c5fe",
                                "name": "buy_amount_curr_no_fees",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c2686901-6492-4f5b-bc93-1a01b38b4f17",
                                "id": "b81ff602-348e-4720-ba31-8edaaaa56673",
                                "name": "sell_amount_curr_no_fees",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "092c33d9-4b94-4ec3-87a3-35ee8f5ca653",
                                "id": "b66ad654-5fa4-41c3-a72f-df1419bf67b2",
                                "name": "completed_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bbd6898d-ff7f-4677-a288-ea121959e403",
                                "id": "b8412097-4f6f-4a91-84ee-dfd2c9c8283b",
                                "name": "diff_exc_CRM",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd1188f1-3157-42bc-a186-61e34ba26234",
                                "id": "dbd09ecf-9faf-4867-82ea-b2076bc9af95",
                                "name": "deposit_diff_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3848a102-3bce-4a50-b122-f1fb7c430de1",
                                "id": "affe25c2-1159-40fa-9b1a-ca9be64faac8",
                                "name": "withdrawal_diff_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6c00ce0-8f46-4af6-9cc4-813f8e851552",
                                "id": "77cffabb-504b-4735-b991-0fa2ea058e3d",
                                "name": "is_check_deposit",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18ab5e07-66f7-4f5c-b772-1cb3456ef2f4",
                                "id": "45edf200-b00b-4de1-9807-13b0c3b6b9d5",
                                "name": "is_check_withdrawal",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "66eea74b-822a-4ba5-9f77-85926f859636",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "6641348d-8e5c-44a4-add3-42ebf568baba",
            "fullname": "MySql:a332ec25-8e03-46a6-94cc-b855626e5807",
            "type": "extract",
            "name": "a332ec25-8e03-46a6-94cc-b855626e5807",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "05ee9d32-feee-4d7c-90d8-6d090e5e3827",
                        "id": "tq_4SeuDrQdB",
                        "name": "Wondercoins_customers",
                        "type": "base",
                        "schemaName": "wonder_coins",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c2ca998e-de74-4b76-81b5-ec2f03631989",
                                "id": "payment_solution",
                                "name": "payment_solution",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f52ddcd4-7f99-4570-bfb9-d80e94b17872",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0f69b7b2-7dd6-46e2-8721-68242262d990",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9fb21db4-ea12-43d9-a8c9-7cb3a49e18b1",
                                "id": "first_name",
                                "name": "first_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e3af864-5a11-487a-932c-29909e526ae9",
                                "id": "last_name",
                                "name": "last_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "33c8d2f7-05d0-4454-a298-453650e4335c",
                                "id": "full_name",
                                "name": "full_name",
                                "type": 18,
                                "size": 511,
                                "precision": 511,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5740273-7f20-472c-8b6c-df0d13c8578c",
                                "id": "email",
                                "name": "email",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d562ec27-4c47-4be3-b74e-0257f5a84160",
                                "id": "country_code",
                                "name": "country_code",
                                "type": 18,
                                "size": 5,
                                "precision": 5,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f8c5f5b8-43db-4886-a541-11bc1e06b9d6",
                                "id": "verification_status",
                                "name": "verification_status",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b581038-eedd-4953-bb84-a6eee0c1d17b",
                                "id": "comment",
                                "name": "comment",
                                "type": 18,
                                "size": 16383,
                                "precision": 16383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a69bde1f-c065-41b7-858f-96ea95d8a673",
                                "id": "locale",
                                "name": "locale",
                                "type": 18,
                                "size": 4,
                                "precision": 4,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "73f8b9a1-2662-4846-9eb6-d8381bceb5eb",
                                "id": "label",
                                "name": "label",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9fd5e9c5-81b7-4a30-a1da-6bc5980917b5",
                                "id": "trader",
                                "name": "trader",
                                "type": 18,
                                "size": 536870911,
                                "precision": 536870911,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "23e471e1-6199-4d02-917c-a2d74c1dcf59",
                                "id": "reg_time",
                                "name": "reg_time",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "429bf7ec-79e8-49e7-9a0e-27a40fd35a54",
                                "id": "reg_time_key",
                                "name": "reg_time_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a5206f01-9102-4a53-8b4a-fd41e3cb032b",
                                "id": "updated_at",
                                "name": "updated_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b4cd23d2-da80-4b1d-b41b-7da02f051613",
                                "id": "first_deposit_date",
                                "name": "first_deposit_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1549f4a7-1c2e-4134-9e68-6f9cb27dc107",
                                "id": "ftd_ind",
                                "name": "ftd_ind",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5c195ff5-52e2-44a9-856c-9fd10cb9d9eb",
                                "id": "is_test",
                                "name": "is_test",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "653bde6d-2a2a-4b7f-9f38-09117b28533c",
                                "id": "customer_risk",
                                "name": "customer_risk",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5012cc97-6a30-45ac-b09a-277f1b3e3123",
                                "id": "country_name",
                                "name": "country_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7e2acd3e-5a7c-4c33-a1b0-446fa17bdb25",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9c31402a-ee26-4f55-b9fc-8f1079fb87a7",
                                "id": "counter",
                                "name": "counter",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "40ee66cf-de29-43e4-a3dc-eaad7eba74dc",
                                "id": "left_join",
                                "name": "left_join",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "71610890-ac49-4a3b-b72b-44e4f5e62783",
                                "id": "verification_required",
                                "name": "verification_required",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9a015e5c-d97c-4c6d-b439-95ca9dc30e6b",
                                "id": "verification_match",
                                "name": "verification_match",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c549bc30-34af-4cc3-b31b-fb1da3d861ba",
                                "id": "verification_match_edited",
                                "name": "verification_match_edited",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "bad8cb75-3990-4249-9c28-327168765239",
                        "configOptions": {
                            "importQuery": "select  \n'WonderCoins' as payment_solution,\nusers.id as customer_id,\nconcat(105,10000,users.id) as customer_key,\nusers.first_name,\nusers.last_name,\nCONCAT(users.first_name,' ',users.last_name) as full_name,\nusers.email,\nusers.country_code,\nCOALESCE(statuses.name,'null') as verification_status,\nusers.note as comment,\nusers.locale,\ncase \nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 111 then 'serbia'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 222 then 'n/a'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 333 then 'tlv'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 444 then 'israel_ib_tur'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 555 then 'n/a'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 666 then 'prime_ot'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 777 then 'israel_ib_tur'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 888 then 'Radix' \nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as unsigned) = 999 then 'serbia' \nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as char) = 'F111' then 'serbia_con'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as char) = 'F222' then 'n/a'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as char) = 'F333' then 'tlv_con'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as char) = 'F444' then 'israel_ib_tur_con'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as char) = 'F555' then 'n/a'\nwhen cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as char) = 'F666' then 'prime_ot_con'\nelse cast(REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') as char)\nend\nas label,\ntrader,\nusers.created_at as reg_time,\nyear(users.created_at)*10000 + month(users.created_at)*100 + day(users.created_at) as reg_time_key,\nusers.updated_at,\nftd_deposit.ftd_date as first_deposit_date,\nftd_deposit.is_ftd as ftd_ind,\ncase when REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','')='test' then 1 else 0 end as is_test,\nbuyers.client_risk as customer_risk,\nbuyers.country as country_name,\ncurrencies.name as currency,\n1 as counter,\n0 as left_join,\nJSON_EXTRACT(buyers.meta, \"$.verification_required\") as verification_required,\nJSON_EXTRACT(buyers.meta, \"$.verification_match\") as verification_match,\nREPLACE(JSON_EXTRACT(buyers.meta, \"$.verification_match\"),'\"','') as verification_match_edited\nfrom users\nleft join statuses on statuses.id = users.status_id\nleft join buyers on buyers.user_id = users.id\nleft join currencies on buyers.currency_id = currencies.id\nleft join (\nSELECT user_id, min(created_at) as ftd_date, 1 as is_ftd from transactions where transactions.transaction_type = 'buy' and  status_id in (25,46,60) group by 1\n) ftd_deposit on ftd_deposit.user_id = users.id\n "
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a603e7fa70ed002ca32bca",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLTFnsgDrlu3M9YJWuk07vfLemoDdp7lwFaPnf+4/nQhNwf10B0h0ZNGPG6rVmf/rY0V0OIlUnsBOPPaD1DzBwPKDYEpOUIfDmlnk02OreMAPM3mMAHs8gAAaxGsOHLXi0SamsIy8KVZHfpiiF5FAuWLfZ6AK1m9Am6RCsT/Y+fmmqP8JXFuDka38fmVcAoGYyJsns/SEXn8CVfzNgFVJazVRt4OVycsr+zSJzSpc4EkjsdetvMieB6MQDIsRIMKDrg==",
                "schema": "wonder_coins",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "69c8791a-bc37-4ffd-a1a3-1e14408371c3",
            "fullname": "MySql:81c808f1-655c-4a46-85f9-925fae7805fe",
            "type": "extract",
            "name": "81c808f1-655c-4a46-85f9-925fae7805fe",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "e6ad316a-4985-4c6c-b430-f9a0cd578fa7",
                        "id": "tq_n4pYNJ49M",
                        "name": "GeniusIG_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "397c3990-e7a4-4798-8317-21e51a06015a",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "249308bc-eca2-44fa-aa93-6b0e82701532",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ecd80d6-d5af-4450-80c4-0f68bfa31452",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab5f6d49-6451-432f-8050-03a23e8b82e8",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c539a0a-0262-4579-99c6-871741713d13",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1eb82373-a21b-456b-9b7a-2feef464c978",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "13190685-d4e7-4b95-8c89-768272fca236",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a053af76-74e2-4436-9086-4ea8f38eeb93",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7b2173f-be85-45d1-9a79-b41f5973d29a",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e9bc1cac-7570-4d9b-91c3-72de5782a0e8",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6f46ef1-d4b3-4006-9cd8-ba546880da05",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "624a0811-cd98-4aef-8783-885bceda638e",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bf04878-1803-4264-94c1-0fc488a35ced",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb90ca03-16ea-4f88-927a-607324f091f8",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4f3de8a3-a610-49d3-b251-e354b6b77684",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1049eb8-0419-4327-b3c4-2abdba85fd66",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "452737b9-cc3a-4c44-b19e-808331e86d56",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7333e99-82a9-4840-8da8-dc56b8833824",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3301788-ab64-432e-a245-bfb724b08545",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b88b7bc-dce1-470b-964b-11cebcf21078",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2946561b-7356-40d8-a2d3-c7d15c18619c",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f7923039-38cd-4455-a943-b0b246ece4bc",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0e96208b-81e6-447d-b216-2daf167ef1ae",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "79bb5313-bb21-4737-8237-780bcea483bb",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f91b286e-55fa-4343-afbd-49a8bd62d9f0",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e4af9c8-69aa-432d-a1cc-1ecb973c748b",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8f0a8ce-8d3f-4ace-9caa-f53e1d670796",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70cd7c58-d5a0-4261-9293-be75f98842cd",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "092dd119-bf02-4a41-8a79-b0426f796470",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName, \r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,70,78) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,70,78) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,70,78) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,70,78) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32,70,78)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32,70,78)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,70,78) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,70,78) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,70,78) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,70,78) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,32,70,78)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,32,70,78)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "618400ea2756ac002c5ecdb1",
                "provider": "MySql",
                "parameters": "1Ft2JRV7yHNuferxAuCwIP+8RrM36+I20zFv2mgjK5kaJVj0QLdE2Z5TZ5/FKnuoEh8mZQYqf/iiQ3p8apM8uCkM37LkFbGnRhmt2tYLFqO1gr0leFAbxvqr45h97aRL2uFXV6bnmXjrx+upQdOgFiG2n1XzowSr7ML18mjmQhnzqjq1V2FUQMfFFcLg11wwiXozn0iLcNZcjGmBoyCW6IdyK2k1UjDiKqlSqoJZSuzAb/GTm3+JvHrvJTMCSB28",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6a9dadd2-2bd8-4939-8188-22d91eed4009",
            "fullname": "MySql:MySql-6a9dadd2-2bd8-4939-8188-22d91eed4009",
            "type": "extract",
            "name": "MySql-6a9dadd2-2bd8-4939-8188-22d91eed4009",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "611875c18a56da002c364c2a",
                "provider": "MySql",
                "parameters": "qLOMtjhNsqBRLO44ms9jQvp1eZAFrTCimfVZcsJxjmA7ciFNEJJQiWRH11gjiL+sFpSKIsyXhY/iKkaaD4FXFL6czB0CGbzkCaBUw+ZXoqcNee235Svk4bYIKmOxmfPKvz/IKZSnvsxykz7VlQXl9sCIXqwArPxFie6FTw/8+52XMLXO7uFglHMTGaJKI92RhOHN+UoCe2DRjs2B+27H2w==",
                "schema": "TempTableQuerySchema",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "6ef5cb90-9c1c-403a-a081-e84f90ba93ec",
            "fullname": "MySql:MySql-6ef5cb90-9c1c-403a-a081-e84f90ba93ec",
            "type": "extract",
            "name": "MySql-6ef5cb90-9c1c-403a-a081-e84f90ba93ec",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b8706d75-6ca7-48ea-acd3-f647f3958123",
                        "id": "tq_H456M6xLO",
                        "name": "Ivy_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "f597ca1a-6d30-40e5-ac3c-d3b07ab834c9",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "70f880f9-ab91-494b-be15-d22bc772874d",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b36a456-e9d9-4ed2-8628-2974a3276ec1",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2407d4f4-d26a-40ca-97bd-794a1d1ca2bc",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e2467075-6ae5-4d7f-95a0-9ebd1e3a1aff",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0f029ffe-ca7f-43c7-9357-b744ff8a57f2",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2dd57fb0-7cf8-4419-8561-01899018c9f7",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6fcbc644-48b2-4f20-87c3-0dff6cc17ff9",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6facd365-b0b0-4810-9f72-72c7c18859a0",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8113f3c-9186-4fa9-a38d-ea00caede0d7",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c12a4ce5-e376-4eb4-97e4-426bd6915c3d",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5979a4c2-d54e-4d10-9ee0-f308efd93965",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c645f27c-0d25-4423-84f2-fe56a2c9a184",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c44bbf23-03c6-4909-9ac8-929195535441",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "86fce472-96d6-4a9d-b68d-2c7b29991204",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf027174-8c0d-4692-9b28-562f6b8502b7",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e655f8bf-94d8-4097-858a-829082177c77",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "26f981b4-41b9-4ec0-8d7b-e37446a2678d",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8f151a9e-4b1e-44d0-87b3-f854564f4ec1",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e3503526-cd3c-48fa-a9f9-51106351e67d",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "faa46e2d-fbc3-481a-9fab-2cda67c5a045",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9e50a327-0192-4dad-a410-3da5e3089642",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3026d59d-6ab9-453e-8bbc-5c33c4c5b12b",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "06257ade-f8de-403c-9e24-a2e195fae5dc",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "33b291c1-67b5-43ff-b96f-a2015be47dd3",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f25ae0d9-c7e8-4a4d-b858-af40e271daa4",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba15f81d-46a7-401c-8c1f-53995b376e53",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "17563d2b-9688-4d7c-8ef0-404a9b588a33",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "cfd269f5-9dad-4b4c-af28-2b6866f9e786",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName,\r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,208,325,478,511,664) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,208,325,478,511,664) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,208,325,478,511,664) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,208,325,478,511,664) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,208,325,478,511,664)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,208,325,478,511,664)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 274 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 274 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,208,325,478,511,664) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,208,325,478,511,664) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,208,325,478,511,664) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,208,325,478,511,664) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,208,325,478,511,664)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,208,325,478,511,664)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61791305d34347002cd7f518",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PfBTfFgWhoAKLWfULHGTnbxABNR0CRzhxoml8es9ZUiAoP3g27zBsTBhENM+dBsf62FQyEzHEvyCyA1AFqG0Wq82nAt5YxcjG5bUujZ6mLgw==",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "73543758-bd4f-47e5-b99e-74248943dff3",
            "fullname": "MySql:debcf1f3-5069-4f7f-af8e-d6db87121c7f",
            "type": "extract",
            "name": "debcf1f3-5069-4f7f-af8e-d6db87121c7f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4afce09f-429a-4936-bca5-5a02413371cf",
                        "id": "tq_OJHA03xIQ",
                        "name": "Chelsea_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "616a11c2-92ab-4b64-bf35-ff6f463f8b05",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27bb9aa6-f07c-4d3b-862f-e3fc997d8cd4",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "afcc3a1a-e493-421f-adf3-095f9e20c52a",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2da861ec-5666-483a-ad85-2215ab60a784",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "63cb60ea-5fdd-4ba1-8536-48b20445a404",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96c9be53-717f-4da8-8c80-88ad6cf45da5",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab31ed91-9cbc-40d8-8742-47e60ffa81ab",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "afd09c1c-254a-453a-b33e-3c10b92f42d1",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f43678b9-785c-4cb4-8ad1-b389db0bd89b",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9f20566a-bda9-4820-94ec-8cb383bd4a68",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "071bdbbe-e404-4e40-96b8-ebf1d590cef9",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91efaf87-bdba-4e9e-92d5-424766208e85",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8a141b44-bbff-4c9e-9fc2-a39036e6d598",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cae48fc-9c2f-4e0d-b213-778b0aa010e1",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "42ac0e84-a084-482e-9c8e-6ed0090decc2",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f3058672-9742-43b1-ad1a-71bdc897a475",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a8ea78b-bc45-440d-b059-2710f12b0419",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07467d70-82c9-499c-80c9-5c83f65cc6b2",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6e505636-686b-40f9-844a-1ee727437921",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8b958482-376c-4415-8ee4-689a42d5cffd",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "61e1fd6c-d630-4be1-9dc8-02d78c07938a",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3639b289-2be1-4d12-b0ee-d31e0eb972a9",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "321a473b-65e8-4d2d-ae50-ff5102b3e5ab",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "485e93f1-1c55-40f9-b2e6-43926619e92f",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0212a2b8-3059-45c0-b054-ee1951db988b",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "513b9baf-899a-4cd9-b507-28e44ebf1d26",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b6317e6c-9455-43a7-a0ad-bacd879d766c",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "09e50070-0213-43a2-a23b-3371a5b4cf0c",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "61d3a4c5-a40a-4036-ac4d-b4faa2d0e380",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName, \r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,32)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,32)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6179138fd34347002cd7f527",
                "provider": "MySql",
                "parameters": "BE4OxiDqsaVb+1ukLM/AG3kiM0mBmEnf5+RF0FNWdMvVMRLKEGHP7i8Jb4OVv7CAoJrH7a/nkykrGiit3FSG/m85DPOX2IUqB6qOs2clw5riXmxFSMuiF3F8MgrP3MH12R4ofvsfF/fYNHAGVdVhOGjYUgjhzKoG+h+ur0i61f2xq5hHO9UjwqjzFmrYrN8ntau9AUUkD/MC6QOashL2AjWRcvpvZbZikoelSn8/Tb4Qv8PiC23gjgUiJBr0/QAq",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "75e86edf-62d0-4ed5-bbed-c3a9e0f84849",
            "fullname": "custom-75e86edf-62d0-4ed5-bbed-c3a9e0f84849",
            "type": "custom",
            "name": "custom-75e86edf-62d0-4ed5-bbed-c3a9e0f84849",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "64e59b06-3379-47f4-bdff-b02fcfab4ca6",
                        "id": "counter",
                        "name": "counter",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "6da50f6c-9d81-4d70-a349-9023a7a17fc9",
                            "expression": "select transactions_crm.site_id, transactions_crm.tr_count,transactions_total.tr_count_all\nfrom\n(select site_id, count(*) as tr_count from Transactions_CRM group by site_id) transactions_crm\nleft join (select site_id, count(*) as tr_count_all from transactions_total group by site_id) transactions_total on transactions_crm.site_id = transactions_total.site_id"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "650a8e33-adec-4fda-a567-f12dba44b1f7",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d7a1f3fe-33db-4686-8ca3-56e019ac5a83",
                                "id": "tr_count",
                                "name": "tr_count",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ef479514-aa44-469e-8551-0606ff83aeae",
                                "id": "tr_count_all",
                                "name": "tr_count_all",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "3d4d744f-c09a-4a9b-adeb-11ab2d2fd751",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "775bbc28-5430-46f4-86ff-3fcef62d0ce1",
            "fullname": "custom-775bbc28-5430-46f4-86ff-3fcef62d0ce1",
            "type": "custom",
            "name": "custom-775bbc28-5430-46f4-86ff-3fcef62d0ce1",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0b1e63d6-f23f-4595-9689-b0f5fc34b45c",
                        "id": "New Custom Table",
                        "name": "Transactions_include_rates",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "9647c6ca-2d49-44ea-927b-15b9be45eb39",
                            "expression": "select \n[source_transactions].*, \ncase \nwhen [source_transactions].currency = 'USD' THEN 1 \nwhen [source_transactions].currency = 'AUD' and isnull([Tmp_rates].rate) AND isnull([Ratesa].rate) then 0.69 \nwhen [source_transactions].currency = 'EUR' and isnull([Tmp_rates].rate) AND isnull([Ratesa].rate) then 1.12\nwhen [source_transactions].currency = 'GBP' and isnull([Tmp_rates].rate) AND isnull([Ratesa].rate) then 1.25\nwhen [source_transactions].currency <> 'USD' and not isnull([Tmp_rates].rate) then [Tmp_rates].rate\nwhen [source_transactions].currency <> 'USD' and isnull([Tmp_rates].rate) then Ratesa.[rate]\nEND as rate\nfrom [source_transactions]\nleft join [Tmp_rates] on [Tmp_rates].symbol = [source_transactions].currency and [Tmp_rates].date_key = [source_transactions].created_at_key\nleft join [Tmp_rates] as Ratesa on getyear(adddays([source_transactions].created_at,-1)) * 10000 + getmonth(adddays([source_transactions].created_at,-1)) * 100 + getday(adddays([source_transactions].created_at,-1)) = Ratesa.[date_key] and [source_transactions].currency = Ratesa.[symbol]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b5c71034-cac4-4368-8f7d-f95f29dc8d80",
                                "id": "dc38995c-4dc2-4871-96b1-896db6031e8e",
                                "name": "payment_solution",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e7a8715-3e4b-48db-9525-1b77298c3332",
                                "id": "ee457e78-3032-4ed0-a047-a397d1a594ca",
                                "name": "customer_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a10a3c9-95e2-4452-8430-e8ef8b607e72",
                                "id": "a420434a-802c-4f38-81fb-61cc37932eba",
                                "name": "customer_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b2c2ddb3-d504-418c-883a-e7adaa6e8633",
                                "id": "417ad890-b63f-45fb-81b9-c9c1f8609532",
                                "name": "transaction_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cf79b44f-0c40-46f9-8431-b6f0f6a8c3d5",
                                "id": "ca0a5c99-ff69-4372-9e73-22fe049b8dbd",
                                "name": "currency",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b5730913-0b89-447a-9ff7-c94989bfdb73",
                                "id": "3939bfbd-2012-42a0-8049-9630ce3fed67",
                                "name": "crypto_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3305c94d-0ffd-400c-bec8-e10bde9930ca",
                                "id": "ff86d88e-97a4-4206-804e-385b38cc06e5",
                                "name": "curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "96033e17-11dc-45bf-a165-3771ca3bcee7",
                                "id": "15067883-8b7c-4729-9faa-21f39e673f76",
                                "name": "crypto_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e99cf84-c4d7-431e-a527-05d76ddf66c1",
                                "id": "e2c19a7a-6915-471f-bf61-b92baa027790",
                                "name": "crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7d952d5-b9d1-439a-8b48-2b62ffceb0b9",
                                "id": "b2eebbbd-4c3c-4593-9793-29883f24a2ad",
                                "name": "wallet",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01361be7-466b-4f3d-bded-b74b46f28bd0",
                                "id": "58e2f3dd-fe11-47b0-9a6f-aaf02df90d16",
                                "name": "transaction_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "800ec7e9-fbe4-46d2-b8f1-4b09a287dbf7",
                                "id": "2c42cbe0-ea84-438f-a4db-d93edaa11226",
                                "name": "payment_method",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4207ee2-5134-483f-be69-4fc5989f60db",
                                "id": "c9e13e04-7066-4445-bb11-fa6bb65bbc7b",
                                "name": "note",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bda8d92-6855-40fa-b5fa-55ed748f0b60",
                                "id": "00d225ec-bfc7-4979-b41b-972d7df9a410",
                                "name": "trader",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1cd855f0-7715-4990-9e69-1d4116b47a09",
                                "id": "e8cbd98f-70fa-4617-bdf7-b4e8b74be126",
                                "name": "created_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64fb1e3d-8c57-44f8-ad63-a5d71c8667af",
                                "id": "8a71cc76-c908-47e3-8bf1-1c102eece597",
                                "name": "updated_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7088829b-d1ef-411a-b8f1-02ce5fa843ca",
                                "id": "83f8c054-16cb-4812-bdbc-71576811cf11",
                                "name": "paid_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0e4a0de0-533c-411d-87cb-cb6a2aff9a6a",
                                "id": "8ad2abc7-4f25-4ead-b73a-4dee05870912",
                                "name": "diff_from_created_to_paid",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4da7912a-66bc-4ab2-a24c-deabf7bcb4b7",
                                "id": "0d2d5ca7-bbbe-4af5-852d-b729ed6af935",
                                "name": "buy_transaction_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "403361bd-c664-44e3-86bf-0f023e779c60",
                                "id": "85cf98dd-4a0d-4df7-be88-698bbc7b4724",
                                "name": "Order_number",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ed15d0e-395d-4c0e-8cb2-86387177d269",
                                "id": "2fdb40fa-da0f-42e5-888f-5e859b7eebf1",
                                "name": "status_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1bbd29cb-be2f-4b01-ad67-58fbd34ebd9e",
                                "id": "98f462db-3d94-4d8d-baad-14cec1a4d226",
                                "name": "transaction_status",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e4a31099-c928-4c00-8be8-599d6e196555",
                                "id": "a0fba6c5-3435-494a-b2c6-f5e55cf6371a",
                                "name": "status_description",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7e6f1f6-4ae8-45f3-9ff9-7130cd4b583f",
                                "id": "2adb5b2e-5b4b-4a2f-a94d-2f78649b3ccc",
                                "name": "payment_provider",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ddd0584e-8a20-4f7b-9bac-16b168921042",
                                "id": "969e8e9d-630e-4e63-857a-05c47f791d84",
                                "name": "Cleared_by",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d0e05418-4752-4bd9-a3e2-54047c7f9e05",
                                "id": "abaef861-ded9-48c4-ab71-bb164057fa01",
                                "name": "total_fee",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7aabb657-6478-42c5-a367-5b979895b221",
                                "id": "db07b4db-c71e-4eef-8812-a24d76703ce3",
                                "name": "buy_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "360bee69-2cf7-466d-9722-19dfe0e5fbc0",
                                "id": "618bc332-b092-4fe4-9e8a-808f5e75c532",
                                "name": "sell_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c37d21da-4e78-4568-8123-c5e35a921ab9",
                                "id": "4d318f8b-fb9b-497d-b911-5b98426be820",
                                "name": "buy_paid_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3adb941e-340b-43b4-bf32-00f29b13f855",
                                "id": "4d5c69ba-1f50-4e8a-9fa3-d00854f811f6",
                                "name": "sell_paid_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ca8eab00-68ed-4259-b286-093680620f35",
                                "id": "3fe6b9a5-8115-4ed6-8756-436a2f3b7df4",
                                "name": "buy_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a199300-155f-42c5-84a0-39bd0e3f3fee",
                                "id": "885002e8-8dba-4645-92a8-42ff5f5dfa01",
                                "name": "sell_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee157f0a-1427-420b-ab6b-074ff0da7c63",
                                "id": "ffe7120b-e8e3-42fc-ad05-6cbc0bfbed53",
                                "name": "buy_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58db564d-7f03-4a12-8947-9199b00f298f",
                                "id": "f3858fca-db76-4450-94c2-7c385f57e4aa",
                                "name": "sell_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7bba3620-52ff-4ab3-aa0f-e449fec53b12",
                                "id": "dcb25d1b-b9be-4d54-a805-75fa4e336e47",
                                "name": "chargeback_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "87b03964-ff5f-4db7-9466-aee741e3050a",
                                "id": "37344213-f646-43d6-af61-d88ed09b32e2",
                                "name": "refund_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a4a6054-103a-4fce-afa8-4e910b5db39b",
                                "id": "9b8fb80d-36b2-43e9-b822-e1e43d52bd30",
                                "name": "total_approved_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "928b105e-c90a-4a37-a3bd-6902cdcb46dd",
                                "id": "39dc4ef3-4e09-43df-8a7b-674abc54e8c0",
                                "name": "total_approved_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8c25415e-5558-45bc-ae4c-1da54f544aec",
                                "id": "fa5f0c27-d28a-4788-bb33-82f81fa0a5d4",
                                "name": "buy_paid_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "325d8b41-5360-4849-af95-f99cf343e976",
                                "id": "6c6e7ffe-5648-4c45-95d0-6f7847a34875",
                                "name": "sell_paid_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd609e5b-26c0-4d11-9603-2d48c5cc9c1d",
                                "id": "7f2d1b78-7cd6-49a8-8275-f399e278c977",
                                "name": "currency_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "36ac1077-9d6f-462b-a796-8f64f7cfa94a",
                                "id": "96f85e9f-cca5-4f45-8697-bca215724bdd",
                                "name": "crypto_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f18dca66-c3ef-401d-96c6-d2c53cacb300",
                                "id": "496e28f5-98e9-402c-862c-4957708afa7f",
                                "name": "buy_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6f90999b-0170-4375-a297-1882469bd6a8",
                                "id": "30ed74cc-6d79-4967-b035-370c8591fa2e",
                                "name": "Sell_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "00ed7e2a-555c-4006-baab-1eff0a4de709",
                                "id": "ba8a3d8c-63b8-4c61-a907-ac2f88acd363",
                                "name": "buy_paid_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d63bc731-02b9-46e8-835b-d062d4838ca1",
                                "id": "9c85991c-644a-43da-94d7-2750dd13c707",
                                "name": "Sell_paid_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2aae99cf-5cc7-4e0e-90ab-5ed3b561c143",
                                "id": "786d3b1d-de83-4700-882b-2bda6416fdeb",
                                "name": "buy_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "910f55f0-1095-49c7-9f5b-6acfdb92c149",
                                "id": "703e5b39-a9ea-4b2e-bbc1-f6aff07a6092",
                                "name": "Sell_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9959b543-d81d-48fe-9bcc-62e04290ea1a",
                                "id": "f99560ad-1bee-42f8-80d3-feb23ba589eb",
                                "name": "buy_paid_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4dd95f98-1eb2-4ba3-9ad5-e93dd57f1cf8",
                                "id": "4d0f2858-8139-4f98-83ad-ad2ab44d2ef1",
                                "name": "Sell_paid_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "706ef75c-2dab-4d10-9053-9b9ca5fe1e0d",
                                "id": "de4c9207-eed2-41b7-9094-4fc395b43924",
                                "name": "buy_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ea51a5a1-fb23-44a8-b5b9-9fbcabd9cae0",
                                "id": "2e561566-5b05-4975-9aa7-56ddbed0f64d",
                                "name": "Sell_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f136e271-8742-4080-a7c4-987f5ca7d485",
                                "id": "ecd89312-3474-43ea-bb4b-962084dd783c",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cc3dca09-1123-4085-823c-82a0aab2b58d",
                                "id": "0c3f6fa5-b3a8-4154-b35c-f4d9799c435c",
                                "name": "refund_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d5a2e821-0f63-4cd0-a8c1-6eae3e20344c",
                                "id": "0fe6276c-7de9-4981-8e8d-a0eac8c810cd",
                                "name": "total_approved_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7332bad0-dd40-48be-8897-f11e8a485843",
                                "id": "83cbc3e2-aaf5-4ca9-b356-1753e60f0256",
                                "name": "total_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1403dac-f3df-402e-b7aa-71f305d5766a",
                                "id": "4c6820bd-8ac5-4648-8aad-6f23710e182d",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "783f2d95-673f-4173-be02-a03a27e09935",
                                "id": "1c22cf25-cd4f-40e0-a9a3-10ecf69a1cdf",
                                "name": "is_deposit",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1b288131-4654-4019-8f76-de5470ece9e3",
                                "id": "27d4e121-5c28-45a0-ad97-e09babd8779a",
                                "name": "is_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02947958-f076-45ef-9fb0-e5dbbeb40729",
                                "id": "af08f2c0-8771-4da7-9558-07cd77631cbb",
                                "name": "label_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5aec19ec-d0f6-4b92-8034-d1ab84e55d23",
                                "id": "162559d8-b5d4-4a77-b42b-a60a2d4b81e8",
                                "name": "label",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5a62f958-e740-4ee7-9ad6-a89bfa9dac0a",
                                "id": "0867702e-7dcc-4632-93cf-fea48c431522",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a76751b-6005-4716-8d94-3ccd94b38b0e",
                                "id": "01b5bc0f-479f-4281-8af8-9445a121f937",
                                "name": "is_approved",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9982ccaf-ccde-4aa3-8111-a1ef6e0de8bc",
                                "id": "022b1737-f621-4798-9b9c-773a34c757e8",
                                "name": "decline_reason",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd7ce168-a246-472e-a9d3-f5459df4ee7e",
                                "id": "ceb4fc42-4a6a-497e-9799-e1862a382321",
                                "name": "completed_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ce72f837-64f5-4b7d-a524-5dc52e04c834",
                                "id": "d56a53d6-913c-4942-85e1-6ac0ab7e9ae1",
                                "name": "meta",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "abcd41de-002f-46ba-8cb8-a167433f2e5b",
                                "id": "73bd8e14-e712-446d-b698-c2ae09d23dfa",
                                "name": "buy_paid_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f756d73-3eb8-4080-88ec-be697ad293dc",
                                "id": "07131e7c-b4e6-49b6-a5a8-cddb49c8f58a",
                                "name": "Sell_paid_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a972be1a-59ca-4982-9416-28a175853c81",
                                "id": "7fa76618-35b6-4b70-b790-62d98f5bd160",
                                "name": "day_diff_from_created_to_paid",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8ce9c5d-19f5-4547-be5d-81af774e284a",
                                "id": "fd6bfd9e-8f36-4b9b-afab-c7d7a02e3917",
                                "name": "day_diff_from_created_to_completed",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fb800779-a080-402a-88de-6cbe3843c7df",
                                "id": "ee330463-72d3-402d-9493-654822b706f1",
                                "name": "day_diff_from_paid_to_completed",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a317592d-7293-4bcd-b0ef-d4efc3f139e8",
                                "id": "b2b018de-61fb-43b8-8d50-5205bfc06d93",
                                "name": "settelment_Date",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3736fed-93c6-4248-a25b-3d42b9aa7abb",
                                "id": "daff1c40-d4fe-4191-adb2-0b9c57052ff9",
                                "name": "refund_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4a7699f8-9d91-49a9-ad2e-d4fca23d8729",
                                "id": "2240f979-4bc6-4781-8364-a068df40b49d",
                                "name": "ftd_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "798fd5dd-d21f-43e7-a59e-6b8941ed94eb",
                                "id": "0ce462b4-2653-4151-8e73-6ff759db3a02",
                                "name": "day_from_refund_to_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "290f95cc-2456-47bf-8429-ec19221b99bf",
                                "id": "131f1797-fce8-407a-9905-33d55f2de854",
                                "name": "bitcoin_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eddea29b-db3c-473d-9285-c9bd90364e22",
                                "id": "d1c32fb8-cbed-42bd-bc36-551dd1d91e08",
                                "name": "bitcoin_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c89bb43d-03ac-49d4-bb0d-1fe917095413",
                                "id": "93a13911-9982-45b9-9c2d-8b0d8d77d3c8",
                                "name": "withdrawal_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8e8eed0f-491d-4f8e-88d1-a1c7358d7639",
                                "id": "9bd1ea72-bdb8-43f3-97ff-d7e0811bd98b",
                                "name": "tariff",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9b401fe-2fdc-406b-8142-3fa3d5c248dd",
                                "id": "29a4a444-4b93-4b23-86c9-6743ed87eb0b",
                                "name": "rate",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "fa5484bb-c45a-4d1c-8c98-76cd0b2a93f8",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "7a7690c7-7b7b-42a7-83e2-ca828e6dcb64",
            "fullname": "custom-7a7690c7-7b7b-42a7-83e2-ca828e6dcb64",
            "type": "custom",
            "name": "custom-7a7690c7-7b7b-42a7-83e2-ca828e6dcb64",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f983e089-1466-445f-95fb-113873b634de",
                        "id": "New Custom Table",
                        "name": "Transactions_Total_calculation",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "80be24b8-fef5-435a-bfa2-0dd370086937",
                            "expression": "select Transactions_CRM.*,\r\nTransactions.[Order_number],\r\nTransactions.[payment_solution],\r\nTransactions.[transaction_id],\r\nTransactions.[currency],\r\nTransactions.[amount_usd],\r\nTransactions.[crypto_amount],\r\nTransactions.[transaction_type],\r\nTransactions.[transaction_status],\r\ncase when isnull(Transactions.[payment_method]) then Transactions_CRM.[payment_method] else Transactions.[payment_method] end as payment_method,\r\ncase when isnull(Transactions.[Cleared_by]) then Transactions_CRM.[cleared_by] else Transactions.[Cleared_by] end as cleared_by,\r\nTransactions.[created_at],\r\nTransactions.[paid_at],\r\ncase when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_completed_amount_eur] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_amount_eur] else 0 end as buy_amount_usd,\r\ncase when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_curr_amount] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_amount_curr] else 0 end as buy_amount_curr,\r\ncase when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_completed_fee_amount_eur] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_fee_amount_eur] else 0 end as buy_fee_amount_usd,\r\ncase when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_fee_amount] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_fee_amount] else 0 end as buy_fee_amount_curr,\r\ncase when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[sell_completed_amount_eur]\r\n     when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_status] = 'Refunded' then Transactions.[refund_amount_eur]\r\n     else 0 end as sell_amount_usd,\r\ncase when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[sell_curr_amount]\r\n     when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_status] = 'Refunded' then Transactions.[refund_amount]\r\n     else 0 end as sell_amount_curr,\r\ncase when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[Sell_completed_fee_amount_eur]\r\n     else 0 end as sell_fee_amount_usd,\r\ncase when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[sell_fee_amount]\r\n     else 0 end as sell_fee_amount_curr,\r\n(case when is_cashback = 1 then 0 else case when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_completed_amount_eur] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_amount_eur] else 0 end - case when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_completed_fee_amount_eur] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_fee_amount_eur] else 0 end\r\nend) + case when is_cashback = 1 then case when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_completed_fee_amount_eur] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_fee_amount_eur] else 0 end else 0 end as buy_amount_usd_no_fees,\r\n(case when is_cashback = 1 then 0 else case when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[sell_completed_amount_eur]\r\n     when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_status] = 'Refunded' then Transactions.[refund_amount_eur]\r\n     else 0 end end - case when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[Sell_completed_fee_amount_eur]\r\n     else 0 end) + case when is_cashback = 1 then case when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[Sell_completed_fee_amount_eur]\r\n     else 0 end else 0 end as sell_amount_usd_no_fees,\r\n(case when is_cashback = 1 then 0 else case when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_curr_amount] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_amount_curr] else 0 end - case when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_fee_amount] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_fee_amount] else 0 end\r\nend) + case when is_cashback = 1 then case when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Completed' then Transactions.[buy_fee_amount] \r\n     when Transactions_CRM.[origin_type] = 1 and Transactions.[transaction_status] = 'Paid' then Transactions.[buy_paid_fee_amount] else 0 end else 0 end as buy_amount_curr_no_fees,\r\n(case when is_cashback = 1 then 0 else case when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[sell_curr_amount]\r\n     when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_status] = 'Refunded' then Transactions.[refund_amount]\r\n     else 0 end end - case when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[sell_fee_amount]\r\n     else 0 end) + case when is_cashback = 1 then case when Transactions_CRM.[origin_type] = 2 and Transactions.[transaction_type] = 'sell' then Transactions.[sell_fee_amount]\r\n     else 0 end else 0 end as sell_amount_curr_no_fees,\r\ntransactions.[completed_at],\r\nminutediff(transactions.[completed_at],Transactions_CRM.[created_at_crm]) as diff_exc_CRM\r\nfrom Transactions_CRM\r\nleft join Transactions on Transactions.[Order_number] = Transactions_CRM.[fixed_transaction_id]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b7bee46f-c408-4c81-b835-9e1d4e2ce1e5",
                                "id": "e071c9bc-ff30-4df4-afae-5f4938a557e1",
                                "name": "Email",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "04f7df4a-b493-4f21-96f5-8a936d4c20a2",
                                "id": "17c760b9-0d0f-4c46-b600-d7b66e277e06",
                                "name": "SiteName",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32a258e4-0bb4-4885-a406-b9c47c7f5839",
                                "id": "44df1556-6b17-40e5-92d7-23a02fabc2d9",
                                "name": "site_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c7cd2b67-4cb0-4e0b-81cf-441078101be0",
                                "id": "9a642047-56f7-4bf0-8fbe-18b3b562a7f2",
                                "name": "customer_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4168c0fb-39f7-45bc-b0f2-93f31ca20415",
                                "id": "5bf43b64-58f0-4cf7-8a98-7eccee62bd76",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "06093253-587d-435b-8767-a37886998365",
                                "id": "f08b8b27-8295-48e9-b05d-4fad4ca6b58a",
                                "name": "id",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "773443be-19cc-4167-81e6-77b48dc8a322",
                                "id": "bff0c415-596e-46cd-b786-b57482c370a0",
                                "name": "origin_type",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e27dcb6-28a4-4fa2-b6d6-03f18faf6278",
                                "id": "20d9a912-c311-4e0d-9a75-7eb58aa5fd96",
                                "name": "name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2edf8486-0613-4505-a471-c89f030e3d31",
                                "id": "193871dd-f8a6-4337-b24b-7ebd6c41f44d",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3daf8949-3fe7-4e7e-80dc-3fae173371c6",
                                "id": "18002e92-8c4a-44bc-bbc7-6b7af84dc5b6",
                                "name": "amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b16f782-9827-4086-9476-8537c6e8dced",
                                "id": "0e2d47a7-b647-4de7-8207-ede18562a2a0",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d041767c-8fda-49f5-88a2-75202c2526c1",
                                "id": "c252795c-7451-4ae1-bf76-5def0ec756f0",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4d66d47e-98c1-4845-9288-ebb36d1e890d",
                                "id": "ae26f4fb-4ed4-41e5-9353-b86eb843554c",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d51fb68f-af8f-48ec-946e-1c8695a6d0fb",
                                "id": "fc3e2687-f99e-4b85-b488-62817b66367a",
                                "name": "withdrawal_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6756200b-5419-4809-8ea0-73f507a9cfea",
                                "id": "1193ac85-def6-43f9-aadb-72820de9c7e7",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58821f77-c4a1-45e9-afda-d53e5afa644c",
                                "id": "65f72ef7-d871-4b44-8edf-ef661591104c",
                                "name": "net_deposit_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4651dd8-5753-45eb-9f1c-56d9a304c61d",
                                "id": "9f16b4a4-193a-4da2-935a-1185c399eefe",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "215d23da-19f9-4d56-a263-add4042c9489",
                                "id": "0b44f33a-e205-468e-8f90-87540e56bea9",
                                "name": "is_tech",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38785f3f-92c9-4e73-8269-eb6d4f034bbf",
                                "id": "29cb1af3-b9c6-4f81-be98-99bef1adb0ed",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e4f8f68-1498-4189-8811-39f08d7719e7",
                                "id": "8a4643ee-8c8f-457e-bd35-113d21510395",
                                "name": "payment_method",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c63e2312-e715-47ec-9bbe-e13da8629847",
                                "id": "ea9ce8e9-f439-4dc4-ab37-20fa9f21d945",
                                "name": "created_at_crm",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56d3e283-bcc4-49fe-9f26-cac9a0cf7b81",
                                "id": "b69611ab-b629-4763-8e13-fced16d3c41a",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b602c8eb-65e2-4af3-ac44-78e6ad9d9555",
                                "id": "77f28ba4-feda-48e1-91bd-a657e2b5b0c8",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "aa0c6990-5289-40d4-a9c5-0f9d89072d9d",
                                "id": "86e59122-02ca-46c4-bef1-4c03f82b9173",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e10346d-0431-43b6-8a76-df114ebb54fd",
                                "id": "9891d238-a62f-461e-a4e7-dce2cbed1c72",
                                "name": "withdrawal_amount_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8068dd2-bbe7-4bc1-96a4-dffebe14f90f",
                                "id": "dde56c48-4b74-4083-bbf9-05930e15fc9b",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2d34e607-ed1f-4dd1-8cc8-36292eff063a",
                                "id": "1eeaae31-d8c7-44ea-870c-24ca546fd6f8",
                                "name": "net_deposit_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ddfd4395-d38d-40fb-9bce-541e1a043c65",
                                "id": "52ebfcea-443b-4172-90e9-6eba31c1e249",
                                "name": "code",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3cb4692c-d1d7-427d-ae83-dff1c5bf46b5",
                                "id": "478977d0-1b6e-4a55-a452-3ac43ae93c0e",
                                "name": "Order_number",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de5a589c-da30-4822-852f-02434fb6be30",
                                "id": "c93108fd-7e97-4c9e-98b4-989efb5b11bc",
                                "name": "payment_solution",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6b098cf-d8ff-43c8-9a86-2121bc35db6f",
                                "id": "1d50d723-57ba-441a-91a8-320dd3224319",
                                "name": "transaction_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46e02f40-e23e-4821-a4f0-d8fcbe89b7a1",
                                "id": "7ead917d-e5ef-4904-bd28-6a1d693f911c",
                                "name": "currency",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5994b742-369f-4884-9c05-b5d61f3bbe3d",
                                "id": "528e7b34-be73-40f6-ad65-6e51889354b3",
                                "name": "amount_usd1",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5427633-8978-4bc7-95b5-2b9524766bf0",
                                "id": "1d3a44dc-1c24-450d-a68d-9b4a56c368b7",
                                "name": "crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "840f9311-1b0b-4c7e-8ee9-b79386ad1ea0",
                                "id": "aa106c73-351b-46f9-b156-39e550aab4f1",
                                "name": "transaction_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a89b8e7-c933-4e60-85bb-3327b3d7155e",
                                "id": "6fb4165d-a8e2-4026-a054-0a43be6b65eb",
                                "name": "transaction_status",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a28a35d0-e9aa-44cd-aaf4-6208bbb08583",
                                "id": "e7df2f6d-ffdd-42e3-8611-6e0869b21f90",
                                "name": "payment_method1",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c8452e8-341a-4953-8e56-e4f1c40d0727",
                                "id": "ae538f90-df12-48b8-bf57-9aba4af8fb4f",
                                "name": "cleared_by1",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3bb785d6-24e8-49a7-8fd7-abb1bd22c1e4",
                                "id": "bc4e1414-fdc1-46b2-b3e7-557e9b52622e",
                                "name": "created_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4abb9720-ecef-468e-9da2-22da959212c6",
                                "id": "76c98683-f3dc-4e92-927b-09b89ab5e09a",
                                "name": "paid_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ff09743-488f-4bb6-ad07-44d00f675cd1",
                                "id": "a2b62610-d9f1-4168-ae89-d5dc40ecf21e",
                                "name": "buy_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f0157b8e-0659-4b6a-99e5-5871aaead62c",
                                "id": "65211fc1-7d1b-465e-bbdc-05ae64d9bf0f",
                                "name": "buy_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f80ab089-67d8-45b4-941c-8827b18ec479",
                                "id": "01d9ff77-ef0c-4abd-bdb2-15b3c6046337",
                                "name": "buy_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f22ffec-a6b2-4a18-bdd5-b2abeca308e5",
                                "id": "2bed8a5e-dc38-4846-9e27-2a6c958825c5",
                                "name": "buy_fee_amount_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "005d3197-e2c8-4e90-9892-430dab6eb79e",
                                "id": "f56c877d-3815-4fdf-a4a3-48af93a15e58",
                                "name": "sell_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8cb6577d-e956-42d6-a0e0-a14d0b6a9ebb",
                                "id": "698ec229-e590-4fd1-9624-4fb39d1848e1",
                                "name": "sell_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2e3c715a-4c39-43ed-b1e7-9d063399b1ba",
                                "id": "241fb0c1-bebd-42c5-9152-3970d2078fbb",
                                "name": "sell_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6162b838-9dfe-497d-bd57-c99f956871ae",
                                "id": "39223b28-61e1-4b7e-a2a8-799427cdedea",
                                "name": "sell_fee_amount_curr",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bfe156c3-4fc5-40f6-8447-c49bedcf6dc2",
                                "id": "92747977-8834-48ed-a929-c83a6c8cf509",
                                "name": "buy_amount_usd_no_fees",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "be1a13e7-c4cf-401d-ad0f-43ef78080892",
                                "id": "00f8db11-7867-4134-a1bc-a21a7e5db4db",
                                "name": "sell_amount_usd_no_fees",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "012b5b41-f30c-4f48-bf0c-a3f84360c834",
                                "id": "e9255efe-100c-4a31-aa16-8d50f5d61fb5",
                                "name": "buy_amount_curr_no_fees",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e9b562fa-d4fe-465f-8392-8b4aded75098",
                                "id": "7a1ae454-5887-47a7-9a15-f6247c3a4b9e",
                                "name": "sell_amount_curr_no_fees",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "588fc2ed-7a96-4f7d-934f-db5eb244fe70",
                                "id": "257b006d-f86e-4748-a31e-9fb5170ca916",
                                "name": "completed_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b9c12c15-bdfc-4f09-8ea1-4a6ef22f405e",
                                "id": "368c7d03-20c9-4fa1-bee0-11f3f474cf39",
                                "name": "diff_exc_CRM",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "f50855fd-ae1f-452b-84e6-d81f2496284e",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "7c749deb-6b3a-4313-a2b1-1b14fd586c9f",
            "fullname": "custom-7c749deb-6b3a-4313-a2b1-1b14fd586c9f",
            "type": "custom",
            "name": "custom-7c749deb-6b3a-4313-a2b1-1b14fd586c9f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "be1f2a62-9326-4e49-aef7-8a003eb4ed44",
                        "id": "New Custom Table",
                        "name": "count_transactions",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "6847e99b-034a-46e4-961c-339ae885e59e",
                            "expression": "select\r\n1,\r\ncount(transaction_id)\r\nfrom [source_transactions]\r\nunion all\r\nselect\r\n2,\r\ncount(transaction_id)\r\nfrom [Transactions_include_rates]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e9a247cc-ccd5-48bb-a826-bd13df0f6c6c",
                                "id": "Column",
                                "name": "Column",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "64c5aa34-8201-4ad2-941c-d77d57b68bc0",
                                "id": "Column1",
                                "name": "Column1",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "a114402b-7e6d-4fe1-9528-3b5cac511bb7",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "7d68a047-300c-420e-82bf-efc99523cc08",
            "fullname": "MySql:93fd7ee6-c4d0-4792-8bbc-3b6db6feadf8",
            "type": "extract",
            "name": "93fd7ee6-c4d0-4792-8bbc-3b6db6feadf8",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "33c5f344-2f2d-4d50-a5d4-39f02b5be32e",
                        "id": "tq_YSSCAnWIU",
                        "name": "TheBPCA_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0f48fa7d-6c2f-4ed2-b88c-b6326835cc9e",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3b84199a-35d8-4068-89ed-3f01a662481c",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d466db67-98f1-4c73-b51f-e95a50f149bf",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08b3e768-9022-48bc-adc0-a5c664601174",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9d4f874d-f3bf-4429-9e14-9c58e5a481aa",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "254eb971-9aff-4222-99cb-998dcaa0bbd0",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "df7a026b-9359-4c9e-9879-b53b804886aa",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b88b837b-106a-44f1-87af-f310ccd6dbc7",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c541800-7355-43c3-8ac9-08fd1c4beeff",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cb425c4e-da3c-470e-8aaf-37dd3a2af579",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "517a4615-bc95-4e01-b095-f1895355e5e7",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4e998cc7-f937-4f3b-b626-c3dd3066e97e",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a25c12f-f879-4236-83c6-74047876d50d",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "66c9ab33-66ca-4ffc-8f7f-44951d8d967b",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cec3c6ed-fb7f-4ba2-be37-23270d96f8b7",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11d02e15-0865-4e34-bdcd-26b46a181169",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "582d917a-ebc9-4f31-a65f-9ba05a4a05bb",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f270ad24-07c6-4a94-8793-a5fb6b40f2d4",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e311492d-176a-4156-9fd1-8c97580f0262",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "146080b3-6ae2-4e08-a274-7e208a3a45b3",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "953ec530-048b-4371-873e-36337ef87b43",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d18022b3-aafa-4a82-8b7a-92d3d7a3f080",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "20b5ab42-a258-4552-84bb-01c2c2223f73",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a3ac5b90-51ab-43b7-9596-4d6874755d39",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1861833a-bef8-4ad8-9d68-31356df68dea",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3882bdd5-3807-4c14-bd96-eda3586e3f7b",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "02e71ee8-2090-4cfc-88cb-96ce35e21bee",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5333cb41-fa42-4067-bb75-bc7f526e214e",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3c39c811-37de-4378-9b5c-324ca9144b51",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,\n       brand.name as SiteName, \n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617913a9d34347002cd7f52a",
                "provider": "MySql",
                "parameters": "Li2FpOBZkuQVFHmglvVO3unF3cyE7uQhXYenrn6ytNP08dPSNopcrZhCPhIEZbJq3GHeZmZNPZrQfHZy7Mo7S3QwZl+lJvy8mcXjoPWADHn7fHD/TXsGlpkaRPNOQnFO1tEd5xDHMHRh7i0mnvMheVsy39u8/PLd+UW23hnoTWzeGuy1jl1t9vmXt8xw1uh0Lw271DKaGVhOc5Lst9nqXnRu5pPfVPjIho4oBLMYdZDsXAdGAFkgsULvW5O9Ut8l",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "88e0e233-6fb3-4161-9d47-d589f4998129",
            "fullname": "custom-88e0e233-6fb3-4161-9d47-d589f4998129",
            "type": "custom",
            "name": "custom-88e0e233-6fb3-4161-9d47-d589f4998129",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "f7fcb49f-6fe4-4c6a-b453-e3151b251a74",
                        "id": "Duplicate",
                        "name": "Duplicate",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "011448a5-5350-4ec4-a194-15c95577a67c",
                            "expression": "select count(customer_id) as customers, count(distinct(customer_key)) as customer_keys\nfrom [Customers]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "3e22b6aa-9f97-417f-a0e3-c1dd39cf04dd",
                                "id": "customers",
                                "name": "customers",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a8a6f1b9-8318-4ad0-a425-52592874c625",
                                "id": "customer_keys",
                                "name": "customer_keys",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "4bf5f09a-ada2-4fb4-8f69-58df015640c2",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "8c4f2258-d04f-4657-9eda-ee97c979bc7a",
            "fullname": "MySql:MySql-8c4f2258-d04f-4657-9eda-ee97c979bc7a",
            "type": "extract",
            "name": "MySql-8c4f2258-d04f-4657-9eda-ee97c979bc7a",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "092eb4f0-1dea-4a1c-be35-7224a971c53b",
                        "id": "tq_0svYNy6uM",
                        "name": "Wondercoins_transactions",
                        "type": "base",
                        "schemaName": "wonder_coins",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "e7ed29cd-facf-4d2a-875b-484ddc198047",
                                "id": "payment_solution",
                                "name": "payment_solution",
                                "type": 18,
                                "size": 11,
                                "precision": 11,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "558ad9a7-efc0-4830-bda7-b899152ac17e",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3f9731fc-cdbd-41fc-8e2f-c853d5e506fb",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 18,
                                "precision": 18,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f6de27f-f3f9-478c-9146-fa7f6e47ba46",
                                "id": "transaction_id",
                                "name": "transaction_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e22091f-9ca4-44b0-95cb-e578cd96046a",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3144f5eb-7cc5-4bf6-8200-07bc356c94b9",
                                "id": "crypto_name",
                                "name": "crypto_name",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a83ceab-5f42-4a5c-be6d-8a1136936f4f",
                                "id": "curr_amount",
                                "name": "curr_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "242ce394-61ea-4058-b5af-d64e1e7c3c5d",
                                "id": "crypto_id",
                                "name": "crypto_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "66b950ea-ba87-4ac6-b541-8ec6c4006eed",
                                "id": "crypto_amount",
                                "name": "crypto_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "36a9066c-c3ac-4cce-b795-10b269170ee4",
                                "id": "wallet",
                                "name": "wallet",
                                "type": 18,
                                "size": 16383,
                                "precision": 16383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "52a521b4-ff67-4910-b150-b2bd52a1645b",
                                "id": "transaction_type",
                                "name": "transaction_type",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a9cd048a-a371-484e-92f5-d2f620917f83",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a471008d-b2fd-404b-b06a-c60e775caf99",
                                "id": "note",
                                "name": "note",
                                "type": 18,
                                "size": 16383,
                                "precision": 16383,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "22eca7cb-9b72-424a-b09d-4c0af09f8ad9",
                                "id": "trader",
                                "name": "trader",
                                "type": 18,
                                "size": 536870911,
                                "precision": 536870911,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ae6d364c-0ec6-4162-ab6b-1157ca81be1d",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fd3a5665-2a30-463d-916d-b431c7273f1c",
                                "id": "updated_at",
                                "name": "updated_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8da8c593-f854-4f20-9d16-813460d9a1b7",
                                "id": "paid_at",
                                "name": "paid_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "56792afe-3e8b-4f39-a67d-886d2b9fc0e4",
                                "id": "diff_from_created_to_paid",
                                "name": "diff_from_created_to_paid",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "05575174-8515-47cb-baa6-8f3d23ac2bb2",
                                "id": "buy_transaction_id",
                                "name": "buy_transaction_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2fe246e6-8b05-41f9-9ac4-212a98632182",
                                "id": "Order_number",
                                "name": "Order_number",
                                "type": 18,
                                "size": 265,
                                "precision": 265,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "77c5f160-fd77-47dc-9c02-c4001a02cf3f",
                                "id": "status_id",
                                "name": "status_id",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d8215378-ebcc-4bf7-9719-a25dc4728621",
                                "id": "transaction_status",
                                "name": "transaction_status",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0f1faf1-d265-406b-b0e4-9c417050bedd",
                                "id": "status_description",
                                "name": "status_description",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26f18e87-c6e2-4071-861f-5218cacf152c",
                                "id": "payment_provider",
                                "name": "payment_provider",
                                "type": 18,
                                "size": 255,
                                "precision": 255,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5628ae2-7448-4f5b-93d2-79bc741260e1",
                                "id": "Cleared_by",
                                "name": "Cleared_by",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3d10271c-1a1f-482a-b224-8c4a35cf78b6",
                                "id": "total_fee",
                                "name": "total_fee",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "78d459ee-22ad-464e-af89-cdfb0edccfcf",
                                "id": "buy_fee_amount",
                                "name": "buy_fee_amount",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b5d524d-155b-4060-82bf-c86f287dd239",
                                "id": "sell_fee_amount",
                                "name": "sell_fee_amount",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4ad31c08-89c6-4fca-9adb-cf479941d2d4",
                                "id": "buy_paid_fee_amount",
                                "name": "buy_paid_fee_amount",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b49eb03d-d8e9-48bb-bef8-1b483f81e23d",
                                "id": "sell_paid_fee_amount",
                                "name": "sell_paid_fee_amount",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "96e76afa-bc65-49bb-b92b-72ff66ac1d35",
                                "id": "buy_curr_amount",
                                "name": "buy_curr_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "06bfbddc-9a1d-4dcc-b0cd-130b94427bed",
                                "id": "sell_curr_amount",
                                "name": "sell_curr_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c0781162-633a-4d85-880f-3902fcec0cbf",
                                "id": "buy_crypto_amount",
                                "name": "buy_crypto_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a482ea41-ed27-44bc-85e9-2201ff71b0b4",
                                "id": "sell_crypto_amount",
                                "name": "sell_crypto_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c10bc27d-3698-4635-b164-f6b003b1d0cd",
                                "id": "chargeback_amount",
                                "name": "chargeback_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9db1eaf3-2564-4799-ad1e-047c0d5d4d4c",
                                "id": "refund_amount",
                                "name": "refund_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1db08d33-c53e-400b-9361-4772dc3e4a2e",
                                "id": "total_approved_curr_amount",
                                "name": "total_approved_curr_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1005f0ca-cd0e-4ee2-b202-41997dd7a59f",
                                "id": "total_approved_crypto_amount",
                                "name": "total_approved_crypto_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "670c1a74-fa23-4ab8-bebd-92c576abd1a0",
                                "id": "buy_paid_crypto_amount",
                                "name": "buy_paid_crypto_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2bfd11a5-5d70-4ff2-a9d9-bc4d95328f14",
                                "id": "sell_paid_crypto_amount",
                                "name": "sell_paid_crypto_amount",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ea1fc388-2bbb-4968-9c4e-e50c7b84cde7",
                                "id": "currency_amount_curr",
                                "name": "currency_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3a506650-3041-40fb-8400-53483d06c706",
                                "id": "crypto_amount_curr",
                                "name": "crypto_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 8,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f348418e-af48-4c70-9312-f60b96efc0d7",
                                "id": "buy_fee_amount_usd",
                                "name": "buy_fee_amount_usd",
                                "type": 40,
                                "size": 20,
                                "precision": 20,
                                "scale": 3,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6b705930-4e8b-4c6d-a7bd-16f9518b56c5",
                                "id": "Sell_fee_amount_usd",
                                "name": "Sell_fee_amount_usd",
                                "type": 40,
                                "size": 20,
                                "precision": 20,
                                "scale": 3,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ed618f3-80cc-4f36-af9c-37a73e2e3690",
                                "id": "buy_paid_fee_amount_usd",
                                "name": "buy_paid_fee_amount_usd",
                                "type": 40,
                                "size": 20,
                                "precision": 20,
                                "scale": 3,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f12ace5f-d144-44a9-9f9e-7d99622af41e",
                                "id": "Sell_paid_fee_amount_usd",
                                "name": "Sell_paid_fee_amount_usd",
                                "type": 40,
                                "size": 20,
                                "precision": 20,
                                "scale": 3,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f6a4556c-a619-455f-a44c-cb7b8df24217",
                                "id": "buy_amount_usd",
                                "name": "buy_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b2d2bd1d-3b9c-4cd8-8d2a-b2547e0fdb46",
                                "id": "Sell_amount_usd",
                                "name": "Sell_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6698dd52-57a2-488b-841f-5120dfe80c93",
                                "id": "buy_paid_amount_usd",
                                "name": "buy_paid_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "af4a1ecd-2235-4b38-82c3-065a39101765",
                                "id": "Sell_paid_amount_usd",
                                "name": "Sell_paid_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f4378947-46d5-4543-becd-156d31e827d4",
                                "id": "buy_crypto_amount_usd",
                                "name": "buy_crypto_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 11,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9933e951-cca0-49e7-9cb0-a0243bdce7fb",
                                "id": "Sell_crypto_amount_usd",
                                "name": "Sell_crypto_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 11,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bdace3c0-4f03-4a5b-a9a8-a90ead904e3b",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "15d38f3e-de56-4e36-addd-73ff201d317d",
                                "id": "refund_amount_usd",
                                "name": "refund_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2be2106f-d519-4654-957f-0d97a26a972b",
                                "id": "total_approved_amount_usd",
                                "name": "total_approved_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1da6df12-74e8-4d49-99ed-fbc5f66fb692",
                                "id": "total_crypto_amount_usd",
                                "name": "total_crypto_amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 11,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7302d3ce-3319-4552-8eeb-c52f87590687",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 23,
                                "precision": 23,
                                "scale": 5,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c57bf99-608d-4b06-92ec-9ceb5ab94162",
                                "id": "is_deposit",
                                "name": "is_deposit",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "76a037a7-96ac-43c3-92aa-6a7de342cf8d",
                                "id": "is_ftd",
                                "name": "is_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d7d5e1da-842c-4c65-9be0-9bc6cab66d22",
                                "id": "label_id",
                                "name": "label_id",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "96109b3d-2d41-408f-98cd-8c4be5cbd230",
                                "id": "label",
                                "name": "label",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e0dd0e44-c7a6-4ada-a8be-9fff262fc8b9",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c367f1a8-b442-458d-9e61-65d509bfe06c",
                                "id": "is_approved",
                                "name": "is_approved",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fb02597b-c023-4693-b76d-8ca19d2bff74",
                                "id": "decline_reason",
                                "name": "decline_reason",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "07b6fda4-fcaf-4f81-a7a0-001a3e8a74d2",
                                "id": "completed_at",
                                "name": "completed_at",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1e7635ca-a938-4f29-8178-01d0223a318b",
                                "id": "meta",
                                "name": "meta",
                                "type": 18,
                                "size": 536870911,
                                "precision": 536870911,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b866f8a2-c71e-4805-a617-0d596b71f146",
                                "id": "buy_paid_amount_curr",
                                "name": "buy_paid_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92adc267-bf00-4487-8bff-08345d5a1031",
                                "id": "Sell_paid_amount_curr",
                                "name": "Sell_paid_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 2,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30d69bfa-c088-4b54-b5a5-2e0dd7a4b121",
                                "id": "day_diff_from_created_to_paid",
                                "name": "day_diff_from_created_to_paid",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ab5fe2a7-4fae-43e2-9792-553c3baaf04d",
                                "id": "day_diff_from_created_to_completed",
                                "name": "day_diff_from_created_to_completed",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "85129379-288b-416b-96a9-6b5e5cd9e411",
                                "id": "day_diff_from_paid_to_completed",
                                "name": "day_diff_from_paid_to_completed",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0931e5a9-6c82-4da0-9930-dec3426d2f9d",
                                "id": "settelment_Date",
                                "name": "settelment_Date",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68b36085-de0c-4af8-9a43-d2c8740ddd10",
                                "id": "refund_date",
                                "name": "refund_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b10f3d83-28ce-4112-b6e4-3a97463107cc",
                                "id": "ftd_date",
                                "name": "ftd_date",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f6d5e0d8-1137-43b6-99f6-60c721ca868e",
                                "id": "day_from_refund_to_ftd",
                                "name": "day_from_refund_to_ftd",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9f2295d3-503a-45ed-90ba-85e2d04ece6e",
                                "id": "bitcoin_id",
                                "name": "bitcoin_id",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ba7c3363-cffe-48bf-a4a3-26324af91990",
                                "id": "bitcoin_amount",
                                "name": "bitcoin_amount",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6315432b-792a-44ed-b7e6-a8e0f38bf330",
                                "id": "withdrawal_id",
                                "name": "withdrawal_id",
                                "type": 18,
                                "size": 4194304,
                                "precision": 4194304,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d9402178-c20d-4c00-a720-41b4a246a7f4",
                                "id": "tariff",
                                "name": "tariff",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5d8e49e9-a217-4429-8111-37afd389462b",
                                "id": "addition5",
                                "name": "addition5",
                                "type": -1,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4305e78-f06d-410b-bbc8-f76740f434d3",
                                "id": "addition6",
                                "name": "addition6",
                                "type": -1,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38b51e77-5e93-4841-9728-f2642fc3bc9c",
                                "id": "addition7",
                                "name": "addition7",
                                "type": -1,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [
                            {
                                "arguments": {
                                    "column": "5d8e49e9-a217-4429-8111-37afd389462b"
                                },
                                "type": "dont-import"
                            },
                            {
                                "arguments": {
                                    "column": "d4305e78-f06d-410b-bbc8-f76740f434d3"
                                },
                                "type": "dont-import"
                            },
                            {
                                "arguments": {
                                    "column": "38b51e77-5e93-4841-9728-f2642fc3bc9c"
                                },
                                "type": "dont-import"
                            }
                        ],
                        "hidden": true,
                        "vTag": "0ab5d079-da71-489f-b57d-5e037bb526e8",
                        "configOptions": {
                            "importQuery": "select \r\n'WonderCoins' as payment_solution,\r\ntransactions.user_id as customer_id,\r\nconcat(105,10000,transactions.user_id) as customer_key,\r\ntransactions.id as transaction_id,\r\ncurrencies.name as currency,\r\ncryptos.name as crypto_name,\r\ntransactions.currency_amount as curr_amount,\r\ntransactions.crypto_id as crypto_id,\r\ntransactions.crypto_amount as crypto_amount,\r\ntransactions.wallet as wallet,\r\ntransactions.transaction_type as transaction_type,\r\ntransactions.payment_method as payment_method,\r\ntransactions.note as note,\r\ntransactions.trader as trader,\r\ntransactions.created_at as created_at,\r\ntransactions.updated_at as updated_at,\r\ntransactions.paid_at as paid_at,\r\ndatediff(transactions.paid_at,transactions.created_at) as diff_from_created_to_paid,\r\ntransactions.buy_transaction_id as buy_transaction_id,\r\nconcat(transactions.prefix,transactions.id) as Order_number,\r\ntransactions.status_id as status_id,\r\ncoalesce(statuses.name,'null') as transaction_status,\r\ncoalesce(statuses.description,'null') as status_description,\r\ncoalesce(payments.`type`,'null') as payment_provider,\r\ncoalesce(JSON_EXTRACT(response, \"$.descriptor\"),'null') as Cleared_by,\r\nCOALESCE(JSON_EXTRACT(transactions.meta, \"$.total_fee\"),0) as total_fee,\r\nCOALESCE(case when transactions.transaction_type = 'buy' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") else 0 end,0)*1 as buy_fee_amount,\r\nABS(COALESCE(case when transactions.transaction_type = 'sell' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") else 0 end,0)*1) as sell_fee_amount,\r\nCOALESCE(case when transactions.transaction_type = 'buy' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") else 0 end,0)*1 as buy_paid_fee_amount,\r\nABS(COALESCE(case when transactions.transaction_type = 'sell' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") else 0 end,0)*1) as sell_paid_fee_amount,\r\ncase when transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.currency_amount else 0 end as buy_curr_amount,\r\ncase when transactions.transaction_type = 'sell' and transactions.status_id in (60) then transactions.currency_amount else 0 end as sell_curr_amount,\r\ncase when transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.crypto_amount else 0 end as buy_crypto_amount,\r\ncase when transactions.transaction_type = 'sell' and transactions.status_id in (60) then transactions.crypto_amount else 0 end as sell_crypto_amount,\r\ncase when transactions.transaction_type = 'chargeback' and transactions.status_id in (63) then transactions.currency_amount else 0 end as chargeback_amount,\r\ncase when transactions.status_id in (46) then transactions.currency_amount else 0 end as refund_amount,\r\ncase when transactions.status_id in (25,60) then transactions.currency_amount else 0 end as total_approved_curr_amount,\r\ncase when transactions.status_id in (25,60) then transactions.crypto_amount else 0 end as total_approved_crypto_amount,\r\ncase when transactions.transaction_type = 'buy' and transactions.status_id in (25) then transactions.crypto_amount else 0 end as buy_paid_crypto_amount,\r\ncase when transactions.transaction_type = 'sell' and transactions.status_id in (25) then transactions.crypto_amount else 0 end as sell_paid_crypto_amount,\r\ntransactions.currency_amount as currency_amount_curr,\r\ntransactions.crypto_amount as crypto_amount_curr, \r\nCOALESCE(case \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1\r\nelse 0\r\nend,0)*1  as buy_fee_amount_usd,\r\nABS(COALESCE(case \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1\r\nelse 0\r\nend,0)*1) as Sell_fee_amount_usd,\r\nCOALESCE(case \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'buy' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'buy' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'buy' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'buy' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1\r\nelse 0\r\nend,0)*1 as buy_paid_fee_amount_usd,\r\nCOALESCE(case \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'Sell' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'Sell' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'Sell' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'Sell' and transactions.status_id in (25) then JSON_EXTRACT(transactions.meta, \"$.total_fee\") * 1\r\nelse 0\r\nend,0)*1 as Sell_paid_fee_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.currency_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.currency_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.currency_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.currency_amount * 1\r\nelse 0\r\nend as buy_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then transactions.currency_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then transactions.currency_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then transactions.currency_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then transactions.currency_amount * 1\r\nelse 0\r\nend as Sell_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'buy' and transactions.status_id in (25) then transactions.currency_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'buy' and transactions.status_id in (25) then transactions.currency_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'buy' and transactions.status_id in (25) then transactions.currency_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'buy' and transactions.status_id in (25) then transactions.currency_amount * 1\r\nelse 0\r\nend as buy_paid_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'Sell' and transactions.status_id in (25) then transactions.currency_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'Sell' and transactions.status_id in (25) then transactions.currency_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'Sell' and transactions.status_id in (25) then transactions.currency_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'Sell' and transactions.status_id in (25) then transactions.currency_amount * 1\r\nelse 0\r\nend as Sell_paid_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.crypto_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.crypto_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.crypto_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'buy' and transactions.status_id in (60) then transactions.crypto_amount * 1\r\nelse 0\r\nend as buy_crypto_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then transactions.crypto_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then transactions.crypto_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then transactions.crypto_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'Sell' and transactions.status_id in (60) then transactions.crypto_amount * 1\r\nelse 0\r\nend as Sell_crypto_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.transaction_type = 'chargeback' and transactions.status_id in (63) then transactions.currency_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.transaction_type = 'chargeback' and transactions.status_id in (63) then transactions.currency_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.transaction_type = 'chargeback' and transactions.status_id in (63) then transactions.currency_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.transaction_type = 'chargeback' and transactions.status_id in (63) then transactions.currency_amount * 1\r\nelse 0\r\nend as chargeback_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.status_id in (46) then transactions.currency_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.status_id in (46) then transactions.currency_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.status_id in (46) then transactions.currency_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.status_id in (46) then transactions.currency_amount * 1\r\nelse 0\r\nend as refund_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.status_id in (25,60) then transactions.currency_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.status_id in (25,60) then transactions.currency_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.status_id in (25,60) then transactions.currency_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.status_id in (25,60) then transactions.currency_amount * 1\r\nelse 0\r\nend as total_approved_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' and transactions.status_id in (25,60) then transactions.crypto_amount * 0.687\r\nwhen currencies.name = 'EUR' and transactions.status_id in (25,60) then transactions.crypto_amount * 1.109 \r\nwhen currencies.name = 'GBP' and transactions.status_id in (25,60) then transactions.crypto_amount * 1.299 \r\nwhen currencies.name = 'USD' and transactions.status_id in (25,60) then transactions.crypto_amount * 1\r\nelse 0\r\nend as total_crypto_amount_usd,\r\ncase \r\nwhen currencies.name = 'AUD' then transactions.currency_amount * 0.687\r\nwhen currencies.name = 'EUR' then transactions.currency_amount * 1.109 \r\nwhen currencies.name = 'GBP' then transactions.currency_amount * 1.299 \r\nwhen currencies.name = 'USD' then transactions.currency_amount * 1\r\nelse 0\r\nend as amount_usd,\r\ncase when transactions.status_id in (25,60) then 1 else 0 end as is_deposit,\r\nCOALESCE(ftd_deposit.is_ftd,0) as is_ftd,\r\nCOALESCE(JSON_EXTRACT(trader, \"$.label\"),'Direct') as label_id,\r\ncase \r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 111 then 'serbia'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 222 then 'n/a'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 333 then 'tlv'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 444 then 'israel_ib_tur'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 555 then 'n/a'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 666 then 'prime_ot'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 'F111' then 'serbia_con'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 'F222' then 'n/a'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 'F333' then 'tlv_con'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 'F444' then 'israel_ib_tur_con'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 'F555' then 'n/a'\r\nwhen REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','') = 'F666' then 'prime_ot_con'\r\nelse REPLACE(JSON_EXTRACT(trader, \"$.label\"),'\"','')\r\nend\r\nas label,\r\nyear(transactions.created_at)*10000 + month(transactions.created_at)*100 + day(transactions.created_at) as created_at_key,\r\ncase when transactions.status_id in (25,60) then 1 else 0 end as is_approved,\r\nCOALESCE(payments.decline_reason,'null') as decline_reason,\r\ncast(REPLACE(JSON_EXTRACT(transactions.meta, \"$.completed_at\"),'\"','') as datetime) as completed_at,\r\ntransactions.meta as meta,\r\ncase \r\nwhen transactions.transaction_type = 'buy' and transactions.status_id in (25) then transactions.currency_amount\r\nelse 0\r\nend as buy_paid_amount_curr,\r\ncase \r\nwhen transactions.transaction_type = 'Sell' and transactions.status_id in (25) then transactions.currency_amount\r\nelse 0\r\nend as Sell_paid_amount_curr,\r\nCOALESCE(datediff(transactions.paid_at,transactions.created_at),0) as day_diff_from_created_to_paid,\r\nCOALESCE(datediff(cast(REPLACE(JSON_EXTRACT(transactions.meta, \"$.completed_at\"),'\"','') as datetime),transactions.created_at),0) as day_diff_from_created_to_completed,\r\nCOALESCE(datediff(cast(REPLACE(JSON_EXTRACT(transactions.meta, \"$.completed_at\"),'\"','') as datetime),transactions.paid_at),0) as day_diff_from_paid_to_completed,\r\nJSON_EXTRACT(transactions.meta, \"$.settlement_date\") as settelment_Date,\r\nif(transactions.status_id=46,ifnull(cast(REPLACE(JSON_EXTRACT(transactions.meta, \"$.refunded_at\"),'\"','') as datetime),transactions.created_at),null) as refund_date,\r\nftd_date.ftd_date as ftd_date,\r\nif(transactions.status_id=46,ifnull(datediff(cast(REPLACE(JSON_EXTRACT(transactions.meta, \"$.refunded_at\"),'\"','') as datetime),ftd_date.ftd_date),COALESCE(datediff(transactions.created_at,ftd_date.ftd_date),0)),null) as day_from_refund_to_ftd,\r\ncast(replace(JSON_EXTRACT(JSON_EXTRACT(transactions.meta, \"$.bitstamp\"),\"$.id\"),'\"','') as Char) as bitcoin_id,\r\nreplace(JSON_EXTRACT(JSON_EXTRACT(transactions.meta, \"$.bitstamp\"),\"$.amount\"),'\"','')*1 as bitcoin_amount,\r\ncast(replace(JSON_EXTRACT(JSON_EXTRACT(transactions.meta, \"$.bitstamp_sendout \"),\"$.id\"),'\"','') as Char)  as withdrawal_id,\r\nCOALESCE(JSON_EXTRACT(transactions.meta, \"$.total_fee\"),0)/transactions.currency_amount as tariff,\r\nnull as addition5,\r\nnull as addition6,\r\nnull as addition7\r\nfrom transactions\r\nleft join statuses on statuses.id = transactions.status_id\r\nleft join \r\n(\r\nselect \r\npayments.transaction_id, \r\npayments.id, \r\npayments.`type`,\r\npayments.response,\r\nJSON_EXTRACT(response,\"$.error_message\") as decline_reason\r\nfrom payments \r\ninner join \r\n(\r\nselect transaction_id, max(id) as max_id\r\nfrom payments \r\ngroup by 1\r\n) payments_max_id on payments_max_id.max_id = payments.id)\r\npayments\r\non payments.transaction_id = transactions.id\r\nleft join cryptos on cryptos.id = transactions.crypto_id\r\nleft join currencies on currencies.id = transactions.currency_id\r\nleft join (SELECT user_id, min(created_at) as ftd_date, 1 as is_ftd from transactions where transactions.transaction_type = 'buy' and  status_id in (25,46,60) group by 1) ftd_deposit on ftd_deposit.user_id = transactions.user_id and ftd_deposit.ftd_date = transactions.created_at\r\nleft join (SELECT user_id, min(created_at) as ftd_date, 1 as is_ftd from transactions where transactions.transaction_type = 'buy' and  status_id in (25,46,60) group by 1) ftd_date on ftd_date.user_id = transactions.user_id\r\n"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61a604d7fa70ed002ca32bcc",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLTFnsgDrlu3M9YJWuk07vfLemoDdp7lwFaPnf+4/nQhNwf10B0h0ZNGPG6rVmf/rY0V0OIlUnsBOPPaD1DzBwPKDYEpOUIfDmlnk02OreMAPM3mMAHs8gAAaxGsOHLXi0SamsIy8KVZHfpiiF5FAuWLfZ6AK1m9Am6RCsT/Y+fmmqP8JXFuDka38fmVcAoGYyJsns/SEXn8CVfzNgFVJazVRt4OVycsr+zSJzSpc4EkjsdetvMieB6MQDIsRIMKDrg==",
                "schema": "wonder_coins",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "90418e38-d22b-4baf-b3b0-86d6d5bdcd68",
            "fullname": "MySql:95384b07-90c1-4501-92b7-4aa144229106",
            "type": "extract",
            "name": "95384b07-90c1-4501-92b7-4aa144229106",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4b106e71-3257-484a-9333-e05186086d43",
                        "id": "tq_gU8xpMF11",
                        "name": "NostraCapital_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8ea9a70b-b3d3-4cc4-b1f5-fd3b0718a378",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44781007-c6d1-43b7-a670-b083d016c31f",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56b6caab-502d-45d1-a3aa-bdbd245d23e1",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38efbe80-f5db-49ae-8069-bdd749f44575",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6b52c6e9-3a26-4c62-b2b9-1c121b5c3a7c",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64452093-296f-4167-ae0e-0fd059d97eb9",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "133f8c78-f785-4675-9d95-a0650199dee1",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "add4ec03-0e44-4511-ad30-73f9ba241802",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "563ab395-ad94-40c0-aaaf-1a21a530e318",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3fc6f6b-a899-44d2-a021-5a86c76c80b0",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f9b7fe1-8763-40b9-b4f6-8884953039d5",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "20ee458d-c8cb-419c-bde5-686eeaaa94a2",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8066664b-2c6a-488d-94f0-088f98b9cbd6",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "64336118-9261-4131-9c7d-945d51f2d0b2",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1e6cc1d5-3eb2-4e97-8f51-d6b6f9d8a70e",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "94116a4c-90f5-495a-9fb2-adff50d8c765",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d163b0a1-2f92-44fa-959f-061a7b8a8dee",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "907786d5-da25-4939-b967-fa8157575c14",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "736bf55d-12e5-4a13-b139-d27ce4157c14",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c93ef517-8dc3-4c1e-bdae-475d4688a583",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6c23487-a380-430b-820f-69420edccdbb",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1d719cf4-b8c8-485c-923e-f5e6a70fe45e",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7a214240-8661-4fc2-ac3c-b17f91d40399",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f11e324a-6e3e-4c1d-a57d-2f2e48304a81",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35d0a623-d266-436e-b5e6-131eadcc9235",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0420f441-e7be-4385-89ee-33342ace2485",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4212a2e-2377-4c02-b8a5-2424cdcd3b51",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3eaa8617-a759-412c-a889-bd3076494cdf",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "e3d63974-0307-4b64-afa9-3c7f52371a31",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,      \n       brand.name as SiteName, \n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617912ccd34347002cd7f515",
                "provider": "MySql",
                "parameters": "5zpNi1/ivLrPCYd3lQIeMwzQq5sAuc2YxZlngeeRz8hpTWd0H8LeepAHS57ZrJJbLGMhcYYJi5jTdTs58x9Ifb38GYxx5LABrwlbp4PgUKEopCjg+Bdl9PQiGCx8H7K7nWAdNIkesmJqig4SBGeNKtw1XDvwnBW3u/rrXgFKnw1iQo69EEWu7CqZHboIqgmOLsXk4QP+RQIQ0ffDKky9F0uishDV78kkCxoNl+Mfe8tBKYck/ulmOghb0RL9ZKCb",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "90ba44dd-7cac-4018-939f-70728729eca7",
            "fullname": "MySql:MySql-90ba44dd-7cac-4018-939f-70728729eca7",
            "type": "extract",
            "name": "MySql-90ba44dd-7cac-4018-939f-70728729eca7",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "8a4bd4a6-9f30-4654-a096-0df267f31b22",
                        "id": "tq_8eEmrZFQD",
                        "name": "Tmp_rates",
                        "type": "base",
                        "schemaName": "tmp",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "dc2767ac-a167-49cb-8124-fa553a1fb1ca",
                                "id": "symbol",
                                "name": "symbol",
                                "type": 18,
                                "size": 3,
                                "precision": 3,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ec6be89-d718-495a-9be0-0975bd02bfc6",
                                "id": "date",
                                "name": "date",
                                "type": 18,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "750b990e-ddca-4b65-8944-346b83343a51",
                                "id": "date_key",
                                "name": "date_key",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "73570088-9f55-4b00-8b87-84efa8777a8c",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c715c3b2-7eed-46d7-b1b8-4aeb1df651ce",
                                "id": "rate",
                                "name": "rate",
                                "type": 6,
                                "size": 22,
                                "precision": 22,
                                "scale": 31,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "81f58523-9ee6-4eec-b07e-dc3b71337b95",
                        "configOptions": {
                            "importQuery": "select\n\tright(\n\t\trates.symbol,\n\t\t3\n\t) as symbol,\n\trates.`date`,\n\tyear(\n\t\trates.`date`\n\t) * 10000 + month(\n\t\trates.`date`\n\t) * 100 + day(\n\t\trates.`date`\n\t) as date_key,\n\trates.id,\n\t1/exchange_rates.`mid` as rate\nfrom\n\t(\n\t\tselect\n\t\t\tsymbol,\n\t\t\tdate(eventTime) as date,\n\t\t\tmax( id ) as id\n\t\tfrom\n\t\t\ttmp.exchange_rates\n\t\twhere\n\t\t\tsymbol = 'eurusd'\n\t\t\tor symbol = 'eurgbp'\n\t\t\tor symbol = 'euraud'\n\t\tgroup by\n\t\t\t1,\n\t\t\t2\n\t) rates\ninner join exchange_rates on\n\trates.id = exchange_rates.id\nunion\nselect 'AUD','2020-12-25',20201225,0,0.6231189596405850\nunion\nselect 'GBP','2020-12-25',20201225,0,1.112532680647494\nunion\nselect 'USD','2020-12-25',20201225,0,0.8206811653672549\nunion \nselect 'AUD','2021-01-01',20210101,0,0.6298022420959818\nunion \nselect 'GBP','2021-01-01',20210101,0,1.1182680264805869\nunion \nselect 'USD','2021-01-01',20210101,0,0.8185583550251297"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "611875c28a56da002c364c41",
                "provider": "MySql",
                "parameters": "P5wPlHgOZTJiVsCA63LyByCMJt6C1jjhmakGoabej1wiyTpZeoFbyEDgxeCG2GE90UNwM/2NA/NMisgg5JywZJL7FoG5oR/s4/rhmZalcbw3r2qaFz+PSC6H1c5oQReFWBDAOIocgMvQpzy5sbsRM2P+HTa53lg5+fRMO52l1+sKuhufhU4irueTFK9XWTH+NX12s2Q7qgvu3q6jf59lV21xyk96Laws+Wk/Rh7IS7bh+eYf6IlMJCeO4l26L0Tb",
                "schema": "tmp",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9921338a-d77a-4529-89c2-2659c9ececd8",
            "fullname": "MySql:8f8ee70a-5405-4068-b5ee-1d3278ac9a25",
            "type": "extract",
            "name": "8f8ee70a-5405-4068-b5ee-1d3278ac9a25",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "1c11b9f1-7958-459f-90e4-79d925f1449c",
                        "id": "tq_9mY3FT65W",
                        "name": "365TradingFX_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "75e235f6-307c-4896-805b-5562d696e8e1",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8fe8264a-8ef7-45a2-83ee-6c534e0d9f86",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2305051e-dc65-4839-985a-101ea726e2e4",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4801193-4f70-48de-8177-a96532ad6773",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6c6b22fd-7c8d-43ec-9f5f-ea49bcbc41b5",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "27bee8a4-6f5f-4fe2-b03b-d3dd89be4667",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fad19eb9-f9c0-4a41-950e-1700291613dd",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "58b994ab-076e-4d7d-8645-3704bf091775",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b24f4dd2-7d7d-4dd7-a594-aa280ff426fa",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "65c5c914-c3f5-42e7-937d-f1936f710aa4",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4895b16-859a-4f77-b693-434979fae001",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8ce7337f-6da5-4949-851f-e2b085c29b71",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d634b299-1709-4d5d-aeba-d82443be83bb",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14480b04-c144-42ca-b1bb-d8044d90790f",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e225eb11-af8d-4bef-90e3-cfdf09b1ac48",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ebae8157-c813-4c9b-ba18-981c4c930f0f",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "50ed234f-279d-4060-8a23-2866bddd6ea6",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "dfbeccfe-f130-489d-a702-933a3e636f66",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3b35795-2ad1-4bc4-9e59-12b7d28af19b",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ad1eef0c-bde3-460a-ba5d-2c2d914c80fb",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1dafca8f-a04c-4055-8b81-f956d80afe80",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1793bc3-c489-4a68-80be-d4d35ebbfeab",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "066a1097-dca6-4dd9-96fd-5f1dbd8b1bfd",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4493854d-fc45-4756-9dd5-dbf2f5290ab1",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39d9eb6e-30d8-4823-af1a-8e89a66e1876",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d62b3b7a-272a-4e0b-8fc9-21d2e79c096f",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "866c41cc-ee98-4860-aeda-2ad552529135",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b572938-c9b8-470c-86bd-78ed3991ee62",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "ea29782f-d9fc-412d-ba91-3cdc35b1f3a9",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName, \r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,68,76) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,68,76) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,68,76) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,68,76) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32,68,76)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32,68,76)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,68,76) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,68,76) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,68,76) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,68,76) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,32,68,76)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,32,68,76)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617913cfd34347002cd7f52f",
                "provider": "MySql",
                "parameters": "WpjwuHhqzfDIdAFVxxbzsI0YjwvC+DbfC5SOQEIG9Hv/ov90B4e996K5jgUO+RnMIymf8vUv4ZkKAz3a9ZjFWfFx0Vo47BjpHtnTXLtkifQRqyaZfd4D6O1eqmErosIKNYe9BaLz/Dcd/UP9mDlqVceymGdLGHoVvU8f/jie8mwEQUF6aAirIkBFxSa+GAc1y/33qpuBkVC0lkCPxLhwxjFEew4CVf7nWq1YJkAA++dxReSWYPaOBwUZ1W5/aDZr",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9a29711f-5637-429f-9137-eba2e3f7b325",
            "fullname": "MySql:MySql-9a29711f-5637-429f-9137-eba2e3f7b325",
            "type": "extract",
            "name": "MySql-9a29711f-5637-429f-9137-eba2e3f7b325",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "71bfe7b4-e16c-409d-a5fb-149481d38be9",
                        "id": "tq_s4oMnE7SB",
                        "name": "MarketsCG_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "7540c063-4646-48de-8507-cd32c733723a",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e2f2c0ac-ff3e-45a4-b42c-1b622d2a4639",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "af82d9d6-3127-4ddf-885e-7eb144e58382",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8e33cab6-9627-4649-97b5-a326f435766e",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b247886c-36f0-426a-b5e4-4a49b40064d8",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bef99933-9423-4c4b-a063-3402bc753969",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "44bba56f-9218-4e7c-a659-37dacf40fb38",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "38ba46b9-cc23-4660-ab26-6b1fee158314",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4df1e007-ca12-4e7e-aece-4d5a4ae2925e",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4981460e-85a9-4ec8-ba79-a03bd59c0cbf",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6626df26-9972-4f66-a63f-ef4d09cbc3b0",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eb944cc2-c27c-418b-9254-c9e7c68ac786",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4e6441e1-18e5-43a5-9fcf-444bd92b98fc",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f334e168-9695-4ccc-95b0-f24ae60301e8",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "65bd535c-5109-4a8f-b540-ecf2dfe0321b",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9646e78e-8526-4bdd-a933-c8939781c3f6",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "15bd86d8-489d-48ba-a61d-bbd84b295475",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6740dcce-7295-4f91-a908-5dcd28958f7c",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "94e75b56-b4b7-4288-9f34-dbc06ec21163",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e425ea6c-8994-42bf-b1e8-823a3221cc78",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a10b7e04-f7b9-44af-8d9c-4e5685eaa9fa",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fb647c8b-b0e6-46dd-82eb-6b329f29445b",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "819be818-974a-4541-b858-b0dc60f8e8e6",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ef86a471-b5e6-4a6e-a743-6f1fa6ac1f27",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ca05a4b-c47f-4c0c-b632-999812eb44d6",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ee4674b0-f742-487b-842f-d11d92c66a8d",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "41092ca4-888d-48ef-a202-1924c1d476e2",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "af73f07e-3a41-47f8-90c8-8898ac7f52f6",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "bc934111-bcd7-4b11-a26f-af90bd8e91e7",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,\n       brand.name as SiteName,\n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t  case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id <> 24\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id <> 24\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617912e1d34347002cd7f516",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NAc1gMa0VBzZ9QDyN4mgrYY4RdbmC5kaicIuBKtyLx50isgKI42gk0NUhwNAOs/C+1ClXW3UC6yk8zdu2MLwnevpcBXSYS5lL8i4M0k06sUJIQFcjc1VnpGNQCbGzv+s0=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "9bd38923-da09-423b-a737-b7a4f77f0ff1",
            "fullname": "MySql:MySql-9bd38923-da09-423b-a737-b7a4f77f0ff1",
            "type": "extract",
            "name": "MySql-9bd38923-da09-423b-a737-b7a4f77f0ff1",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "dead0b2c-a5fc-4f5b-a802-ccddfb9d958b",
                        "id": "tq_sVcGaSKdX",
                        "name": "Aussie_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b01a69b1-2121-4948-994c-8e93e6131f85",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "215dc0d0-355d-4559-8920-c86ad5ee3e3c",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c08344f1-692f-4e16-a1d6-91038ac7b14c",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7f36f48b-d99c-4df5-be42-7f2262537cd7",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f44129ad-f0de-4f25-b38b-de5e41edd52c",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2fb9d583-96fb-4f40-b04b-20d1827eb690",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5fd1347a-3786-480b-94a2-74b399d7473d",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d745d40-4aa7-46a6-ac4f-f332a67d7372",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "26c899a8-5127-472a-a8b8-9e3fc5dc6bc5",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c6b0abef-fc2c-4e4e-b51a-7ff856f35fd9",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "783dad7f-df1b-4c12-ac1d-f6e30dfea184",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c0464557-c08c-4367-9af9-68043b2851dd",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c0121aaa-ea7e-4555-aeb8-96fbb10ef419",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "41afacac-f945-44ed-ba35-32a7d7987feb",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "89d3bf69-4d95-4b8c-978b-b3241eeb2aa3",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b3efe5ab-5d64-4952-9532-3397d0d76550",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b2dec8e1-a84d-4cc5-a69a-f69e56fdc3f3",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1355e495-0b6c-406c-9e87-410e71c8e874",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6ef5e1c9-d251-4446-bf14-efb4ee72409a",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9b87e8a9-99b8-4889-a4d6-2ff78720e690",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9cbe278b-6845-4b66-be9f-81fa0ef6288f",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1a6106f2-7981-4667-9cb5-9f6e48db91f5",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6800ab6e-af7d-4615-ade6-8256b83c53bd",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "866af1ba-85f9-4736-8fb7-b8e954183d53",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1523e7f1-000d-4bbc-bdaa-c3c18835e35e",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cb2bf1cd-c0fd-428a-bfb2-86f3bc7460e0",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "97d516b3-f27d-43f5-bf27-eb8326ade4b1",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "498cd085-3365-48d6-91b1-bc6be4fd18f0",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "7eea7271-6491-460b-b2c4-d05c43df33be",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,\n       brand.name as SiteName,\n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id <> 24\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id <> 24\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61791347d34347002cd7f51f",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PSVyCWrzmgxejQLgphqBGGnS4RlQfc6rnWYrrsovwY55O2i5tya3B3VkxOv2UtuuqX1lNJuB7IYatoh0t/jxtuUQhdNytgzcJoSc2JWipXmMspv4n3KwwH4cBbSuQcw7U=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "a0d00455-258c-4c0a-a1fc-47b337ad542f",
            "fullname": "MySql:MySql-a0d00455-258c-4c0a-a1fc-47b337ad542f",
            "type": "extract",
            "name": "MySql-a0d00455-258c-4c0a-a1fc-47b337ad542f",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "3b3a915f-7080-4a82-90d8-6202958fec0d",
                        "id": "tq_2n4Lfw4Xq",
                        "name": "Arrowteks_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "7e2f4424-d9d6-450d-9ba2-4b81518b4d15",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "695cf1d6-6e3a-451e-8bf5-651ba79f1110",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c3999570-0409-41e2-846f-15dbf1a68467",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "84dc797a-e8ac-4a25-94ec-b1b3acfbf1f1",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "457034f6-b54e-4be1-9abd-0159c08b582f",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9559cb41-fd7a-4a46-9da0-4b74441a314b",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4d887dc3-dd71-418f-ab69-acc19a845c0e",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b9e8f7ca-667c-4c1c-8011-dc2a523c0955",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f2ed702-b3b2-42dd-b1d0-d88175037a6a",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1dc42089-f117-460b-bf1b-dcb9e42fd8f4",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "80d49ccc-bb3d-454b-b46f-5d0c5a83ad6d",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "bf1ba4ce-221f-4726-a056-6c8570f0f0d4",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "490a18d0-4992-4031-9f2a-b2842a08f1e7",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "21ead46b-981e-4179-9436-c7584a7699e1",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ad2e5597-9dc7-4071-b053-5721d96b2e4b",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "93f2f09a-12fc-4d9e-bee6-4be1cfdaa43d",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "adabec0b-83e6-4ec8-9a2f-2f8083660ba1",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a4565e18-bbeb-494b-b960-5c63ee2f5072",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "927d12a8-338b-48b6-938c-490422537bf8",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b68189b5-c728-45c0-90e1-32ef1a3bbefb",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80f120d4-b54c-4a80-a63d-8a49c9c61abf",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3c8cd905-8084-4de0-b5a7-d0cb69fdf49c",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "201e0087-2e29-4351-96d6-7c877391e13c",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b13be217-a719-4342-b5b4-a5d53f5aa55f",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b86c35ab-2316-4655-88d1-1d89ee71e73c",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f9600b8e-dc8e-40cd-a0fc-c2b6d59df4c6",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "44b8b684-02a8-4622-80f0-fb46bc49ff19",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1e45b29-a68c-48ef-b216-bfbbaf2c913f",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "3df9d016-a0dd-4b10-b79f-040cac7b7530",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,\n       brand.name as SiteName,\n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32,65,73,107,115) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32,65,73,107,115) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32,65,73,107,115) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32,65,73,107,115) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32,65,73,107,115) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32,65,73,107,115) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32,65,73,107,115) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32,65,73,107,115) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id not in (24,32,65,73,107,115)\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id not in (24,32,65,73,107,115)\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617913ded34347002cd7f531",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8NmVm8t32iBvaxvRNv9kAo6ZZDQSAnerZZ1mcdus6f1dB3y6CYs90yDwvLLD2F/ZS5wkgvfBOkorkPD6wtNa5YmDvFh0JUTdzOqO9/PUqPw2Xnza14x3iHY/PxTB45AGAg=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ad714625-8452-41ea-aa32-c469b1d52d61",
            "fullname": "MySql:92ba3c02-bb09-4194-9abe-bfd834962d41",
            "type": "extract",
            "name": "92ba3c02-bb09-4194-9abe-bfd834962d41",
            "modelingTransformations": [],
            "schema": {
                "tables": []
            },
            "connection": {
                "id": "611875c28a56da002c364c4d",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8Mxo9b7CjxxLElv0FO2h9LDTvjVcFeSyvwpTQnO2qg5o1hQtBbI9Stp8zFr3ZUeKoheAP1kZvNi+4VpN1pRRv3kaD/RL2IIGntCq0mo/lZJkYw5sZYML0+enaqd6ElULbA=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": null,
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b23d0df8-6d9e-4921-8298-eddbf5dabb23",
            "fullname": "MySql:MySql-b23d0df8-6d9e-4921-8298-eddbf5dabb23",
            "type": "extract",
            "name": "MySql-b23d0df8-6d9e-4921-8298-eddbf5dabb23",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "0efb22c1-b292-4cc9-b6d2-c69fbbaa8567",
                        "id": "tq_WBYtY5Hdx",
                        "name": "InfinityCapitalg_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "c4f883a4-33b0-4537-8063-cd5aba3fd6a7",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7dc7a580-5f16-4d29-bfb6-10a391abde2e",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a29bcb17-4e6d-4f3a-9fe9-62a839fb410c",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0bff2b67-794e-4d10-a54c-baf133d0aaec",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "85ffcaa7-efb2-4519-bcdc-2c8191394477",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fedef886-29a1-40ae-ba11-3f6dae6177be",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "eef3eac8-35a5-48af-b49b-cc6154bbe2f0",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c0ae0b9c-2083-43b8-ad03-8178eb899053",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7b43d595-1435-4c80-b5d1-27932e7a0467",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2c0968e0-e33a-45a4-ba2b-bd733a90564e",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b54c69bd-6b08-44b9-a92a-c7907d1615c2",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "08d14c3f-56cb-492f-b3f1-cdc84da54dae",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b621d2bb-59a5-453e-8dec-be3138d532f5",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c2595777-d94c-4567-b4ed-c7e7de193542",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "86e3fbbf-f1ce-4ae9-be4a-e56a0a8c25a7",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f3684d36-ec06-467f-bfa9-b72f9aded73e",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8f645f4a-3820-4d75-b1fc-26fee402698c",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e2cc312-fc3b-481a-8830-9a0cfb044ff7",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "87bb24cc-0327-408f-8ea9-911669ee9efd",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c1c65962-bdf9-4422-a3ab-3433e7774f4e",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e047bfd7-9079-44fd-89f0-8974db16c130",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3484f7b6-27cc-4768-b3af-1d75bdd47f9c",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b6511436-131a-445f-beca-cb190ca9fe17",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5a71aea1-4a68-4b7b-a6ab-dcc3646fa199",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c1bfdc7f-5ff7-4689-9259-48f18ba4c8c5",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b0650ac3-ea9d-4c66-b966-a128bbb3e0f8",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d1a8e544-f4a7-416b-a9f9-c672b6afd219",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e7d11a55-a83b-4f73-be27-b6d4cce077f5",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "4fc104cd-c875-4654-8923-7841925187f7",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,\n       brand.name as SiteName, \n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6179133bd34347002cd7f51d",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8MfPoIiLJAA86EU1KY37Py81h/EK2Ljonxfecihivf7BxLCHtUgeQ9UBFJEZFjU+2XpMwz/mptpoLqEXrk0jrIG9j9xRQxExNkPAIjARac4gX0C5xlIk5c7nmPzjEEfl5g=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "b950838e-9202-49a8-885a-e342d25ee9d2",
            "fullname": "custom-b950838e-9202-49a8-885a-e342d25ee9d2",
            "type": "custom",
            "name": "custom-b950838e-9202-49a8-885a-e342d25ee9d2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "772ceceb-c29e-4695-89aa-8c9a38eb1a67",
                        "id": "New Custom Table",
                        "name": "Transactions",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "fe8007b7-2511-45d2-922d-455f81232505",
                            "expression": "select \r\n[Transactions_include_rates].*,\r\n[Transactions_include_rates].buy_fee_amount * rate as buy_completed_fee_amount_eur,\r\n[Transactions_include_rates].sell_fee_amount * rate as sell_completed_fee_amount_eur,\r\n[Transactions_include_rates].buy_paid_fee_amount * rate as buy_paid_fee_amount_eur,\r\n[Transactions_include_rates].sell_paid_fee_amount * rate as sell_paid_fee_amount_eur,\r\n[Transactions_include_rates].buy_curr_amount * rate as buy_completed_amount_eur,\r\n[Transactions_include_rates].sell_curr_amount * rate as sell_completed_amount_eur,\r\n[Transactions_include_rates].buy_crypto_amount * rate as buy_completed_crypto_amount_eur,\r\n[Transactions_include_rates].sell_crypto_amount * rate as sell_completed_crypto_amount_eur,\r\n[Transactions_include_rates].chargeback_amount * rate as chargeback_amount_eur,\r\n[Transactions_include_rates].refund_amount * rate as refund_amount_eur,\r\n[Transactions_include_rates].total_approved_curr_amount * rate as total_approved_amount_eur,\r\n[Transactions_include_rates].total_approved_crypto_amount * rate as total_approved_crypto_amount_eur,\r\n[Transactions_include_rates].buy_paid_crypto_amount * rate as buy_paid_crypto_amount_eur,\r\n[Transactions_include_rates].sell_paid_crypto_amount * rate as sell_paid_crypto_amount_eur,\r\n[Transactions_include_rates].currency_amount_curr * rate as currency_amount_eur,\r\n[Transactions_include_rates].crypto_amount_curr * rate as crypto_amount_eur,\r\n[Transactions_include_rates].buy_paid_amount_curr * rate as buy_paid_amount_eur,\r\n[Transactions_include_rates].Sell_paid_amount_curr * rate as Sell_paid_amount_eur,\r\n1 as counter,\r\nlookup([Customers],[first_deposit_date],[customer_key],[customer_key]) as First_deposit_date,\r\ndaydiff([Transactions_include_rates].[created_at],lookup([Customers],[first_deposit_date],[customer_key],[customer_key])) as days_from_ftd_to_transaction\r\nfrom [Transactions_include_rates]"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "46e12c88-a9f3-44ec-945a-bbace1594c07",
                                "id": "010b998b-c668-4ba9-bf7a-6dc910cbc0ce",
                                "name": "payment_solution",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "49512e84-7d7b-4eca-9f34-2b39d430a623",
                                "id": "3e84358e-6613-4ccc-9f6b-e2a32ea7d893",
                                "name": "customer_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c85f1f7c-250f-4d85-b5bc-0825edc0c4d3",
                                "id": "ba354b2b-6683-4383-9c30-92206d233bbe",
                                "name": "customer_key",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ca300be-48b0-4e86-a3cb-dda09398d897",
                                "id": "c269a7f9-e67f-4394-8149-a25ec1d1a043",
                                "name": "transaction_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "da93fb68-4286-4e50-8422-50fe1bf5a31a",
                                "id": "13713be1-340b-4277-8dd3-5a6e3e4b47d8",
                                "name": "currency",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ec79f9f-28b8-481f-a06c-6391db5e7293",
                                "id": "123df566-4f23-44a3-b144-e97a6ef996b4",
                                "name": "crypto_name",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "12575d59-4321-4a0b-a1b7-6ba4e3cfff86",
                                "id": "f4f07575-2e45-4e68-96fa-3411fce9a621",
                                "name": "curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2d66b65-8015-40b8-8c9d-89d668b96af5",
                                "id": "7f9208f3-2589-4e45-a771-6f10a1046c81",
                                "name": "crypto_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "78cfd3ae-ed5a-499b-b039-8e28583b9f88",
                                "id": "85804579-c127-4813-9a9d-04d23e3b499f",
                                "name": "crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "cd856039-41fb-40a1-afd7-f3d86b5da317",
                                "id": "f5220731-fe38-4f88-b7a7-1dec400e0478",
                                "name": "wallet",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "14fae282-ce4e-4513-af37-dab920a5a115",
                                "id": "8f62b3cb-361f-4390-a06c-7161a7508efe",
                                "name": "transaction_type",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c5981531-d7e9-4b49-9a79-375a056d6c30",
                                "id": "7ca3b14f-8c08-47cb-89d8-7e6d0bed8fff",
                                "name": "payment_method",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a2c4e6db-5f12-410f-a2f8-df39ebb59391",
                                "id": "059b8108-d74e-4e4a-bbd8-1e78941fccba",
                                "name": "note",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d08d60d4-8fd9-4964-84f8-1670a30f7ecf",
                                "id": "18638ebe-6715-4cd5-b1e0-71bb36057ce5",
                                "name": "trader",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "882f7846-4764-4ccc-96b5-94b823f72fa6",
                                "id": "5cbe37f6-0d8a-44f0-9df0-96c35a099739",
                                "name": "created_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6295f9e-7687-45c0-a356-bbccff1dc515",
                                "id": "deb4907a-0ea6-4a51-acb6-6c1d62ceaae8",
                                "name": "updated_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b0d7c61a-1ea0-40db-be8c-fba761826d65",
                                "id": "ad6827a3-5736-4c5e-ac93-e39530d6bd80",
                                "name": "paid_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "32aba6f2-1f12-4f2b-9e92-5b9e0df0173a",
                                "id": "273309c3-669d-4317-b8fd-0f49612df401",
                                "name": "diff_from_created_to_paid",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d144b7ec-a2ad-4ef7-9518-f731664f1c77",
                                "id": "79a75fd7-4037-4490-ba0e-5b7345ba1b06",
                                "name": "buy_transaction_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a6bc7f77-88bf-4365-ac48-4ca812e63b86",
                                "id": "9d27d05d-a22d-4803-8089-ef8116ca158d",
                                "name": "Order_number",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "812a24ce-6537-4024-ad69-e94367f01005",
                                "id": "9bfa4e08-c6c7-4516-91c8-2ff6c26dd1d0",
                                "name": "status_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ed888c31-3644-43ff-a3c3-9db7333dd247",
                                "id": "4ce5b368-8c95-41bb-9b91-9de74ec43758",
                                "name": "transaction_status",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fc3488b0-425c-42ac-b220-dc740dc536d6",
                                "id": "b00aab54-7e50-456e-ba5c-09ee39783829",
                                "name": "status_description",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f837bbca-002b-41fe-80a0-ca335e28f0a6",
                                "id": "7e93b0e6-06e5-461e-adda-85579359aba2",
                                "name": "payment_provider",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "35725cf4-c459-4d53-bd0e-82ce6afd73bb",
                                "id": "2eb8e24b-6591-4663-a621-9a67231f6f15",
                                "name": "Cleared_by",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "420cd1d2-c5cf-451b-8248-186ed5cd44e6",
                                "id": "0ec6c8b7-6dcf-4d21-a7fb-e69e0197ec2f",
                                "name": "total_fee",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9a486204-85b1-46d3-80be-45f1270f10ff",
                                "id": "8f9e70e5-df79-4714-8f57-122256afec16",
                                "name": "buy_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7c3dbeac-b8da-43cc-a825-9a00ed45fcbe",
                                "id": "7bd9dae1-8c6b-4733-bc1e-c39848a2b638",
                                "name": "sell_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "de8f1f9d-8ada-4ea4-b0fe-0b83e4dc685d",
                                "id": "d48f9e14-f7e7-4a40-a92e-04eb228b59da",
                                "name": "buy_paid_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "487a7cf9-f3fb-4a42-90cc-2bc721a83abf",
                                "id": "68f3d24b-0b41-4868-aed1-b173c7ed6fb8",
                                "name": "sell_paid_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "000c7abc-1047-4b90-bfa2-278bb09e2d59",
                                "id": "635589ae-de14-4b57-98b9-7db47566aeaa",
                                "name": "buy_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1ed26978-6d57-44d2-88d8-00ca1050a5f9",
                                "id": "ad0d58c7-bb2b-428c-8e03-447ad32f712f",
                                "name": "sell_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "951b003c-a4cf-4952-8b51-0ec72aca7052",
                                "id": "03df8ff0-c4c0-4d33-8c13-63ca60784817",
                                "name": "buy_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c82aa3a7-fb2f-44d9-a773-c16ef3e871d0",
                                "id": "ddfcfad2-8185-4ea6-98e5-e0954523803c",
                                "name": "sell_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "08d82ea9-3592-41ae-a605-8908ebe18b0a",
                                "id": "8dcc0648-9bd3-40f9-987c-9e228a7ba938",
                                "name": "chargeback_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc0be8f9-071d-45bf-8193-73029f5b494e",
                                "id": "410bc84e-9280-4e78-a475-876147ba5b8a",
                                "name": "refund_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "44c83a61-ca0f-4fdc-ad82-d4282c96c91d",
                                "id": "45d8898d-d7b1-488e-bc29-0e0c4dd30e46",
                                "name": "total_approved_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5fb1806c-2f8d-41c8-bd5a-02a8754d5fd5",
                                "id": "9953555b-88c5-42c7-98de-40070ac05cab",
                                "name": "total_approved_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "765ff04c-c62a-4f91-a309-ceb18878e9ce",
                                "id": "b82512ad-330a-4aef-978e-5d4ffe56f6ef",
                                "name": "buy_paid_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "211e79e6-89ad-48ac-adcc-9d569f385f2e",
                                "id": "188188c4-d320-4ba2-b555-fe3f2c5609a9",
                                "name": "sell_paid_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d140f174-6752-48b2-afa2-9ea32b7aacd7",
                                "id": "558930a9-6bf6-4c42-9970-6c604bff6a67",
                                "name": "currency_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "97365816-ae48-464b-a2fa-077950998e26",
                                "id": "ec7c2c3a-644e-42e8-a705-783dd4469618",
                                "name": "crypto_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8d16f8ea-c923-45cf-9188-ca68a6c707fd",
                                "id": "47d0db30-d6b5-4c03-83c6-04cb8f108b30",
                                "name": "buy_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "24ced8f8-b260-49eb-93e0-671785257d1c",
                                "id": "3ec5c260-9c80-4e34-b476-6fe7d346f506",
                                "name": "Sell_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7738e7d9-acb9-41e0-89ef-2a6881a8fb1e",
                                "id": "7a246d59-9ae9-4031-a520-9f284a92b1f7",
                                "name": "buy_paid_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b704115-65d6-4c6c-b4dd-cd68b6348f47",
                                "id": "ed9361ec-be93-4f36-9f80-f498856fb734",
                                "name": "Sell_paid_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "740892e7-fd37-468f-9e90-3a451d46d943",
                                "id": "c931f5a3-ebee-402d-95d0-f61452be309a",
                                "name": "buy_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc178456-534d-4bc5-9a42-9f67ccd5c878",
                                "id": "8953ae94-38ea-49f5-b68d-1eaee447f43a",
                                "name": "Sell_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56b972ab-c359-4878-ae44-7508aac0f802",
                                "id": "807102a7-2030-4b69-a432-e0360c8f3550",
                                "name": "buy_paid_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4067dc7c-f965-4a1a-9c3f-a162273b3e5f",
                                "id": "91045fc1-cef4-417d-b0cb-ef82a048f34b",
                                "name": "Sell_paid_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eeb026f8-321b-4470-ae91-5555cedb3930",
                                "id": "5a64a3f4-c32d-45fa-b97e-45b0f644be96",
                                "name": "buy_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1a7a2a0f-71f9-4efd-862a-c15c1faf2b48",
                                "id": "119cd3c0-9355-4189-a3a7-abd5a4654559",
                                "name": "Sell_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "80a3e203-6417-48c4-bb71-22a5449010b3",
                                "id": "518fd478-161a-43b8-9442-4af2e830dcd8",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e70274a-0164-4f38-bb15-bf580e0c5370",
                                "id": "5e545bcf-cca9-4bb9-814a-b9645eae3bbc",
                                "name": "refund_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9657a075-c19e-4d48-ba3c-3fa0f38da34e",
                                "id": "63e3cebe-404c-4397-87b5-aca59576dd6a",
                                "name": "total_approved_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "25aa5372-172d-492b-a3a8-21e8e1191a01",
                                "id": "9e9dedfb-c233-4d7d-88e3-96a8a24fcb29",
                                "name": "total_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a921bf8-b06a-4341-9a96-e32b6d35b969",
                                "id": "80f59884-1580-4291-9b90-f0cd683bbeeb",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e03b10b4-8166-4b97-8780-d3fc55eb5fcf",
                                "id": "bd8d7294-2159-4afa-a573-cb0d91f17ae2",
                                "name": "is_deposit",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b4c21513-3b4f-4ed4-a0ec-f2d5cfd72866",
                                "id": "b3e28274-49b7-4916-8a91-e283a6b4d426",
                                "name": "is_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "268c6c4b-ff6d-4764-b7b3-6c3e33b09789",
                                "id": "464956c4-6eea-4ffc-a562-88b151946d72",
                                "name": "label_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c4feed88-6eb3-4de1-a8f2-d3adf9271d42",
                                "id": "50f2d4e4-ecd9-4354-8507-5bf840635b5b",
                                "name": "label",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6276ba78-aba8-43da-9375-9ed7ba7df4e7",
                                "id": "bf494ceb-8f28-4580-9470-436a6ee54f7d",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc63e3ca-9784-4fa4-84e2-cfac285c3c71",
                                "id": "673da5b2-7ca9-4c49-8e07-903e096947cb",
                                "name": "is_approved",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3dba405-c3bf-4d7e-b3cd-25e3eaa3aa68",
                                "id": "0ee13b2a-bcdf-4e45-bcfc-41e09a9e46e7",
                                "name": "decline_reason",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "03571149-2b8e-4c38-8709-00da1c349d55",
                                "id": "23c35968-7393-44aa-a839-d4db672f792c",
                                "name": "completed_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "747ce77c-d593-4b81-92ba-9c3e4687f6c7",
                                "id": "6917093d-a868-4f7d-abd9-04c0e2de538f",
                                "name": "meta",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e124d95a-d911-4e19-abf2-20d9f0f2a2f7",
                                "id": "e366b522-bbd0-4271-b2d4-f0ef1fe607ea",
                                "name": "buy_paid_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6ffd763f-d6ef-4c37-9dca-e996ea191473",
                                "id": "038e6c9e-c08e-4b11-a5f3-9ac324904e14",
                                "name": "Sell_paid_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d9dfc6e5-ae80-4f61-9c96-4fdd558135b8",
                                "id": "1df6fa26-ee22-446f-8623-26604ec73479",
                                "name": "day_diff_from_created_to_paid",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e6b0545e-482b-4ce6-9525-985791848736",
                                "id": "209b4a32-7a95-4bf4-ba3c-2caf64c55b6d",
                                "name": "day_diff_from_created_to_completed",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f9588fb9-ce58-4479-b6d3-6c160918dd35",
                                "id": "b555e3ff-59c7-4dcb-8343-a4cc41d2d07d",
                                "name": "day_diff_from_paid_to_completed",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4c691ef4-e9f3-431f-a859-7513e80565c7",
                                "id": "536bc714-272e-48c2-a937-de34ee6e6525",
                                "name": "settelment_Date",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ec4fd90a-b961-4a41-8078-edbbab22c225",
                                "id": "c1b3d27f-00cc-4818-b2ca-59c6169a5ee7",
                                "name": "refund_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "870336d7-daec-4048-bd80-9e6dff19224d",
                                "id": "59eb1122-a2d0-4e8d-ad6b-89efef3cc617",
                                "name": "ftd_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a9b46da-56d1-4df3-a2b2-45f16e2f53fb",
                                "id": "29b124f4-036a-4f2b-be38-f33b9f40be20",
                                "name": "day_from_refund_to_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ac6469f-94a6-4f5b-b9b5-681224550f11",
                                "id": "9a8e348d-e133-473c-989c-b955c5488d38",
                                "name": "bitcoin_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a2dc548-09a5-4f64-9de8-920931693833",
                                "id": "a30e3f67-3f3c-4692-891f-50e90cbfed27",
                                "name": "bitcoin_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98e691b6-9904-4069-8ed7-35e80e556212",
                                "id": "44eceeba-3b21-41ca-b91b-cd471cd217db",
                                "name": "withdrawal_id",
                                "type": 18,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41555fb6-9dad-48fd-a11d-4bce19df2fe0",
                                "id": "cf3409bc-3319-4d5c-aab1-0bcfc4726e43",
                                "name": "tariff",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "337e2060-c7a8-49c9-8d17-c0dedae88317",
                                "id": "dddd9904-3299-4c4c-b425-317ad7eeb155",
                                "name": "rate",
                                "type": 5,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5ada57c6-aa10-444b-8243-23bccc110728",
                                "id": "6918d336-eac3-42b5-a2dc-aa54a2a99064",
                                "name": "buy_completed_fee_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "11b6f4aa-4db6-476c-aecc-522b1c5bea55",
                                "id": "fc6201b5-186f-4663-979a-346929b29a0b",
                                "name": "sell_completed_fee_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e7284ade-71e3-480c-aaad-87d954dce476",
                                "id": "475fce94-7950-4dfd-a587-c5c4ffbe4ab9",
                                "name": "buy_paid_fee_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3d5a0e29-e9bd-4fc5-9319-c7510f6699a5",
                                "id": "40b982fa-e53c-4f0e-8236-c07b1f96008c",
                                "name": "sell_paid_fee_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "48351890-92ea-40c8-8ed4-65b7cf8ce1f1",
                                "id": "ed64872b-90ea-42ed-acc5-20cf856fbbc4",
                                "name": "buy_completed_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d6b05f86-f19b-4089-a80d-700510fe1e58",
                                "id": "0e6274ee-496b-4bc0-8a5a-aa4c7db98073",
                                "name": "sell_completed_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7a0b0011-03d0-4fcd-b35e-f6a4b32e59b4",
                                "id": "b622cb4e-acfc-4e47-9236-41a29a823d4b",
                                "name": "buy_completed_crypto_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "17492609-8fee-4068-a367-51ed00923616",
                                "id": "14e48806-04ef-4a65-9364-57d1d60be9ff",
                                "name": "sell_completed_crypto_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9de254b7-a55c-42a8-87df-ec82582afd34",
                                "id": "2d21f9b6-dff6-4439-b4e7-0c5bc8c97154",
                                "name": "chargeback_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "702ec7bd-f892-4af5-b640-4dc3b5e5f689",
                                "id": "481e2292-f6f0-468f-9b6e-68135bb160b4",
                                "name": "refund_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1483924c-6f42-49fa-adbd-a7802e872fc2",
                                "id": "c972d597-4eee-498e-856d-04f580d27935",
                                "name": "total_approved_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f739db63-1125-4b26-be6d-f8183ea39447",
                                "id": "5fb8ca40-6fff-4992-ae62-f8245ff81c4c",
                                "name": "total_approved_crypto_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1001fc4e-142a-486b-b2ea-7356e6936311",
                                "id": "29237060-4197-443a-bb6d-591013fb0c58",
                                "name": "buy_paid_crypto_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38f5558c-8968-4630-bf84-0d6b4cf381ae",
                                "id": "cd47ec26-4793-4188-a617-5aa33b988695",
                                "name": "sell_paid_crypto_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc0346ac-c8a2-44c6-b29c-d750ac8a5769",
                                "id": "a53f637b-3a9e-4fe6-bd9f-8759981239f1",
                                "name": "currency_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eadf0329-aca9-4d5c-b102-aeca0e7405fe",
                                "id": "ab394af3-f251-42d3-b594-c435c2dad844",
                                "name": "crypto_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a18065b4-02b3-4c02-87bb-e2640ffee030",
                                "id": "e29bfdb3-bde6-4392-8c07-81f2a2842d54",
                                "name": "buy_paid_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e8a29c4-29ad-48f0-8eac-821e17555fd6",
                                "id": "bc8ae764-c748-49c9-a868-a89186ddadc6",
                                "name": "Sell_paid_amount_eur",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7ca8bf02-458f-4a4d-a330-292dcb05a0aa",
                                "id": "9c7505c4-ccda-4ab9-a0ca-a1724c7f94f8",
                                "name": "counter",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "556f54b6-e787-4e10-94e4-1c90520c7711",
                                "id": "22f37f1c-a81a-4071-aef4-89e67bb44210",
                                "name": "First_deposit_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d8c66fe0-cf02-460d-a1b4-9cb0508076cf",
                                "id": "e732644e-6678-423f-b611-09e9687982cb",
                                "name": "days_from_ftd_to_transaction",
                                "type": 6,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": false,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": false,
                        "vTag": "6994860a-da3d-4b05-a3e4-84e19ef24926",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "cc53b458-7d56-4707-ace3-99a31b91eb34",
            "fullname": "MySql:a86ac831-f4cb-4744-ad6b-1ca71eee58b2",
            "type": "extract",
            "name": "a86ac831-f4cb-4744-ad6b-1ca71eee58b2",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "4905e5a3-1fc2-4691-a35e-3f1c88edee4b",
                        "id": "tq_vwcCVPlFe",
                        "name": "BendigoCoins_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "477d0a14-99b3-4453-a3cd-bf79c2134f4f",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "950af840-4402-4a61-88a5-fa1d7363948b",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "99031e4e-2423-421e-be29-61cbddbc27ac",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ae1b19a0-ca0b-429a-ab5b-1a965d1786ed",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bcb6f3d6-40a9-4c41-9d10-e0b1b6c37360",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "91b99660-3906-46bc-a4c5-228614eb7536",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "39c92a69-d743-414e-934d-bbf808e80331",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19fa4142-f111-49a1-934e-356ba39fcec1",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5b2b9b0d-a006-436b-8668-c21d8cc6ecfc",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "8274e519-f52e-4c7e-a03f-a8a8d859aa4b",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b7377e47-e160-4122-a69d-a5bd81a09213",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9470ca69-6ee7-44ac-ab7f-6b68d7c7ca48",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2ff76bd5-afe9-4289-8c32-2cf258daf9a1",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9e5a5e9a-d90b-45a1-9a2e-932c1e5aebcd",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "342e8324-c65d-4157-81e4-612b0d673b38",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b891046-7323-40d6-bb20-f59c7af97195",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fe756620-5b73-4ae1-82e3-b21afbec9074",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b169615c-f697-4c79-a52d-7eeb63a2ef10",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2849cc1b-edbb-46d4-a123-bcb94b8ce782",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d85f7402-3bf3-457c-b696-21d691d13484",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1f2333dd-14ca-46e3-a7b6-7d926c94118c",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b55e9803-7b9e-477d-8029-b818a041c452",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0cc14f24-23bc-415e-98a8-34d1043ecc7a",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f4d1bc10-631d-4196-946c-bb23e4b1efdf",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5f0cbab9-80e8-44f9-83a2-f3cf0d6cef41",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a0be0b98-82f1-4c93-a895-76dd79facf27",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5e9b3db8-5c9b-492a-844a-b351f27e7bb6",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1fb0d9a-0a18-4e03-bdba-740dad99993c",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "81b2dfbd-12d7-465f-a383-17945c777d46",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,\n       brand.name as SiteName, \n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "6179137ed34347002cd7f525",
                "provider": "MySql",
                "parameters": "FhwKndxsEm4karcTRhcRhQ31JuodaLCOkLCPAL5UDyKQmplY4PGQirEicte+5XlO7CmeguqIciMcA3dWSPlLRdyZQQBa8rSl7481iBoEVleEKNnY0oZY59Uua0u3yiz/U5itDzyqwT3hV27JP+osZrKYLMelBUn+F7vnCn46CtacVjNzMfL/BmkfA2U0DhrLnI0aG8HaWhblMUs9PMPHSLPgZ1yWRCKlfMFEAtsVU51Jg4PyWiAT5+nvRZJBKlUf",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "dc41b7b6-4717-466c-bcc7-3a5072ed9262",
            "fullname": "custom-dc41b7b6-4717-466c-bcc7-3a5072ed9262",
            "type": "custom",
            "name": "custom-dc41b7b6-4717-466c-bcc7-3a5072ed9262",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "522cddf0-15be-42c4-a3dc-975a0721fa43",
                        "id": "New Custom Table",
                        "name": "source_transactions",
                        "type": "custom",
                        "schemaName": null,
                        "expression": {
                            "oid": "6ba829f7-6b94-4617-88fb-0d7c1944bb8f",
                            "expression": "select *\r\nfrom [Wondercoins_transactions]\r\n"
                        },
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "0a8d5208-412e-45a4-9ad6-9f2704962737",
                                "id": "payment_solution",
                                "name": "payment_solution",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f6b9d8d0-ac8b-4609-9172-4c66e3e4fec1",
                                "id": "8f375a93-74aa-447d-b97b-d0d89022ba35",
                                "name": "customer_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3514e1a9-bbbd-4b14-9dfb-8c36d4c3a637",
                                "id": "customer_key",
                                "name": "customer_key",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "715e1b5d-a905-4999-8668-89a09f4418a9",
                                "id": "1f1ef621-58ef-42e2-94fa-985f25b3f827",
                                "name": "transaction_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b38762f5-c94e-406b-997e-6f2d4fb9c791",
                                "id": "currency",
                                "name": "currency",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d2f86e81-3aea-494d-b70d-1c5c04aace6e",
                                "id": "crypto_name",
                                "name": "crypto_name",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0768aea3-fe49-40bd-a82a-67e7e490efcf",
                                "id": "curr_amount",
                                "name": "curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "23faa3c8-ec56-4509-84b9-5299560a8f2f",
                                "id": "4a4c2ea3-cef8-4b8c-93d7-5b3f7196d2ac",
                                "name": "crypto_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "651e1030-42c0-46f5-b64b-a6b5409e52b5",
                                "id": "crypto_amount",
                                "name": "crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7556d577-f07e-47fa-beff-95e1e9987f39",
                                "id": "wallet",
                                "name": "wallet",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7fa8a087-bec9-4bc5-b348-c49709abeefc",
                                "id": "transaction_type",
                                "name": "transaction_type",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "151fbe34-5ec7-4d1c-bbdb-e513e298e393",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3c670265-cd36-4445-8268-5599b1fb6dc1",
                                "id": "note",
                                "name": "note",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1778ee42-6ce7-4fd2-88e8-c15f481c3ff8",
                                "id": "trader",
                                "name": "trader",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab834b72-cc6c-4463-ad26-606f5d41d70e",
                                "id": "created_at",
                                "name": "created_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "fc77ca69-57c2-457c-92d7-36c5a96ec505",
                                "id": "updated_at",
                                "name": "updated_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a5da34f-2986-4f16-a7ab-2f41abe7b08a",
                                "id": "paid_at",
                                "name": "paid_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c3d3271c-ec44-49ef-a9b1-4b62d84c0a5c",
                                "id": "diff_from_created_to_paid",
                                "name": "diff_from_created_to_paid",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7aa41c19-9214-45cb-9ffe-7364f5745876",
                                "id": "0a2bcd7b-2263-4b33-b607-e6e3c3502e12",
                                "name": "buy_transaction_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a94da20-24c3-4eb3-a141-bd94c13b4b0e",
                                "id": "Order_number",
                                "name": "Order_number",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2b1851d5-113b-4631-93de-116ba2487e12",
                                "id": "094c0e44-39f9-45d7-8df2-5002ebac9cd6",
                                "name": "status_id",
                                "type": 8,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "2a4cbb57-d51d-4dce-bb6c-06fa692948fd",
                                "id": "transaction_status",
                                "name": "transaction_status",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0571d9a1-614b-49b3-91fb-7b8d56d8a79a",
                                "id": "status_description",
                                "name": "status_description",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d3342ecb-6ae2-481a-a2ee-16c61550b920",
                                "id": "payment_provider",
                                "name": "payment_provider",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5a453b56-1cd9-4342-b3b8-ea6fdd2e0a0e",
                                "id": "Cleared_by",
                                "name": "Cleared_by",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eb34c984-321c-488d-8232-4bc02fb7503a",
                                "id": "total_fee",
                                "name": "total_fee",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e1f2b7e4-0ec6-4b24-a5cc-412b03f6c8a1",
                                "id": "buy_fee_amount",
                                "name": "buy_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5e6539b3-1a13-4db0-acae-4fd282021d5c",
                                "id": "sell_fee_amount",
                                "name": "sell_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7885ca84-f1f5-4511-bb07-0d8920c3b600",
                                "id": "buy_paid_fee_amount",
                                "name": "buy_paid_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a94e6fc-d403-46ee-9a8d-1b15293eda1f",
                                "id": "sell_paid_fee_amount",
                                "name": "sell_paid_fee_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c1aea17-19a2-4570-b9cb-be63ed8b1cde",
                                "id": "buy_curr_amount",
                                "name": "buy_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "11f36460-e367-45ba-941c-e00ac4f2e0af",
                                "id": "sell_curr_amount",
                                "name": "sell_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "68901cc8-4312-43e8-b11a-ad7193f7e714",
                                "id": "buy_crypto_amount",
                                "name": "buy_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "dae23e1c-0749-4a5a-9b39-0e7032e983e0",
                                "id": "sell_crypto_amount",
                                "name": "sell_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2b83f5d5-e257-4292-b6b4-748b01853e5b",
                                "id": "chargeback_amount",
                                "name": "chargeback_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d63a568a-1d9b-4384-aea7-3286bfb3e77e",
                                "id": "refund_amount",
                                "name": "refund_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "25dbf200-fa49-4497-bf0b-b0820c8807c7",
                                "id": "total_approved_curr_amount",
                                "name": "total_approved_curr_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "98148577-0bf8-40c5-be84-85dd7ad529ee",
                                "id": "total_approved_crypto_amount",
                                "name": "total_approved_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ab296121-e050-4378-bfec-6740b76f1199",
                                "id": "buy_paid_crypto_amount",
                                "name": "buy_paid_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "45ace508-cf39-4e2d-b454-a3b0e6994e4b",
                                "id": "sell_paid_crypto_amount",
                                "name": "sell_paid_crypto_amount",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "863b8670-aa62-49d1-a335-7deab6027b42",
                                "id": "currency_amount_curr",
                                "name": "currency_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "10021fd8-2245-4369-a17d-dfec95d42e9e",
                                "id": "crypto_amount_curr",
                                "name": "crypto_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "590b5ba5-4155-49f0-ad4a-0c0f542024ae",
                                "id": "buy_fee_amount_usd",
                                "name": "buy_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b915d60-ca35-4dc7-bf0b-8ebf5939015e",
                                "id": "Sell_fee_amount_usd",
                                "name": "Sell_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "98aa4793-7fa0-41cc-a7f2-1e34356c3bc7",
                                "id": "buy_paid_fee_amount_usd",
                                "name": "buy_paid_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5ec78c16-5d1b-4e2b-a318-44f24cad0272",
                                "id": "Sell_paid_fee_amount_usd",
                                "name": "Sell_paid_fee_amount_usd",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "01ec86df-c9cb-461e-8a4a-0be33170d823",
                                "id": "buy_amount_usd",
                                "name": "buy_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "8b9aff2e-77be-47f9-8466-f08ff7e19aa8",
                                "id": "Sell_amount_usd",
                                "name": "Sell_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2705af57-2ab8-401b-92c5-2f9bb947ed38",
                                "id": "buy_paid_amount_usd",
                                "name": "buy_paid_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7b4ee566-2587-4e7f-a6f5-b07969625a5d",
                                "id": "Sell_paid_amount_usd",
                                "name": "Sell_paid_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5dfbf624-cf38-486e-b882-4c372bdec399",
                                "id": "buy_crypto_amount_usd",
                                "name": "buy_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "54e30c74-f102-4d58-90bc-ba5ae6a8f29b",
                                "id": "Sell_crypto_amount_usd",
                                "name": "Sell_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "da67da9b-8477-4be0-965b-88674fc49c05",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e8bccb80-4af9-4348-8517-b41198ea1847",
                                "id": "refund_amount_usd",
                                "name": "refund_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "99c9b43a-4acd-4e3c-a816-aa6255778c35",
                                "id": "total_approved_amount_usd",
                                "name": "total_approved_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1a4410b4-ec0c-46e7-bf11-cf623c60c065",
                                "id": "total_crypto_amount_usd",
                                "name": "total_crypto_amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "1b872639-57a3-406c-b9c0-69887c7d6847",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "552323f3-d31a-4694-9536-99d565e559d4",
                                "id": "is_deposit",
                                "name": "is_deposit",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e889fa9d-e93a-46aa-81ae-e3585d87c96f",
                                "id": "is_ftd",
                                "name": "is_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "9b793632-3aee-4935-bfea-418a13f46c74",
                                "id": "label_id",
                                "name": "label_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6a49cec9-f725-48a2-809a-ff324451608e",
                                "id": "label",
                                "name": "label",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d1078cb2-0639-46e1-a4f7-4a70e614dca7",
                                "id": "created_at_key",
                                "name": "created_at_key",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "30a7a699-9191-4955-877e-e777b6e9a1c4",
                                "id": "is_approved",
                                "name": "is_approved",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7b59f4d5-d3a4-40f2-9841-8cd1e9dc79cc",
                                "id": "decline_reason",
                                "name": "decline_reason",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0f3ba9cc-0ab4-4abc-ac92-5275f38e12c3",
                                "id": "completed_at",
                                "name": "completed_at",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2ac82b49-5e0a-4685-a1c8-f99b16e97e8c",
                                "id": "meta",
                                "name": "meta",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "19233617-ac8f-49e6-9ec7-9f23a89103f3",
                                "id": "buy_paid_amount_curr",
                                "name": "buy_paid_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ac7a70d7-4f11-4913-b7de-b7147b256ea7",
                                "id": "Sell_paid_amount_curr",
                                "name": "Sell_paid_amount_curr",
                                "type": 5,
                                "size": 0,
                                "precision": 16,
                                "scale": 16,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6790b685-7f45-4206-adcc-5905126c1200",
                                "id": "day_diff_from_created_to_paid",
                                "name": "day_diff_from_created_to_paid",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4396bf6d-91d3-4932-86fc-a1fa2509c3c9",
                                "id": "day_diff_from_created_to_completed",
                                "name": "day_diff_from_created_to_completed",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d374f2d-f7ca-4fa7-a670-24d6069c2148",
                                "id": "day_diff_from_paid_to_completed",
                                "name": "day_diff_from_paid_to_completed",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "4d9329c6-ed49-4b1b-a022-6de485114912",
                                "id": "settelment_Date",
                                "name": "settelment_Date",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bf359b2d-05f0-447e-b59c-748542e67445",
                                "id": "refund_date",
                                "name": "refund_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c146a110-8443-4948-965f-7c3bc63da903",
                                "id": "ftd_date",
                                "name": "ftd_date",
                                "type": 19,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c68408db-92fd-49a1-aa12-51eedf13a599",
                                "id": "day_from_refund_to_ftd",
                                "name": "day_from_refund_to_ftd",
                                "type": 0,
                                "size": 0,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "91405caf-a067-49e1-8053-b4841ab450ae",
                                "id": "bitcoin_id",
                                "name": "bitcoin_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d4f1812d-a5b5-45c6-a8a4-3592322fda4b",
                                "id": "bitcoin_amount",
                                "name": "bitcoin_amount",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "24253c5d-4bfc-4f1b-92a3-b7c40fc0115f",
                                "id": "withdrawal_id",
                                "name": "withdrawal_id",
                                "type": 18,
                                "size": 65536,
                                "precision": 0,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c8a9371a-ecde-42f2-8d14-7f93fedcaf2a",
                                "id": "tariff",
                                "name": "tariff",
                                "type": 6,
                                "size": 0,
                                "precision": 16,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "dcf13a6b-7c65-4d72-9239-01f7f637c929",
                        "configOptions": {},
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": null
        },
        {
            "oid": "e9862328-3718-46a9-9a01-ca8f2abbbd3b",
            "fullname": "MySql:MySql-e9862328-3718-46a9-9a01-ca8f2abbbd3b",
            "type": "extract",
            "name": "MySql-e9862328-3718-46a9-9a01-ca8f2abbbd3b",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "d42047b3-9f1e-4ca0-b58c-fb10fae6e479",
                        "id": "tq_EPkuzdeTB",
                        "name": "York_transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "616407a6-310a-4c61-a847-47712b0e98ef",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7f9f301e-33c7-4270-ab82-52b27cb636d9",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "9355f65e-88b7-4b3d-9d6a-2a0a46a4d4d8",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "60b0ffa2-1754-411f-afa2-a678bb3a6800",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7d8a64f3-0457-4f19-870e-9ed0c29c448a",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "0439f47e-7574-4d5e-bd7e-091b04a83803",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "047fe652-a355-43a5-a769-ff28bc6c670b",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5f8a02d2-4984-4ddd-b52d-68feba6cb284",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c33cca7d-52d3-45a6-8825-8adb0471972d",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "92958c76-fe38-4bb6-b73f-f6f71a3f74fe",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "40c298ce-2e16-4419-838c-5e85b681566d",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c8b2077c-16e4-404e-9560-3f9dd5f079f2",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b964fdb7-74af-4110-abbe-ec31fc5c7768",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d4ff2d04-8383-4233-9ad5-89734920f4c1",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92754857-a5e2-4358-b71d-0296d9095421",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ae020638-ac18-43f6-870a-932b465002b1",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e3025011-fe32-468b-a94e-0c0cfa852711",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2e3ce90b-bd5e-4de3-b16a-d2c138f854bc",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "aab1279a-db03-48e2-9b39-f043484691dd",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e636a5cb-6d50-45bd-a325-08a5fafb2503",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "52265d44-cd42-4ddc-a610-7a8b10407494",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "f97d99fd-721d-4387-941b-875ff882037d",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "2293220b-cf94-48c2-a13b-38792164fb64",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "58dd283b-b0a2-465e-b674-9fbbfcc83467",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "d892bec3-f2df-468e-9966-a5268d9474ea",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "92e84bc2-588d-44a0-ae02-ca6ab0943f85",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c2c2ead1-9af7-4df5-870e-b76b9aa9aadd",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "ed349c2b-b703-4c47-8a2e-6ce542e0c360",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "5fc6edf1-e321-46d9-816f-0b16af8ebc25",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName,\r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,54,68,96,128) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,54,68,96,128) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,54,68,96,128) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,54,68,96,128) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32,54,68,96,128)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32,54,68,96,128)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,54,68,96,128) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,54,68,96,128) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,54,68,96,128) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,54,68,96,128) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and coalesce(payment_provider_id,0) not in (24,32,54,68,96,128)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and COALESCE(transaction_deposit.payment_provider_id,0) not in (24,32,54,68,96,128)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617912a2d34347002cd7f513",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8PmNaR3+DZvltVY+BRrAid7RX43ivrb1Jd+YLR/hHFwhb6Dx70U9gENpiN6svSSZiXsMSYsuAL/CbGN4aqsTqQK37h2jvswX7OUxbO5ncsXT5ZAQx6xX8RhjlXWOBl+OUE=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "ee177892-0750-4e36-8fad-e83d269a73d3",
            "fullname": "MySql:MySql-ee177892-0750-4e36-8fad-e83d269a73d3",
            "type": "extract",
            "name": "MySql-ee177892-0750-4e36-8fad-e83d269a73d3",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "268f1840-4ed9-44ba-9e09-d18ea0781293",
                        "id": "tq_N5icy1TlQ",
                        "name": "PrimeOT_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "8ab1f4cb-6fc9-4a4b-9523-38b078cddafb",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f01253b9-2505-40b3-adf7-38bad239f206",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "01979f99-1701-418c-8028-1221846a68bb",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a4a626f0-f40d-46e6-a0d7-86e22297c1e1",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "95fe47e0-b282-4870-91bd-dbc1e03aec36",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "90e8f782-7b79-4ee0-be16-9c3960b6da06",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "64539d48-e885-448a-841f-5e35a2279fce",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "57ea22bf-4956-4b87-80ab-64f4d1710645",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a54f5e38-21b9-4e5c-bc6f-8e29acbb7690",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "d36f3619-a780-4d7b-a6a0-0cd2f80f5d9c",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "67bff7a7-6be2-4f6f-b4bf-aaed28ffd34d",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6d1544f5-ba48-412b-8799-6efc55545f49",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6df10bd8-45f1-49d5-b589-7dcd02384a0e",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "a61851ac-5fb7-47b0-9940-1487886983f1",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cc335d7b-5acb-4628-beae-3a321476c37a",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "79c45163-ce84-4412-8c3c-01e83f4ff6d9",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "5797dd0f-32c2-4f5d-a764-b2bcd2dc0b54",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6a5290ee-a383-4b29-993b-69365def1fc5",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e1247031-4458-4898-986f-f0e72d90cc7c",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "509fd17a-a985-43e9-86fd-d10daed3c6c5",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7cb2ac8d-1a27-4df4-b1c6-cf7a16134e52",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "35512e2c-bf09-4373-bee3-f929f7e92065",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "7c504275-ecc4-424f-8c83-6f991bb1595c",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "70fabfe9-1bf6-4691-87aa-fff66d9e9482",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "b7ace647-322f-4485-b001-2c5fb8a3d8cb",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "c348ad9e-9770-4e47-9b39-0ec784ce7784",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "cfaaea58-3230-424a-9f04-7ec11277abfa",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "6e88c3ac-7be8-401f-ae89-27c1b65e3fec",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "70b6daf6-d0b0-46f9-b494-72965a5b5a8e",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName,\r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n      replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,29,45,62,107) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,29,45,62,107) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,29,45,62,107) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,29,45,62,107) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,29,45,62,107)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,29,45,62,107)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 269 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 269 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,29,45,62,107) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,29,45,62,107) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,29,45,62,107) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,29,45,62,107) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,29,45,62,107)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,29,45,62,107)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617912b7d34347002cd7f514",
                "provider": "MySql",
                "parameters": "0uJay0RlWn75SYw5xVdoLT4FWyBbFUlsjsBxWPYQvqVuycv/bO1/KlhFXTgenJk3+BHu9aRIkX/j7vWbXGa9+f/eAlKNduVNg7Ju/gGBE8P4ucP3ysRpUY+WEjVV9XyGz+Ayjtjl2eLVAGaGDLe7CLQO1pn40szcYNg2rZoiX1Vg29Vp5lwLqTDoBiPX74Z7tq4A1c99blLl+UTfHxXxv3fHMdNaD6ZQ0AYwLSELF3A=",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fbc1eae0-df6f-45b5-83e9-bbf1785b770a",
            "fullname": "MySql:2e64207f-f792-4f5a-bc35-e991085b154e",
            "type": "extract",
            "name": "2e64207f-f792-4f5a-bc35-e991085b154e",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "b8a475da-6620-4abc-bd6a-d81ba3da6951",
                        "id": "tq_jvQj4WPt8",
                        "name": "TradeTheBit_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "7ec96bca-6463-4bd4-b07a-a319a2537595",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41463b26-768a-46ca-9a13-7e36f2d41c81",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "56cef406-e64d-4afe-a329-e7860d87bd2f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1186a9d0-3302-4edb-8cec-ee4e2e5beeef",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "7448f2bf-5592-4ff1-bfbe-2365bd9b1b67",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "308e3449-3f82-4430-9e11-07d867ae9f34",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "889fc1b1-f585-46a7-b9c3-5779aad0f8c9",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "41b4a1b4-0f8b-4300-8557-14073c7ce059",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6134de7f-7a57-46a0-91e8-cedfd48333c1",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6dd5c90d-60e0-4abb-ac2d-64c84d9944c0",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ab652b6c-8388-47e9-8655-49857cff72f7",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0a482f26-8e5f-433f-b820-f5f9e84cc9a5",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "adfd24d1-7e27-44a3-953d-c98e78b0ec58",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a24ffea3-54d4-4ee2-be71-9f5a74a96bf3",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ade055a4-2369-47a4-918a-f180aba01c37",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee914fd9-2024-40cd-89c4-33558eb2fbca",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "62c2c770-b7a1-4bce-a571-2d7ce7666329",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "68ee1c16-e2c2-46c0-aa78-e65b7d48fcf7",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "fd389857-f4da-4db8-ab0d-4c86c933351c",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b626f92b-2c12-4e24-bc09-f1d6cda86b93",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a00a02b7-6308-4d10-b538-7e4d3ab029f5",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "eac42e57-60a6-4ba9-9353-b0cc1f478560",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "3308cdca-ccde-4c48-935a-ea9b97501bdd",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a7152204-dc7d-4385-8f16-6e9836da91c0",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "98bf71e7-7b28-47be-ae7b-cc83775f1d72",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "e488acc2-b61c-4ddc-8621-a9517ccb99f4",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c87907eb-2626-4e8f-ba0b-eac6f52967ce",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "682dbb16-d1b7-4e87-8fcf-edf6e92be55d",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "771e6ea7-b42b-43dc-a221-9afad1517926",
                        "configOptions": {
                            "importQuery": "SELECT\r\n       trader.email as Email,\r\n       brand.name as SiteName, \r\n       1000 + brand_id as site_id,\r\n       trader.id as customer_id,\r\n       transaction_record.trader_account_id as trader_account_id,\r\n       transaction_record.id,\r\n       transaction_record.origin_type,\r\n       transaction_type.name,\r\n       replace(replace(replace(case when (left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)) = ''\r\n       then  case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end\r\n       else left(    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end,locate(' ',    case\r\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\r\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\r\n              else null\r\n       end) -1)\r\n       end, '\"',''),' ',''),'\t','')\r\n       as fixed_transaction_id,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.amount *( - 1 )\r\n              else transaction_record.amount\r\n       end as amount,\r\n       case\r\n              when transaction_record.origin_type in ( 2,\r\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\r\n              else transaction_record.wide_currency_amount\r\n       end as amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1 then wide_currency_amount\r\n              else 0\r\n       end as total_deposit_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,70,78) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end as deposit_amount_usd,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,70,78) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  as withdrawal_amount_usd,\r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,70,78) then wide_currency_amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,70,78) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\r\n              1)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\r\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32,70,78)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\r\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32,70,78)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\r\n       \t\telse 0 end as is_cashback,\r\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \r\n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\r\n       else 0 end as is_tech,\r\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\r\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\r\n       end as cleared_by,\r\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\r\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\r\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\r\n       end as payment_method,\r\ntransaction_record.created_at as created_at_crm,\r\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\r\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\r\n\t else 'null' end as crm_comment,\r\n\t case\r\n              when transaction_record.origin_type = 1 then transaction_record.amount\r\n              else 0\r\n       end as total_deposit_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,70,78) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end as deposit_amount_curr,\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,70,78) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  as withdrawal_amount_curr,\r\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\r\n       case\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id not in (24,32,70,78) then transaction_record.amount\r\n              when transaction_record.origin_type = 1\r\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\r\n              else 0\r\n       end -\r\n       case\r\n       \t\t  when transaction_record.origin_type = 2\r\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id not in (24,32,70,78) then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              when transaction_record.origin_type = 2\r\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\r\n              0)\r\n              else 0\r\n       end  - \r\n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\r\n       currency.code\r\n from\r\n       transaction_record\r\ninner join trader_account on\r\n       trader_account.id = transaction_record.trader_account_id\r\ninner join trader on\r\n       trader.id = trader_account.trader_id\r\ninner join transaction_type on\r\n       transaction_type.id = transaction_record.origin_type\r\ninner join currency on\r\n       currency.id = trader_account.currency_id\r\nleft join (\r\n       select\r\n              transaction_deposit.ftr_id,\r\n              transaction_deposit.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_deposit.owner_id as employee_id,\r\n              transaction_deposit.comment,\r\n              transaction_deposit.transaction_id,\r\n              transaction_deposit.psp_reference_id,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\r\n       from\r\n              transaction_deposit\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_deposit.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\r\n       transaction_deposits.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_withdraw.ftr_id,\r\n              transaction_withdraw.payment_provider_id,\r\n              payment_provider.name as payment_provider,\r\n              payment_type.name as payment_method,\r\n              transaction_withdraw.owner_id as employee_id,\r\n              transaction_withdraw.comment,\r\n              transaction_withdraw.transaction_id,\r\n              transaction_withdraw.fee_amount,\r\n              transaction_withdraw.amount -\r\n              case\r\n                     when transaction_withdraw.fee_amount is null then 0\r\n                     else transaction_withdraw.fee_amount\r\n              end as withdrawal_amount,\r\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\r\n              payment_sub_processor.name as cleared_by\r\n       from\r\n              transaction_withdraw\r\n       left join payment_provider on\r\n              payment_provider.id = transaction_withdraw.payment_provider_id\r\n       left join payment_type on\r\n              payment_type.id = payment_provider.payment_type_id\r\n       left join `user` on\r\n              `user`.id = transaction_withdraw.user_id\r\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\r\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\r\n       transaction_withdrawals.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              trader_account_id,\r\n              min(ftr_id) as ftr_id,\r\n              min(created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       WHERE\r\n              status = 'completed'\r\n              and payment_provider_id not in (24,32,70,78)\r\n       group by\r\n              1 ) ftd_ind on\r\n       ftd_ind.ftr_id = transaction_record.id\r\nleft join (\r\n       select\r\n              transaction_deposit.trader_account_id,\r\n              min(transaction_record.created_at) as ftd_date\r\n       from\r\n              transaction_deposit\r\n       inner join transaction_record on\r\n              transaction_record.id = transaction_deposit.ftr_id\r\n       WHERE\r\n              transaction_deposit.status = 'completed'\r\n              and transaction_deposit.payment_provider_id not in (24,32,70,78)\r\n       group by\r\n              1 ) ftd_date on\r\n       ftd_date.trader_account_id = transaction_record.trader_account_id\r\nleft join brand on trader.brand_id = brand.id\r\nwhere\r\n       trader.is_test = 0\r\n       and transaction_record.origin_type in ( 1,\r\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "61791355d34347002cd7f521",
                "provider": "MySql",
                "parameters": "F954Cqx2+xpp7cv613X4To3KDLtYkIILY9DKa7o2J6iwT7Hhp/LuVGR7WVoXuAJR6pANxIXoQ9aWeJiI7OcJP72ZHBxG9xyN42erULpN5ZuqvWQ4Ab7IRfQ6FHGxrmIec/RVbJ5P1EBneN6L0WOHnZFugjR8UPuM7oh3rwSSnzvjLJFOJ0c2gxjMsXRaCgVGAB0Pjz5j/uHDcFPg85fyrANVftdnJomPKg7Rk6G5kbKEybu1E9znVlAXap1CpXX6",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        },
        {
            "oid": "fd8f01c8-760a-425f-adbc-78d8da788ed6",
            "fullname": "MySql:c395927f-fc24-4d3c-89d4-4ff80e7dfbcf",
            "type": "extract",
            "name": "c395927f-fc24-4d3c-89d4-4ff80e7dfbcf",
            "modelingTransformations": [],
            "schema": {
                "tables": [
                    {
                        "oid": "ea24d713-20bb-4fd3-98d6-8e123eebf1b3",
                        "id": "tq_1cxqkHndK",
                        "name": "WinGroup_Transactions",
                        "type": "base",
                        "schemaName": "crm",
                        "expression": null,
                        "customCode": null,
                        "columns": [
                            {
                                "oid": "b0beb6e5-cce6-4718-a1e3-bd2155efa0a8",
                                "id": "Email",
                                "name": "Email",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b84aeae3-6381-4c05-b7e2-7a2af6af2ae4",
                                "id": "SiteName",
                                "name": "SiteName",
                                "type": 18,
                                "size": 50,
                                "precision": 50,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a8b67ff6-470b-4d91-bfef-b4430c128b4f",
                                "id": "site_id",
                                "name": "site_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "f54ff330-382f-4373-8f29-db74aebf642b",
                                "id": "customer_id",
                                "name": "customer_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "46ad1789-c01f-412d-9c32-1bdb405e03cd",
                                "id": "trader_account_id",
                                "name": "trader_account_id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3e6bdaee-f27b-474c-b2a7-6366cef67227",
                                "id": "id",
                                "name": "id",
                                "type": 0,
                                "size": 20,
                                "precision": 20,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "4b0659be-dfcf-42da-9a3c-aa6bbb9d3861",
                                "id": "origin_type",
                                "name": "origin_type",
                                "type": 8,
                                "size": 10,
                                "precision": 10,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ba071f72-d8e7-4f4e-b094-39820f0714c1",
                                "id": "name",
                                "name": "name",
                                "type": 18,
                                "size": 100,
                                "precision": 100,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a1ece6de-ca1f-47af-92b3-1a2abd7beb15",
                                "id": "fixed_transaction_id",
                                "name": "fixed_transaction_id",
                                "type": 18,
                                "size": 128,
                                "precision": 128,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "708b5b38-79e4-481c-be94-b0a0c6bc3029",
                                "id": "amount",
                                "name": "amount",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "a5e90fd7-ea74-4484-a8ae-a714930cd612",
                                "id": "amount_usd",
                                "name": "amount_usd",
                                "type": 5,
                                "size": 20,
                                "precision": 20,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bc366f6e-0134-4324-91f5-318ba230eecd",
                                "id": "total_deposit_amount_usd",
                                "name": "total_deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "1fad70e4-d456-4024-b35a-bd019161c54d",
                                "id": "deposit_amount_usd",
                                "name": "deposit_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b1e62c30-3e23-4e80-b08d-a4780b61a1ef",
                                "id": "withdrawal_amount_usd",
                                "name": "withdrawal_amount_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "ee4eead9-f00e-4d5c-9107-f62dedbb659e",
                                "id": "chargeback_amount_usd",
                                "name": "chargeback_amount_usd",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "354d5813-ffd3-4c71-a94e-505d816c33b4",
                                "id": "net_deposit_usd",
                                "name": "net_deposit_usd",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "18433a83-f867-44c1-8222-25b4f49e19a1",
                                "id": "is_cashback",
                                "name": "is_cashback",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0ba903bd-5848-4bbc-94e3-9f97418efdc9",
                                "id": "is_tech",
                                "name": "is_tech",
                                "type": 0,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "b33117eb-0306-49ce-84dc-f8b3a26b3704",
                                "id": "cleared_by",
                                "name": "cleared_by",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "c0dc32ad-d009-4067-bade-bb8e5e83c617",
                                "id": "payment_method",
                                "name": "payment_method",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "bd38f57e-5457-423c-a27f-df659e2e1e7f",
                                "id": "created_at_crm",
                                "name": "created_at_crm",
                                "type": 4,
                                "size": 19,
                                "precision": 19,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "6717ab0e-cc1e-47a5-a869-6ae105592109",
                                "id": "crm_comment",
                                "name": "crm_comment",
                                "type": 18,
                                "size": 65535,
                                "precision": 65535,
                                "scale": 0,
                                "hidden": true,
                                "indexed": false,
                                "description": null
                            },
                            {
                                "oid": "e9e3c76f-6516-466a-ac15-72980d87481b",
                                "id": "total_deposit_amount_curr",
                                "name": "total_deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "0786c15d-b13b-481d-964c-3fab936983f3",
                                "id": "deposit_amount_curr",
                                "name": "deposit_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "38f82d33-a6f6-4c35-9303-77e9d321621e",
                                "id": "withdrawal_amount_curr",
                                "name": "withdrawal_amount_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3bbf47f6-457a-4147-8eeb-cded3ccdf2f5",
                                "id": "chargeback_amount_curr",
                                "name": "chargeback_amount_curr",
                                "type": 5,
                                "size": 19,
                                "precision": 19,
                                "scale": 4,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "5c61cb5a-3bf8-4cd1-9ee9-3ba5058568bc",
                                "id": "net_deposit_curr",
                                "name": "net_deposit_curr",
                                "type": 40,
                                "size": 23,
                                "precision": 23,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            },
                            {
                                "oid": "3a242929-bb43-4c5d-b812-018fa32ae86f",
                                "id": "code",
                                "name": "code",
                                "type": 18,
                                "size": 191,
                                "precision": 191,
                                "scale": 0,
                                "hidden": true,
                                "indexed": true,
                                "description": null
                            }
                        ],
                        "buildBehavior": {
                            "type": "sync",
                            "accumulativeConfig": null
                        },
                        "tupleTransformations": [],
                        "hidden": true,
                        "vTag": "00096249-e419-4729-a324-5eb5a7b89312",
                        "configOptions": {
                            "importQuery": "SELECT\n       trader.email as Email,\n       brand.name as SiteName, \n       1000 + brand_id as site_id,\n       trader.id as customer_id,\n       transaction_record.trader_account_id as trader_account_id,\n       transaction_record.id,\n       transaction_record.origin_type,\n       transaction_type.name,\n       replace(replace(replace(case when (left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)) = ''\n       then  case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end\n       else left(    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end,locate(' ',    case\n              when transaction_record.origin_type = 1 then cast(transaction_deposits.transaction_id as char)\n              when transaction_record.origin_type = 2 then cast(transaction_withdrawals.transaction_id as char)\n              else null\n       end) -1)\n       end, '\"',''),' ',''),'\t','')\n       as fixed_transaction_id,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.amount *( - 1 )\n              else transaction_record.amount\n       end as amount,\n       case\n              when transaction_record.origin_type in ( 2,\n              3 ) then transaction_record.wide_currency_amount * ( - 1 )\n              else transaction_record.wide_currency_amount\n       end as amount_usd,\n       case\n              when transaction_record.origin_type = 1 then wide_currency_amount\n              else 0\n       end as total_deposit_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end as deposit_amount_usd,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  as withdrawal_amount_usd,\n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount else 0 end as chargeback_amount_usd,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then wide_currency_amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then wide_currency_amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0) * COALESCE((transaction_record.wide_currency_amount / transaction_record.amount),\n              1)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.wide_currency_amount * -1 else 0 end as net_deposit_usd,\n       case when (transaction_record.origin_type = 1 and coalesce(transaction_deposits.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 1 and transaction_deposits.psp_reference_id in ('CH SR Cashback')) then 1\n       \t\twhen (transaction_record.origin_type = 2 and COALESCE(transaction_withdrawals.payment_provider_id,0) in (24,32)) or (transaction_record.origin_type = 2 and transaction_withdrawals.cleared_by in ('CH SR Cashback')) then 1\n       \t\telse 0 end as is_cashback,\n       case when transaction_record.origin_type = 1 and transaction_deposits.employee_id = 219 then 1 \n       \t\twhen transaction_record.origin_type = 2 and transaction_withdrawals.employee_id = 219 then 1\n       else 0 end as is_tech,\n       case when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.psp_reference_id,transaction_deposits.payment_method)\n       \t\twhen transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.cleared_by,transaction_withdrawals.payment_method)\n       end as cleared_by,\n       case when transaction_record.origin_type = 1 then transaction_deposits.payment_method\n       \t\twhen transaction_record.origin_type = 2 then transaction_withdrawals.payment_method\n       \t\twhen transaction_record.origin_type = 3 then 'Chargeback'\n       end as payment_method,\ntransaction_record.created_at as created_at_crm,\ncase when transaction_record.origin_type = 1 then COALESCE(transaction_deposits.comment,'null')\n\t when transaction_record.origin_type = 2 then COALESCE(transaction_withdrawals.comment,'null')\n\t else 'null' end as crm_comment,\n\t case\n              when transaction_record.origin_type = 1 then transaction_record.amount\n              else 0\n       end as total_deposit_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end as deposit_amount_curr,\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  as withdrawal_amount_curr,\n       case when transaction_record.origin_type = 3 then transaction_record.amount else 0 end as chargeback_amount_curr,\n       case\n              when transaction_record.origin_type = 1\n              and transaction_deposits.psp_reference_id = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id not in (24,32) then transaction_record.amount\n              when transaction_record.origin_type = 1\n              and transaction_deposits.payment_provider_id is null then transaction_record.amount\n              else 0\n       end -\n       case\n       \t\t  when transaction_record.origin_type = 2\n       \t\t  and transaction_withdrawals.cleared_by = 'CH SR Cashback' then 0\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id not in (24,32) then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              when transaction_record.origin_type = 2\n              and transaction_withdrawals.payment_provider_id is null then COALESCE(transaction_withdrawals.withdrawal_amount,\n              0)\n              else 0\n       end  - \n       case when transaction_record.origin_type = 3 then transaction_record.amount * -1 else 0 end as net_deposit_curr,\n       currency.code\n from\n       transaction_record\ninner join trader_account on\n       trader_account.id = transaction_record.trader_account_id\ninner join trader on\n       trader.id = trader_account.trader_id\ninner join transaction_type on\n       transaction_type.id = transaction_record.origin_type\ninner join currency on\n       currency.id = trader_account.currency_id\nleft join (\n       select\n              transaction_deposit.ftr_id,\n              transaction_deposit.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_deposit.owner_id as employee_id,\n              transaction_deposit.comment,\n              transaction_deposit.transaction_id,\n              transaction_deposit.psp_reference_id,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee\n       from\n              transaction_deposit\n       left join payment_provider on\n              payment_provider.id = transaction_deposit.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_deposit.user_id ) transaction_deposits on\n       transaction_deposits.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_withdraw.ftr_id,\n              transaction_withdraw.payment_provider_id,\n              payment_provider.name as payment_provider,\n              payment_type.name as payment_method,\n              transaction_withdraw.owner_id as employee_id,\n              transaction_withdraw.comment,\n              transaction_withdraw.transaction_id,\n              transaction_withdraw.fee_amount,\n              transaction_withdraw.amount -\n              case\n                     when transaction_withdraw.fee_amount is null then 0\n                     else transaction_withdraw.fee_amount\n              end as withdrawal_amount,\n              concat( `user`.first_name, ' ', `user`.last_name ) as process_employee,\n              payment_sub_processor.name as cleared_by\n       from\n              transaction_withdraw\n       left join payment_provider on\n              payment_provider.id = transaction_withdraw.payment_provider_id\n       left join payment_type on\n              payment_type.id = payment_provider.payment_type_id\n       left join `user` on\n              `user`.id = transaction_withdraw.user_id\n       left join transaction_sub_processor on transaction_withdraw.id = transaction_sub_processor.transaction_id and transaction_sub_processor.origin_id = 2\n       left join payment_sub_processor on transaction_sub_processor.payment_sub_processor_id = payment_sub_processor.id) transaction_withdrawals on\n       transaction_withdrawals.ftr_id = transaction_record.id\nleft join (\n       select\n              trader_account_id,\n              min(ftr_id) as ftr_id,\n              min(created_at) as ftd_date\n       from\n              transaction_deposit\n       WHERE\n              status = 'completed'\n              and payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_ind on\n       ftd_ind.ftr_id = transaction_record.id\nleft join (\n       select\n              transaction_deposit.trader_account_id,\n              min(transaction_record.created_at) as ftd_date\n       from\n              transaction_deposit\n       inner join transaction_record on\n              transaction_record.id = transaction_deposit.ftr_id\n       WHERE\n              transaction_deposit.status = 'completed'\n              and transaction_deposit.payment_provider_id not in (24,32)\n       group by\n              1 ) ftd_date on\n       ftd_date.trader_account_id = transaction_record.trader_account_id\nleft join brand on trader.brand_id = brand.id\nwhere\n       trader.is_test = 0\n       and transaction_record.origin_type in ( 1,\n       2,3)"
                        },
                        "description": null,
                        "tags": null
                    }
                ]
            },
            "connection": {
                "id": "617913c2d34347002cd7f52d",
                "provider": "MySql",
                "parameters": "7niuYEzJZH44LaPxXSBFhgupfobVTnd8RwuqT0tnpje5KDJ7gduGgbtju1DOzrlHXyxYXX725adKvwo0Axykr9WoMGo9e6lj1avkQiOehykewRR3dL0bFhZy2PD1D/s214ZB/FP6EjZLCw1IBo8M2ECB8F5338o8R/suGfqjWRnOflsq2MUpBYr+Wc7GJM/Dz7GG94Zi/zFyYcZz2sw/RvGv2nW3dmxfd2U2fn5h1ubfdO27mRkN4g+kxmvyY8s8",
                "schema": "crm",
                "fileName": null,
                "timeout": 300,
                "autoRefresh": null,
                "refreshRate": null,
                "resultLimit": null,
                "protectedParameters": [
                    "password"
                ],
                "uiParams": {},
                "globalTableConfigOptions": null
            }
        }
    ]
}